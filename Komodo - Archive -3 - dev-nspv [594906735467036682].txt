==============================================================
Guild: Komodo
Channel: Archive -3 / dev-nspv
Topic: ./komodod -nSPV=1 -ac_reward=100000000  -ac_name=NSPV -ac_supply=10000000000 -ac_cc=2 -addressindex=1 -spentindex=1 -connect=5.9.102.210 &
./komodod -nSPV=1 -addnode=5.9.253.195 &
https://drive.google.com/drive/folders/1ZvzrhNBQgroejTKPl0kCOTJ8h7XMnO2M?usp=sharing
==============================================================

[30-Jun-19 08:07 AM] Fab√ò#8941
top

{Reactions}
üîù 

[30-Jun-19 08:07 AM] Tierno#3327
üëå


[30-Jun-19 08:07 AM] Fab√ò#8941
Hi @Deleted User how are you


[30-Jun-19 08:07 AM] Fab√ò#8941
on it?


[30-Jun-19 08:08 AM] Fab√ò#8941
nice


[30-Jun-19 08:08 AM] Fab√ò#8941
could anyone interested could declare itself like " on it for ......"


[30-Jun-19 08:09 AM] Fab√ò#8941
```on it for``` business dev, funding, legals, venture capital industry and asset management


[30-Jun-19 08:09 AM] Fab√ò#8941
@Tierno I volunteer you üòÉ


[30-Jun-19 08:09 AM] grewalsatinder#9653
feeling excited for this! üòÉ


[30-Jun-19 08:10 AM] Fab√ò#8941
of course man


[30-Jun-19 08:11 AM] Fab√ò#8941
@jl777c thanks for these, you killing it


[30-Jun-19 08:11 AM] Tierno#3327
On it for venture capital, and asset management and more if needed !


[30-Jun-19 08:11 AM] jl777c#5810
always nice to solve a previously unsolved problem using simple means


[30-Jun-19 08:12 AM] Fab√ò#8941
@Tierno would you mind gathering what JL says need to be done and ping it here as a start point


[30-Jun-19 08:12 AM] jl777c#5810
first step is to find a competent dev to do the breadwallet core changes


[30-Jun-19 08:12 AM] jl777c#5810
once we get the core working, then can deal with GUI side things


[30-Jun-19 08:12 AM] Fab√ò#8941
that is what is missing in this damn world "Le bon sens"


[30-Jun-19 08:12 AM] Tierno#3327
@Fab√ò sure!


[30-Jun-19 08:13 AM] grewalsatinder#9653
May I suggest @dukeleto ? üòâ


[30-Jun-19 08:13 AM] grewalsatinder#9653
or @radix42 üòâ


[30-Jun-19 08:14 AM] Fab√ò#8941
@grewalsatinder @Deleted User @Alright @dukeleto any idea of good candidates for this ```competent dev```


[30-Jun-19 08:14 AM] Fab√ò#8941
üòâ


[30-Jun-19 08:14 AM] grewalsatinder#9653
I mentioned already... üòÅ


[30-Jun-19 08:14 AM] Fab√ò#8941
damn i am to old guys


[30-Jun-19 08:14 AM] grewalsatinder#9653
I'd also lean towards @miketout, but I know he's hell more busy with his project üôÇ


[30-Jun-19 08:15 AM] jl777c#5810
would be good to find new devs, instead of overloading existing ones


[30-Jun-19 08:15 AM] jl777c#5810
this is a well defined task

{Reactions}
‚òù 

[30-Jun-19 08:15 AM] grewalsatinder#9653
agree with James on new devs too


[30-Jun-19 08:15 AM] jl777c#5810
prefer to find new devs that can come into the ecosystem


[30-Jun-19 08:15 AM] Fab√ò#8941
k @grewalsatinder @radix42 is kind of busy on ARRR (we are deep on this dont pull it away üòâ


[30-Jun-19 08:15 AM] grewalsatinder#9653
üòÑ yeh


[30-Jun-19 08:16 AM] Fab√ò#8941
```prefer to find new devs that can come into the ecosystem``` copy


[30-Jun-19 08:16 AM] Fab√ò#8941
let's bring someone


[30-Jun-19 08:16 AM] jl777c#5810
maybe someone from the breadwallet community?


[30-Jun-19 08:16 AM] jl777c#5810
that would be the most efficient


[30-Jun-19 08:16 AM] grewalsatinder#9653
I'll try finding someone from my circle if possible...


[30-Jun-19 08:16 AM] Fab√ò#8941
@grewalsatinder could you be of help here to help me write the specs


[30-Jun-19 08:17 AM] grewalsatinder#9653
Sure!


[30-Jun-19 08:17 AM] Fab√ò#8941
```maybe someone from the breadwallet community?``` best way for sure what will be the incentive?


[30-Jun-19 08:17 AM] jl777c#5810
a bounty?


[30-Jun-19 08:17 AM] jl777c#5810
or for a proven dev, some short term dev contract


[30-Jun-19 08:17 AM] Fab√ò#8941
@grewalsatinder could you organize a talk we can talk with him about compensation package fiat and crypto


[30-Jun-19 08:18 AM] grewalsatinder#9653
him who?


[30-Jun-19 08:18 AM] Fab√ò#8941
```or for a proven dev, some short term dev contract``` some people (amazing one) are incentive to money üòâ they like vision


[30-Jun-19 08:18 AM] grewalsatinder#9653
the dev?


[30-Jun-19 08:18 AM] jl777c#5810
does breadwallet have a discord?


[30-Jun-19 08:18 AM] Fab√ò#8941
```someone from the breadwallet community?```


[30-Jun-19 08:18 AM] grewalsatinder#9653
I'm going to look into breadwallet community, give me few minutes


[30-Jun-19 08:18 AM] Fab√ò#8941
@grewalsatinder


[30-Jun-19 08:19 AM] jl777c#5810
maybe you can find where their community is and try to recruit for a short term project


[30-Jun-19 08:19 AM] jl777c#5810
and get quotes


[30-Jun-19 08:19 AM] Fab√ò#8941
on it JL with @Tierno


[30-Jun-19 08:19 AM] jl777c#5810
if it can be added to the official breadwallet, that would be the best case


[30-Jun-19 08:19 AM] grewalsatinder#9653
got it, on to my research


[30-Jun-19 08:19 AM] jl777c#5810
and worth more


[30-Jun-19 08:19 AM] jl777c#5810
sapling support will need a new signing method to be added


[30-Jun-19 08:19 AM] jl777c#5810
that gets all the zcash forks added to breadwalle


[30-Jun-19 08:20 AM] Fab√ò#8941
k @grewalsatinder @Tierno  coordination is super important we need to seem very pro

{Reactions}
üëç 

[30-Jun-19 08:20 AM] jl777c#5810
nSPV can then be a special optimization for dPoW enabled coins


[30-Jun-19 08:20 AM] Fab√ò#8941
```that gets all the zcash forks added to breadwalle``` huge


[30-Jun-19 08:20 AM] jl777c#5810
so maybe breadwallet company is interested to do this as an official project


[30-Jun-19 08:20 AM] jl777c#5810
that would be the best case actually


[30-Jun-19 08:20 AM] Fab√ò#8941
agreed


[30-Jun-19 08:20 AM] Fab√ò#8941
we need to talk to them


[30-Jun-19 08:21 AM] jl777c#5810
that is definitely in the VC/bizdev side of things


[30-Jun-19 08:21 AM] jl777c#5810
i know they didn an ICO and have a BRD token


[30-Jun-19 08:21 AM] Fab√ò#8941
maybe eventually do the old fashion rodeo and see them in personne to put energy in


[30-Jun-19 08:21 AM] Fab√ò#8941
on it JL


[30-Jun-19 08:21 AM] jl777c#5810
thanks!


[30-Jun-19 08:21 AM] Fab√ò#8941
are you kidding thanks to you, sorry we are all slow


[30-Jun-19 08:22 AM] grewalsatinder#9653
https://www.reddit.com/r/BRDapp/

{Embed}
https://www.reddit.com/r/BRDapp/
r/BRDapp
https://images-ext-2.discordapp.net/external/_iJNbb4iVILezm_TDpTegLc2HxpMUlYTcOzid2C1328/https/b.thumbs.redditmedia.com/ymGzpteqLc-L_ytFcRtmyVZR7Kzh0tXw8O-cTplkXZQ.png


[30-Jun-19 08:23 AM] grewalsatinder#9653
support@breadwallet.com


[30-Jun-19 08:24 AM] Fab√ò#8941
please @grewalsatinder  @Tierno  let's gather informations, analyze this and know what are the outcome we are looking for, evaluate them and than contact them with proposals in mind


[30-Jun-19 08:24 AM] Fab√ò#8941
seems like a plan?


[30-Jun-19 08:24 AM] grewalsatinder#9653
breadwallet dev: Ehsan https://twitter.com/ewerx
CTO: Samuel Sutch sam@sutch.net https://github.com/samuraisam
Aaron Voisine: http://breadwallet.com https://github.com/voisine

{Embed}
https://twitter.com/ewerx
Ehsan (@ewerx)
code/design/tech/art/crypto. dev at @BRDHQ, maker of @apphindsight, pixel pusher at @orbitalmechs. i have a beard, sometimes.
Tweets
1246
Followers
390
https://images-ext-2.discordapp.net/external/311oCdf3P41F6eKZwN6EXwhV9noRQszkdwJRKcixLao/https/pbs.twimg.com/profile_images/378800000796144033/58b71749485c4e50c9e80b65e5fa7433_normal.png
Twitter

{Embed}
https://github.com/samuraisam
samuraisam - Overview
CTO @breadwallet. samuraisam has 102 repositories available. Follow their code on GitHub.
https://images-ext-2.discordapp.net/external/7UP3w2Rl3LaZ8S-Ta8KJNxE_xV9T2WSXMxCqsLMQloI/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/101497


[30-Jun-19 08:24 AM] Fab√ò#8941
killing it


[30-Jun-19 08:25 AM] Tierno#3327
@Fab√ò yes let‚Äôs start digging


[30-Jun-19 08:25 AM] Fab√ò#8941
now let's figure out what we exactly wants from this and evaluate it with accuracy


[30-Jun-19 08:26 AM] grewalsatinder#9653
these are the only 3 people who are contributors to this BreadWallet project


[30-Jun-19 08:26 AM] Fab√ò#8941
sorry @grewalsatinder


[30-Jun-19 08:26 AM] grewalsatinder#9653
I guess we can also make a post in breadwallet reddit which is the only community I found so far


[30-Jun-19 08:26 AM] Fab√ò#8941
I m not a dev could you help map up with @Deleted User what exactly needs to be done in details


[30-Jun-19 08:26 AM] Fab√ò#8941
with skills set , estimate time etc....


[30-Jun-19 08:27 AM] Fab√ò#8941
```I guess we can also make a post in breadwallet reddit which is the only community I found so far``` to fast IMO


[30-Jun-19 08:27 AM] Fab√ò#8941
üòÉ


[30-Jun-19 08:28 AM] grewalsatinder#9653
yep, after making some text ready etc. of course


[30-Jun-19 08:29 AM] jl777c#5810
changes to breadwallet core:
1. support for sapling tx signing
2. support for komodo ecosystem coins (i already did this to old breadwallet but without sapling signing)
3. support for nSPV

I estimate one to two months (at most) for the above, and that should be enough to get it so it can be part of the official breadwallet


[30-Jun-19 08:29 AM] Fab√ò#8941
ok perfect


[30-Jun-19 08:29 AM] jl777c#5810
then, the breadwallet GUI would just work automatically with nSPV


[30-Jun-19 08:29 AM] grewalsatinder#9653
Token support -tokensupport@breadapp.com


[30-Jun-19 08:29 AM] Fab√ò#8941
thanks


[30-Jun-19 08:30 AM] jl777c#5810
1. is about implementing https://github.com/zcash/zips/blob/master/zip-0243.rst

{Embed}
https://github.com/zcash/zips/blob/master/zip-0243.rst
zcash/zips
Zcash Improvement Proposals. Contribute to zcash/zips development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/QPRkPDZ0P8HYtO4CeaEVJF0ANfqYgXKpk3VxiNKYmhw/%3Fs%3D400%26v%3D4/https/avatars0.githubusercontent.com/u/16122764


[30-Jun-19 08:30 AM] jl777c#5810
2. is a matter of coin parameters


[30-Jun-19 08:30 AM] jl777c#5810
3. is making a few calls per utxo to verify them, but also would require changing the internal control flow as it must be based on syncing all the headers


[30-Jun-19 08:31 AM] grewalsatinder#9653
@jl777c I guess the first task must be the support to add zcash/komodo transparent SPV, like porting your changes from breadwallet iOS repo to breadwallet-core, and then add nSPV, and then add Sapling signing support. making the sapling signing task first they may probably feel it's too difficult.... or may be not, but just thinking....


[30-Jun-19 08:32 AM] jl777c#5810
sapling support lets them support ZEC and all zcash forks


[30-Jun-19 08:32 AM] jl777c#5810
more work, but a lot more coins supported


[30-Jun-19 08:32 AM] Fab√ò#8941
this is huge


[30-Jun-19 08:32 AM] jl777c#5810
maybe zcash foundation can be brought into this too


[30-Jun-19 08:32 AM] Fab√ò#8941
privacy coins is the only future for this space


[30-Jun-19 08:32 AM] Fab√ò#8941
this is huge


[30-Jun-19 08:33 AM] jl777c#5810
seems that they could easily pay for sapling support added to breadwallet


[30-Jun-19 08:33 AM] grewalsatinder#9653
if sapling signing is the task, I guess we can also just post about this first task in Zcash community places and get a dev for doing this task ü§î


[30-Jun-19 08:33 AM] Fab√ò#8941
we should almost buy them out before we start and own this wallet


[30-Jun-19 08:34 AM] jl777c#5810
doubt that is possible, as they have a company based on this wallet, been around since 2012(?), did an ICO


[30-Jun-19 08:34 AM] Fab√ò#8941
tks for your insight


[30-Jun-19 08:35 AM] Fab√ò#8941
I am gonna do some due dil to understand where they coming from where they are heading to and what can of deal we could leverage


[30-Jun-19 08:35 AM] jl777c#5810
@grewalsatinder can you see if there is any existing SPV wallet for ZEC taddr?


[30-Jun-19 08:35 AM] jl777c#5810
if not, we should be able to get zcash foundation to help with funding for that portion of this


[30-Jun-19 08:35 AM] grewalsatinder#9653
sure, will dig on to github and search engines


[30-Jun-19 08:36 AM] grewalsatinder#9653
or I'll probably just sign up with Zcash foundation community and ask them directly, they might have better knowledge if there is already one.


[30-Jun-19 09:22 AM] grewalsatinder#9653
found Guarda wallet is working on Zcash-SPV: https://github.com/guardaco/zcash-SPV/issues/1

{Embed}
https://github.com/guardaco/zcash-SPV/issues/1
SPV library API discussion ¬∑ Issue #1 ¬∑ guardaco/zcash-SPV
Dear Z-Cash foundation and community.Guarda is doing Z-Cash grant SPV library and Wallet Android project #ZcashFoundation/GrantProposals-2017Q4#16. We&#39;d like to have the communications in a...
https://images-ext-1.discordapp.net/external/QfoNOam5VefryEUvgDmIHQ9pFnzLs4WJkmHN52a1qEY/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/36878430


[30-Jun-19 09:22 AM] grewalsatinder#9653
@jl777c


[30-Jun-19 09:22 AM] grewalsatinder#9653
checking further to make sure it is what it is that we want


[30-Jun-19 09:23 AM] grewalsatinder#9653
yes, this is the Zcash T-SPV library: https://github.com/guardaco/zcash-SPV

{Embed}
https://github.com/guardaco/zcash-SPV
guardaco/zcash-SPV
Zcash Grant SPV library (Sapling). Contribute to guardaco/zcash-SPV development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/QfoNOam5VefryEUvgDmIHQ9pFnzLs4WJkmHN52a1qEY/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/36878430


[30-Jun-19 09:24 AM] grewalsatinder#9653
based on this comment: https://github.com/guardaco/zcash-SPV/issues/1#issuecomment-374911301

{Embed}
https://github.com/guardaco/zcash-SPV/issues/1
SPV library API discussion ¬∑ Issue #1 ¬∑ guardaco/zcash-SPV
Dear Z-Cash foundation and community.Guarda is doing Z-Cash grant SPV library and Wallet Android project #ZcashFoundation/GrantProposals-2017Q4#16. We&#39;d like to have the communications in a...
https://images-ext-1.discordapp.net/external/QfoNOam5VefryEUvgDmIHQ9pFnzLs4WJkmHN52a1qEY/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/36878430


[30-Jun-19 09:24 AM] grewalsatinder#9653
and I see it's all just a Java Mobile App code


[30-Jun-19 09:27 AM] grewalsatinder#9653
this guy did most of the work on Zcash-SPV wallet:
https://github.com/samosudov

{Embed}
https://github.com/samosudov
samosudov - Overview
samosudov has 14 repositories available. Follow their code on GitHub.
https://images-ext-2.discordapp.net/external/ibYR34d6BiTK6tPR4-R0mpt9mVWEazyYP2PwzaBMYg4/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/14328865


[30-Jun-19 09:27 AM] grewalsatinder#9653
Zcash-SPV Dev: Danila Samosudov samosudovd@gmail.com


[30-Jun-19 09:27 AM] grewalsatinder#9653
@Fab√ò


[30-Jun-19 09:28 AM] jl777c#5810
the perfect dev for this!


[30-Jun-19 09:28 AM] jl777c#5810
someone that did a normal SPV wallet especially sapling taddr, if the wallet is good of course


[30-Jun-19 09:28 AM] jl777c#5810
maybe we should test it to make sure it does headers only sync and works stable


[30-Jun-19 09:29 AM] Fab√ò#8941
thanks @grewalsatinder copy that


[30-Jun-19 09:30 AM] grewalsatinder#9653
yes, I know @ca333 knows mobile Java stuff. I guess he can help with it.


[30-Jun-19 09:37 AM] jl777c#5810
not sure Java is a tech stack ca333 will like

{Reactions}
üíØ 

[30-Jun-19 09:38 AM] jl777c#5810
but to get a quick proof of concept, maybe it is ok


[30-Jun-19 09:41 AM] grewalsatinder#9653
true, I'd even think some Java and C/C++ dev who can port the changes from this Java logic to breadwallet-core, just in case the logic porting is the thing.
I know it looks more work, but just had a quick thought


[30-Jun-19 09:42 AM] grewalsatinder#9653
So far I couldn't find any other Zcash SPV project other than this library I found, and that guy I mentioned is the main dev for it.


[30-Jun-19 09:44 AM] jl777c#5810
i like the breadwallet core as it is in C


[30-Jun-19 09:44 AM] jl777c#5810
so maybe we can approach breadwallet dev too and it is much better to become part of official breadwallet than guarda wallet


[30-Jun-19 09:45 AM] grewalsatinder#9653
agree, I will leave the contacting to @Fab√ò and @Tierno üôÇ


[30-Jun-19 09:46 AM] Fab√ò#8941
perfect will be done


[30-Jun-19 09:46 AM] jl777c#5810
so advantage of guarda is already the zcash sapling is supported, but downside is that it is in java and guarda wallet is much smaller installed base than breadwallet


[30-Jun-19 09:46 AM] jl777c#5810
breadwallet is much larger installed base and in C, but no zcash sapling support


[30-Jun-19 09:47 AM] grewalsatinder#9653
yes, and pretty sure BreadWallet team will love to have Sapling support added in their code, and now they can also have a look at the Zcash-SPV codebase for required logic to implement üòâ


[30-Jun-19 09:47 AM] Fab√ò#8941
humm seems that Guarda has an hedge no?


[30-Jun-19 09:47 AM] grewalsatinder#9653
and if they really go with that, even on their own, that'd be kinda half requirement done.


[30-Jun-19 09:49 AM] Fab√ò#8941
yep can see that, seems like the distance and difficulties are higher with breadwallet compare to guarda no?


[30-Jun-19 09:50 AM] Fab√ò#8941
also probably less ego on the guarda wallet


[30-Jun-19 09:50 AM] jl777c#5810
a bit, but supporting zcash family must be an attractive thing for breadwallet for expanding market and it would give you a good reason to get involved with zcash foundation


[30-Jun-19 09:50 AM] Fab√ò#8941
seems like we will get an easier time negociating


[30-Jun-19 09:50 AM] Fab√ò#8941
```a bit, but supporting zcash family must be an attractive thing for breadwallet for expanding market and it would give you a good reason to get involved with zcash foundation
```


[30-Jun-19 09:51 AM] Fab√ò#8941
are we doing the gemini thing contacting both?


[30-Jun-19 09:52 AM] jl777c#5810
i leave to you, how best you see this


[30-Jun-19 09:53 AM] grewalsatinder#9653
@jl777c thank for that innovative post on nSPV tech today. It's been a best day start for me after so long! üòÉ


[30-Jun-19 09:53 AM] Fab√ò#8941
ok thanks JL


[30-Jun-19 09:53 AM] Fab√ò#8941
will do


[30-Jun-19 12:13 PM] jl777c#5810
found a dev that can start in about a month or so on the breadwallet work, so maybe we just need to convince them to help us in the effort and to accept a PR once it is working so it gets added to their standard breadwallet. having a secondary effort on the java path would make sense as it is better to have two solutions ready to go than rely on one

{Reactions}
üëè (5) üòÉ (5) üëç (5) üöÄ (5) üéâ (4) üíØ (3) 

[30-Jun-19 12:18 PM] grewalsatinder#9653
great progress! üòÉ


[30-Jun-19 12:20 PM] jl777c#5810
so pursue talks with breadwallet, we need the path paved for them to accept the PR when we get the nSPV working, along with some advice along the way (if we need it). and on the java side, maybe we can see if the java dev is interested in adding nSPV support

{Reactions}
‚úÖ 

[01-Jul-19 01:51 AM] Slyris#2880
I can totally translate the Java code in modern c++ if someone is interested


[01-Jul-19 01:52 AM] jl777c#5810
seems best to add the nSPV functionality to the java code, in java


[01-Jul-19 01:53 AM] Slyris#2880
You want to fork the project ?


[01-Jul-19 01:56 AM] Slyris#2880
Oh ok i read the whole conversation, very interesting, I need to dive into the code, and by the way nice article on nSPV very interesting


[01-Jul-19 01:56 AM] jl777c#5810
starting from https://github.com/guardaco/zcash-SPV which supports sapling, it seems we need to replace the header syncing

{Embed}
https://github.com/guardaco/zcash-SPV
guardaco/zcash-SPV
Zcash Grant SPV library (Sapling). Contribute to guardaco/zcash-SPV development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/QfoNOam5VefryEUvgDmIHQ9pFnzLs4WJkmHN52a1qEY/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/36878430


[01-Jul-19 01:56 AM] jl777c#5810
and change to a per-utxo validation


[01-Jul-19 01:58 AM] jl777c#5810
that can then invoke a series of p2p queries to find the notarizations bracketing the utxo, getting the headers between the first and last notarization, then validating that they link backwards properly. once that is done, a standard merkle proof for the utxo for whichever block it was in. at that point we know the utxo is "in" the merkleroot, which is in the block, which is in the segment of the blockchain that is notarized


[01-Jul-19 01:59 AM] jl777c#5810
separately to this logic, we need a way to know what utxo an address has, so there will be some extra p2p messages supported that allow to query for notarizations, addressutxos/txids, txproofs


[01-Jul-19 02:02 AM] jl777c#5810
nSPV avoids having to do the headers sync, which for bitcoin is only 80 bytes per block, but for equihash it is 2kb, so a much bigger issue for equihash coins. even for 80 byte headers, one million blocks is 80mb of data that is needed. nSPV for 80 byte headers would be less than 1kb of data plus txproof to validate a utxo


[01-Jul-19 02:02 AM] Slyris#2880
It's really interesting, I'm reading the code of the spv library


[01-Jul-19 02:02 AM] jl777c#5810
so depending on what you compare to 100x, 1000x or 10000x less data


[01-Jul-19 02:02 AM] Slyris#2880
Yes, if I understand your article is an huge improvement


[01-Jul-19 02:02 AM] Slyris#2880
And disruptive approach


[01-Jul-19 02:03 AM] jl777c#5810
basically achieves the same goals of flyclient without any complex math, not that there is anything wrong with complex math and fancy algo. just not something you can code up in a relatively small amount of time. with nSPV,  the code changes would be minimal


[01-Jul-19 02:04 AM] Slyris#2880
Did you plan to write a paper ? I mean a PDF with full details ?


[01-Jul-19 02:04 AM] jl777c#5810
it seems simple enough. does it need a paper? i think just need to define the p2p messages needed to support the nSPV clients


[01-Jul-19 02:04 AM] jl777c#5810
getnotarization, getaddressutxos, gettxproof


[01-Jul-19 02:05 AM] jl777c#5810
basically mapping existing rpc calls to p2p message


[01-Jul-19 02:05 AM] Slyris#2880
It's simple, yes but it's very interesting


[01-Jul-19 02:05 AM] jl777c#5810
simple is not a pejorative, it is in fact a very good attribute. much less chance for bugs!


[01-Jul-19 02:05 AM] Slyris#2880
We absolutely need this.


[01-Jul-19 02:06 AM] jl777c#5810
yes, i estimate each 1000 full nodes can support a million nSPV clients


[01-Jul-19 02:06 AM] jl777c#5810
maybe even more for special full nodes configured to handle a lot of client connections


[01-Jul-19 02:07 AM] Slyris#2880
We can probably benchmark it once we have something ready


[01-Jul-19 02:07 AM] jl777c#5810
yes. and i prefer to document things after it is working


[01-Jul-19 02:07 AM] Slyris#2880
I'm at work now, I will look deeper when I'm at home


[01-Jul-19 02:08 AM] jl777c#5810
the nSPV blogpost describes enough to guide how to do it. if you are able to do this, i am sure we can gather up a bounty for it and i can help define the specifcs that are needed, and probably just code up the required daemon side code. we can launch a smartchain just to test this and get it working


[01-Jul-19 02:12 AM] Slyris#2880
I will play with the existing spv client to understand how it's work first, and then I will try to make a playground and playing with it, once I learn how its work I will of course try to implement what you described in your blog post


[01-Jul-19 02:12 AM] Slyris#2880
Thank's for the information and the repository


[01-Jul-19 02:16 AM] jl777c#5810
you will need to connect to a coin network with the nSPV p2p messages, let me know a few days before you are ready to test and i can have the daemon side ready


[01-Jul-19 02:17 AM] Slyris#2880
Ok firstly I'm reading and I will look deeper this evening.


[01-Jul-19 02:18 AM] jl777c#5810
thanks!


[01-Jul-19 02:44 AM] Slyris#2880
If I have any question, I will let you know in ask-jl777c channel


[01-Jul-19 03:02 AM] jl777c#5810
ok


[02-Jul-19 11:49 AM] jl777c#5810
@Slyris i made a stubbed out, but functional -nSPV=1 mode in my nSPV branch. you can see where the client side is headed in the komodo_nSPV.h file


[02-Jul-19 11:58 AM] Slyris#2880
@jl777c Thank's i will check it


[02-Jul-19 12:01 PM] Slyris#2880
@jl777c Can you explain me :

```cpp
    uint8_t nSolution[1344]; //! <- 
```

I dont understand this array size


[02-Jul-19 12:06 PM] jl777c#5810
size of equihash solution


[02-Jul-19 12:06 PM] Slyris#2880
ok i get it


[02-Jul-19 12:07 PM] Slyris#2880
Is it for compilation speed that you use C functionnality instead of C++ ? (such as time functionnality) ?


[02-Jul-19 12:11 PM] jl777c#5810
I like to fully understand what the code is doing. with C, I can do this. not so with C++


[02-Jul-19 12:11 PM] Slyris#2880
Ok !


[02-Jul-19 12:11 PM] jl777c#5810
also, it is very likely we will need to port this to pure C


[02-Jul-19 12:11 PM] jl777c#5810
and so i want to minimize c++ usage as much as possible


[02-Jul-19 12:11 PM] Slyris#2880
There is a line where you cast the return of time to uint32_t and another line where you didn't


[02-Jul-19 12:11 PM] Slyris#2880
but i think is not important


[02-Jul-19 12:12 PM] Slyris#2880
I understand you, if you can do it without using any std library, it's will improve your compilation time


[02-Jul-19 12:13 PM] jl777c#5810
fixed the missing (uint32_t)


[02-Jul-19 12:14 PM] jl777c#5810
some compilers spit out warnings if isnt done


[02-Jul-19 12:14 PM] jl777c#5810
std::vector is the only thing that seems very useful


[02-Jul-19 12:14 PM] Slyris#2880
Yes but we can remplace it with full C code easyli if you target C


[02-Jul-19 12:14 PM] jl777c#5810
i got the hooks into the main protocol flow and all the nSPV specific things will be in komodo_nSPV.h


[02-Jul-19 12:14 PM] Slyris#2880
We can totally drop the C++ part


[02-Jul-19 12:15 PM] jl777c#5810
yes, I can just port the std::vector to C ptrs, for now, just trying to get things put together and working as a reference implementation


[02-Jul-19 12:15 PM] Slyris#2880
If we want we can do that: https://github.com/doom/ceeds/blob/master/include/ceeds/vector.h

{Embed}
https://github.com/doom/ceeds/blob/master/include/ceeds/vector.h
doom/ceeds
C boilerplate code, to be used as seeds for my C projects - doom/ceeds
https://images-ext-1.discordapp.net/external/AXdY00wq3_PjAqJBQgFv0sDwcv8Q9fHbyh7HUZ5EyWw/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/19640245


[02-Jul-19 12:15 PM] jl777c#5810
the daemon side will be there in all the nodes


[02-Jul-19 12:16 PM] jl777c#5810
thanks, ceeds seems handy


[02-Jul-19 12:16 PM] Slyris#2880
It's my best friend C library


[02-Jul-19 12:16 PM] Slyris#2880
is an expert


[02-Jul-19 12:16 PM] Slyris#2880
He write this library to have some usefull container in C


[02-Jul-19 12:16 PM] Slyris#2880
and dropping C++


[02-Jul-19 12:17 PM] Slyris#2880
so you have basis : string, vector, map, set etc


[02-Jul-19 12:17 PM] Slyris#2880
binary_heap, bitmanip


[02-Jul-19 12:18 PM] jl777c#5810
i will just write the reference and get it working. after that we can worry about making it pure C, porting to java, etc.


[02-Jul-19 12:19 PM] Slyris#2880
Yes, great


[02-Jul-19 12:19 PM] jl777c#5810
i think with the NSPV_INFO, UTXOS, NTZS, NTZPROOF, TXPROOF query messages, that will allow a client to have all the data needed to create and sign rawtransactions


[02-Jul-19 12:19 PM] jl777c#5810
but pretty sure some of the structures will need tweaking, at least they should be reasonably close


[02-Jul-19 12:20 PM] jl777c#5810
there is a rate limit per peer built in, so the nSPV client needs to make sure it doesnt go too fast or it just wastes query


[02-Jul-19 12:20 PM] Slyris#2880
Yes i just link you this code to have an idea


[02-Jul-19 12:21 PM] Slyris#2880
We need to make a measurement for the performance of `nSPV` no ?


[02-Jul-19 12:21 PM] jl777c#5810
so, get basic chain info, get a list of all your utxo. for each utxo, find the before/after notarizations. then aggregate the data and make requests for the notarization proofs, along with txproofs


[02-Jul-19 12:22 PM] jl777c#5810
that gets all the data needed to validate the rawtx, blockheaders and you can create transactions ready to spend. though it doesnt deal with mempool, it is a good practical first iteration


[02-Jul-19 12:22 PM] jl777c#5810
i think the limit for nSPV will be the number of peer connections per full node. it isnt bandwidth intensive


[02-Jul-19 12:23 PM] jl777c#5810
we can definitely stress test things to see what sort of multiplier each full node can get, i estimate at least 1000x, if not 10000x


[02-Jul-19 12:23 PM] Slyris#2880
Yes stress test will be usefull here


[02-Jul-19 12:24 PM] jl777c#5810
aha! i can just add any txid in the mempool to the UTXOS query


[02-Jul-19 12:24 PM] Slyris#2880
How much number peer of connections did you expect


[02-Jul-19 12:24 PM] jl777c#5810
the default caps to 155 or something like that.


[02-Jul-19 12:24 PM] jl777c#5810
so we will need to tweak the networking limits a bit


[02-Jul-19 12:25 PM] Slyris#2880
hmm, seem's fair


[02-Jul-19 12:26 PM] jl777c#5810
currently, i think all peers are counted the same. we need to allow much higher numbers of nSPV peers


[02-Jul-19 12:27 PM] Slyris#2880
what the mean of the `n` in `nSPV` ?


[02-Jul-19 12:27 PM] jl777c#5810
notarized SPV


[02-Jul-19 12:27 PM] Slyris#2880
Of course


[02-Jul-19 12:27 PM] Slyris#2880
Since is all based on notarization


[02-Jul-19 12:27 PM] Slyris#2880
dpow is an incredible consensus man


[02-Jul-19 12:28 PM] Slyris#2880
i'm impressed.


[02-Jul-19 12:30 PM] jl777c#5810
now that the p2p networking is basically working, (i have a testnet doing request/response with stub messages) i just need to connect it to the actual rpc functionality and then the cli nSPV client would be able to return notarized balance, list of utxo and their values. Given that using normal createrawtransaction and signrawtransaction, sendrawtransaction, you can construct sends. since all the actual nSPV clients will be doing their own local signing, probably no need to do much fancy operations, maybe a nSPVsend rpc call to just simplify the rawtx stuff


[02-Jul-19 12:30 PM] jl777c#5810
then with a working reference nSPV client and a working set of full nodes deployed, validating other nSPV implementations becomes much much easier


[02-Jul-19 12:31 PM] Slyris#2880
You will add an optional parameters in those rpc call ?


[02-Jul-19 12:31 PM] Slyris#2880
Specifying nSPV ?


[02-Jul-19 12:31 PM] jl777c#5810
i will make a special nSPVsend that will work similar to sendtoaddress


[02-Jul-19 12:31 PM] jl777c#5810
but it will only work in nSPV=1 nodes


[02-Jul-19 12:31 PM] Slyris#2880
so a new rpc call


[02-Jul-19 12:31 PM] Slyris#2880
ok i get it


[02-Jul-19 12:31 PM] jl777c#5810
yes, much better to keep things separated


[02-Jul-19 12:32 PM] Slyris#2880
Yeah, it's better actually


[02-Jul-19 12:33 PM] jl777c#5810
i think there will only be a few rpc calls, will know more when i put it all together, but something like nSPVlogin and nSPVbalance,maybe nSPVhistory, nSPVsend, nSPVtxinfo


[02-Jul-19 12:35 PM] jl777c#5810
nothing will be saved to disk


[02-Jul-19 12:35 PM] Slyris#2880
you will push in the same branch ?


[02-Jul-19 12:35 PM] jl777c#5810
yes, it will all go into nSPV branch


[02-Jul-19 12:35 PM] Slyris#2880
Ok


[02-Jul-19 12:36 PM] Slyris#2880
i will follow the code update


[02-Jul-19 12:36 PM] jl777c#5810
i am aiming for a working cli nSPV wallet by this weekend

{Reactions}
üëÄ 

[02-Jul-19 12:37 PM] Slyris#2880
nSPV will distrupt the blockchain industry, lot of people don't know yet


[02-Jul-19 12:37 PM] Slyris#2880
But it's a huge improvement...


[02-Jul-19 12:37 PM] jl777c#5810
3 to 5 seconds from start to being able to send a valid tx


[02-Jul-19 12:38 PM] jl777c#5810
basically a stateless wallet tech as it is fast enough to reinitialize everything with each login


[02-Jul-19 12:39 PM] jl777c#5810
if you have 10,000 utxo, that will take a long time with just one full node, but once there are 100+ fullnodes, it would initialize in a couple minutes


[02-Jul-19 12:39 PM] jl777c#5810
and 10,000 utxo is just too many, most wallets will just have a few utxo


[02-Jul-19 12:40 PM] Slyris#2880
you are right


[02-Jul-19 02:05 PM] jl777c#5810
i verified that nSPV capable full nodes and normal can coexist. nSPV client nodes will just reject any full node or other client node


[02-Jul-19 02:06 PM] jl777c#5810
this means we can test with existing coin p2p networks, without any hardfork

{Reactions}
üëç 

[03-Jul-19 07:32 AM] jl777c#5810
@TonyL latest version is working, at least the nSPV client requests blockchain info and addressutxos info. inadvertently i had an address with 12,000+ utxo, but it seemed to work nearly instantly


[03-Jul-19 07:32 AM] jl777c#5810
i have serialization/deserialization done for all the initial structs, which i think will get us 90%+ of the way to a working cli nSPV wallet


[03-Jul-19 07:33 AM] jl777c#5810
which is the next step, to add rpc calls for basic wallet functions


[03-Jul-19 07:33 AM] jl777c#5810
at first it will work as api wallet and not bother with merkle validations, but with all the data available, it would just be a matter of adding the checks to make it secure


[03-Jul-19 08:23 AM] allbits#5898
When you get the working nSPV cli wallet, is that something a noob like me could test?


[03-Jul-19 08:31 AM] jl777c#5810
yes


[03-Jul-19 08:31 AM] jl777c#5810
the commands will be very limited


[03-Jul-19 08:32 AM] jl777c#5810
login, getbalance, send


[03-Jul-19 08:46 AM] allbits#5898
Cool :)

SPV wallets are far more secure than API lite wallets, right?


[03-Jul-19 08:53 AM] jl777c#5810
yes


[03-Jul-19 08:54 AM] jl777c#5810
nSPV wallet is basically the same security level as a full node


[03-Jul-19 08:54 AM] jl777c#5810
the only issue is that it needs to poll random nodes to find out what utxo it has, but if you track that locally, there is no need to rely on external nodes


[03-Jul-19 09:03 AM] allbits#5898
Thanks


[03-Jul-19 10:19 AM] Mylo#8306
how will nodes allow nSPV clients to connect?  is it a different RPC interface?


[03-Jul-19 10:20 AM] Mylo#8306
or is it http?  sorry for noob q


[03-Jul-19 10:38 AM] jl777c#5810
new p2p messages


[03-Jul-19 10:38 AM] jl777c#5810
it is already coded to allow the nSPV capable nodes to be mixed with older nodes. no hardfork needed


[03-Jul-19 10:41 AM] jl777c#5810
existing coin network will support the nSPV nodes


[03-Jul-19 10:42 AM] jl777c#5810
look into normal headers sync SPV clients


[03-Jul-19 10:54 AM] jl777c#5810
@Slyris the p2p networking is testing out well, i got all the (de)serialization coded for all the structures and the fullnode side is 99% done with setting them, even validated two of the messages is going from client -> fullnode -> client and the data seems reasonable. next will be to properly request all the messages from the client side and writing a simple wallet rpc -> client side code.
 on track for simple reference cli wallet by the weekend, probably wont get all the merkle validation done as that is tricky, but at least the data will be flowing from fullnode to superlite, so we can get bandwidth loading tests


[03-Jul-19 10:55 AM] jl777c#5810
its up to 1000 lines of code though... probably a few bugs crept in, but when i validate the data client side i should find most all of those issues. i did remove the internal usage of std::vector and just made it allocated/freed


[03-Jul-19 11:27 AM] Slyris#2880
i will look at it thank's¬†@jl777c


[03-Jul-19 11:36 AM] Slyris#2880
@jl777c You have to much verification that a pointer is not null for free


[03-Jul-19 11:36 AM] Slyris#2880
Is not needed in c : https://stackoverflow.com/questions/6084218/is-it-good-practice-to-free-a-null-pointer-in-c

{Embed}
https://stackoverflow.com/questions/6084218/is-it-good-practice-to-free-a-null-pointer-in-c
Is it good practice to free a NULL pointer in C?
Possible Duplicate:
  Does free(ptr) where ptr is NULL corrupt memory?  
I'm writing a C function that frees a pointer if it was malloc()ed. The pointer can either be NULL (in the case that an error
https://images-ext-1.discordapp.net/external/dP07hBXxuorGcvXU609uJ_e6ZgPlIdBxqG8OjQQiAyY/%3Fv%3D73d79a89bded/https/cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon%402.png


[03-Jul-19 11:37 AM] Slyris#2880
according to: http://www.open-std.org/JTC1/SC22/wg14/www/docs/n1124.pdf


[03-Jul-19 11:37 AM] Slyris#2880
https://github.com/jl777/komodo/blob/nSPV/src/komodo_nSPV.h#L308 you can safely remove the verification here inside the first if statement

{Embed}
https://github.com/jl777/komodo/blob/nSPV/src/komodo_nSPV.h
jl777/komodo
Komodo. Contribute to jl777/komodo development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[03-Jul-19 11:39 AM] jl777c#5810
i am not 100% convinced it holds true for all C compilers on all OS


[03-Jul-19 11:39 AM] Slyris#2880
It is since it's the standard


[03-Jul-19 11:39 AM] jl777c#5810
it is a defensive check, doesnt harm the logic


[03-Jul-19 11:40 AM] Slyris#2880
Yeah


[03-Jul-19 11:40 AM] Slyris#2880
no problem


[03-Jul-19 11:40 AM] Slyris#2880
and also i have a question about here: https://github.com/jl777/komodo/blob/nSPV/src/komodo_nSPV.h#L356

{Embed}
https://github.com/jl777/komodo/blob/nSPV/src/komodo_nSPV.h
jl777/komodo
Komodo. Contribute to jl777/komodo development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[03-Jul-19 11:40 AM] Slyris#2880
Is it something like if the pointer is null you dereference it ?


[03-Jul-19 11:40 AM] jl777c#5810
fprintf(stderr,"implement NSPV_getnotarization_txid\n");


[03-Jul-19 11:40 AM] jl777c#5810
that is the one function not implemented yet


[03-Jul-19 11:40 AM] Slyris#2880
Ah ok , was afraid


[03-Jul-19 11:41 AM] Slyris#2880
With which compiler are you compiling ?


[03-Jul-19 11:41 AM] jl777c#5810
this is meant to be a reference version, not worried about efficiency so much


[03-Jul-19 11:41 AM] jl777c#5810
just using gcc or clang


[03-Jul-19 11:43 AM] Slyris#2880
May be, when the efficiency will be important we can add unlikely attribute


[03-Jul-19 11:43 AM] Slyris#2880
what do you think ?


[03-Jul-19 11:44 AM] jl777c#5810
for reference version, i dont see so much need


[03-Jul-19 11:44 AM] jl777c#5810
though i guess the fullnode side will likely be the production version...


[03-Jul-19 11:44 AM] jl777c#5810
for now, i am not worried about optimizations, more just getting it to work so it can be used as a spec


[03-Jul-19 11:44 AM] Slyris#2880
Ok !


[03-Jul-19 11:44 AM] Slyris#2880
No problem


[03-Jul-19 11:45 AM] Slyris#2880
i will check the rest of the code and ask you if i dont undesrtand something


[03-Jul-19 11:45 AM] jl777c#5810
thanks, not worried about small stuff, just that it makes sense and works


[03-Jul-19 11:46 AM] Slyris#2880
to be honest i trust you on the behavior, because it's your idea, and if the tests are going well, i dont worry


[03-Jul-19 11:46 AM] Slyris#2880
I was thinking that performance was mandatory for you that's why i tell you that minor things


[03-Jul-19 11:46 AM] Slyris#2880
i will focus on the behavior and critical error if i find


[03-Jul-19 11:47 AM] jl777c#5810
most concerned i forgot some field in some structures in the (de)serialization


[03-Jul-19 11:47 AM] jl777c#5810
or forgot to initialize some variable before using it


[03-Jul-19 11:48 AM] Slyris#2880
still one vector here: https://github.com/jl777/komodo/blob/nSPV/src/komodo_nSPV.h#L798

{Embed}
https://github.com/jl777/komodo/blob/nSPV/src/komodo_nSPV.h
jl777/komodo
Komodo. Contribute to jl777/komodo development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[03-Jul-19 11:49 AM] jl777c#5810
yes for the interface functions, there will be c++ stuff as it is interfacing to c++ code


[03-Jul-19 11:49 AM] jl777c#5810
i did minimize it a lot though, so a pure C implementation wont be too much changes, but it didnt make sense to convert the C++ interface to the c++ code to C


[03-Jul-19 11:50 AM] Slyris#2880
i think for future pure C implementation we can think about something like ceeds to make our life easier


[03-Jul-19 11:50 AM] Slyris#2880
So it's will be more pleaseant to write


[03-Jul-19 11:50 AM] jl777c#5810
it only took a day to get it all in place, i just didnt want to spend time getting familiar with some new tools


[03-Jul-19 11:51 AM] Slyris#2880
i understand you


[03-Jul-19 11:51 AM] jl777c#5810
on a strict schedule. today was to get the fullnode side as close to code complete as possible


[03-Jul-19 11:51 AM] Slyris#2880
Perfectly understandable


[03-Jul-19 11:51 AM] jl777c#5810
tomorrow is to get the client side done


[03-Jul-19 11:51 AM] jl777c#5810
so that last function will be totally redone anyway


[03-Jul-19 11:52 AM] jl777c#5810
i am finding that a 12000 utxo address is taking fraction of a second, so i can change the client side model to being a single threaded one


[03-Jul-19 11:53 AM] jl777c#5810
which will simplify the logic a lot and still i think the transaction can be constructed and sent within a few seconds, though for many vin tx i will need to rethink the one request per second limitation on proof queries


[03-Jul-19 11:55 AM] jl777c#5810
anyway, i will think on how to make the client side easy to understand and flexible


[03-Jul-19 07:29 PM] TonyL#3577
@jl777c rebuilding to test connection with latest changes


[03-Jul-19 07:49 PM] TonyL#3577
Not connecting on latest:

prints on client side:
```
236 236 236 nonz.3 ccenables[]
perc 0.0777% ac_pub=[02713b...] acsize.0
ERA0: end.0 reward.1478310502 halving.525600 decay.0 notarypay.0
MAX_MONEY 11562981097404846 115629810.97404847
02713bd85e054db923694b6b7a85306264edf4d6bd6d331814f2b40af444b3ebbc0000000000000000663a1d580000000020050800000000000000000000000000842f01005d2a0000feffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff extralen.105 crc0.5530402a
call komodo_args.(./komodod) NOTARY_PUBKEY.()
>>>>>>>>>> ZEXO: p2p.33969 rpc.33970 magic.13043f5d 319045469 100000000 coins
initialized ZEXO at 1562208485
recv: version peer=1
request address @ÔøΩÔøΩN
recv: verack peer=1
recv: ping peer=1
recv: pong peer=1
recv: nSPV peer=1
got info response 1562208487 size.145
```

prints on server side:
```getaddressutxos.(@ÔøΩÔøΩN) slen.0
implement NSPV_getnotarization_txid
free(): invalid next size (fast)
```


[03-Jul-19 09:22 PM] jl777c#5810
you need -pubkey=0.... for now


[03-Jul-19 09:55 PM] TonyL#3577
on both server and client?


[03-Jul-19 09:55 PM] jl777c#5810
just the client

{Reactions}
üëç 

[03-Jul-19 09:56 PM] jl777c#5810
this will change with next version


[03-Jul-19 09:56 PM] jl777c#5810
just needed a hardcoded address


[03-Jul-19 09:57 PM] jl777c#5810
invalid free could be an independent bug, but i should be able to make things more reliable once i get client side way to invoke messages


[03-Jul-19 09:57 PM] TonyL#3577
ok, I can just wait for the next version I think


[03-Jul-19 10:01 PM] jl777c#5810
yes, that will have client side rpc, much easier to use


[04-Jul-19 07:37 AM] jl777c#5810
@TonyL next version has half a dozen nspv_* rpc calls, help will show them. ILN is the best chain to use, very short and notarized. -addnode=5.9.102.210 and it should connect to 1 or more fullnodes ready to go. there is a one message per second limit per peer, for each specific type of message. now that the low level messages appear to be working, the next step is to put it all together to allow it to send funds. at first without 100% validation, as that gets it to the same level as API wallets, and as more and more is validated, it becomes the near native level security.

there is the concept of "login", which is passed in a valid wif. for the following 60 seconds, transactions using vins with that privkey will be signed. that is the plan. after 60 seconds, it is scrubbed from RAM.

still need to implement an efficient way to find the notarization transaction txid, once that is there, all the data needed for validation will be back to the nSPV client. more peers are 5.9.253.200 to 204


[04-Jul-19 07:41 AM] TonyL#3577
sounds great! will go ahead with testing when wake up


[04-Jul-19 03:53 PM] daemonfox#6136
I have synced an ILN node with the latest nSPV branch to try and help if I can.


[04-Jul-19 03:54 PM] daemonfox#6136
75.11.62.221 dedicated IP


[04-Jul-19 03:54 PM] daemonfox#6136
"blocks": 2668,
  "longestchain": 2668,
  "timeoffset": 0,
  "tiptime": 1562233138,
  "connections": 8,


[04-Jul-19 07:41 PM] TonyL#3577
Aha @daemonfox , so this node is your nSPV server - now you can connect client/s to it. In your client daemon start  params just use your server IP in `addnode` and add `-nSPV=1`


[04-Jul-19 07:42 PM] TonyL#3577
https://github.com/tonymorony/komodo-cctools-python/blob/master/scripts/nspv_clients_spawn.py have simple script to spawn multiply clients on single PC in case if you will want to test loading on your server, just chain params needs to be changed to ILN

{Embed}
https://github.com/tonymorony/komodo-cctools-python/blob/master/scripts/nspv_clients_spawn.py
tonymorony/komodo-cctools-python
Python libs and interfaces for Komodo cryptoconditions consensus modules - tonymorony/komodo-cctools-python
https://images-ext-1.discordapp.net/external/Holp9AfaeFvGp5-FK21tFWPUG6Vhnnx7aN2SJk6LnTA/https/repository-images.githubusercontent.com/151382224/5007df00-6c99-11e9-8f36-dfd6d7e8d715


[04-Jul-19 07:44 PM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 2668,
  "chaintip": "0551057bfd0fe25e49a6b2a7aad27dcb2e75d36d66a764cf6d9f0eb8c96ef35e",
  "notarization": {
    "notarized_height": 2664,
    "notarized_blockhash": "01ff20ae26b2ad4ff3bc4993bdd12caa9a6e1e7f0739df356705d58293434558",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "c4ff3370392c3ca2ac61331bec98e91225a23297f2ded150c23e80d0c22913f7"
  }
}
``` thats awesome really


[04-Jul-19 07:45 PM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_proof 10 2664
error code: -32601
error message:
Method not found
``` hmm but have it in help


[04-Jul-19 08:03 PM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_spentinfo bf18a4809fd8218c5096c901e6520ab82a9a04cef6bf5a4e7be33a9800d7d1d9 0
got spentinfo response 1562295728 size.12557
{
  "result": "success",
  "txid": "bf18a4809fd8218c5096c901e6520ab82a9a04cef6bf5a4e7be33a9800d7d1d9",
  "vout": 0,
  "spentheight": 791,
  "spenttxid": "eefcf8e2397c56cc3e323b1e15826b348132fce977a0f05e49007f9c1dcb5ab4",
  "spentvini": 92,
  "spenttxlen": 10886,
  "spenttxprooflen": 1590
}
```


[04-Jul-19 08:03 PM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_txproof bf18a4809fd8218c5096c901e6520ab82a9a04cef6bf5a4e7be33a9800d7d1d9 777
got txproof response 1562295801 size.1718
{
  "txid": "bf18a4809fd8218c5096c901e6520ab82a9a04cef6bf5a4e7be33a9800d7d1d9",
  "height": 777,
  "txlen": 119,
  "txprooflen": 1558
}
```


[04-Jul-19 08:03 PM] daemonfox#6136
oh man... this looks awesome... but im working on another thing right now so it has to wait


[04-Jul-19 08:03 PM] daemonfox#6136
but i will play with this soon


[04-Jul-19 08:03 PM] TonyL#3577
calls seems work fine, just need some addy with balance to check listunspent


[04-Jul-19 08:04 PM] daemonfox#6136
and try some nSPV commands


[04-Jul-19 08:04 PM] daemonfox#6136
is there a testnet coin we can get some funds on that will work with this? I think i have BEER and PIZZA left but IDK which will work with this


[04-Jul-19 08:06 PM] TonyL#3577
in general you can make full node for any chain you want


[04-Jul-19 08:07 PM] TonyL#3577
just for huge chains syncing with `-addressindex=1 -spentindex=1 ` is long


[04-Jul-19 08:07 PM] TonyL#3577
only clue is that this chain should be notarized


[04-Jul-19 08:11 PM] TonyL#3577
ah, and if you want to connect many clients to server - server you should start with `-maxconnections=somebignumber`, forgot to mention that


[04-Jul-19 08:19 PM] TonyL#3577
`  "connections": 191,` connected few clients from laptop


[04-Jul-19 09:30 PM] TonyL#3577
`"connections": 790,` somewhere around this number server starting to drop connections, it feels like there is 777 nSPV clients limitation üòÖ (other few clients - initial non nSPV connections)


[04-Jul-19 09:31 PM] TonyL#3577
`"connections": 835` oh just passed trough - 1000 is close


[04-Jul-19 09:32 PM] TonyL#3577
resources usage on server with almost 1000 connections

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/596558953765273611/unknown.png


[04-Jul-19 09:34 PM] TonyL#3577
looks like it's possible to make nSPV server on microwave


[04-Jul-19 09:51 PM] TonyL#3577
Can't pass trough `"connections": 873,`, have few thousand clients
tried to restart server but it reaching this number and not connecting more, nothing helpful in prints/logs


[04-Jul-19 09:52 PM] TonyL#3577
and new clients I'm connecting receiving `got info response 1562302296 size.145 height.2668` but connections amount on server doesn't grow


[04-Jul-19 10:06 PM] jl777c#5810
typo in help, nspv_hdrsproof


[04-Jul-19 10:07 PM] daemonfox#6136
wow


[04-Jul-19 10:07 PM] daemonfox#6136
im almost done with my PoS64 setup and want to mess with this lol


[04-Jul-19 10:07 PM] jl777c#5810
you shouldnt need to spin up any fullnodes, i have 10 of them and i think there is enough remote data calls now to put together a wallet function


[04-Jul-19 10:08 PM] jl777c#5810
i just need to implement the DB query for finding the notarization. its been a long grind, but finally coming together


[04-Jul-19 10:10 PM] daemonfox#6136
so then i think i technically do not have a full node running... that IP I set is my VM static but I launchd and left my daemon with one of your addnode IPs and -nSPV=1 from the start


[04-Jul-19 10:10 PM] daemonfox#6136
I should be able to make an nSPV call from here but i have no coins lol


[04-Jul-19 10:10 PM] daemonfox#6136
WTB ILN?


[04-Jul-19 10:18 PM] jl777c#5810
post your address i will send some test amounts


[04-Jul-19 10:19 PM] jl777c#5810
@TonyL pretty sure i fixed that invalid free() crash, but we really need to stress test the fullnodes as the support for it goes into all the fullnodes and any bug could cause the entire network to be messed up


[04-Jul-19 10:21 PM] TonyL#3577
Oh, ok will attack with ` -addnode=5.9.102.210 ` param so


[04-Jul-19 10:21 PM] TonyL#3577
`RMjy5VkHFJkXTJDTJ3XX1zVzukP48sKyva`


[04-Jul-19 10:22 PM] jl777c#5810
or -connect so it will just try to kill that node


[04-Jul-19 10:23 PM] jl777c#5810
i will send funds later today


[04-Jul-19 10:27 PM] daemonfox#6136
RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa


[04-Jul-19 10:34 PM] daemonfox#6136
ok without my local node running without nSPV, i cant get the rigth info


[04-Jul-19 10:34 PM] daemonfox#6136
nspv calls come back 0 blocks


[04-Jul-19 10:35 PM] daemonfox#6136
so how would I launch a simple nspv command to one of the published nodes?


[04-Jul-19 10:35 PM] jl777c#5810
you need to build nSPV branch


[04-Jul-19 10:35 PM] daemonfox#6136
i have it


[04-Jul-19 10:35 PM] jl777c#5810
launch with -nSPV=1


[04-Jul-19 10:36 PM] jl777c#5810
now it is an nSPV node and other than the nspv_* rpc calls, maybe they will work, maybe not


[04-Jul-19 10:36 PM] jl777c#5810
the normal wallet is disabled


[04-Jul-19 10:36 PM] daemonfox#6136
just komodod -ac_name=ILN -addnode=5.9.102.210 -nSPV=1


[04-Jul-19 10:36 PM] jl777c#5810
as long as you have 1 nSPV full node, you can issue nSPV messages and the nspv rpc calls will work


[04-Jul-19 10:37 PM] jl777c#5810
if you see a "got info response... " prints you are in contact with the fullnode


[04-Jul-19 10:37 PM] TonyL#3577
`-ac_name=ILN  -ac_supply=10000000000 -ac_cc=2 -addnode=5.9.102.210 -nSPV=1`


[04-Jul-19 10:37 PM] daemonfox#6136
^^


[04-Jul-19 10:37 PM] daemonfox#6136
When i run that with that last flag added...


[04-Jul-19 10:37 PM] daemonfox#6136
I get calls with only zero values


[04-Jul-19 10:38 PM] jl777c#5810
getpeerinfo and make sure you have nSPV fullnode(s) as peers


[04-Jul-19 10:38 PM] jl777c#5810
nServices will have 70000... set


[04-Jul-19 10:38 PM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 2668,
  "chaintip": "0551057bfd0fe25e49a6b2a7aad27dcb2e75d36d66a764cf6d9f0eb8c96ef35e",
  "notarization": {
    "notarized_height": 2664,
    "notarized_blockhash": "01ff20ae26b2ad4ff3bc4993bdd12caa9a6e1e7f0739df356705d58293434558",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "c4ff3370392c3ca2ac61331bec98e91225a23297f2ded150c23e80d0c22913f7"
  }
}```


[04-Jul-19 10:38 PM] TonyL#3577
Just connected fine to `5.9.102.210`


[04-Jul-19 10:40 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 0,
  "chaintip": "0000000000000000000000000000000000000000000000000000000000000000",
  "notarization": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"
  }


[04-Jul-19 10:40 PM] jl777c#5810
do you have nSPV peer?


[04-Jul-19 10:42 PM] TonyL#3577
started to connect more clients to `5.9.102.210`


[04-Jul-19 10:43 PM] jl777c#5810
nSPV clients should only keep peers that are nSPV full nodes


[04-Jul-19 10:43 PM] jl777c#5810
i see 7 on my client


[04-Jul-19 10:43 PM] jl777c#5810
so far, i am not seeing any stability issues


[04-Jul-19 10:43 PM] TonyL#3577
7 thats strange - I spinned 400 already


[04-Jul-19 10:43 PM] TonyL#3577
```unexpected fname.(/home/ubuntu/node_236) vs ILN [ILN] n.3 len.21 (236)
call komodo_args.(./komodod) NOTARY_PUBKEY.()
push.(getnSPV)
recv: pong peer=1
push.(getnSPV)
push.(getnSPV)
recv: ping peer=1
push.(pong)
push.(ping)
recv: addr peer=1
recv: pong peer=1
push.(getnSPV)
push.(getnSPV)
push.(getnSPV)
push.(getnSPV)
recv: nSPV peer=1
got info response 1562305421```


[04-Jul-19 10:44 PM] TonyL#3577
and getting info response


[04-Jul-19 10:44 PM] jl777c#5810
i see 384 on the full node


[04-Jul-19 10:44 PM] jl777c#5810
7 on the client node


[04-Jul-19 10:44 PM] jl777c#5810
there are 10 nSPV fullnodes


[04-Jul-19 10:44 PM] TonyL#3577
ah, I see - I'm using `-connect=5.9.102.210`


[04-Jul-19 10:44 PM] TonyL#3577
lets try to rekt this one first


[04-Jul-19 10:44 PM] jl777c#5810
cant get more than 10 peers if you are an nSPV client


[04-Jul-19 10:45 PM] jl777c#5810
5.9.102.210 at 80% CPU


[04-Jul-19 10:46 PM] TonyL#3577
4 juicy servers attacking it simultaniously


[04-Jul-19 10:46 PM] jl777c#5810
what messages are you issuing?


[04-Jul-19 10:46 PM] TonyL#3577
just connecting


[04-Jul-19 10:47 PM] TonyL#3577
no RPC calls in test yet


[04-Jul-19 10:48 PM] jl777c#5810
strange that load is so high... i guess a bug


[04-Jul-19 10:50 PM] TonyL#3577
spinned 2000 clinets - how many connected?


[04-Jul-19 10:52 PM] jl777c#5810
384


[04-Jul-19 10:53 PM] jl777c#5810
i didnt set maxconnections!


[04-Jul-19 10:54 PM] jl777c#5810
restarting node


[04-Jul-19 10:54 PM] jl777c#5810
let see if it automatically reconnects


[04-Jul-19 10:54 PM] TonyL#3577
it should


[04-Jul-19 10:54 PM] jl777c#5810
it seem so,


[04-Jul-19 10:54 PM] TonyL#3577
in my tests nodes reconnected automatically and pretty fast


[04-Jul-19 10:55 PM] jl777c#5810
860 connections


[04-Jul-19 10:55 PM] TonyL#3577
873 was my highscore


[04-Jul-19 10:55 PM] TonyL#3577
then it just stopped to connect without visible reason


[04-Jul-19 10:55 PM] daemonfox#6136
ive tried a couple of the node IPs provided earlier... same result IDK why with the .nSPV=1 flag it wont return any block info


[04-Jul-19 10:55 PM] jl777c#5810
that is why CPU load is high


[04-Jul-19 10:55 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodod -ac_name=ILN -ac_supply=10000000000 -ac_cc=2 -connect=5.9.253.204 -nSPV=1
ASSETCHAINS_SUPPLY 10000000000
nonz.0 ccenables[]
MAX_MONEY 1000000006320417438 10000000063.20417404
Created (/home/daemonfox/.komodo/ILN/ILN.conf)
call komodo_args.(./komodod) NOTARY_PUBKEY.()
>>>>>>>>>> ILN: p2p.12985 rpc.12986 magic.23cbb4fe 600552702 1410065408 coins
initialized ILN at 1562305914


[04-Jul-19 10:55 PM] TonyL#3577
not `.nSPV=1` but `-nSPV=1`


[04-Jul-19 10:56 PM] jl777c#5810
getpeerinfo


[04-Jul-19 10:56 PM] daemonfox#6136
typo here not in launch

{Reactions}
üëç 

[04-Jul-19 10:56 PM] jl777c#5810
5.9.253.204 <- ???


[04-Jul-19 10:56 PM] jl777c#5810
try the main node


[04-Jul-19 10:56 PM] TonyL#3577
node is `5.9.102.210`


[04-Jul-19 10:56 PM] daemonfox#6136
more peers are 5.9.253.200 to 204


[04-Jul-19 10:56 PM] jl777c#5810
253.204 is mini node, not sure it is stable


[04-Jul-19 10:56 PM] daemonfox#6136
per you earlier


[04-Jul-19 10:56 PM] daemonfox#6136
ok


[04-Jul-19 10:56 PM] jl777c#5810
873 peers


[04-Jul-19 10:57 PM] jl777c#5810
do a getpeerinfo


[04-Jul-19 10:57 PM] TonyL#3577
873 is some magic number üòÉ


[04-Jul-19 10:57 PM] jl777c#5810
do a getpeerinfo


[04-Jul-19 10:57 PM] jl777c#5810
if you have no nSPV fullnodes, you dont have any source of data


[04-Jul-19 10:57 PM] CHMEX#0686
deamonfox:
5.9.253.204  works for me 
5.9.102.210 didnt


[04-Jul-19 10:57 PM] jl777c#5810
connectivity issues


[04-Jul-19 10:57 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN getpeerinfo
[
  {
    "id": 1,
    "addr": "5.9.253.204",
    "addrlocal": "75.11.62.221:42666",
    "services": "0000000070000005",
    "lastsend": 1562306156,
    "lastrecv": 1562306156,
    "bytessent": 372,
    "bytesrecv": 1543,
    "conntime": 1562305915,
    "timeoffset": 0,
    "pingtime": 0.122157,
    "version": 170007,
    "subver": "/MagicBean:2.0.15rc2/",
    "inbound": false,
    "startingheight": 2668,
    "banscore": 0,
    "synced_headers": -1,
    "synced_blocks": -1,
    "inflight": [
    ],
    "whitelisted": false
  }


[04-Jul-19 10:57 PM] jl777c#5810
5.9.102.210 is saturated


[04-Jul-19 10:58 PM] jl777c#5810
"services": "0000000070000005",


[04-Jul-19 10:58 PM] TonyL#3577
but why it's exactly 873 for both you and me


[04-Jul-19 10:58 PM] jl777c#5810
internal limits it seems


[04-Jul-19 10:58 PM] TonyL#3577
we have different servers I believe


[04-Jul-19 10:58 PM] jl777c#5810
enough for decent scaling, will investigate handling 10000+ nSPV clients per node after i get the cli wallet done


[04-Jul-19 10:59 PM] jl777c#5810
ok, so it seems enough is working for tests while i code the wallet


[04-Jul-19 10:59 PM] daemonfox#6136
how do I change the services value?


[04-Jul-19 11:00 PM] jl777c#5810
on my nodes?


[04-Jul-19 11:00 PM] jl777c#5810
you dont


[04-Jul-19 11:00 PM] jl777c#5810
it is either nSPV fullnode or not


[04-Jul-19 11:00 PM] TonyL#3577
now unlikely any node will be able to connect `5.9.102.210`


[04-Jul-19 11:00 PM] TonyL#3577
have to stop my clients


[04-Jul-19 11:00 PM] TonyL#3577
should I ?


[04-Jul-19 11:01 PM] jl777c#5810
lets limit to 512 nSPV clients


[04-Jul-19 11:01 PM] jl777c#5810
that allows decent stress testing along with others to connect


[04-Jul-19 11:01 PM] TonyL#3577
ok, killing 3 from 4


[04-Jul-19 11:02 PM] jl777c#5810
load dropped to 3%


[04-Jul-19 11:02 PM] TonyL#3577
should be only 500 clients from my side now


[04-Jul-19 11:02 PM] jl777c#5810
522 connections


[04-Jul-19 11:02 PM] jl777c#5810
i guess having 1000+ nodes constantly trying to connect, uses up some CPU


[04-Jul-19 11:03 PM] jl777c#5810
so not a bug!


[04-Jul-19 11:03 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN getpeerinfo
[
  {
    "id": 1,
    "addr": "5.9.102.210",
    "addrlocal": "75.11.62.221:35306",
    "services": "0000000070000005",
    "lastsend": 1562306559,
    "lastrecv": 1562306474,
    "bytessent": 464,
    "bytesrecv": 1779,
    "conntime": 1562306352,
    "timeoffset": 0,
    "pingtime": 0.140272,
    "version": 170007,
    "subver": "/MagicBean:2.0.15rc2/",
    "inbound": false,
    "startingheight": 2668,
    "banscore": 0,
    "synced_headers": -1,
    "synced_blocks": -1,
    "inflight": [
    ],
    "whitelisted": false
  }
]
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 0,
  "chaintip": "0000000000000000000000000000000000000000000000000000000000000000",
  "notarization": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"
  }
}


[04-Jul-19 11:03 PM] jl777c#5810
do the other calls work?


[04-Jul-19 11:03 PM] TonyL#3577
`git log -1` ?


[04-Jul-19 11:05 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN nspv_login UXXXXXXXX
{
  "result": "success",
  "status": "wif will expire in 60 seconds",
  "address": "RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa",
  "pubkey": "03ffc0a032958132c048acedc2fe03b26bda7a4218f2f69edcf819aa21b9c92d55",
  "wifprefix": 188,
  "compressed": 1
}


[04-Jul-19 11:05 PM] jl777c#5810
that one is local only


[04-Jul-19 11:06 PM] TonyL#3577
hmm


[04-Jul-19 11:06 PM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 193,
  "chaintip": "02d62fa7787bc007648efd101455d256d105b7ded1f8dc242f5a2ae1f231b746",
  "notarization": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"
  }
}
```


[04-Jul-19 11:06 PM] TonyL#3577
```fgot info response 1562306778 size.145 height.1574
d -ac_name=ILN -ac_supply=10000000000 -ac_cc=2  -nSPV=1 -c-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 1574,
  "chaintip": "09eb05c83cc355a863390ea439b98994e544ef39fb822c5fe863f5d63deeac16",
  "notarization": {
    "notarized_height": 1568,
    "notarized_blockhash": "058ce9946304d0d7799b8c0bb7c9be968018aba34bd30e774c5d3df5e3187c4d",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "a463136fcb9b0b70cb31df20473d11d5b46bc4da76dab1de8e34b8b4365d0545"
  }
}
```


[04-Jul-19 11:06 PM] TonyL#3577
I'm kinda syncing now slowly


[04-Jul-19 11:06 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN nspv_listunspent RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa
{
  "result": "success",
  "utxos": [
  ],
  "height": 0,
  "numutxos": 0,
  "balance": 0


[04-Jul-19 11:07 PM] TonyL#3577
```got info response 1562306819 size.145 height.2668
./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 2668,
  "chaintip": "0551057bfd0fe25e49a6b2a7aad27dcb2e75d36d66a764cf6d9f0eb8c96ef35e",
  "notarization": {
    "notarized_height": 2664,
    "notarized_blockhash": "01ff20ae26b2ad4ff3bc4993bdd12caa9a6e1e7f0739df356705d58293434558",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "c4ff3370392c3ca2ac61331bec98e91225a23297f2ded150c23e80d0c22913f7"
  }
}
```


[04-Jul-19 11:07 PM] TonyL#3577
maybe it's because of big clients amount


[04-Jul-19 11:08 PM] TonyL#3577
getinfo shown actual heigh after like a minute after connection


[04-Jul-19 11:08 PM] jl777c#5810
i was resyncing


[04-Jul-19 11:08 PM] TonyL#3577
ah ok


[04-Jul-19 11:08 PM] TonyL#3577
yes, stopped started and synced immideatly


[04-Jul-19 11:08 PM] jl777c#5810
due to first iteration implementation, it only had notarization info if fully resynced


[04-Jul-19 11:09 PM] jl777c#5810
this is why i need to switch to DB lookup


[04-Jul-19 11:09 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN nspv_notarizations 2600 {
  "result": "success",
  "prev": {
    "notarized_height": 2598,
    "notarized_blockhash": "006d949a7ac4135ce7a082b0f1e044ce4b7b53b0622525eb55eed621374e0a00",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 2600,
    "notarization_desttxid": "c9317209464896c2cdf647ff32e9d8512f3c6cc5afe430db4e5ba9fa5895ab20"
  },
  "next": {
    "notarized_height": 2602,
    "notarized_blockhash": "00e0ef54cded04d8e166e7c5831696b6cc2409aa237067251e69b8416dbfdccb",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 2604,
    "notarization_desttxid": "b396b6caf6f898e0edec3634c126181d8e65fb5c1d15f8e0d0da50b3746d8c4d"
  }
}


[04-Jul-19 11:09 PM] jl777c#5810
that says that height 2600 is in between the notarizations of 2598 and 2602


[04-Jul-19 11:09 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 0,
  "chaintip": "0000000000000000000000000000000000000000000000000000000000000000",
  "notarization": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"
  }
}

{Reactions}
ü§î 

[04-Jul-19 11:09 PM] daemonfox#6136
too funny


[04-Jul-19 11:09 PM] jl777c#5810
the desttxid are the KMD txid


[04-Jul-19 11:10 PM] jl777c#5810
somehow getinfo is the only call that doesnt work


[04-Jul-19 11:10 PM] jl777c#5810
very strange


[04-Jul-19 11:10 PM] daemonfox#6136
very


[04-Jul-19 11:10 PM] jl777c#5810
i will keep an eye out for it


[04-Jul-19 11:10 PM] daemonfox#6136
and this is straight Ubuntu 16.04 VM in hyper-V


[04-Jul-19 11:10 PM] daemonfox#6136
no frills


[04-Jul-19 11:10 PM] jl777c#5810
it is some sort of bug in my code as all the other messages are working


[04-Jul-19 11:11 PM] TonyL#3577
```git log -1
commit 33d82c5bb6abcdd5064ae5fbba4a52e8d4ea1e59 (HEAD -> nSPV, origin/nSPV)
Author: jl777 <jameslee777@yahoo.com>
Date:   Thu Jul 4 03:20:07 2019 -1100

    -print
```


[04-Jul-19 11:11 PM] TonyL#3577
are you on this commit?


[04-Jul-19 11:11 PM] TonyL#3577
just in case


[04-Jul-19 11:11 PM] daemonfox#6136
im on whatever seeting the branch to nSPV and git pull has it on


[04-Jul-19 11:11 PM] Deleted User#0000
@jl777c  
Maybe this will serve as a good example. 
I created new function to scan notarizations DB forwards, along with existing backwards. Should enable a very fast return of a notarization range. 
https://github.com/KMDLabs/komodo/blob/68bf392d394bac371a027100ea04afba2bda5a4f/src/notarisationdb.cpp#L117
This function and hte one below.

{Embed}
https://github.com/KMDLabs/komodo/blob/68bf392d394bac371a027100ea04afba2bda5a4f/src/notarisationdb.cpp
KMDLabs/komodo
Komodo. Contribute to KMDLabs/komodo development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/HhyWP-0Sd5I4jG6OLRR8Z4upEFZlVyxGwgtl6Aqq9hw/%3Fs%3D400%26v%3D4/https/avatars0.githubusercontent.com/u/42953759


[04-Jul-19 11:12 PM] jl777c#5810
yes, i found it and figured out how to do it. seems easy enough


[04-Jul-19 11:12 PM] Deleted User#0000
Given a height, you can call each function once, and it will return the noatization neither side.


[04-Jul-19 11:12 PM] jl777c#5810
that was the next thing i was going to do as it gets the fullnode side feature complete


[04-Jul-19 11:13 PM] Deleted User#0000
Yes, just letting you know its there, I had to make it for the CC I am working on.


[04-Jul-19 11:13 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo$ git log -1
commit 33d82c5bb6abcdd5064ae5fbba4a52e8d4ea1e59
Author: jl777 <jameslee777@yahoo.com>
Date:   Thu Jul 4 03:20:07 2019 -1100


[04-Jul-19 11:14 PM] TonyL#3577
aha, same commit. quite strange that this call not working on your side


[04-Jul-19 11:14 PM] TonyL#3577
did you try to sync in non spv mode before? maybe some files in ~/.komodo/ILN affecting


[04-Jul-19 11:14 PM] jl777c#5810
i will change how that call works


[04-Jul-19 11:14 PM] TonyL#3577
just crazy ideas üòÉ


[04-Jul-19 11:14 PM] jl777c#5810
it is done a bit differently than others


[04-Jul-19 11:15 PM] daemonfox#6136
im applying some updates to this VM didnt realize how out of date it was


[04-Jul-19 11:17 PM] daemonfox#6136
same...


[04-Jul-19 11:17 PM] daemonfox#6136
ill check back for the next build commit


[04-Jul-19 11:18 PM] daemonfox#6136
Just to check... if I run it without the -nSPV=1, i am then a full node and as many conenctions as you config to allow can use my node jas their -addnode=


[04-Jul-19 11:19 PM] daemonfox#6136
maxconnections=XXX in conf file?


[04-Jul-19 11:20 PM] jl777c#5810
that is the effect


[04-Jul-19 11:20 PM] jl777c#5810
the actual logic is fully decentralized


[04-Jul-19 11:21 PM] jl777c#5810
an nSPV client will reject any node that doesnt provide nSPV services


[04-Jul-19 11:21 PM] jl777c#5810
nSPV branch enables nSPV services for fullnodes


[04-Jul-19 11:21 PM] jl777c#5810
so with the p2p networking having a few nSPV enabled fullnodes, eventually the nSPV node will find them, of course much more efficient to just point them at one directly


[04-Jul-19 11:22 PM] daemonfox#6136
ok im trying to reverse it now and test that myself


[04-Jul-19 11:22 PM] jl777c#5810
after majority of people update to nSPV enabled nodes, then most any node will provide nSPV services, so this state of sparse nSPV support is just during testing


[04-Jul-19 11:22 PM] jl777c#5810
the cool part is that we are able to test nSPV with the live mainnet, without disrupting it at all


[04-Jul-19 11:23 PM] jl777c#5810
and basically all full nodes perform function similar to electrum servers, automaticallly


[04-Jul-19 11:23 PM] jl777c#5810
and of course the data set it fine tuned to be 1000x more efficient than an SPV headers only client


[04-Jul-19 11:24 PM] daemonfox#6136
ok... is there a perk OTHER than solving this decentralized issue to a node deciding to provide nSPV services? Do they earn anything... do they contribute to the other asset accumulation in any way?


[04-Jul-19 11:24 PM] daemonfox#6136
or is this a 50/50 we all want it so we all support it as a use cost?


[04-Jul-19 11:25 PM] jl777c#5810
it is part of the p2p messaging


[04-Jul-19 11:25 PM] jl777c#5810
all fullnodes are delivering blocks to the network


[04-Jul-19 11:25 PM] jl777c#5810
no cost


[04-Jul-19 11:25 PM] dukeleto#7326
@jl777c how does the memo field and nspv work ?


[04-Jul-19 11:25 PM] jl777c#5810
what memo field?


[04-Jul-19 11:26 PM] dukeleto#7326
üò¶


[04-Jul-19 11:26 PM] dukeleto#7326
well, wondering if nSPV has support for shielded transactions


[04-Jul-19 11:26 PM] jl777c#5810
nspv is about proving a txid happened or not


[04-Jul-19 11:26 PM] dukeleto#7326
shielded txid ?


[04-Jul-19 11:26 PM] jl777c#5810
proven via notarizations, merkleroots


[04-Jul-19 11:27 PM] jl777c#5810
txid is a hash of the raw tx bytes, so you can prove a specific txid exists


[04-Jul-19 11:27 PM] jl777c#5810
the problem is what txids need to be proven?


[04-Jul-19 11:27 PM] jl777c#5810
and then given the rawtx, how will you process it


[04-Jul-19 11:27 PM] jl777c#5810
that is the layer above nspv


[04-Jul-19 11:27 PM] dukeleto#7326
how does zSPV and nSPV interact, if at all?


[04-Jul-19 11:28 PM] jl777c#5810
nSPV would be the transport layer


[04-Jul-19 11:28 PM] jl777c#5810
the big giant issue with zSPV is that nobody knows which txid belongs to which node...


[04-Jul-19 11:28 PM] daemonfox#6136
oh god my heads gonna explode zSPV


[04-Jul-19 11:29 PM] jl777c#5810
so short of syncing the entire chain and trying to decrypt each one, you cant know which txid you want


[04-Jul-19 11:29 PM] jl777c#5810
however...


[04-Jul-19 11:29 PM] jl777c#5810
if the sender can tell you the txid, say using a taddr opreturn with encrypted payload


[04-Jul-19 11:30 PM] dukeleto#7326
yes, that sounds interesting


[04-Jul-19 11:30 PM] jl777c#5810
then we can get a taddr/zaddr nSPV solution!


[04-Jul-19 11:30 PM] dukeleto#7326
I am just catching up on nSPV stuff but it really reminds me of https://eprint.iacr.org/2019/226


[04-Jul-19 11:30 PM] jl777c#5810
but it leaks privacy big time as people will know you are getting txid


[04-Jul-19 11:30 PM] jl777c#5810
yes, flyclient


[04-Jul-19 11:31 PM] jl777c#5810
i tried to read that paper and realized it would be faster to implement nSPV than to decipher it


[04-Jul-19 11:31 PM] dukeleto#7326
nSPV seems like FlyClient in a DPoW-ized world


[04-Jul-19 11:31 PM] jl777c#5810
nSPV is very simple


[04-Jul-19 11:31 PM] dukeleto#7326
@jl777c yes, the paper must be hard to read so it looks good and gets published


[04-Jul-19 11:31 PM] jl777c#5810
i made a 2min medium post, it achieves the same effect as flyclient


[04-Jul-19 11:31 PM] dukeleto#7326
FlyClient didn't have DPoW, so it had to do a bunch of complex stuff


[04-Jul-19 11:31 PM] jl777c#5810
not saying it is better or worse, they are equivalent


[04-Jul-19 11:32 PM] jl777c#5810
resultwise


[04-Jul-19 11:32 PM] dukeleto#7326
Since we have DPoW, the job of nSPV is much easier


[04-Jul-19 11:32 PM] jl777c#5810
i like easy


[04-Jul-19 11:32 PM] jl777c#5810
third day of coding and it is almost done, the reference cli nSPV client


[04-Jul-19 11:32 PM] dukeleto#7326
I really don't like the architecture of Electrum and I really like how every full node can help light wallets run


[04-Jul-19 11:33 PM] jl777c#5810
need a few addressindex=1 nodes


[04-Jul-19 11:33 PM] jl777c#5810
it is not required to have addressindex=1 to support nSPV, most of the calls are available to any txindex=1 node


[04-Jul-19 11:34 PM] dukeleto#7326
HUSH3 GUI nodes turn on all indexes by default, I haven't done that for plain CLI full nodes since I assume people can do that for themselves. I knew it would pay dividends in the future


[04-Jul-19 11:35 PM] dukeleto#7326
If RPC work is needed, let me know


[04-Jul-19 11:36 PM] jl777c#5810
i am making a C based nSPV wallet so people can see what they need to do to make a GUI for it


[04-Jul-19 11:36 PM] jl777c#5810
they can either just use the rpc calls to avoid having to mess with p2p messaging


[04-Jul-19 11:37 PM] jl777c#5810
or they can become a non-relaying peer and issue the messages directly


[04-Jul-19 11:37 PM] jl777c#5810
I guess i should implement the superlite wallet purely via rpc calls


[04-Jul-19 11:50 PM] daemonfox#6136
SUCCESS!!!!


[04-Jul-19 11:50 PM] daemonfox#6136
Using my own full node and then a second data directory for the nSPV node... i got a good nspv_getinfo call


[04-Jul-19 11:50 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 2668,
  "chaintip": "0551057bfd0fe25e49a6b2a7aad27dcb2e75d36d66a764cf6d9f0eb8c96ef35e",
  "notarization": {
    "notarized_height": 2664,
    "notarized_blockhash": "01ff20ae26b2ad4ff3bc4993bdd12caa9a6e1e7f0739df356705d58293434558",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "c4ff3370392c3ca2ac61331bec98e91225a23297f2ded150c23e80d0c22913f7"
  }
}


[04-Jul-19 11:51 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodod -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN -ac_supply=10000000000 -ac_cc=2 -addnode=localhost -nSPV=1
ASSETCHAINS_SUPPLY 10000000000
nonz.0 ccenables[]
MAX_MONEY 1000000006320417438 10000000063.20417404
call komodo_args.(./komodod) NOTARY_PUBKEY.()
>>>>>>>>>> ILN: p2p.12985 rpc.12996 magic.23cbb4fe 600552702 1410065408 coins
initialized ILN at 1562309347
..got info response 1562309367 size.145 height.2668
got info response 1562309408 size.145 height.2668
got info response 1562309449 size.145 height.2668


[04-Jul-19 11:53 PM] daemonfox#6136
maybe not... maybe im just finally connected to you i just killed my local node and still get good calls with info now


[05-Jul-19 03:39 AM] jl777c#5810
@daemonfox fixed your not getting nspv_getinfo bug


[05-Jul-19 03:40 AM] jl777c#5810
also all fields are now returned and hopefully accurate. barring any big bugs, fullnode side is feature complete


[05-Jul-19 03:40 AM] jl777c#5810
i will be lazy and do the nSPV wallet inside the komodod so i dont have to fight with making new functions for things that already exist


[05-Jul-19 06:26 AM] daemonfox#6136
recompiling


[05-Jul-19 07:02 AM] daemonfox#6136
seems fixed


[05-Jul-19 07:05 AM] daemonfox#6136
and cutting off my full node, launching nSPV pointed at you


[05-Jul-19 07:06 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodod -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN -ac_supply=10000000000 -ac_cc=2 -addnode=5.9.102.210 -listen=0 -nSPV=1
ASSETCHAINS_SUPPLY 10000000000
nonz.0 ccenables[]
MAX_MONEY 1000000006320417438 10000000063.20417404
call komodo_args.(./komodod) NOTARY_PUBKEY.()
>>>>>>>>>> ILN: p2p.12985 rpc.12996 magic.23cbb4fe 600552702 1410065408 coins
initialized ILN at 1562335527


[05-Jul-19 07:06 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "height": 2668,
  "chaintip": "0551057bfd0fe25e49a6b2a7aad27dcb2e75d36d66a764cf6d9f0eb8c96ef35e",
  "notarization": {
    "notarized_height": 2664,
    "notarized_blockhash": "01ff20ae26b2ad4ff3bc4993bdd12caa9a6e1e7f0739df356705d58293434558",
    "notarization_txid": "919c97456165b384e7e75f0e089c1276a8a57e3787f809bad599e3364ec74a4d",
    "notarization_txidheight": 2666,
    "notarization_desttxid": "c4ff3370392c3ca2ac61331bec98e91225a23297f2ded150c23e80d0c22913f7"
  }
}


[05-Jul-19 09:41 AM] jl777c#5810
@TonyL https://iln.explorer.dexstats.info/tx/244ce377e3b22475b59052bba61c2137825805ebeffc8102b53ad1330e4c5442

{Reactions}
treasure 

[05-Jul-19 09:44 AM] daemonfox#6136
RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa for ILN nSPV testing


[05-Jul-19 09:48 AM] daemonfox#6136
and did we ose the nspv_listunspent call?


[05-Jul-19 09:48 AM] daemonfox#6136
its no longer listed in help


[05-Jul-19 09:48 AM] daemonfox#6136
== NSPV ==
nspv_getinfo
nspv_hdrsproof prevheight nextheight
nspv_login wif
nspv_notarizations height
nspv_send destaddr amount
nspv_spentinfo txid vout
nspv_txproof txid height


[05-Jul-19 09:51 AM] daemonfox#6136
Also... on wif expiry... th nspv daemon crashes


[05-Jul-19 09:58 AM] jl777c#5810
fixed


[05-Jul-19 09:58 AM] jl777c#5810
what are the crash details?


[05-Jul-19 10:08 AM] jl777c#5810
decoderawtransaction and sendrawtransaction used to crash, so any untested rpc call might crash


[05-Jul-19 10:08 AM] jl777c#5810
i sent you and tonyL 7.77 ILN, via nspv_send


[05-Jul-19 10:08 AM] jl777c#5810
all that is left is to make sendrawtransaction actuall send, for now it needs to be broadcast from a different online node


[05-Jul-19 10:09 AM] jl777c#5810
and doing all the merkle validations, but it is getting all the required data locally when doing the nspv_send


[05-Jul-19 10:09 AM] jl777c#5810
basically, it is working, but likely half a dozen rpc calls are prone to crashing as there is no normal wallet


[05-Jul-19 10:11 AM] jl777c#5810
just fixed a random crash, which i think looked like wif expiration caused it


[05-Jul-19 10:26 AM] daemonfox#6136
thats what happened to me... random segmentation fault on WIF expiry


[05-Jul-19 10:27 AM] jl777c#5810
in the backtrace where is it?


[05-Jul-19 10:30 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_listunspent RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa
{
  "result": "success",
  "utxos": [
    {
      "height": 2672,
      "txid": "b0f3937412b38e8ea52a3e90f77a1abd6fb8f7dba1a20d940c8168016cbc54d3",
      "vout": 0,
      "value": 7.77
    }
  ],
  "address": "RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa",
  "height": 2675,
  "numutxos": 1,
  "balance": 7.77
}


[05-Jul-19 10:32 AM] daemonfox#6136
it seems to behave now with this last commit


[05-Jul-19 10:32 AM] daemonfox#6136
and very fast too


[05-Jul-19 10:38 AM] jl777c#5810
thats with 322 connections


[05-Jul-19 10:39 AM] jl777c#5810
seems to be stable now, but i didnt test all rpc calls. with nSPV client, a lot of rpc calls wont make sense


[05-Jul-19 10:40 AM] daemonfox#6136
i tried a few non nspv and all so far kick back disabled


[05-Jul-19 10:40 AM] jl777c#5810
the basics of getting balance, listunspent, getinfo and send should work


[05-Jul-19 10:40 AM] daemonfox#6136
yup all have worked


[05-Jul-19 10:40 AM] jl777c#5810
but only one tx per block as there is no concept of mempool


[05-Jul-19 10:40 AM] daemonfox#6136
ill try a send in abit


[05-Jul-19 10:40 AM] jl777c#5810
that will need more complex handling in the wallet code


[05-Jul-19 10:48 AM] Alright#0419
@dukeleto all indexes are enabled on HUSH no matter what because of ac_cc


[05-Jul-19 11:01 AM] daemonfox#6136
so currently, I cant sned any nspv txes?


[05-Jul-19 11:02 AM] daemonfox#6136
id have to craft a rawtx elsewhere and send that through the nspv client?


[05-Jul-19 11:04 AM] jl777c#5810
nSPV client cannot do sendrawtransaction yet


[05-Jul-19 11:04 AM] jl777c#5810
but it is making valid signed tx


[05-Jul-19 11:04 AM] jl777c#5810
so do the nspv_send to create the signed raw tx and then that can be broadcast on a different node


[05-Jul-19 11:04 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_login XXX
{
  "result": "success",
  "status": "wif will expire in 60 seconds",
  "address": "RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa",
  "pubkey": "03ffc0a032958132c048acedc2fe03b26bda7a4218f2f69edcf819aa21b9c92d55",
  "wifprefix": 188,
  "compressed": 1
}
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_send RU6yXkH67VGxDgNKr1rp4yv6E2ZywrZFfT 0.01
{
  "result": "error",
  "error": "couldnt get addressutxos"
}


[05-Jul-19 11:05 AM] jl777c#5810
does listunspent work?


[05-Jul-19 11:05 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_listunspent RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa
{
  "result": "success",
  "utxos": [
    {
      "height": 2672,
      "txid": "b0f3937412b38e8ea52a3e90f77a1abd6fb8f7dba1a20d940c8168016cbc54d3",
      "vout": 0,
      "value": 7.77
    }
  ],
  "address": "",
  "height": 2676,
  "numutxos": 1,
  "balance": 7.77
}


[05-Jul-19 11:05 AM] daemonfox#6136
Without WIF logged in


[05-Jul-19 11:05 AM] jl777c#5810
login and send


[05-Jul-19 11:06 AM] daemonfox#6136
the first was when logged in


[05-Jul-19 11:06 AM] daemonfox#6136
litunspent shows same whether logged in or not


[05-Jul-19 11:08 AM] jl777c#5810
yes, listunspent doesnt require being logged in


[05-Jul-19 11:08 AM] jl777c#5810
only making a tx


[05-Jul-19 11:09 AM] jl777c#5810
what if you restart, do login and send, and nothing else


[05-Jul-19 11:09 AM] daemonfox#6136
restarted client daemon


[05-Jul-19 11:09 AM] daemonfox#6136
that worked


[05-Jul-19 11:10 AM] daemonfox#6136
"result": "success",
  "status": "wif will expire in 60 seconds",
  "address": "RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa",
  "pubkey": "03ffc0a032958132c048acedc2fe03b26bda7a4218f2f69edcf819aa21b9c92d55",
  "wifprefix": 188,
  "compressed": 1
}
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_send RU6yXkH67VGxDgNKr1rp4yv6E2ZywrZFfT 0.01
{
  "result": "success",
  "hex": "0400008085202f8901d354bc6c0168810c940da2a1dbf7b86fbd1a7af7903e2aa58e8eb3127493f3b0000000006b483045022100a345e30a3d1b34e8c5a7236c3c6fe47bd0456d4d1c05ed38c6dab618475da46a02207003fc0adb4832f05b924c515420a7c4ae5e5e00d255c7605477606b228e2189012103ffc0a032958132c048acedc2fe03b26bda7a4218f2f69edcf819aa21b9c92d55ffffffff0240420f00000000001976a914ce7bc185a78a9d5fb01669e97f52de65a2eab98388acf0aa402e00000000232103ffc0a032958132c048acedc2fe03b26bda7a4218f2f69edcf819aa21b9c92d55ac00000000000000000000000000000000000000"
}


[05-Jul-19 11:10 AM] daemonfox#6136
daemon output...


[05-Jul-19 11:10 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodod -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN -ac_supply=10000000000 -ac_cc=2 -addnode=5.9.102.210 -listen=0 -nSPV=1
ASSETCHAINS_SUPPLY 10000000000
nonz.0 ccenables[]
MAX_MONEY 1000000006320417438 10000000063.20417404
call komodo_args.(./komodod) NOTARY_PUBKEY.()
>>>>>>>>>> ILN: p2p.12985 rpc.12996 magic.23cbb4fe 600552702 1410065408 coins
initialized ILN at 1562350170
..got utxos response 1562350184 size.145
RW8kWgnvAzYgGTrD66P7ZSpUJxDGzj5KRa numutxos.1 balance 7.77000000
got txproof response 1562350184 size.1820
got ntzs response 1562350184 size.209
got ntzproof response 1562350185 size.10930 prev.2668 next.2672
sign 1 inputs 7.77000000 + interest 0.00000000 -> 2 outputs 0.01000000 change 7.75990000


[05-Jul-19 11:11 AM] jl777c#5810
it should be a valid tx,which can be verified by broadcasting with a fullnode


[05-Jul-19 11:13 AM] jl777c#5810
likely the node you contacted was lagging the other node you got getinfo from. almost no error checking going on now


[05-Jul-19 11:13 AM] daemonfox#6136
but that step will not be needed at some point right... a broadcast call from nspv ?


[05-Jul-19 11:14 AM] jl777c#5810
once we make sure the rawtx are happy, i will make it automatically broadcast


[05-Jul-19 11:14 AM] daemonfox#6136
got it


[05-Jul-19 11:14 AM] jl777c#5810
its just not easy from nSPV node with everything disabled. the bitcoin code assumes mempool is working, etc. for it to be able to start the process


[05-Jul-19 11:14 AM] jl777c#5810
didnt expect this, so it will be a bit delayed


[05-Jul-19 11:15 AM] jl777c#5810
so valid bugs now are any crashes, just need to know what causes crash and preferably a backtrace


[05-Jul-19 11:15 AM] jl777c#5810
any invalid transaction created


[05-Jul-19 11:18 AM] daemonfox#6136
6a0fe0a5d068d9bf3dedb37b9c601903892c5f62fabb4cd344c4c692352d393e


[05-Jul-19 11:19 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli -datadir=/home/daemonfox/.komodo2/ILN -ac_name=ILN nspv_listunspent RU6yXkH67VGxDgNKr1rp4yv6E2ZywrZFfT
{
  "result": "success",
  "utxos": [
    {
      "height": 2677,
      "txid": "6a0fe0a5d068d9bf3dedb37b9c601903892c5f62fabb4cd344c4c692352d393e",
      "vout": 0,
      "value": 0.01
    }
  ],
  "address": "RU6yXkH67VGxDgNKr1rp4yv6E2ZywrZFfT",
  "height": 2677,
  "numutxos": 1,
  "balance": 0.01
}


[05-Jul-19 11:19 AM] daemonfox#6136
thats a happy hex to rawtx


[05-Jul-19 12:08 PM] daemonfox#6136
thats weird... offtopic for here but i just pulled the Komodoplatform 0.4.0a binaries to mess with ZEXO staking... and they refuse to launch with -pubkey set


[05-Jul-19 03:21 PM] Alright#0419
@daemonfox what do you mean "refuse to launch"


[05-Jul-19 04:35 PM] daemonfox#6136
Launch the copmmand and it just shuts down the window


[05-Jul-19 04:35 PM] daemonfox#6136
but remove -pubkey and daemon starts just fine


[05-Jul-19 04:36 PM] Alright#0419
"shuts down the window"? @daemonfox


[05-Jul-19 04:36 PM] Alright#0419
windows?


[05-Jul-19 07:18 PM] TonyL#3577
latest nSPV build failing on my side @jl777c 
```In file included from main.cpp:7052:
komodo_nSPV_wallet.h: In function ‚ÄòUniValue NSPV_send(char*, char*, int64_t)‚Äô:
komodo_nSPV_wallet.h:249:49: error: request for member ‚Äòcoinaddr‚Äô in ‚Äòsrcaddr‚Äô, which is of non-class type ‚Äòchar*‚Äô
         result.push_back(Pair("srcaddr",srcaddr.coinaddr));
                                                 ^~~~~~~~
make[2]: *** [Makefile:3947: libbitcoin_server_a-main.o] Error 1
make[2]: *** Waiting for unfinished jobs....
mv -f wallet/.deps/libbitcoin_wallet_a-asyncrpcoperation_mergetoaddress.Tpo wallet/.deps/libbitcoin_wallet_a-asyncrpcoperation_mergetoaddress.Po
mv -f wallet/.deps/libbitcoin_wallet_a-rpcdump.Tpo wallet/.deps/libbitcoin_wallet_a-rpcdump.Po
mv -f wallet/.deps/libbitcoin_wallet_a-asyncrpcoperation_sendmany.Tpo wallet/.deps/libbitcoin_wallet_a-asyncrpcoperation_sendmany.Po
mv -f wallet/.deps/libbitcoin_wallet_a-rpcwallet.Tpo wallet/.deps/libbitcoin_wallet_a-rpcwallet.Po
make[2]: Leaving directory '/home/tony/nspv_test/komodo/src'
make[1]: *** [Makefile:5314: all-recursive] Error 1
make[1]: Leaving directory '/home/tony/nspv_test/komodo/src'
make: *** [Makefile:659: all-recursive] Error 1```


[05-Jul-19 11:56 PM] jl777c#5810
fixed


[06-Jul-19 05:14 AM] jl777c#5810
https://medium.com/@jameslee777/nspv-reference-cli-client-cf1ffdc03631

{Embed}
https://medium.com/@jameslee777/nspv-reference-cli-client-cf1ffdc03631
nSPV reference cli client - jl777 - Medium
Above is the first ever transaction created by nSPV! nSPV went from idea to initial implementation during this last week. With the rest of‚Ä¶


[06-Jul-19 06:46 AM] jl777c#5810
i have a nSPV fullnode for KMD at: 23.254.165.16
a cookie for the first one to verify that it works with KMD


[06-Jul-19 06:55 AM] TonyL#3577
```./komodo-cli nspv_getinfo
{
  "result": "success",
  "height": 1431111,
  "chaintip": "09b7667b9be203a677bd682daeea04da37f687a99758774b75dd48a7a7f81126",
  "notarization": {
    "notarized_height": 1431090,
    "notarized_blockhash": "00000000b8481bdb62b39e197edffee5836374b2037a13c4ee4caade992b8f18",
    "notarization_txid": "c9025f00e17d808205b26ee2fd33426700595545b9ca0fb0368e94d3e0fcb127",
    "notarization_txidheight": 1431103,
    "notarization_desttxid": "425099fba0d181025405601e0a60de45a3d786e152106e1b17e94f3f0a94e149"
  }
}
```


[06-Jul-19 06:55 AM] TonyL#3577
getting prints ```[] PASSPORT iteration waiting for KOMODO_INITDONE
[] PASSPORT iteration waiting for KOMODO_INITDONE
[] PASSPORT iteration waiting for KOMODO_INITDONE
[] PASSPORT iteration waiting for KOMODO_INITDONE
[] PASSPORT iteration waiting for KOMODO_INITDONE
```  constantly


[06-Jul-19 06:56 AM] TonyL#3577
let me try to broadcast some tx


[06-Jul-19 06:59 AM] jl777c#5810
it might mess up a normal fullnodes data to run as nSPV=1


[06-Jul-19 07:00 AM] TonyL#3577
```./komodo-cli nspv_broadcast 0400008085202f89011b274d79d66fffbccf51bfc98e10d8fadc981fea7c6e2b736b17388ae7390f8a000000006a47304402204560f9efc959634a64812617fc9a37bc6a650a6658c8b582fb0bd02e7e113ba0022076301eaf2bbf12202cd2ebcdb1d79d6caf4156cf503da7d0d2f4c7737d8e0c33012102f76e2d7122dd3c731d15b845337826ce636a43d016e0eaf427fa53894ffdd957ffffffff02c09ee605000000001976a914a19f7aa254dced0a17920ab1c2acf698841f67f688ac301b0f0000000000232102f76e2d7122dd3c731d15b845337826ce636a43d016e0eaf427fa53894ffdd957ac00000000000000000000000000000000000000
{
  "result": "success",
  "expected": "a308279d498fb45b899d645a0e02265f2f689adade8323629fb560a6a79935ee",
  "broadcast": "a308279d498fb45b899d645a0e02265f2f689adade8323629fb560a6a79935ee",
  "retcode": 1,
  "type": "broadcast and mempool"
}
```


[06-Jul-19 07:00 AM] TonyL#3577
https://www.kmdexplorer.io/tx/a308279d498fb45b899d645a0e02265f2f689adade8323629fb560a6a79935ee


[06-Jul-19 07:01 AM] jl777c#5810
üç™

{Reactions}
üòÇ 3040_kingpeepo üëè 

[06-Jul-19 07:02 AM] jl777c#5810
is it still spamming: [] PASSPORT iteration waiting for KOMODO_INITDONE


[06-Jul-19 07:02 AM] TonyL#3577
yes, it spamming it constantly


[06-Jul-19 07:02 AM] TonyL#3577
so used another terminal window to broadcast tx


[06-Jul-19 07:06 AM] jl777c#5810
pushed fix


[06-Jul-19 07:06 AM] jl777c#5810
this will make onboarding people so easy!

{Reactions}
üî• (2) 

[06-Jul-19 07:06 AM] TonyL#3577
rebuilding


[06-Jul-19 07:07 AM] TonyL#3577
connected, no spam prints


[06-Jul-19 07:07 AM] TonyL#3577
trying to broadcast


[06-Jul-19 07:09 AM] TonyL#3577
https://www.kmdexplorer.io/tx/6e482c390e35c808522daea6dabd4daf42ef704cfab730207847a4f4153939df


[06-Jul-19 07:10 AM] TonyL#3577
Broadcast KMD tx is easy now like taking candy from a baby


[06-Jul-19 07:10 AM] TonyL#3577
taking cookie I mean

{Reactions}
troll_compadre üç™ (2) troll_cool 

[06-Jul-19 07:13 AM] jl777c#5810
it is such a simple idea, but very very practical and cool

{Reactions}
üÜí (2) üöÄ 

[06-Jul-19 07:14 AM] TonyL#3577
mindblowing as usual üòÉ


[06-Jul-19 07:14 AM] jl777c#5810
a better than normal week


[06-Jul-19 07:14 AM] jl777c#5810
it is also possible to support CC signing, but i was too lazy for that


[06-Jul-19 07:15 AM] CHMEX#0686
So you are eligable for siu's kmdice lite cc bounty

{Reactions}
PeepoThink üòÇ 

[06-Jul-19 07:16 AM] jl777c#5810
CC signing a bit too messy, and the way to support it would be to add an nSPV special case in FinalizeCCtx


[06-Jul-19 07:16 AM] jl777c#5810
i guess it wont be that hard


[06-Jul-19 07:17 AM] TonyL#3577
CC based mobile apps seems as close as never before


[06-Jul-19 07:17 AM] jl777c#5810
not sure mobile can run a komodod, even if nSPV


[06-Jul-19 07:17 AM] TonyL#3577
so next challenge is mobile komodod


[06-Jul-19 07:18 AM] jl777c#5810
its 17MB


[06-Jul-19 07:18 AM] jl777c#5810
so i guess not that big


[06-Jul-19 07:19 AM] CHMEX#0686
If it runs on a rasp it might very well run on a phone some of them have 4gb+ ram now


[06-Jul-19 07:21 AM] TonyL#3577
yeah, komodod nspv client eating less than 100 mb ram


[06-Jul-19 07:22 AM] TonyL#3577
on smartwatches and etc it's possible to run in theory I think


[06-Jul-19 07:23 AM] TonyL#3577
broadcast KMD txs from toaster - thats the future üòÖ


[06-Jul-19 07:28 AM] jl777c#5810
CC signing for some things wont be hard, for others, quite difficult


[06-Jul-19 07:28 AM] TonyL#3577
Do you need clients spam attack on KMD node?


[06-Jul-19 07:28 AM] jl777c#5810
no, lets keep attacks to the ILN node

{Reactions}
üëç 

[06-Jul-19 07:30 AM] TonyL#3577
I shutdown spammers yesterday, can prepare new server image with latest komodod and spin (if ILN fullnode updated)


[06-Jul-19 07:32 AM] jl777c#5810
yes, all the nodes updated


[06-Jul-19 07:40 AM] TonyL#3577
btw now to run nSPV client node zcash params are mandatory - is there any way to avoid it?


[06-Jul-19 07:43 AM] jl777c#5810
pushed a version that skips loading, but it might still have other checks for it

{Reactions}
üî• 

[06-Jul-19 07:44 AM] jl777c#5810
let me know if it loads


[06-Jul-19 07:45 AM] TonyL#3577
building


[06-Jul-19 07:48 AM] TonyL#3577
```./komodo-cli nspv_getinfo
{
  "result": "success",
  "height": 1431167,
  "chaintip": "000000007dc6e29df2cefc76e23d5724011f2ac574b0cadb056b0cd33d066f47",
  "notarization": {
    "notarized_height": 1431150,
    "notarized_blockhash": "04796162447a8eefedfccc53426ed95f57ef40a125511ca468bad30a935e680e",
    "notarization_txid": "9ecb9d01508e1bcc83d5cc94d5b9c93ba9c7b7293f641abec355b3f04f046767",
    "notarization_txidheight": 1431163,
    "notarization_desttxid": "ccb56300e4a3f64339f284ca8feed8c05a9117b71a5d5ea40edc15eb878d12b3"
  }
}
``` connected (daemon loaded without zcash params)


[06-Jul-19 07:49 AM] TonyL#3577
so all what client need now is 199M komodod + 9M komodo-cli


[06-Jul-19 07:50 AM] TonyL#3577
And like a 100M free ram


[06-Jul-19 07:57 AM] TonyL#3577
connecting clients to `5.9.102.210`
1000 spinned


[06-Jul-19 09:14 AM] allbits#5898
I'm ready to noob test. Downloaded. How do I launch haha? In the kind that needs basic instructions


[06-Jul-19 09:25 AM] daemonfox#6136 (pinned)
launch a fresh daemon but instead of normal command, add a specific addnode=5.9.102.210 which is James main full node, then also add the nSPV=1 flag


[06-Jul-19 09:26 AM] daemonfox#6136
./komodod -ac_name=ILN -ac_supply=10000000000 -ac_cc=2 -addnode=5.9.102.210 -nSPV=1


[06-Jul-19 09:27 AM] daemonfox#6136
./komodo-cli -ac_name=ILN nspv_getinfo


[06-Jul-19 09:27 AM] allbits#5898
I'm in the src directory. I don't see komodod


[06-Jul-19 09:27 AM] daemonfox#6136
^ should then return info using the nspv command in help


[06-Jul-19 09:27 AM] daemonfox#6136
oh did you build it?


[06-Jul-19 09:27 AM] allbits#5898
Also, are we doing ILN only, or is KMD possible?


[06-Jul-19 09:27 AM] daemonfox#6136
Was only told to try ILN so far


[06-Jul-19 09:28 AM] allbits#5898
No, download only. I've never built anything


[06-Jul-19 09:28 AM] daemonfox#6136
but was in the middle of trying to stand up a VRSC capable full node and nSPV to it


[06-Jul-19 09:28 AM] daemonfox#6136
ok


[06-Jul-19 09:28 AM] daemonfox#6136
run this...


[06-Jul-19 09:28 AM] daemonfox#6136
cd ..


[06-Jul-19 09:28 AM] daemonfox#6136
you shoul de back in komodo


[06-Jul-19 09:28 AM] daemonfox#6136
then run...


[06-Jul-19 09:29 AM] daemonfox#6136
./zcutil/fetch-params.sh


[06-Jul-19 09:29 AM] daemonfox#6136
then run...


[06-Jul-19 09:29 AM] daemonfox#6136
./zcutil/build.sh -j#


[06-Jul-19 09:30 AM] daemonfox#6136
except # is how many threads you want to build with


[06-Jul-19 09:30 AM] allbits#5898
Got it. Yes I've done that before on native. Didn't know that was "build". Didn't know was required for nSPV. Makes sense tho


[06-Jul-19 09:31 AM] daemonfox#6136
also change branch


[06-Jul-19 09:31 AM] daemonfox#6136
git branch -a


[06-Jul-19 09:31 AM] daemonfox#6136
shows a list


[06-Jul-19 09:32 AM] daemonfox#6136
you wanna run...


[06-Jul-19 09:32 AM] daemonfox#6136
git checkout nSPV


[06-Jul-19 09:32 AM] daemonfox#6136
then run that final build command


[06-Jul-19 09:34 AM] daemonfox#6136
@jl777c if I start a VRSC node with this build... and then nSPV to it is there any reason it would not work? I know its all ALPHA and at own risk... just wanna check with you if you know any reason i shouldnt bother yet.


[06-Jul-19 09:35 AM] jl777c#5810
my tree doesnt support VRSC, that is a source level fork


[06-Jul-19 09:35 AM] jl777c#5810
so my nSPV changes would need to be merged into VRSC for that\


[06-Jul-19 09:35 AM] jl777c#5810
you can test with my KMD nSPV fullnode


[06-Jul-19 09:36 AM] daemonfox#6136
ok so KMD testing


[06-Jul-19 09:36 AM] jl777c#5810
./komodod -nSPV=1 -addnode=23.254.165.16 &


[06-Jul-19 09:36 AM] jl777c#5810
it wont even need to download the zcash params


[06-Jul-19 09:36 AM] daemonfox#6136
gotcha


[06-Jul-19 09:38 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli nspv_getinfo
{
  "result": "success",
  "height": 1431273,
  "chaintip": "094ff43d6f18534af657d44fec27132158045e75aebc180e076e6d1c4145c226",
  "notarization": {
    "notarized_height": 1431260,
    "notarized_blockhash": "03749717467101ef6c658ebd3e8318ae0dc5c12c663e34ee2a913424a4344bc2",
    "notarization_txid": "6171988c0ee70c3074130d79ea3f7c21ac72dcff2c8a1fc4239c4837d9d58ea3",
    "notarization_txidheight": 1431273,
    "notarization_desttxid": "55970e3e904193a0bb8c70c6a233d9811561b9f3cf69338f7e1bf2198b02cfb0"
  }


[06-Jul-19 09:38 AM] daemonfox#6136
too easy


[06-Jul-19 09:38 AM] daemonfox#6136
You make this stuff look simple J


[06-Jul-19 09:38 AM] jl777c#5810
it was simple!


[06-Jul-19 09:38 AM] daemonfox#6136
a very novel solution indeed


[06-Jul-19 10:56 AM] allbits#5898
result: success

{Reactions}
üéá 

[06-Jul-19 11:02 AM] jl777c#5810
dont use address with any big funds


[06-Jul-19 11:07 AM] allbits#5898
Ok, won't use hollowman's address.


[06-Jul-19 11:18 AM] allbits#5898
So, I've logged in successfully using wif. To spend to a different address I use nspv_spend? Do I then need to nspv_broadcast?


[06-Jul-19 11:18 AM] jl777c#5810
yes


[06-Jul-19 11:21 AM] allbits#5898
noob friendly confirmed


[06-Jul-19 11:21 AM] jl777c#5810
presto! a cli wallet


[06-Jul-19 11:22 AM] jl777c#5810
theoretically it supports collecting rewards, but doesnt set nlocktime yet


[06-Jul-19 11:24 AM] allbits#5898
Love it. That was fun. Thanks!


[06-Jul-19 11:25 AM] jl777c#5810
@TonyL i made it set nLockTime for KMD now and it should also collect rewards. let me know if it works


[06-Jul-19 11:32 AM] allbits#5898
I see you added getnewaddress for nSPV mode!


[06-Jul-19 11:35 AM] daemonfox#6136
68d4b13c20e0be2fec907fc14f99162d9ce61307e89a0a23764c26cac4ede66d


[06-Jul-19 11:35 AM] jl777c#5810
yes, i realized it was disabled and inconvenient to have to make wif externally


[06-Jul-19 11:36 AM] daemonfox#6136
id paste a pic but cant...


[06-Jul-19 11:36 AM] daemonfox#6136
But live Agama lite wallet just picked up my nSPV transaction of KMD through your node


[06-Jul-19 11:37 AM] jl777c#5810
with latest version? nLockTime isnt set, i fixed that not too long ago


[06-Jul-19 11:37 AM] jl777c#5810
i have it calculated total rewards and spending it (i think), but forgot to set nLockTime


[06-Jul-19 11:37 AM] daemonfox#6136
idk... i just did a spend and then a broadcast of 0.01 to test to myself


[06-Jul-19 11:37 AM] jl777c#5810
when did you last update?


[06-Jul-19 11:38 AM] daemonfox#6136
and then signed into AGAMA 5.7.3 Verus lite with WIF and saw the TX come in


[06-Jul-19 11:38 AM] allbits#5898
So here's a noob question.  When you update the code, I have to rebuild from scratch again (that seems to take twenty minutes or so)?


[06-Jul-19 11:38 AM] daemonfox#6136
i recompiled not long agao


[06-Jul-19 11:38 AM] jl777c#5810
update again


[06-Jul-19 11:38 AM] daemonfox#6136
like third time today ive built this


[06-Jul-19 11:38 AM] jl777c#5810
i built it 134 times today


[06-Jul-19 11:38 AM] daemonfox#6136
lol


[06-Jul-19 11:38 AM] jl777c#5810
@allbits after you build it once


[06-Jul-19 11:38 AM] jl777c#5810
just go to ~/komodo/src


[06-Jul-19 11:38 AM] jl777c#5810
git pull; make


[06-Jul-19 11:39 AM] jl777c#5810
@daemonfox i am not exaggerating


[06-Jul-19 11:39 AM] allbits#5898
Ok! Can I get a verbatim command for git pull and make please?


[06-Jul-19 11:39 AM] jl777c#5810
git pull; make


[06-Jul-19 11:40 AM] allbits#5898
Haha ok


[06-Jul-19 11:40 AM] jl777c#5810
cd ~/komodo/src


[06-Jul-19 11:40 AM] jl777c#5810
git pull;make


[06-Jul-19 11:40 AM] daemonfox#6136
is that faster than ./zcutil/build.sh -j3


[06-Jul-19 11:40 AM] jl777c#5810
yes


[06-Jul-19 11:41 AM] jl777c#5810
only works after you already did a build


[06-Jul-19 11:41 AM] daemonfox#6136
lol ok so ill try that .next time


[06-Jul-19 11:41 AM] jl777c#5810
make will just do what needs to be done


[06-Jul-19 11:41 AM] daemonfox#6136
so... should it not have worked when i did it before?


[06-Jul-19 11:41 AM] daemonfox#6136
the tx has a confirm


[06-Jul-19 11:42 AM] jl777c#5810
until you build successfully,make likely wont work


[06-Jul-19 11:43 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli nspv_spend RFeZSx2h7yEaXaq5PWLEHgAQYTp9PqK4CF 0.01
{
  "txid": "68d4b13c20e0be2fec907fc14f99162d9ce61307e89a0a23764c26cac4ede66d",
  "overwintered": true,
  "version": 4,
  "versiongroupid": "892f2085",
  "locktime": 0,
  "expiryheight": 0,
  "vin": [
    {
      "txid": "7460b607f379aeb196c05256fcabd5fddd1ef265d86a62d74851a72502ffefaf",
      "vout": 21,
      "scriptSig": {
        "asm": "3045022100d0fc685d96b0a968900aa318ce0cf3f1631eed70bb9ee4f45263209f943066b30220076926c698f7e21d30be3001fdbc2daaea4f0a0ddd450f017f593a338acaa9d3[ALL] 0383484bdc745b2b953c85b5a0c496a1f27bc42ae971f15779ed1532421b3dd943",
        "hex": "483045022100d0fc685d96b0a968900aa318ce0cf3f1631eed70bb9ee4f45263209f943066b30220076926c698f7e21d30be3001fdbc2daaea4f0a0ddd450f017f593a338acaa9d301210383484bdc745b2b953c85b5a0c496a1f27bc42ae971f15779ed1532421b3dd943"
      },
      "sequence": 4294967295
    }
  ],


[06-Jul-19 11:43 AM] daemonfox#6136
"vout": [
    {
      "value": 0.01000000,
      "valueZat": 1000000,
      "n": 0,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 45db540b45178fbf26fd91428983dec491aeee25 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a91445db540b45178fbf26fd91428983dec491aeee2588ac",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": [
          "RFeZSx2h7yEaXaq5PWLEHgAQYTp9PqK4CF"
        ]
      }
    },
    {
      "value": 6.73504060,
      "valueZat": 673504060,
      "n": 1,
      "scriptPubKey": {
        "asm": "0383484bdc745b2b953c85b5a0c496a1f27bc42ae971f15779ed1532421b3dd943 OP_CHECKSIG",
        "hex": "210383484bdc745b2b953c85b5a0c496a1f27bc42ae971f15779ed1532421b3dd943ac",
        "reqSigs": 1,
        "type": "pubkey",
        "addresses": [
          "REScxcZm3dsWmERSax1yVgoPPadh8BYQ6k"
        ]
      }
    }
  ],
  "vjoinsplit": [
  ],
  "valueBalance": 0.00000000,
  "vShieldedSpend": [
  ],
  "vShieldedOutput": [
  ],
  "result": "success",
  "hex": "0400008085202f8901afefff0225a75148d7626ad865f21eddfdd5abfc5652c096b1ae79f307b66074150000006b483045022100d0fc685d96b0a968900aa318ce0cf3f1631eed70bb9ee4f45263209f943066b30220076926c698f7e21d30be3001fdbc2daaea


[06-Jul-19 11:43 AM] jl777c#5810
"locktime": 0,


[06-Jul-19 11:43 AM] jl777c#5810
thats with latest on KMD chain?


[06-Jul-19 11:44 AM] daemonfox#6136
no that was previous im about to send another test with this build


[06-Jul-19 11:44 AM] daemonfox#6136
but yes on live chain


[06-Jul-19 11:44 AM] daemonfox#6136
txid 68d4b13c20e0be2fec907fc14f99162d9ce61307e89a0a23764c26cac4ede66d


[06-Jul-19 11:45 AM] jl777c#5810
yes, as soon as it goes into the mempool, it should just be a matter of getting mined


[06-Jul-19 11:45 AM] SHossain#0007
```
./komodo-cli nspv_getinfo
{
  "result": "success",
  "height": 1431399,
  "chaintip": "034e803ecfb4eacaa03541684ca1dbb4be3274f2da3762bee827ec6e47e2bf05",
  "notarization": {
    "notarized_height": 1431380,
    "notarized_blockhash": "0e2ee4e71264e37ab6c1e22fe5e7bc862dd5dcdc2e3c05474cafa963e456d153",
    "notarization_txid": "e2d03a92c51da6a6dcdc2848c46996b6bf4a9b810dc74208cb0964998ac22e95",
    "notarization_txidheight": 1431393,
    "notarization_desttxid": "b19308c8751533b2cff45fd1afeb923d72bd50bfc9d976101459a2b6c377d3cf"
  }
}
```


[06-Jul-19 11:46 AM] SHossain#0007
```
./komodo-cli nspv_listunspent RVA7jffsmYi3Yf6WDk76G3X91c8HxBRA4y
{
  "result": "success",
  "utxos": [
    {
      "height": 1415627,
      "txid": "865385f6e25dc94070ab19c8b0238e3562af1c4b1869e20d2744734b4b509bdd",
      "vout": 0,
      "value": 49.9897,
      "interest": 0.07516399999999999
    }
  ],
  "address": "RVA7jffsmYi3Yf6WDk76G3X91c8HxBRA4y",
  "height": 1431399,
  "numutxos": 1,
  "balance": 49.9897,
  "interest": 0.07516399999999999
}
```


[06-Jul-19 11:47 AM] jl777c#5810
good, it sees the interest. now we need to make sure it will collect it


[06-Jul-19 11:47 AM] jl777c#5810
make sure to use latest version


[06-Jul-19 11:47 AM] SHossain#0007
yep. using latest version. will login with WIF now and try to send to same addr


[06-Jul-19 11:48 AM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli nspv_listunspent RFeZSx2h7yEaXaq5PWLEHgAQYTp9PqK4CF
{
  "result": "success",
  "utxos": [
    {
      "height": 1418766,
      "txid": "46d694657118991c91fd3e473ec587effd19f1f415545bf33e44725cbe9d9917",
      "vout": 1,
      "value": 171.52974559,
      "interest": 0.2066477
    },
    {
      "height": 1419561,
      "txid": "eab08e1ad8c87be2d9a621ae68f08996623125004eefa6c7e28ad7733b987133",
      "vout": 1,
      "value": 150.018,
      "interest": 0.16904242
    },
    {
      "height": 1431393,
      "txid": "68d4b13c20e0be2fec907fc14f99162d9ce61307e89a0a23764c26cac4ede66d",
      "vout": 0,
      "value": 0.01,
      "interest": 0
    }
  ],
  "address": "RFeZSx2h7yEaXaq5PWLEHgAQYTp9PqK4CF",
  "height": 1431399,
  "numutxos": 3,
  "balance": 321.55774559,
  "interest": 0.37569012


[06-Jul-19 11:48 AM] SHossain#0007
```
./komodo-cli nspv_spend RVA7jffsmYi3Yf6WDk76G3X91c8HxBRA4y 49.9897
{
  "result": "error",
  "error": "not enough funds",
  "balance": 49.9897,
  "amount": 49.9897
}
```


[06-Jul-19 11:49 AM] SHossain#0007
```
./komodo-cli nspv_spend RVA7jffsmYi3Yf6WDk76G3X91c8HxBRA4y 49.9896
error: couldn't connect to server: EOF reached (code 1)
(make sure server is running and you are connecting to the correct RPC port)
```


[06-Jul-19 11:49 AM] daemonfox#6136
yes mine too


[06-Jul-19 11:49 AM] SHossain#0007
```
[1]+  Segmentation fault      (core dumped) ./komodod -nSPV=1 -addnode=23.254.165.16
```


[06-Jul-19 11:49 AM] daemonfox#6136
tried to spend and daemon crashes


[06-Jul-19 11:49 AM] SHossain#0007
let me start with `gdb`


[06-Jul-19 11:49 AM] jl777c#5810
aha! a bug. so spending interest crashes it?


[06-Jul-19 11:49 AM] daemonfox#6136
whats the backtrace launch command


[06-Jul-19 11:49 AM] daemonfox#6136
i dont htink interest


[06-Jul-19 11:49 AM] daemonfox#6136
I tried my first addy


[06-Jul-19 11:50 AM] daemonfox#6136
had no interest it dumped


[06-Jul-19 11:50 AM] daemonfox#6136
so i tried mine with the 321 KMD to see and same thing


[06-Jul-19 11:50 AM] daemonfox#6136
i always forget the gdb args to use to launch


[06-Jul-19 11:50 AM] SHossain#0007
https://gist.githubusercontent.com/himu007/60696ddb402ee8a42776d85eece1f965/raw/f66137f687b1100383eeb7e2fbd26c9701125901/nSPV-crash1


[06-Jul-19 11:50 AM] SHossain#0007
backtrace data


[06-Jul-19 11:51 AM] SHossain#0007
yay...found my first bug üòÉ


[06-Jul-19 11:51 AM] jl777c#5810
i see. fixing

{Reactions}
üëçüèΩ 

[06-Jul-19 11:53 AM] jl777c#5810
pushed fix


[06-Jul-19 11:53 AM] SHossain#0007
updating


[06-Jul-19 11:54 AM] allbits#5898
Trying to do git pull with no success. "Please specify with a URL or a remote name from which new revisions should be fetched"


[06-Jul-19 11:54 AM] SHossain#0007
@daemonfox congrats! you found this too üòÉ


[06-Jul-19 11:55 AM] jl777c#5810
@allbits what directory are you in?


[06-Jul-19 11:55 AM] SHossain#0007
```
./komodo-cli nspv_broadcast 0400008085202f8901dd9b504b4b7344270de269184b1caf62358e23b0c819ab7040c95de2f6855386000000006a47304402205ca60de29cef0683690d7904c06e2e40c4e1aa3e21fb6eb2edf5dfd39124ed5902207cc01afed7a51f377ed0dbcef346eddf4778778888798d215fb3f37ce35387710121033f54a270732097c53fbaf4a5e18748b0d4ec63c7c0bfbafca6a3c9bc18725b14ffffffff028013f629010000001976a914da0bfaafb8e5a5c541c56f10e99b85109fc2030988aca3c17200000000002321033f54a270732097c53fbaf4a5e18748b0d4ec63c7c0bfbafca6a3c9bc18725b14ac85eb205d000000000000000000000000000000
{
  "result": "success",
  "expected": "2480bd7dc9809fe54aee9d5f8da795b4d1cf15873b2eadb5810231d4f4f4ac36",
  "broadcast": "2480bd7dc9809fe54aee9d5f8da795b4d1cf15873b2eadb5810231d4f4f4ac36",
  "retcode": 1,
  "type": "broadcast and mempool"
}
```


[06-Jul-19 11:55 AM] allbits#5898
src


[06-Jul-19 11:56 AM] jl777c#5810
~/komodo/src


[06-Jul-19 11:56 AM] SHossain#0007
claimed reward


[06-Jul-19 11:56 AM] jl777c#5810
git pull should be there


[06-Jul-19 11:56 AM] SHossain#0007
https://kmdexplorer.io/tx/2480bd7dc9809fe54aee9d5f8da795b4d1cf15873b2eadb5810231d4f4f4ac36


[06-Jul-19 11:56 AM] SHossain#0007
also it did set locktime


[06-Jul-19 11:56 AM] jl777c#5810
and nLockTime is set! so rewards claiming works


[06-Jul-19 11:56 AM] SHossain#0007
yep


[06-Jul-19 11:57 AM] SHossain#0007
this is really cool


[06-Jul-19 11:58 AM] SHossain#0007
this is from stdout
```
got utxos response 1562439310 size.145
RVA7jffsmYi3Yf6WDk76G3X91c8HxBRA4y numutxos.1 balance 49.98970000
got txproof response 1562439310 size.1907
got ntzs response 1562439310 size.209
got ntzproof response 1562439312 size.19682 prev.1415610 next.1415620
sign 1 inputs 49.98970000 + interest 0.07520675 -> 2 outputs 49.98960000 change 0.07520675
got broadcast response 1562439334 size.37 2480bd7dc9809fe54aee9d5f8da795b4d1cf15873b2eadb5810231d4f4f4ac36 retcode.1
scrub wif from NSPV memory
```


[06-Jul-19 11:58 AM] SHossain#0007
i like the last line


[06-Jul-19 12:00 PM] allbits#5898
Unfortunately it just tells me no remote repository is specified. Initially I did not use git. I downloaded zip and extracted


[06-Jul-19 12:00 PM] daemonfox#6136
ah


[06-Jul-19 12:01 PM] SHossain#0007
@allbits which OS you are using?


[06-Jul-19 12:01 PM] daemonfox#6136
sudo rm -R ~/komodo


[06-Jul-19 12:01 PM] daemonfox#6136
the git clone the repo URL


[06-Jul-19 12:02 PM] allbits#5898
Ubuntu


[06-Jul-19 12:02 PM] daemonfox#6136
git clone https://github.com/komodoplatform/komodo --branch nSPV--single-branch

{Embed}
https://github.com/komodoplatform/komodo
KomodoPlatform/komodo
Komodo. Contribute to KomodoPlatform/komodo development by creating an account on GitHub.
https://images-ext-2.discordapp.net/external/RDvx2WIoH0iRzE_70DuHLDOM6rqONFcnMd4HT0XBnOI/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/21276113


[06-Jul-19 12:03 PM] daemonfox#6136
and the commands in the readme to build


[06-Jul-19 12:04 PM] SHossain#0007
follow the following:
```
rm -rf ~/komodo
cd
git clone https://github.com/jl777/komodo
cd komodo
git checkout nSPV
./zcutil/fetch-params.sh
./zcutil/build.sh -j$(nproc)
cd src
./komodod -nSPV=1 -addnode=23.254.165.16 &
```


[06-Jul-19 12:05 PM] allbits#5898
K thanks


[06-Jul-19 12:05 PM] SHossain#0007
`nspv_listunspent` call is very fast


[06-Jul-19 12:06 PM] jl777c#5810
yes, i made mistake of doing it with an address with 12000 utxos, still it finished in less than a second

{Reactions}
üëΩ üíØ 

[06-Jul-19 12:11 PM] daemonfox#6136
"result": "success",
  "hex": "0400008085202f89016de6edc4ca264c76230a9ae80713e69c2d16994fc17f90ec2fbee0203cb1d4680100000048473044022004dcddb3196f85d272bd1005522dec502679cef8aa1e89e0f4f2b011d116b8e70220187595b6d588c0f5b6ce14c0747f1241cd14329144bfa93c29461988edf8b46301ffffffff02e0c81000000000001976a91445db540b45178fbf26fd91428983dec491aeee2588ac4ceb13280000000023210383484bdc745b2b953c85b5a0c496a1f27bc42ae971f15779ed1532421b3dd943acf3ee205d000000000000000000000000000000"
}
daemonfox@KMDuser:~/komodo/src$ ./komodo-cli nspv_broadcast "0400008085202f89016de6edc4ca264c76230a9ae80713e69c2d16994fc17f90ec2fbee0203cb1d4680100000048473044022004dcddb3196f85d272bd1005522dec502679cef8aa1e89e0f4f2b011d116b8e70220187595b6d588c0f5b6ce14c0747f1241cd14329144bfa93c29461988edf8b46301ffffffff02e0c81000000000001976a91445db540b45178fbf26fd91428983dec491aeee2588ac4ceb13280000000023210383484bdc745b2b953c85b5a0c496a1f27bc42ae971f15779ed1532421b3dd943acf3ee205d000000000000000000000000000000"
{
  "result": "success",
  "expected": "4d0a7621c3c3ad2fbd259c067f1d05fefdbead45d17ff26b5b856f599a9ffeaf",
  "broadcast": "4d0a7621c3c3ad2fbd259c067f1d05fefdbead45d17ff26b5b856f599a9ffeaf",
  "retcode": 1,
  "type": "broadcast and mempool"
}


[06-Jul-19 12:11 PM] daemonfox#6136
and got the gdb trace going in case... looks good now


[06-Jul-19 12:12 PM] daemonfox#6136
AGAMA just picked up the tx


[06-Jul-19 12:14 PM] daemonfox#6136
now we need testnet coins to burn... and dwy attack this


[06-Jul-19 12:16 PM] jl777c#5810
updated to allow making tx with up to 64 utxo


[06-Jul-19 12:16 PM] jl777c#5810
right now network has only one KMD nSPV fullnode and there is a rate limiter of one request per second


[06-Jul-19 12:17 PM] jl777c#5810
so 64 utxo takes at least 64 seconds, and the wif autoexpired after 60 seconds. that is now at 777 seconds


[06-Jul-19 12:17 PM] jl777c#5810
getnewaddress (just the normal one) is changed in behavior to generate wif/address/pubkey, but since there is no wallet.dat, it isnt saved


[06-Jul-19 12:18 PM] daemonfox#6136
building


[06-Jul-19 12:19 PM] jl777c#5810
ILN has 10 fullnode peers and is the one to be used for stress testing


[06-Jul-19 12:19 PM] jl777c#5810
let me know if you need some ILN for testing


[06-Jul-19 12:19 PM] daemonfox#6136
i have the ILN sent yesterday


[06-Jul-19 12:20 PM] daemonfox#6136
and ill see if I cant cook up a dwy style way to hammer dust txes at it


[06-Jul-19 12:20 PM] jl777c#5810
the limit is about 70,000 utxo


[06-Jul-19 12:21 PM] jl777c#5810
at that point it takes more than 4MB to send all the utxo info


[06-Jul-19 12:24 PM] jl777c#5810
i wonder if nSPV works with zaddr transactions. it should, but i havent verified it


[06-Jul-19 12:24 PM] jl777c#5810
we should test it on PIRATE


[06-Jul-19 12:24 PM] SHossain#0007
it worked with 64 utxos


[06-Jul-19 12:25 PM] SHossain#0007
didn't crash


[06-Jul-19 12:25 PM] daemonfox#6136
ill test some ARRR


[06-Jul-19 12:26 PM] SHossain#0007
let me try setting up PIRATE nSPV node then üòÉ


[06-Jul-19 12:27 PM] daemonfox#6136
k


[06-Jul-19 12:27 PM] daemonfox#6136
grabbing my key and loading up my wallet


[06-Jul-19 12:28 PM] daemonfox#6136
Can you imagine... z2z lite...


[06-Jul-19 12:29 PM] daemonfox#6136
the full nodes would be crunched... they already are for normal z2z


[06-Jul-19 12:31 PM] daemonfox#6136
I just launched a PIRATE node to sync from scratch with this build and GDB tracing


[06-Jul-19 12:31 PM] daemonfox#6136
lets see what happens


[06-Jul-19 12:31 PM] daemonfox#6136
its syncing


[06-Jul-19 12:43 PM] daemonfox#6136
daemonfox@KMDuser:~/komodo/src$ ./komodod -datadir=/home/daemonfox/.komodo2/PIRATE -ac_name=PIRATE -daemon=0 -server -ac_halving=77777 -ac_private=1 -ac_reward=25600000000 -ac_supply=0 -listen=0 -addnode=localhost -nSPV=1
ASSETCHAINS_SUPPLY 0
perc 0.0000% ac_pub=[000000...] acsize.0
ERA0: end.0 reward.25600000000 halving.77777 decay.0 notarypay.0
MAX_MONEY 3982187503731922 39821875.03731922
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000e1f505000000d12f01000000000000000000000000004000000000000000 extralen.73 crc0.a7561c48
PIRATE halving changed to 388885 270.1 days ASSETCHAINS_LASTERA.0
call komodo_args.(./komodod) NOTARY_PUBKEY.()
>>>>>>>>>> PIRATE: p2p.45452 rpc.45453 magic.17b6e058 397860952 0 coins
initialized PIRATE at 1562442149
Error: Unable to start HTTP server. See debug log for details.
komodod: scheduler.cpp:45: CScheduler::~CScheduler(): Assertion `nThreadsServicingQueue == 0' failed.
Aborted (core dumped)


[06-Jul-19 12:45 PM] daemonfox#6136
(gdb) run
Starting program: /home/daemonfox/komodo/src/komodod -datadir=/home/daemonfox/.komodo2/PIRATE -ac_name=PIRATE -daemon=0 -server -ac_halving=77777 -ac_private=1 -ac_reward=25600000000 -ac_supply=0 -listen=0 -addnode=localhost -nSPV=1
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
[New Thread 0x7ffff6502700 (LWP 56164)]
ASSETCHAINS_SUPPLY 0
perc 0.0000% ac_pub=[000000...] acsize.0
ERA0: end.0 reward.25600000000 halving.77777 decay.0 notarypay.0
MAX_MONEY 3982187503731922 39821875.03731922
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000e1f505000000d12f01000000000000000000000000004000000000000000 extralen.73 crc0.a7561c48
PIRATE halving changed to 388885 270.1 days ASSETCHAINS_LASTERA.0
call komodo_args.(/home/daemonfox/komodo/src/komodod) NOTARY_PUBKEY.()
>>>>>>>>>> PIRATE: p2p.45452 rpc.45453 magic.17b6e058 397860952 0 coins
[Thread 0x7ffff6502700 (LWP 56164) exited]
initialized PIRATE at 1562442208
[New Thread 0x7ffff5a29700 (LWP 56165)]
[New Thread 0x7ffff5228700 (LWP 56166)]
[New Thread 0x7ffff4a27700 (LWP 56167)]
[New Thread 0x7fffeffff700 (LWP 56168)]
Error: Unable to start HTTP server. See debug log for details.
[Thread 0x7ffff4a27700 (LWP 56167) exited]
[Thread 0x7ffff5228700 (LWP 56166) exited]
[Thread 0x7fffeffff700 (LWP 56168) exited]
[Thread 0x7ffff5a29700 (LWP 56165) exited]
[Inferior 1 (process 56160) exited with code 01]
(gdb) backtrace
No stack.


[06-Jul-19 12:46 PM] jl777c#5810
not surprising it wont work


[06-Jul-19 12:51 PM] jl777c#5810
no need to test zaddr


[06-Jul-19 12:51 PM] jl777c#5810
i took out the params loading, it cant work with zaddr


[06-Jul-19 12:52 PM] SHossain#0007
ok


[06-Jul-19 12:52 PM] SHossain#0007
will setup a KMD nSPV peer then


[06-Jul-19 12:53 PM] jl777c#5810
yes we need that and a bootstrap for all the files so we can spin up a lot more KMD nSPV fullnodes


[06-Jul-19 12:53 PM] jl777c#5810
once we get them into a self-connected network (each does addnodes for all the others)


[06-Jul-19 12:53 PM] jl777c#5810
then we will have a decent capacity of at least 850x number of full nodes


[06-Jul-19 12:56 PM] jl777c#5810
@TonyL, i think i boosted the max possible connections to 8000


[06-Jul-19 12:58 PM] SHossain#0007
compiling nPSV branch on server now. will do fresh sync with addressindex=1 and txindex=1 in conf file


[06-Jul-19 01:24 PM] jl777c#5810
there are 11 nSPV fullnodes for ILN, theoretical capacity of almost 10,000 clients, assuming just one fullnode peer per nSPV client. the 873 limit is pretty hardcoded, wont be easy to update. just need more fullnodes


[06-Jul-19 01:28 PM] jl777c#5810
i guess spreading out the load with 873 nSPV clients for each fullnode, that shouldnt cause it that much load as most of the time the superlite clients will just be idle


[06-Jul-19 01:34 PM] SHossain#0007
all NN could be a full node perhaps?


[06-Jul-19 01:34 PM] SHossain#0007
we could get at least 100 nodes üòÉ


[06-Jul-19 01:36 PM] jl777c#5810
when nSPV is released, all fullnodes will be nSPV fullnodes, even without addressindex=1, they can provide most all the other info needed


[06-Jul-19 01:36 PM] SHossain#0007
nice


[06-Jul-19 01:36 PM] jl777c#5810
only nspv_listunspent needs addressindex=1


[06-Jul-19 01:37 PM] jl777c#5810
and that can be mostly cached client side


[06-Jul-19 01:42 PM] allbits#5898
So I rebuilt, logged in fine. Attempted to send but I put an amount that was too high. Then after that I could not make any other calls: "couldn't connect to server". Looked at original terminal and I see "Assertion 'fvalid' failed.


[06-Jul-19 01:44 PM] allbits#5898
When I put in the too high amount it did respond with the appropriate message of "not enough funds"


[06-Jul-19 01:45 PM] allbits#5898
After that I tried to spend the proper amount (without logging in again) and it returned the message "couldn't connect to server: EOF reached (code 1)"


[06-Jul-19 01:48 PM] jl777c#5810
couldn't connect to server


[06-Jul-19 01:48 PM] jl777c#5810
that means it crashed


[06-Jul-19 01:49 PM] jl777c#5810
do you have the latest version?


[06-Jul-19 01:49 PM] allbits#5898
I pulled about an hour ago


[06-Jul-19 01:50 PM] jl777c#5810
pull again, i added more error checking for expired wif about an hour ago


[06-Jul-19 01:50 PM] allbits#5898
Ok


[06-Jul-19 01:51 PM] jl777c#5810
if you did a login and waited a bit, then it could easily have gone past the old 60 second limit. i increased the login time to 777 seconds


[06-Jul-19 01:51 PM] jl777c#5810
and also check right before using the wif that it is still there


[06-Jul-19 01:52 PM] allbits#5898
How do I check if it's still there?


[06-Jul-19 01:52 PM] jl777c#5810
if what is still there? oh, the wif... i will add it to getinfo


[06-Jul-19 01:52 PM] allbits#5898
K


[06-Jul-19 01:58 PM] allbits#5898
Ok. Updated, repeated same work flow and everything worked as expected


[06-Jul-19 01:58 PM] jl777c#5810
updated nspv_getinfo


[06-Jul-19 01:58 PM] jl777c#5810
it shows your address/pubkey and when wif expires


[06-Jul-19 02:01 PM] allbits#5898
Updating again. Loving the git pull; make


[06-Jul-19 02:02 PM] SHossain#0007
üòÉ


[06-Jul-19 02:02 PM] SHossain#0007
live debugging


[06-Jul-19 02:03 PM] SHossain#0007
this only happens in Komodo Universe


[06-Jul-19 02:09 PM] allbits#5898
Ok. Updated. Logged in. nspv_getinfo shows address, pubkey and wifexpires!


[06-Jul-19 02:11 PM] allbits#5898
Also, getnewaddress works. Returns wif, address and pubkey. However, those aren't shown in nspv_getinfo


[06-Jul-19 02:24 PM] allbits#5898
After the wif expires, the expired address and pubkey are still returned by nspv_getinfo. The wifexpires is no longer returned.


[06-Jul-19 02:34 PM] SHossain#0007
does that show your WIF though?


[06-Jul-19 02:35 PM] SHossain#0007
you shouldn't be able to spend from that address after the WIF expires.


[06-Jul-19 02:35 PM] SHossain#0007
you need to login again usign the WIF


[06-Jul-19 02:36 PM] allbits#5898
Yes I understand. Just saying that the address and pubkey persist past expiry in the nspv_getinfo call. Maybe they shouldn't?


[06-Jul-19 02:37 PM] allbits#5898
And when getnewaddress is called, is there an expiry that's associated with that? And should the address that's generated by getnewaddress be returned in a nspv_getinfo call?


[06-Jul-19 02:41 PM] allbits#5898
Confirm that when I log in with an entirely new wif, nspv_getinfo returns the address and pocket for the new wif only


[06-Jul-19 03:08 PM] daemonfox#6136
sounds like the memcache is holding the 2 values but the code does wipe the WIF.


[06-Jul-19 03:09 PM] daemonfox#6136
Also, in theory this now works for every dPOW notarized coin within the Komodo ecosystem... can you activate nSPV atomic swaps?


[06-Jul-19 03:18 PM] daemonfox#6136
I mean that is supposed to be the idea right? Lite and easy enough that anyone with their WIF/Seed can open the Lite wallet, enter their key and issue many KMD commands not just sends and reads, but viewing, publishing and interacting with DEX offers, Voting, viewing a game or stream output live and  take tips/subs/donations


[06-Jul-19 05:44 PM] Alright#0419
Pinned a message.


[06-Jul-19 05:48 PM] allbits#5898
@Alright I launched the kmd nspv with a different addnode, as per jl777


[06-Jul-19 05:50 PM] allbits#5898
./komodod -nSPV=1 -addnode=23.254.165.16 &


[06-Jul-19 05:51 PM] Alright#0419
hey thanks, was scrolling endlessly looking for that

{Reactions}
üëç 

[06-Jul-19 10:03 PM] TonyL#3577
`@TonyL, i think i boosted the max possible connections to 8000` @jl777c max possible clients amount of client connections to single server? 
Can see `nMaxConnections 873` print on daemon init atm


[06-Jul-19 10:13 PM] TonyL#3577
yep, still 873 üòÉ


[06-Jul-19 10:41 PM] jl777c#5810
yes it is a hardcoded limit on unix as the select call only handles up to 1024 and there are some slots reserved


[06-Jul-19 10:41 PM] jl777c#5810
@allbits getnewaddress just generates a random new address


[06-Jul-19 10:42 PM] jl777c#5810
doesnt store it anyway, doesnt login, though maybe i should make it automatically login


[06-Jul-19 10:42 PM] jl777c#5810
the getinfo shows the most recent login info


[06-Jul-19 10:42 PM] jl777c#5810
my idea is that unless you specifically login, there is no indication you are actually using a privkey


[06-Jul-19 10:43 PM] jl777c#5810
so getinfo just ignores anything getnewaddress does, that is just to generate a new address now, nothing to do with login


[06-Jul-19 11:30 PM] TonyL#3577
maybe add `nspv_logout` call which will immideatly flush wif from memory? (this way apps will be able to control for how long keep wif)


[06-Jul-19 11:37 PM] TonyL#3577
```scrub wif and privkey from NSPV memory
./komodo-cli -ac_name=ILN nspv_getinfo
{
  "result": "success",
  "address": "RMjy5VkHFJkXTJDTJ3XX1zVzukP48sKyva",
```


[06-Jul-19 11:37 PM] TonyL#3577
after 777 seconds getinfo not showing `wifexpires` anymore but still can see address


[06-Jul-19 11:37 PM] jl777c#5810
yes, that is by design


[06-Jul-19 11:38 PM] jl777c#5810
it shows last address used

{Reactions}
üëå 

[06-Jul-19 11:38 PM] TonyL#3577
and listunspent with any argument returns  unspent for`  "address": "RMjy5VkHFJkXTJDTJ3XX1zVzukP48sKyva",`


[06-Jul-19 11:38 PM] jl777c#5810
that is not right, it should only be if there is no argument for listunspent


[06-Jul-19 11:38 PM] jl777c#5810
fixing


[06-Jul-19 11:39 PM] TonyL#3577
almost finished with unittest üòÉ


[06-Jul-19 11:42 PM] jl777c#5810
i added nspv_logout, fixed listunspent. the idea of the address staying around is for things like listunspent without arg defaulting to the last address


[06-Jul-19 11:43 PM] jl777c#5810
the model is user has single address, though with the speed there is no such restriction


[06-Jul-19 11:43 PM] jl777c#5810
keeping the wif active just seems dangerous


[06-Jul-19 11:43 PM] jl777c#5810
autologout will prevent access to funds on a node that was logged into and forgotten about


[06-Jul-19 11:44 PM] jl777c#5810
if you want to keep it alive, just login on a timer. there is no harm to login again


[06-Jul-19 11:44 PM] jl777c#5810
it works more with a dead man switch type of logic


[06-Jul-19 11:45 PM] TonyL#3577
I think best way from app side is like a: login -> needed operations -> logout


[06-Jul-19 11:46 PM] TonyL#3577
rebuilding


[06-Jul-19 11:46 PM] jl777c#5810
you have 777 seconds to complete  "needed operations"


[06-Jul-19 11:46 PM] jl777c#5810
if not done, do a login again


[06-Jul-19 11:47 PM] TonyL#3577
just thought that 777 seconds might be unsafe for mobile devices lets say - you can go toilet let say


[06-Jul-19 11:47 PM] TonyL#3577
back and money gone


[06-Jul-19 11:47 PM] TonyL#3577
üòÉ


[06-Jul-19 11:47 PM] jl777c#5810
you can logout anytime before 777 seconds

{Reactions}
üòÇ 

[06-Jul-19 11:47 PM] TonyL#3577
yeah, now I can üôå


[06-Jul-19 11:47 PM] jl777c#5810
fixed syntax error


[06-Jul-19 11:50 PM] TonyL#3577
hmm nspv_listunspent after logout working same way as before for me


[06-Jul-19 11:52 PM] jl777c#5810
ok, i will reproduce and fix. such simple logic to have bugs... i need more coffee

{Reactions}
‚òï (2) üç™ (2) 

[07-Jul-19 12:00 AM] rainbro7#4735
James is hilarious. I bet he would have named his pet lizard li777ard üòÇ üòù


[07-Jul-19 12:03 AM] jl777c#5810
@TonyL fixed the causal issue, which was that the most recent successful getaddressutxos result was being returned


[07-Jul-19 12:03 AM] jl777c#5810
to save time to do spend, i intentionally do not clear the utxos data that is there


[07-Jul-19 12:10 AM] TonyL#3577
and on listunspent without args returning list for address with which I was logined before - really cool


[07-Jul-19 12:15 AM] jl777c#5810
with these rpc calls, we can do a 873 peer saturation test. lilkely being bombarded with requests every second from 873 nodes will cause a lot of load


[07-Jul-19 12:15 AM] jl777c#5810
maybe even some fullnode crashes


[07-Jul-19 12:15 AM] TonyL#3577
sure, will finish unittest and prepare such attack


[07-Jul-19 12:16 AM] jl777c#5810
there really should be more fullnode crashes, i did add a bunch of new p2p messages right into the core


[07-Jul-19 12:16 AM] jl777c#5810
doing mallocs and frees, pointers, all the really dangerous things


[07-Jul-19 12:17 AM] jl777c#5810
one specific test to run is if there is a normal fullnode that is happy and you run it as an nSPV=1 node for a bit, does that mess up any data for the fullnode


[07-Jul-19 12:17 AM] jl777c#5810
i tried to disable all HDD operations, but i still see it is making mods, not sure if it is damaging or not


[07-Jul-19 12:20 AM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_txproof 67ffe0eaecd6081de04675c492a59090b573ee78955c4e8a85b8ac0be0e8e418 2673
got txproof response 1562483884 size.1820
{
  "txid": "67ffe0eaecd6081de04675c492a59090b573ee78955c4e8a85b8ac0be0e8e418",
  "height": 2673,
  "txlen": 221,
  "txprooflen": 1558
}
``` is it expected that txproof returns proof len but not proof itself?


[07-Jul-19 12:42 AM] jl777c#5810
it is just not being displayed. if you need the hex of the proof, i can add it, bit it seems something only the validation code needs


[07-Jul-19 12:42 AM] jl777c#5810
txlen is also there without rawtx bytes for same reason


[07-Jul-19 12:44 AM] jl777c#5810
i cant fully validate the proof without the merkleroot, but i can calculate a result from the merkle validation and will be adding such useful things to the json


[07-Jul-19 12:52 AM] TonyL#3577
Not sure if proof itself is needed, just wanted to confirm :)

Is retcode 0 means error on broadcast?
` "retcode": 0,` 
have problems with consistent tx broadcasting on ILN, getting such response:
 `got broadcast response 1562485805 size.37 9f3441c0e96d57c742a1137273b89ca6845e5baf0810d2a02dfbd49413e1852d retcode.0` 
not sure what is the problem - I have balance/utxos


[07-Jul-19 12:52 AM] TonyL#3577
maybe it's some specifics because ILN ondemand chain


[07-Jul-19 12:52 AM] jl777c#5810
retcode 0 means it is already in the mempool (on the fullnode)


[07-Jul-19 12:53 AM] TonyL#3577
ah, I see


[07-Jul-19 12:53 AM] jl777c#5810
are you sure it isnt already broadcast?


[07-Jul-19 12:53 AM] jl777c#5810
1 means added to mempool and broadcasted


[07-Jul-19 12:53 AM] TonyL#3577
no, it's not


[07-Jul-19 12:53 AM] jl777c#5810
-1 means some sort of error on the fullnode side


[07-Jul-19 12:53 AM] jl777c#5810
-2 means timeout


[07-Jul-19 12:55 AM] TonyL#3577
do you have some txs in mempool on `5.9.102.210` ?


[07-Jul-19 12:55 AM] jl777c#5810
no, adding prints for the fullnode and restarting


[07-Jul-19 12:55 AM] jl777c#5810
we can then see if the tx is even getting to the 102.210 node

{Reactions}
üî• 

[07-Jul-19 01:03 AM] jl777c#5810
ready


[07-Jul-19 01:06 AM] TonyL#3577
hmm ```./komodo-cli -ac_name=ILN nspv_spend broadcast 0400008085202f8901fe6697d2672ec575895ee1c233ce24d4a4896a40dffb5424769db408f38dfb150100000000ffffffff0280969800000000001976a91488b1e3638c6ba4b13c64a09111d0b93dbd5afc1f88ac001eed2b000000002321038dd117af4a372a08943aab6af42c3f07cf90f994289f80ec92de5bc71d56083eac00000000000000000000000000000000000000
error code: -1
error message:
amount too small
```


[07-Jul-19 01:06 AM] TonyL#3577
https://paste.ubuntu.com/p/8c9NRTXY4n/


[07-Jul-19 01:06 AM] jl777c#5810
i never see it


[07-Jul-19 01:07 AM] TonyL#3577
```./komodo-cli -ac_name=ILN getpeerinfo
[
  {
    "id": 2,
    "addr": "5.9.102.210",
    "addrlocal": "5.251.252.151:52438",
    "services": "0000000070000005",
    "lastsend": 1562486812,
    "lastrecv": 1562486812,
    "bytessent": 702,
    "bytesrecv": 5788,
    "conntime": 1562486525,
    "timeoffset": 0,
    "pingtime": 0.099478,
    "version": 170007,
    "subver": "/MagicBean:2.0.15rc2/",
    "inbound": false,
    "startingheight": 2694,
    "banscore": 0,
    "synced_headers": -1,
    "synced_blocks": -1,
    "inflight": [
    ],
    "whitelisted": false
  }
]
```


[07-Jul-19 01:07 AM] jl777c#5810
couldnt find txid.15fb8df308b49d762454fbdf406a89a4d424ce33c2e15e8975c52e67d29766fe


[07-Jul-19 01:07 AM] jl777c#5810
that seems to have confused it


[07-Jul-19 01:07 AM] TonyL#3577
now it's not broadcasting at all with `amount too small` error


[07-Jul-19 01:08 AM] TonyL#3577
https://paste.ubuntu.com/p/8c9NRTXY4n/ nspv_spend output


[07-Jul-19 01:08 AM] TonyL#3577
maybe I should update too?


[07-Jul-19 01:08 AM] TonyL#3577
`
  "valueBalance": 0.00000000,`


[07-Jul-19 01:08 AM] TonyL#3577
``` "vin": [
    {
      "txid": "15fb8df308b49d762454fbdf406a89a4d424ce33c2e15e8975c52e67d29766fe",
      "vout": 1,
      "scriptSig": {
        "asm": "",
        "hex": ""
      },
      "sequence": 4294967295
    }```


[07-Jul-19 01:09 AM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_broadcast 0400008085202f8901fe6697d2672ec575895ee1c233ce24d4a4896a40dffb5424769db408f38dfb150100000000ffffffff0280969800000000001976a91488b1e3638c6ba4b13c64a09111d0b93dbd5afc1f88ac001eed2b000000002321038dd117af4a372a08943aab6af42c3f07cf90f994289f80ec92de5bc71d56083eac00000000000000000000000000000000000000
got broadcast response 1562486973 size.37 61b7885f20dbb813b8022d944818429e0381638135ee51b61f63391ecbcdb2ec retcode.0
{
  "result": "success",
  "expected": "61b7885f20dbb813b8022d944818429e0381638135ee51b61f63391ecbcdb2ec",
  "broadcast": "61b7885f20dbb813b8022d944818429e0381638135ee51b61f63391ecbcdb2ec",
  "retcode": 0,
  "type": "broadcast"
}
```


[07-Jul-19 01:09 AM] TonyL#3577
now RPC call passing but receiving 0


[07-Jul-19 01:10 AM] TonyL#3577
not sure how was created `15fb8df308b49d762454fbdf406a89a4d424ce33c2e15e8975c52e67d29766fe`


[07-Jul-19 01:10 AM] jl777c#5810
look where the "amount too smal" error is, it didnt get past rpc


[07-Jul-19 01:10 AM] jl777c#5810
i see the tx got recv


[07-Jul-19 01:12 AM] jl777c#5810
i guess the error detection is not very good... it sent it so it thinks it was good, even though it was rejected by mempool


[07-Jul-19 01:12 AM] jl777c#5810
so if you get a 0 on the first broadcast, that does mean a failure


[07-Jul-19 01:12 AM] jl777c#5810
i added print in the rpc to see what satoshis it came up with, it thought it was less than 10000


[07-Jul-19 01:13 AM] TonyL#3577
aha, now after one `retcode: 0` broadcast getting again (generated new hex by spend) ```error code: -1
error message:
amount too small```


[07-Jul-19 01:13 AM] TonyL#3577
brb in 15 minutes update and retest


[07-Jul-19 01:16 AM] jl777c#5810
tx without signature is not valid


[07-Jul-19 01:34 AM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_broadcast 0400008085202f8901fe6697d2672ec575895ee1c233ce24d4a4896a40dffb5424769db408f38dfb150100000000ffffffff0280969800000000001976a91488b1e3638c6ba4b13c64a09111d0b93dbd5afc1f88ac001eed2b000000002321038dd117af4a372a08943aab6af42c3f07cf90f994289f80ec92de5bc71d56083eac00000000000000000000000000000000000000
got broadcast response 1562488444 size.37 61b7885f20dbb813b8022d944818429e0381638135ee51b61f63391ecbcdb2ec retcode.0
{
  "result": "success",
  "expected": "61b7885f20dbb813b8022d944818429e0381638135ee51b61f63391ecbcdb2ec",
  "broadcast": "61b7885f20dbb813b8022d944818429e0381638135ee51b61f63391ecbcdb2ec",
  "retcode": 0,
  "type": "broadcast"
}
```


[07-Jul-19 01:35 AM] TonyL#3577
```satoshis.10000000 from 0.10000000
got utxos response 1562488436 size.425
RMjy5VkHFJkXTJDTJ3XX1zVzukP48sKyva numutxos.6 balance 23.30970000
got txproof response 1562488436 size.1820
got ntzs response 1562488436 size.209
couldnt find txid.15fb8df308b49d762454fbdf406a89a4d424ce33c2e15e8975c52e67d29766fe
sign 1 inputs 7.46970000 + interest 0.00000000 -> 2 outputs 0.10000000 change 7.36960000
```


[07-Jul-19 01:35 AM] TonyL#3577
prints which I got on `spend`


[07-Jul-19 01:35 AM] TonyL#3577
`couldnt find txid.15fb8df308b49d762454fbdf406a89a4d424ce33c2e15e8975c52e67d29766fe` I wonder it's a clue


[07-Jul-19 01:37 AM] TonyL#3577
https://iln.explorer.dexstats.info/tx/15fb8df308b49d762454fbdf406a89a4d424ce33c2e15e8975c52e67d29766fe


[07-Jul-19 01:39 AM] jl777c#5810
i am in the middle of adding validations and it isnt complete, so it is invalidating the vin


[07-Jul-19 01:39 AM] jl777c#5810
skip this test for now and test other things until i announce validations are done

{Reactions}
üëç 

[07-Jul-19 01:40 AM] TonyL#3577
ok, will attack by getinfo calls from many nodes üòÉ


[07-Jul-19 02:18 AM] TonyL#3577
trying some getinfo spam


[07-Jul-19 02:59 AM] TonyL#3577
is full node fine? hope getinfo performing not locally üòÉ


[07-Jul-19 03:03 AM] jl777c#5810
330 connections, 4% CPU usage


[07-Jul-19 03:16 AM] TonyL#3577
That strange, I have ~800 clients spamming getinfo non stop


[07-Jul-19 03:16 AM] jl777c#5810
with -connect or -addnode


[07-Jul-19 03:16 AM] TonyL#3577
ouch `-addnode`


[07-Jul-19 03:16 AM] TonyL#3577
let me fix it


[07-Jul-19 03:28 AM] TonyL#3577
changed, now test conditions should be correct


[07-Jul-19 03:29 AM] jl777c#5810
336 peers, 5% CPU


[07-Jul-19 03:30 AM] TonyL#3577
I'm getting quite often `no pnodes` prints


[07-Jul-19 03:31 AM] TonyL#3577
maybe because of getinfo spam some connections dropping


[07-Jul-19 03:31 AM] TonyL#3577
now 730 clients started with `-connect=5.9.102.210'` param


[07-Jul-19 03:32 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/597374300021981205/unknown.png


[07-Jul-19 03:32 AM] jl777c#5810
are you checking in each client if it is getting valid data?


[07-Jul-19 03:33 AM] TonyL#3577
for now just connecting, then calling nspv_getinfo one by one and printing output in infinity loop


[07-Jul-19 03:33 AM] jl777c#5810
maybe check for "connections" from getinfo output


[07-Jul-19 03:56 AM] TonyL#3577
spinned 480 clients, all have 1 in getinfo connections


[07-Jul-19 03:56 AM] TonyL#3577
can you see 480 connections now?


[07-Jul-19 03:57 AM] jl777c#5810
330


[07-Jul-19 03:57 AM] TonyL#3577
hmmm very strange


[07-Jul-19 03:57 AM] jl777c#5810
747


[07-Jul-19 03:57 AM] jl777c#5810
i was looking at KMD peers. ooops


[07-Jul-19 03:57 AM] TonyL#3577
üòÇ


[07-Jul-19 03:58 AM] jl777c#5810
5.5% CPU


[07-Jul-19 03:58 AM] TonyL#3577
not spamming now


[07-Jul-19 03:58 AM] TonyL#3577
wanted just to ensure that I'm connecting first


[07-Jul-19 04:00 AM] TonyL#3577
started some spam now


[07-Jul-19 04:00 AM] jl777c#5810
5.6% CPU load

{Reactions}
üòÖ 

[07-Jul-19 04:00 AM] jl777c#5810
up 0.1%


[07-Jul-19 04:00 AM] jl777c#5810
massive spam attack it is


[07-Jul-19 04:01 AM] TonyL#3577
let me try to make separate spam thread for each client


[07-Jul-19 04:02 AM] jl777c#5810
there is a one getinfo per second limit


[07-Jul-19 04:02 AM] jl777c#5810
per peer


[07-Jul-19 04:02 AM] jl777c#5810
per message


[07-Jul-19 04:02 AM] TonyL#3577
aha, need to separate on groups so maybe


[07-Jul-19 04:02 AM] TonyL#3577
and call one by one in groups


[07-Jul-19 04:03 AM] TonyL#3577
should be more calls because now 498 nodes calling one by one in loop - so first node calling only after 497 more calls


[07-Jul-19 04:03 AM] jl777c#5810
issuing all the different messages in a burst from each peer and only doing it once per second for a peer would be the most


[07-Jul-19 04:03 AM] TonyL#3577
my server will burn faster I bet üòÇ


[07-Jul-19 04:08 AM] TonyL#3577
are you updating server?


[07-Jul-19 04:08 AM] jl777c#5810
yes


[07-Jul-19 04:08 AM] jl777c#5810
accidentally updated the wrong node


[07-Jul-19 04:10 AM] jl777c#5810
back up


[07-Jul-19 04:10 AM] jl777c#5810
732 connections


[07-Jul-19 04:18 AM] jl777c#5810
9% CPU load


[07-Jul-19 04:18 AM] jl777c#5810
it seems the rate limiter is working well


[07-Jul-19 04:18 AM] jl777c#5810
if at most it is 10% to 20% when being saturated, this is not bad at all


[07-Jul-19 04:19 AM] TonyL#3577
aha, I've added some threading - trying to add more calls now


[07-Jul-19 04:21 AM] TonyL#3577
added more calls and removed prints on my side as an attempt to speed up things üòÉ


[07-Jul-19 04:23 AM] jl777c#5810
same


[07-Jul-19 04:28 AM] TonyL#3577
have to think a little bit and design test better I wonder. stdout (stderr ? ) moving not in burst mode on my side I can say


[07-Jul-19 04:29 AM] jl777c#5810
each client should be in its own thread


[07-Jul-19 04:30 AM] jl777c#5810
every time timestamp changes, issues all the different rpc calls that generate a p2p message


[07-Jul-19 04:30 AM] jl777c#5810
that will be the maxload possible


[07-Jul-19 04:30 AM] TonyL#3577
yes, I've started own thread for each client, each thread calling like a 5 RPC calls which needs response from server, then sleep 1 sec


[07-Jul-19 04:30 AM] TonyL#3577
python just not the fastest thingy for multithreading


[07-Jul-19 04:34 AM] jl777c#5810
8 requests in one second is not much load


[07-Jul-19 04:34 AM] jl777c#5810
actually only 7 diffrent message types


[07-Jul-19 04:34 AM] TonyL#3577
8 request from 480 clients


[07-Jul-19 04:34 AM] jl777c#5810
but if it takes 1 milliseconds each, then it could make some load


[07-Jul-19 04:35 AM] jl777c#5810
still, any load will mostly be waiting for DB


[07-Jul-19 04:37 AM] jl777c#5810
9.1%


[07-Jul-19 04:38 AM] TonyL#3577
new record üòÉ


[07-Jul-19 04:39 AM] TonyL#3577
I think I'll make 4 servers now with 100 clients each


[07-Jul-19 04:39 AM] jl777c#5810
what load is your server at?


[07-Jul-19 04:39 AM] jl777c#5810
unless it is at 100%, it wont change much


[07-Jul-19 04:40 AM] TonyL#3577
yes, it's somewhere around your numbers


[07-Jul-19 04:52 AM] TonyL#3577
is node fine? - getting `no pnodes` now


[07-Jul-19 04:53 AM] jl777c#5810
10%


[07-Jul-19 04:53 AM] jl777c#5810
746 peers


[07-Jul-19 05:25 AM] SHossain#0007
sync is very slow on the server that i wanted to use for nSPV peer. this is what i have since last night
```
  "blocks": 480609,
  "longestchain": 1432437,
  "connections": 38,
```


[07-Jul-19 05:26 AM] jl777c#5810
yes, addressindex makes it very slow


[07-Jul-19 05:26 AM] jl777c#5810
this is why i advised to make a bootstrap


[07-Jul-19 05:28 AM] SHossain#0007
i'll  make a bootstrap once i have fully synced


[07-Jul-19 05:31 AM] SHossain#0007
i have a KMD node with 
```
txindex=1
addressindex=1
timestampindex=1
spentindex=1
```
the chain is last synced to last month. would that be good to bootstrap?


[07-Jul-19 05:32 AM] jl777c#5810
just sync that node to current and it can be used


[07-Jul-19 05:32 AM] SHossain#0007
cool. will do now


[07-Jul-19 05:32 AM] jl777c#5810
nSPV mode does not change addressindex data


[07-Jul-19 05:33 AM] SHossain#0007
this may be faster than my current sluggish sync


[07-Jul-19 05:44 AM] SHossain#0007
sync done on that node. shall i just compress `blocks, chainstate & notarisations` directory?


[07-Jul-19 05:46 AM] SHossain#0007
ok. started with these 3 dirs


[07-Jul-19 05:46 AM] CHMEX#0686
If you need this bootstraps let me know the explorer need all those indexes


[07-Jul-19 05:47 AM] SHossain#0007
haha...yes, we needed bootstrap with `txindex=1` & `addressindex=1`


[07-Jul-19 05:48 AM] SHossain#0007
i started syncing fresh node with those 2 but was taking longer. but i have another node with all of those. bootstrapping that


[07-Jul-19 06:06 AM] jl777c#5810
you need all the data files


[07-Jul-19 06:15 AM] SHossain#0007
sorry, you mean `fee_estimates.dat, fee_estimates.dat, komodostate, komodostate.ind, realtime, signedmasks, peers.dat` files also needed?


[07-Jul-19 06:46 AM] jl777c#5810
komodostate, komodostate.ind and notarisations


[07-Jul-19 06:46 AM] SHossain#0007
thanks. i'll compress again and re-upload


[07-Jul-19 07:02 AM] TonyL#3577
@jl777c I think I optimisied way to spam a little bit. Is loading on server changed?


[07-Jul-19 07:02 AM] TonyL#3577
cooked my laptop hard üòÉ

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/597427237158912010/unknown.png


[07-Jul-19 07:04 AM] SHossain#0007
does it  taste like Dimitri's BBQ? üòâ

{Reactions}
ü•ò 

[07-Jul-19 07:04 AM] TonyL#3577
haha, it's possible to cook Dimitri's BBQ on it now I bet üòÉ


[07-Jul-19 07:05 AM] TonyL#3577
```Core 0:        +86.0¬∞C  (high = +100.0¬∞C, crit = +100.0¬∞C)
Core 1:        +82.0¬∞C  (high = +100.0¬∞C, crit = +100.0¬∞C)
Core 2:        +90.0¬∞C  (high = +100.0¬∞C, crit = +100.0¬∞C)
Core 3:        +82.0¬∞C  (high = +100.0¬∞C, crit = +100.0¬∞C)
Core 4:        +80.0¬∞C  (high = +100.0¬∞C, crit = +100.0¬∞C)
Core 5:        +79.0¬∞C  (high = +100.0¬∞C, crit = +100.0¬∞C)
```

{Reactions}
üî• 

[07-Jul-19 07:05 AM] TonyL#3577
quite hot


[07-Jul-19 07:06 AM] TonyL#3577
VPS my bash locked so hard so can't even ssh into it


[07-Jul-19 07:08 AM] TonyL#3577
really interesting now how James server handle it, I think spam is like a 50 times more massive now üòÉ


[07-Jul-19 07:08 AM] jl777c#5810
yes load is WAY up


[07-Jul-19 07:09 AM] jl777c#5810
15.4%

{Reactions}
üòø 

[07-Jul-19 07:09 AM] jl777c#5810
15.8


[07-Jul-19 07:09 AM] jl777c#5810
15.9


[07-Jul-19 07:09 AM] TonyL#3577
I thought it burning in fire


[07-Jul-19 07:09 AM] jl777c#5810
it is going up slowly


[07-Jul-19 07:10 AM] jl777c#5810
it could be all your threads are not running at full speed yet


[07-Jul-19 07:10 AM] TonyL#3577
core i7 on laptop and core i9 on VPS threads busy 100%


[07-Jul-19 07:10 AM] jl777c#5810
17.2%


[07-Jul-19 07:12 AM] jl777c#5810
18.7%, node is falling behind


[07-Jul-19 07:13 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/597430087457046539/video.mov


[07-Jul-19 07:14 AM] TonyL#3577
prints so fast so when I'm doing screencast even frames not moving üòÉ


[07-Jul-19 07:14 AM] jl777c#5810
you need to > logfile


[07-Jul-19 07:14 AM] jl777c#5810
otherwise it will slow down the threads


[07-Jul-19 07:14 AM] jl777c#5810
you can tail -f logfile and it wont affect thread performance


[07-Jul-19 07:14 AM] jl777c#5810
75%


[07-Jul-19 07:15 AM] TonyL#3577
aha!


[07-Jul-19 07:15 AM] TonyL#3577
yeah, I can even drop it to /dev/null I think


[07-Jul-19 07:15 AM] TonyL#3577
it is a pilot run üòÉ


[07-Jul-19 07:15 AM] jl777c#5810
yes, good CPU saturation, mem is stable at 0.4%


[07-Jul-19 07:52 AM] TonyL#3577
made assasisns silent - maybe it's a little bit faster now


[07-Jul-19 08:13 AM] jl777c#5810
60%


[07-Jul-19 08:46 AM] TonyL#3577
ok, right now should be the best attack I can do I think üòÉ


[07-Jul-19 08:58 AM] TonyL#3577
`issue getinfo` suspicous prints in stdout I've started to get (but maybe just some clients disconnected because of connections limit - separated nodes between servers a little bit different now)


[07-Jul-19 09:04 AM] jl777c#5810
130%


[07-Jul-19 09:04 AM] jl777c#5810
if the most aggressive attack is 130%, it seems we have no problems at this peer limit!


[07-Jul-19 09:05 AM] jl777c#5810
at 10x this peer limit it would be a problem, so it seems it is good the limit is 873


[07-Jul-19 09:06 AM] TonyL#3577
ah, means it was loading indication on single core?


[07-Jul-19 09:09 AM] jl777c#5810
it could be


[07-Jul-19 09:09 AM] TonyL#3577
130 is more than 5, tried to break it - but peers limitation + 1 second limitation looks as nice organic DDoS protection


[07-Jul-19 09:09 AM] jl777c#5810
it was 70% before so double now


[07-Jul-19 09:10 AM] TonyL#3577
on my side it is 3 servers with 44 cores in total loaded almost fully


[07-Jul-19 09:13 AM] TonyL#3577
btw as protection from such attack fullnode operator can ban IP if amounts of clients with it more than 10 lets say


[07-Jul-19 09:14 AM] jl777c#5810
it costs more work to send than to respond


[07-Jul-19 09:29 AM] jl777c#5810
@TonyL updating to new version. this is a "hardfork" from old version. 
it proves each utxo via merkle proof for the blocks merkle root, it also verifies that all headers in the range between notarizations are backlinking to each other, and it uses the opreturn data inside the notarization


[07-Jul-19 09:30 AM] jl777c#5810
the only validations left to do are to verify the notary signatures and KMD interest values, which are not critical at this stage


[07-Jul-19 09:30 AM] jl777c#5810
that was a long grind to get all the data to match up

{Reactions}
üöÄ 

[07-Jul-19 09:31 AM] TonyL#3577
shutting down clients and updating


[07-Jul-19 09:33 AM] jl777c#5810
now doing a spend might take a bit longer


[07-Jul-19 09:33 AM] jl777c#5810
but it is essentially doing most of the nSPV validation


[07-Jul-19 09:50 AM] TonyL#3577
updated nodes and restarted spammers, going to rest


[07-Jul-19 09:51 AM] jl777c#5810
92%


[07-Jul-19 09:51 AM] TonyL#3577
just started to get `no pnodes` on all clients


[07-Jul-19 09:51 AM] jl777c#5810
another cool thing about nSPV at the p2p protocol level is that it is totally stateless, so you can connect to any fullnode at any point for any required data. also you can restart a node


[07-Jul-19 09:51 AM] jl777c#5810
and after it comes back up, things should get back to normal


[07-Jul-19 09:52 AM] jl777c#5810
that is a good test


[07-Jul-19 09:52 AM] TonyL#3577
aha, so you're restarting üòÉ


[07-Jul-19 09:52 AM] jl777c#5810
it seems it will take quite a few nodes to saturate the 10 nSPV full nodes


[07-Jul-19 09:53 AM] jl777c#5810
it was spewing printouts and slowing things down


[07-Jul-19 09:53 AM] jl777c#5810
should be faster on your end now


[07-Jul-19 09:53 AM] jl777c#5810
164%!


[07-Jul-19 09:53 AM] TonyL#3577
I spam exactly same way as b4


[07-Jul-19 09:54 AM] TonyL#3577
`it seems it will take quite a few nodes to saturate the 10 nSPV full nodes` depends of how much is 164% from total of such full node capacity


[07-Jul-19 09:54 AM] TonyL#3577
üòÉ


[07-Jul-19 09:57 AM] TonyL#3577
`I spam exactly same way as b4` - ah maybe from working machine a little bit faster (before did some reindex in background which took some resources and now it finished)


[07-Jul-19 09:57 AM] jl777c#5810
this node has 800% capacity


[07-Jul-19 09:57 AM] jl777c#5810
but you cant get many more peers due to the max limit


[07-Jul-19 09:58 AM] jl777c#5810
so it seems the rate limit is working as it should


[07-Jul-19 09:58 AM] TonyL#3577
so with same spam mechanism it should be totally busy with around 3500-4000 peers


[07-Jul-19 09:58 AM] SHossain#0007
this is very interesting. bootstrap upload will be done in approx 1 hours 30 mins.


[07-Jul-19 09:59 AM] SHossain#0007
home network's upload speed is very low


[07-Jul-19 09:59 AM] TonyL#3577
is it bootstrap for KMD nSPV full nodes?


[07-Jul-19 09:59 AM] SHossain#0007
yes


[07-Jul-19 10:00 AM] SHossain#0007
once i have it on server, it will be easier to distribute and setup full node in very low time

{Reactions}
üî• 

[07-Jul-19 10:01 AM] SHossain#0007
also syncing an alien node from scratch using different data dir.


[07-Jul-19 10:03 AM] SHossain#0007
@jl777c found a small thing. i started `komodod` using different data dir and the conf specifies to use 
```
rpcport=6771
p2pport=6770
```
but, when i do getinfo call, i see default komodo rpc and p2p port values


[07-Jul-19 10:03 AM] SHossain#0007
7771 & 7770


[07-Jul-19 10:04 AM] SHossain#0007
shouldn't it show 6771 and 6770 as i am using those values?


[07-Jul-19 10:04 AM] TonyL#3577
prints on init showing port not from config/startup params also


[07-Jul-19 10:04 AM] TonyL#3577
little visual bug üòÉ


[07-Jul-19 10:05 AM] SHossain#0007
yes, it's just cosmetic. but, to new users, might be little confusing üòÉ


[07-Jul-19 10:05 AM] TonyL#3577
confused me b4 coffee as well, had to `netstat` to reveal confusion


[07-Jul-19 10:06 AM] SHossain#0007
not an issue for me as i know what i'm doing :abused_smiley:


[07-Jul-19 10:08 AM] SHossain#0007
found, alien server syncs relatively faster with all those indexes are on compared to the first node i waas trying with


[07-Jul-19 10:12 AM] TonyL#3577
reindex using single cpu thread atm - thread on alien is probably more powerful than thread on another server


[07-Jul-19 10:14 AM] TonyL#3577
if somebody implement multiprocessing reindex/rescan - it should be super fast on alien üòÉ


[07-Jul-19 10:15 AM] SHossain#0007
btw @TonyL , BTC also uses same single thread for reindexing

{Reactions}
ü§î 

[07-Jul-19 10:15 AM] SHossain#0007
it doesn't use multi-thread


[07-Jul-19 10:15 AM] SHossain#0007
i've done that test recently


[07-Jul-19 10:16 AM] TonyL#3577
perhaps there are deep/complicated reasons of such limitation


[07-Jul-19 10:21 AM] SHossain#0007
if reindex uses multi-thread, some users will always complain that komodo or BTC using all their computational power and other software they are running doesn't work at the same time


[07-Jul-19 10:22 AM] TonyL#3577
param like a `nproc` in mining can resolve such complains

{Reactions}
üíØ 

[07-Jul-19 10:22 AM] jl777c#5810
much faster to resync from scratch than reindex addressindex=1


[07-Jul-19 10:24 AM] SHossain#0007
`./komodod -reindex -j$(nproc)` would be cool for normal reindex üòÉ


[07-Jul-19 10:25 AM] jl777c#5810
problem is that it is a blockchain


[07-Jul-19 10:25 AM] jl777c#5810
serial dependencies


[07-Jul-19 10:25 AM] jl777c#5810
processing it in parallel would require iguana internal data structures


[07-Jul-19 10:41 AM] Tylor zkFS#8280
Woah....I like this channel


[07-Jul-19 11:03 AM] allbits#5898
Noob report. Updated and attempted too login, spend and broadcast like yesterday.. However, it's not working for me today. Console says couldn't find txid or it was spent. Explorer shows funds available to spend.


[07-Jul-19 11:06 AM] jl777c#5810
likely an issue with strict validation


[07-Jul-19 11:07 AM] jl777c#5810
pushed a debug version that should print an error retval


[07-Jul-19 11:16 AM] allbits#5898
Updating


[07-Jul-19 11:16 AM] jl777c#5810
it might work, but it will tell me the error with the retval would have been print


[07-Jul-19 11:21 AM] allbits#5898
So, same result. What should I look for?


[07-Jul-19 11:21 AM] jl777c#5810
any printouts?


[07-Jul-19 11:22 AM] allbits#5898
No additional printouts in komodod console it seems


[07-Jul-19 11:23 AM] jl777c#5810
is it a test address with small funds?


[07-Jul-19 11:23 AM] allbits#5898
Yes. One kmd


[07-Jul-19 11:23 AM] jl777c#5810
if so DM me the wif and i can see if i can reproduce it


[07-Jul-19 11:24 AM] allbits#5898
Done


[07-Jul-19 11:34 AM] jl777c#5810
problem reproduced. the txproof is not being returned


[07-Jul-19 11:34 AM] jl777c#5810
ooops!


[07-Jul-19 11:34 AM] jl777c#5810
i forgot to update that node!


[07-Jul-19 11:35 AM] jl777c#5810
i made a hardfork change so of course it doesnt work


[07-Jul-19 11:35 AM] allbits#5898
Does this mean I helped find a bug? Kind of anyway?


[07-Jul-19 11:35 AM] jl777c#5810
yes!


[07-Jul-19 11:35 AM] allbits#5898
Cool!


[07-Jul-19 11:35 AM] jl777c#5810
not a bug in the code but a bug in the infrastructure


[07-Jul-19 11:35 AM] jl777c#5810
still a bug is a bug


[07-Jul-19 12:05 PM] SHossain#0007 (pinned)
bootstrap
http://allatone.co.uk/KMD-bootstrap-full.tar.gz


[07-Jul-19 12:09 PM] jl777c#5810
@allbits works better now, but still some off by one errors. but you should be able to spend


[07-Jul-19 12:18 PM] SHossain#0007
Pinned a message.


[07-Jul-19 12:18 PM] SHossain#0007
compiling latest and will start the daemon for nSPV full node


[07-Jul-19 12:21 PM] allbits#5898
Confirm that spend worked


[07-Jul-19 12:23 PM] Tylor zkFS#8280
Pay the bug finder....


[07-Jul-19 12:23 PM] Tylor zkFS#8280
I'll jump in


[07-Jul-19 12:35 PM] SHossain#0007
`./komodod -nSPV=1 -addnode=94.130.224.11 &`


[07-Jul-19 12:35 PM] SHossain#0007
this node is working


[07-Jul-19 12:38 PM] SHossain#0007 (pinned)
**Start nPSV daemon**
`./komodod -nSPV=1 -addnode=94.130.224.11 -addnode=23.254.165.16 &`
**CLI Commands**
```
./komodo-cli nspv_getinfo
./komodo-cli nspv_listunspent address
./komodo-cli nspv_notarizations height
./komodo-cli nspv_hdrsproof prevheight nextheight
./komodo-cli nspv_txproof txid height
./komodo-cli nspv_spentinfo txid vout
./komodo-cli nspv_login wif
./komodo-cli nspv_spend destaddr amount
./komodo-cli nspv_broadcast hex
```
Read more here https://medium.com/@jameslee777/nspv-reference-cli-client-cf1ffdc03631

{Embed}
https://medium.com/@jameslee777/nspv-reference-cli-client-cf1ffdc03631
nSPV reference cli client - jl777 - Medium
Above is the first ever transaction created by nSPV! nSPV went from idea to initial implementation during this last week. With the rest of‚Ä¶


[07-Jul-19 12:38 PM] SHossain#0007
Pinned a message.


[07-Jul-19 12:48 PM] SHossain#0007
i have 15 utxos. logged in using WIF. wanted to send them to self address, but getting this
```
{
  "result": "error",
  "error": "couldnt create tx"
}
```


[07-Jul-19 04:50 PM] dukeleto#7326
nSPV is really coming along, awesome to see

{Reactions}
shexy 

[07-Jul-19 10:13 PM] jl777c#5810
@SHossain need console prints to see the reason. also latest version will help troubleshoot


[07-Jul-19 10:16 PM] TonyL#3577
will try to do the same now


[07-Jul-19 10:33 PM] TonyL#3577
```./komodo-cli -ac_name=ILN nspv_broadcast 0400008085202f8901fe6697d2672ec575895ee1c233ce24d4a4896a40dffb5424769db408f38dfb150100000048473044022066a3dc90527b1cd8528e91b2b7c7e6a2148f66f2776fce6f0274190a2c907d780220038b4f3d97922368cd2e65ce2bfce1564fafcf436c764fac1eaddea0fd09890801ffffffff0200e1f505000000001976a91488b1e3638c6ba4b13c64a09111d0b93dbd5afc1f88ac80d38f26000000002321038dd117af4a372a08943aab6af42c3f07cf90f994289f80ec92de5bc71d56083eac00000000000000000000000000000000000000
got broadcast response 1562563966 size.37 70f536befe7776ccbf508234ef20a36877d545e9abc54cf3d16b91ce198f9f74 retcode.1
{
  "result": "success",
  "expected": "70f536befe7776ccbf508234ef20a36877d545e9abc54cf3d16b91ce198f9f74",
  "broadcast": "70f536befe7776ccbf508234ef20a36877d545e9abc54cf3d16b91ce198f9f74",
  "retcode": 1,
  "type": "broadcast and mempool"
}
``` sent 1 coin to myself, but it's on ILN. Let me try KMD also


[07-Jul-19 10:34 PM] jl777c#5810
i noticed some notarization bracket issues. the thing we forget is that this is all very new code and we didnt make sure 100% of the low level calls are working as they should


[07-Jul-19 10:35 PM] jl777c#5810
for nspv_spend to work, literally the entire system needs to be bug free


[07-Jul-19 10:35 PM] jl777c#5810
i saw a bad notarizations bracket on KMD, which would make validation fail


[07-Jul-19 10:35 PM] TonyL#3577
```./komodo-cli nspv_broadcast 0400008085202f8901b66c9f32f9e40fefa857ad54e93a0878d4eb508bd176a097901fd73e83d83ab7010000006b483045022100c93f42405f3b630b6fa2755e02dafdfd36c35ad470736b9cd888612cf776b33c022076a06e2ea043b73de15fe18ea3ff3e9728db65996eb9b6eaee8566e819d1361a012103aa464529c190398d44017c3d7a71a854ad195a9d396bf84182679c242bb60085ffffffff0200e1f505000000001976a914a19f7aa254dced0a17920ab1c2acf698841f67f688ac2efc8c0e01000000232103aa464529c190398d44017c3d7a71a854ad195a9d396bf84182679c242bb60085ac0cd3225d000000000000000000000000000000
got broadcast response 1562564127 size.37 6df93447bc0c19ffd6712a354f9441812b10b944ab0084e3cf8063a11c432b90 retcode.1
{
  "result": "success",
  "expected": "6df93447bc0c19ffd6712a354f9441812b10b944ab0084e3cf8063a11c432b90",
  "broadcast": "6df93447bc0c19ffd6712a354f9441812b10b944ab0084e3cf8063a11c432b90",
  "retcode": 1,
  "type": "broadcast and mempool"
}
```


[07-Jul-19 10:35 PM] TonyL#3577
broadcasted on KMD too, at least now üòÉ


[07-Jul-19 10:36 PM] TonyL#3577
`sign 1 inputs 46.39066607 + interest 0.00031311 -> 2 outputs 1.00000000 change 45.39087918` interest claimed as well


[07-Jul-19 10:37 PM] jl777c#5810
did the console say what retval it would have been?


[07-Jul-19 10:38 PM] TonyL#3577
yes


[07-Jul-19 10:38 PM] TonyL#3577
-22


[07-Jul-19 10:38 PM] jl777c#5810
latest version allows send even if notarization validation got an error, prints the error code to help troubleshoot


[07-Jul-19 10:39 PM] jl777c#5810
that relates to notarization range, which is what i will fix next

{Reactions}
üôå 

[07-Jul-19 10:41 PM] TonyL#3577
`QJT` like this address so much - it's almost broadway straight (queen jack ten) and generated without vanity
previous address I got randomly was with `Dev` in the end (kmdlabs NN address) - signs everywhere  üòÖ


[08-Jul-19 12:08 AM] jl777c#5810
fixed the bug with the wrong notarization bracket, now i allow validation errors on spend, but return the error code so the user can decide if it is acceptable. still it is getting spurious errors, like when spending non-notarized utxo, probably i should special case that


[08-Jul-19 12:28 AM] Deleted User#0000
lol my LABS nn key ends in Fuk üòÇ

{Reactions}
üòÇ (2) 

[08-Jul-19 12:37 AM] TonyL#3577
```  "retcodes": [
    -22
  ]
```


[08-Jul-19 12:37 AM] TonyL#3577
```./komodo-cli nspv_broadcast 0400008085202f8901902b431ca16380cfe38400ab44b9102b8141944f352a71d6ff190cbc4734f96d0100000049483045022100c48170ed477097a1cab3a6e625c31c1580aff21e0c4d8414059507995cc52dc002201023877e1d92775c9f2e424d5e1a73fc6f4fe66a75568160d352f2cf2331b2f701ffffffff0200e1f505000000001976a914a19f7aa254dced0a17920ab1c2acf698841f67f688acb470970801000000232103aa464529c190398d44017c3d7a71a854ad195a9d396bf84182679c242bb60085ac80ef225d000000000000000000000000000000
got broadcast response 1562571435 size.37 34039af1c2339ba6a1b360b707febf02c287f3fa77757478497253a84948889e retcode.1
{
  "result": "success",
  "expected": "34039af1c2339ba6a1b360b707febf02c287f3fa77757478497253a84948889e",
  "broadcast": "34039af1c2339ba6a1b360b707febf02c287f3fa77757478497253a84948889e",
  "retcode": 1,
  "type": "broadcast and mempool"
}
```


[08-Jul-19 01:16 AM] jl777c#5810
-22 usually means non-notarized utxo


[08-Jul-19 02:16 AM] jl777c#5810
updated with fixes, hardforking as it also now supports nspv_getinfo <hdrheight> which will return the blockheader for <hdrheight>, default is 0 which means chaintip


[08-Jul-19 02:16 AM] jl777c#5810
with this, it is possible to track the mainchain as new headers come in (past notarization)


[08-Jul-19 02:17 AM] jl777c#5810
this is needed when we start getting more nSPV fullnodes that return different data (they might be syncing, they might be evil)


[08-Jul-19 02:19 AM] jl777c#5810
if the recodes are all 0, that means all the utxo are notarized. i think one more rpc call is needed "nspv_validate txid" which will do just the utxo validation that is inside the nspv_spend now. that way, a smarter superlite client can cache validated utxo and not waste time doing it during the spend


[08-Jul-19 02:43 AM] TonyL#3577
```./komodo-cli nspv_getinfo 777777
{
  "result": "success",
  "height": 1433697,
  "chaintip": "03e2f75c3d4cd5ff071f43b6cc0a3744f5c5a8622ded47c0baefdbb8c3113a62",
  "notarization": {
    "notarized_height": 1433680,
    "notarized_blockhash": "029f03de75e7719def97d603f3f217ffbbe60f9dc86b1105d9c89360353d34f0",
    "notarization_txid": "e1842d3df6c1689d13085790df0cfc44df2f6b3d9ba06a92043a764d004f89ba",
    "notarization_txidheight": 1433694,
    "notarization_desttxid": "fc94d918ffb4683dd44e4c47335bf979d5832a49b88db305854a08bcb91728c9"
  },
  "hdr": {
    "height": 0,
    "blockhash": "2b2d8bc4187b2cef6b5dc69ae7c0a362fca09a868ed37f31629f7b264abf3fa1",
    "hashPrevBlock": "f3f217ffbbe60f9dc86b1105d9c89360353d34f00100000000000000a5000000",
    "hashMerkleRoot": "df0cfc44df2f6b3d9ba06a92043a764d004f89ba029f03de75e7719def97d603",
    "nTime": 3561901127,
    "nBits": 4290013245
  }
}
```


[08-Jul-19 02:43 AM] jl777c#5810
latest version?


[08-Jul-19 02:44 AM] TonyL#3577
not grabbed one commit `Updating dcbf1539a..2bbec3792`


[08-Jul-19 02:44 AM] TonyL#3577
let me try again


[08-Jul-19 02:44 AM] jl777c#5810
no need


[08-Jul-19 02:44 AM] jl777c#5810
it is my node not latest


[08-Jul-19 02:44 AM] jl777c#5810
updating


[08-Jul-19 02:46 AM] jl777c#5810
unless you have an ancient version from a few hours ago


[08-Jul-19 02:46 AM] jl777c#5810
using latest, nSPV client shows 777777


[08-Jul-19 02:47 AM] TonyL#3577
now 100% on latest


[08-Jul-19 02:47 AM] TonyL#3577
```./komodo-cli nspv_getinfo 777777
{
  "result": "success",
  "height": 1433699,
  "chaintip": "0a1b807100ad481298f9721faab208d67c97c4399feee4d65460a00a5c9ce1e8",
  "notarization": {
    "notarized_height": 1433680,
    "notarized_blockhash": "029f03de75e7719def97d603f3f217ffbbe60f9dc86b1105d9c89360353d34f0",
    "notarization_txid": "e1842d3df6c1689d13085790df0cfc44df2f6b3d9ba06a92043a764d004f89ba",
    "notarization_txidheight": 1433694,
    "notarization_desttxid": "fc94d918ffb4683dd44e4c47335bf979d5832a49b88db305854a08bcb91728c9"
  },
  "hdr": {
    "height": 0,
    "blockhash": "b0cc77650bda7a16ebce21c1f26626f4581e4d290b028cf832192740d72ece5d",
    "hashPrevBlock": "f3f217ffbbe60f9dc86b1105d9000000000000000000000000000000a5000000",
    "hashMerkleRoot": "df0cfc44df2f6b3d9ba06a92043a764d004f89ba029f03de75e7719def97d603",
    "nTime": 3561901127,
    "nBits": 4290013245
  }
}
```


[08-Jul-19 02:47 AM] TonyL#3577
```./komodo-cli getpeerinfo
[
  {
    "id": 1,
    "addr": "94.130.224.11:7770",
    "addrlocal": "2.135.130.180:51034",
    "services": "0000000060000005",
    "lastsend": 1562579239,
    "lastrecv": 1562579240,
    "bytessent": 304,
    "bytesrecv": 22367,
    "conntime": 1562579232,
    "timeoffset": 0,
    "pingtime": 0.121442,
    "version": 170007,
    "subver": "/MagicBean:2.0.15rc2/",
    "inbound": false,
    "startingheight": 1433699,
    "banscore": 0,
    "synced_headers": -1,
    "synced_blocks": -1,
    "inflight": [
    ],
    "whitelisted": false
  },
  {
    "id": 2,
    "addr": "23.254.165.16:7770",
    "addrlocal": "2.135.130.180:37824",
    "services": "0000000070000005",
    "lastsend": 1562579233,
    "lastrecv": 1562579239,
    "bytessent": 274,
    "bytesrecv": 31903,
    "conntime": 1562579232,
    "timeoffset": -1,
    "pingtime": 0.261719,
    "version": 170007,
    "subver": "/MagicBean:2.0.15rc2/",
    "inbound": false,
    "startingheight": 1433699,
    "banscore": 0,
    "synced_headers": -1,
    "synced_blocks": -1,
    "inflight": [
    ],
    "whitelisted": false
  }
]
```


[08-Jul-19 02:47 AM] jl777c#5810
which fullnode are you connected to


[08-Jul-19 02:48 AM] TonyL#3577
which one from above is yours?


[08-Jul-19 02:48 AM] jl777c#5810
pretty sure shossain didnt update


[08-Jul-19 02:48 AM] jl777c#5810
"addr": "23.254.165.16:7770",

{Reactions}
üëç 

[08-Jul-19 02:48 AM] jl777c#5810
use that one


[08-Jul-19 02:48 AM] TonyL#3577
```./komodo-cli nspv_getinfo 777777
{
  "result": "success",
  "height": 1433700,
  "chaintip": "0b6f52d807e4f03b10d86078a96d076d97d2c6d216be3e0983da81e44cbaba54",
  "notarization": {
    "notarized_height": 1433680,
    "notarized_blockhash": "029f03de75e7719def97d603f3f217ffbbe60f9dc86b1105d9c89360353d34f0",
    "notarization_txid": "e1842d3df6c1689d13085790df0cfc44df2f6b3d9ba06a92043a764d004f89ba",
    "notarization_txidheight": 1433694,
    "notarization_desttxid": "fc94d918ffb4683dd44e4c47335bf979d5832a49b88db305854a08bcb91728c9"
  },
  "hdr": {
    "height": 777777,
    "blockhash": "06e06a5336dd8a7340270e94e09895f6b97f0255770f564ba27c107479625277",
    "hashPrevBlock": "074d5b4bf30573ac4e9841da020c6f85c98f1a9944b9b1edebe0847403a53450",
    "hashMerkleRoot": "a38f25e2506fbc1887cbf4706c43e9abb856f557f8f49c7a04386c618c4adb06",
    "nTime": 1522806527,
    "nBits": 487139178
  }
}
```


[08-Jul-19 02:49 AM] jl777c#5810
works


[08-Jul-19 02:49 AM] jl777c#5810
spend is also having retcodes array


[08-Jul-19 02:50 AM] TonyL#3577
this time not -22 üòÉ


[08-Jul-19 02:51 AM] TonyL#3577
```./komodo-cli nspv_broadcast 0400008085202f89019e884849a853724978747577faf387c202bffe07b760b3a1a69b33c2f19a0334010000004847304402206f42c7d7432937b43fdddd837461376ecdcf6dd18ae31f6aa70d68e3c5a189570220689d071667c408ec39bb1db45187283cf97b8146c9cc4b908fda2da3049686b801ffffffff0200e1f505000000001976a914a19f7aa254dced0a17920ab1c2acf698841f67f688ac0ef8a10201000000232103aa464529c190398d44017c3d7a71a854ad195a9d396bf84182679c242bb60085acdc0e235d000000000000000000000000000000
got broadcast response 1562579438 size.37 f5fe3d02d4b3aae8424153c80d62f44db81634911ae0ce355ea26824cb786c7d retcode.1
{
  "result": "success",
  "expected": "f5fe3d02d4b3aae8424153c80d62f44db81634911ae0ce355ea26824cb786c7d",
  "broadcast": "f5fe3d02d4b3aae8424153c80d62f44db81634911ae0ce355ea26824cb786c7d",
  "retcode": 1,
  "type": "broadcast and mempool"
}
```


[08-Jul-19 02:51 AM] jl777c#5810
0 means 100% of validations worked!

{Reactions}
üéâ 

[08-Jul-19 02:51 AM] jl777c#5810
merkle proof of tx validated to header, within range of notarized blockheaders


[08-Jul-19 02:52 AM] jl777c#5810
oh, still need to actually validate notary signatures, but that is pretty easy to do. all these merkle proofs and header ranges was tricky to get lined up right


[08-Jul-19 05:02 AM] jl777c#5810
pushed client side fix for many-utxo spends, it had issues with rate limiting. also it does random selecting of peers to spread the load across all fullnodes


[08-Jul-19 05:03 AM] jl777c#5810
nSPV mode is limited to 64 utxo spends


[08-Jul-19 05:03 AM] jl777c#5810
this means you might need to consolidate funds


[08-Jul-19 05:03 AM] jl777c#5810
also to verify that all funds are notarized, just spend all funds to yourself to see all 0 in retcodes. just dont broadcast it


[08-Jul-19 08:17 AM] TonyL#3577
it seems there is some problem with caching:
``` ./komodo-cli nspv_getinfo
{
  "result": "success",
  "address": "RQpXhinesqzpiHgvu8svVZa4iDvBZy6VfM",
  "pubkey": "03ca3fb3764515a8a9a34c9ddd58e22d33fe3599ce8de363dd966ab7282ef6b0cc",
  "wifexpires": 756,
  "height": 1434034,
  "chaintip": "0d623797ee2dcc9347dd41792f7f088982de4c541e574d0c52779b8493330bef",
  "notarization": {
    "notarized_height": 1434020,
    "notarized_blockhash": "05e748b68875153ab9853de477d0ef2fd86a1c7f70df484d742f2d709ab32f9a",
    "notarization_txid": "5595a56aaf00f5d5ab2269900999c86fe85d67847b92a1aa941f75b673fe3399",
    "notarization_txidheight": 1434034,
    "notarization_desttxid": "d5235e8c1b98a541536f3208cb20154b6a99285a229b201de582a6ca092619f7"
  },
  "hdr": {
    "height": 0,
    "blockhash": "f1d58bc0edfc1942cb6b7d10d9a6af66422190713e8a853d684f22e6b0c677de",
    "hashPrevBlock": "77d0ef2fd86a1c7f70df484d742f2d709ab32f9a0100000000000000a5000000",
    "hashMerkleRoot": "0999c86fe85d67847b92a1aa941f75b673fe339905e748b68875153ab9853de4",
    "nTime": 1399796232,
    "nBits": 462988609
  }
}
```


[08-Jul-19 08:17 AM] TonyL#3577
My last login is with `RQpXhinesqzpiHgvu8svVZa4iDvBZy6VfM` and it really dont have any UTXOs to spend


[08-Jul-19 08:19 AM] jl777c#5810
so it couldnt get any addressutxos


[08-Jul-19 08:19 AM] jl777c#5810
"address": "RQpXhinesqzpiHgvu8svVZa4iDvBZy6VfM",
  "srcaddr": "RQpXhinesqzpiHgvu8svVZa4iDvBZy6VfM",


[08-Jul-19 08:19 AM] jl777c#5810
they match


[08-Jul-19 08:19 AM] jl777c#5810
spend uses the login address to spend from


[08-Jul-19 08:20 AM] jl777c#5810
if no utxo it will return   "error": "couldnt get addressutxos"


[08-Jul-19 08:20 AM] jl777c#5810
checking


[08-Jul-19 08:21 AM] jl777c#5810
it got that from the last listunspent


[08-Jul-19 08:21 AM] jl777c#5810
since it mismatched, it did error


[08-Jul-19 08:21 AM] TonyL#3577
hmm\, so just visual thing


[08-Jul-19 08:22 AM] jl777c#5810
if you did listunspents to random addresses AND the listunspent during spend doesnt happen (as i am rebooting my server) it will detect this and give an error


[08-Jul-19 12:30 PM] Tylor zkFS#8280
Dude....this combined with mm2....holy fuk

{Reactions}
üíØ (3) 

[08-Jul-19 12:35 PM] jl777c#5810
@SHossain plz update any nSPV nodes, validation and performance improvements, along with bug fixes, it is getting close to beta level

{Reactions}
üëçüèΩ (2) üòé 

[08-Jul-19 12:35 PM] SHossain#0007
updating


[08-Jul-19 10:00 PM] jl777c#5810
@TonyL @SHossain @allbits i merged nSPV branch into jl777 (and FSM) branch. so change to jl777 branch


[08-Jul-19 10:01 PM] jl777c#5810
right now they are in sync, so no need to update if you already had the latest

{Reactions}
üëç (2) 

[08-Jul-19 10:34 PM] TonyL#3577
is there some way to propertly check via RPC was daemon started as nSPV client with `nSPV=1` param or not?


[08-Jul-19 11:00 PM] jl777c#5810
use nspv_getinfo call, new field added


[09-Jul-19 01:15 AM] TonyL#3577 (pinned)
Made simple python wallet on top of nSPV for testing: https://github.com/tonymorony/nspv_pywallet

At the moment possible to use on Ubuntu. Very few deps are needed and can be found in README.

Start procedure is simple - put wallet file to the same folder with nSPV komodod (or nSPV komodod to the same folder with wallet files) and execute: `python3 main.py KMD` or `python3 main.py ILN`

{Embed}
https://github.com/tonymorony/nspv_pywallet
tonymorony/nspv_pywallet
simple Python wallet based on Komodo nSPV technology - tonymorony/nspv_pywallet
https://images-ext-2.discordapp.net/external/IULxymVak7WPV8PZwfkPCOyLSBf6KKjfvRL8wa24Vjc/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/24797699

{Reactions}
shexy (2) 

[09-Jul-19 01:16 AM] TonyL#3577
Pinned a message.


[09-Jul-19 01:49 AM] TonyL#3577
cookie for the first who start wallet and send tx in it (with me this trick worked üòÉ )


[09-Jul-19 01:53 AM] hyperDEX#6586
@TonyL Firstly need to say im a noob.


[09-Jul-19 01:54 AM] hyperDEX#6586
sudo apt-get install python3.6 python3-pip libgnutls28-dev
[sudo] password for dev: 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package python3.6
E: Couldn't find any package by glob 'python3.6'
E: Couldn't find any package by regex 'python3.6'


[09-Jul-19 01:54 AM] hyperDEX#6586
Dependencies giving me an error


[09-Jul-19 01:55 AM] TonyL#3577
oh, you're on 16.04 I wonder, if you have another python3 version installed it should work without 3.6 (I hope)


[09-Jul-19 01:55 AM] hyperDEX#6586
Yeah looks i need sudo add-apt-repository ppa:deadsnakes/ppa


[09-Jul-19 01:55 AM] TonyL#3577
`sudo apt-get install python3 python3-pip libgnutls28-dev` will do a trick


[09-Jul-19 01:56 AM] TonyL#3577
(in case if you dont want to install 3.6), hope I've not used any language version specific things


[09-Jul-19 01:57 AM] hyperDEX#6586
Tried your command but gave me errors, doing sudo apt-get -f install first then i will try again


[09-Jul-19 01:57 AM] hyperDEX#6586
The following packages have unmet dependencies:
 libgnutls28-dev : Depends: libgnutls-dev (= 3.4.10-4ubuntu1.5) but it is not going to be installed
 linux-image-generic-hwe-16.04 : Depends: linux-image-4.15.0-51-generic but it is not going to be installed
 linux-modules-extra-4.15.0-51-generic : Depends: linux-image-4.15.0-51-generic but it is not going to be installed or
                                                  linux-image-unsigned-4.15.0-51-generic but it is not going to be installed
 python3-pip : Depends: python-pip-whl (= 8.1.1-2ubuntu0.4) but it is not going to be installed
               Recommends: python3-dev (>= 3.2) but it is not going to be installed
               Recommends: python3-setuptools but it is not going to be installed
               Recommends: python3-wheel but it is not going to be installed
E: Unmet dependencies. Try 'apt-get -f install' with no packages (or specify a solution).
apt-get -f install


[09-Jul-19 01:58 AM] TonyL#3577
aha, bad instructions I gave so - working on Ubuntu 18 only it seems. libgnutls is older in 16 repos too I wonder


[09-Jul-19 01:59 AM] TonyL#3577
try to install just `libgnutls-dev`


[09-Jul-19 01:59 AM] hyperDEX#6586
üòÑ more errors after apt-get -f install üòÑ


[09-Jul-19 01:59 AM] TonyL#3577
`sudo apt-get install python3 python3-pip libgnutls-dev`


[09-Jul-19 02:00 AM] hyperDEX#6586
sudo apt-get install python3 python3-pip libgnutls-dev
Reading package lists... Done
Building dependency tree       
Reading state information... Done
python3 is already the newest version (3.5.1-3).
You might want to run 'apt-get -f install' to correct these:
The following packages have unmet dependencies:
 libgnutls-dev : Depends: libgnutlsxx28 (= 3.4.10-4ubuntu1.5) but it is not going to be installed
                 Depends: nettle-dev but it is not going to be installed
                 Depends: libtasn1-6-dev but it is not going to be installed
                 Depends: libp11-kit-dev but it is not going to be installed
                 Depends: libidn11-dev (>= 1.31) but it is not going to be installed
 linux-image-generic-hwe-16.04 : Depends: linux-image-4.15.0-54-generic but it is not going to be installed
 linux-modules-extra-4.15.0-51-generic : Depends: linux-image-4.15.0-51-generic but it is not going to be installed or
                                                  linux-image-unsigned-4.15.0-51-generic but it is not going to be installed
 linux-modules-extra-4.15.0-54-generic : Depends: linux-image-4.15.0-54-generic but it is not going to be installed or
                                                  linux-image-unsigned-4.15.0-54-generic but it is not going to be installed
 python3-pip : Depends: python-pip-whl (= 8.1.1-2ubuntu0.4) but it is not going to be installed
               Recommends: python3-dev (>= 3.2) but it is not going to be installed
               Recommends: python3-setuptools but it is not going to be installed
               Recommends: python3-wheel but it is not going to be installed
E: Unmet dependencies. Try 'apt-get -f install' with no packages (or specify a solution).


[09-Jul-19 02:00 AM] TonyL#3577
oh, I'll build portable for Ubuntu now üòÉ


[09-Jul-19 02:00 AM] hyperDEX#6586
Let me get a fresh ubuntu 18


[09-Jul-19 02:01 AM] hyperDEX#6586
Might take me  little while getting a PC with that installed


[09-Jul-19 02:15 AM] TonyL#3577
@hyperDEX https://github.com/tonymorony/nspv_pywallet/releases/download/0.00001/nspv_py_ubuntu.tar.gz onefile executable built on ubuntu 16.04 - probably will start on your machine


[09-Jul-19 02:18 AM] hyperDEX#6586
should i try to get it working on 16.04?


[09-Jul-19 02:18 AM] hyperDEX#6586
I mean the instructions, downloading that file now


[09-Jul-19 02:18 AM] TonyL#3577
@hyperDEX yes, please try on 16.04 - it's definetly faster than setup fresh machine I think
@smkhound could you please give it a try? (readme in repo in pinned post)

{Reactions}
üëçüèº 

[09-Jul-19 02:19 AM] hyperDEX#6586
yep will give it a go now


[09-Jul-19 02:20 AM] TonyL#3577
just want to check if it usable in general - and if it is will start to make multiOS bundles  üòÉ


[09-Jul-19 02:20 AM] hyperDEX#6586
If you want i can give compiling it on 16.04 a go later


[09-Jul-19 02:20 AM] hyperDEX#6586
ah ok


[09-Jul-19 02:21 AM] TonyL#3577
it'll be bundled with compatible komodod so user will just need to `./wallet KMD` or `./wallet ILN` and wallet automatically starting daemon


[09-Jul-19 02:21 AM] hyperDEX#6586
Can you expand on 

    Put wallet files to same folder with komodod or put komodod to the same folder with wallet (komodod should support nSPV)


[09-Jul-19 02:21 AM] hyperDEX#6586
Ah ok üòÑ


[09-Jul-19 02:22 AM] hyperDEX#6586
i already have komodod on this machine, will it cause issues?


[09-Jul-19 02:22 AM] TonyL#3577
do you have some fresh one with nSPV support?


[09-Jul-19 02:22 AM] hyperDEX#6586
No i dont, which branch are you using?


[09-Jul-19 02:23 AM] TonyL#3577
you can build from current jl777 or FSM


[09-Jul-19 02:23 AM] TonyL#3577
it should be same at the moment


[09-Jul-19 02:23 AM] hyperDEX#6586
Ok let me upgrade.

{Reactions}
üî• 

[09-Jul-19 02:24 AM] hyperDEX#6586
ok so now i have main


[09-Jul-19 02:24 AM] hyperDEX#6586
Do i just move it to komodo/src and run it?


[09-Jul-19 02:24 AM] TonyL#3577
just put it to folder with your updated daemon (komodo/src yep) and run as `./main KMD` or `./main ILN` (depends of which chain in superlight nspv mode you want to use)


[09-Jul-19 02:24 AM] hyperDEX#6586
ok sure


[09-Jul-19 03:29 AM] smkhound#7640
`wif will expire in 777 seconds` üòÉ


[09-Jul-19 03:30 AM] TonyL#3577
on refresh button click expiration counter should refresh too üòÉ


[09-Jul-19 03:30 AM] TonyL#3577
as well as balance


[09-Jul-19 03:34 AM] hyperDEX#6586
@TonyL 

./main KMD
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668420
Komodo  server starting
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668422
Komodo  server starting
Error: Cannot obtain a lock on data directory /home/dev/.komodo. Komodo is probably already running.
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668424
Komodo  server starting
Error: Cannot obtain a lock on data directory /home/dev/.komodo. Komodo is probably already running.
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668426
Komodo  server starting
Error: Cannot obtain a lock on data directory /home/dev/.komodo. Komodo is probably already running.


[09-Jul-19 03:34 AM] smkhound#7640
yep, countdown


[09-Jul-19 03:35 AM] TonyL#3577
it will try 5 times and stop trying then


[09-Jul-19 03:35 AM] TonyL#3577
do you have KMD daemon already started?


[09-Jul-19 03:35 AM] hyperDEX#6586
ok but kmd is not running


[09-Jul-19 03:35 AM] hyperDEX#6586
actually maybe i can see the debug file doing something, will kill it and start again


[09-Jul-19 03:36 AM] TonyL#3577
it can say `KMD daemon is not started! Lets try to start` on wide amount of things now as I can see


[09-Jul-19 03:37 AM] smkhound#7640
sent to, received, sent out üëçüèº


[09-Jul-19 03:37 AM] TonyL#3577
for example if KMD daemon without nspv support at all started (when nspv_getinfo return error than call doesnt found)


[09-Jul-19 03:37 AM] smkhound#7640
https://kmd.explorer.dexstats.info/address/RB1cm5mLgixJcDRqVLAmmjFZFQRDU8gS7i

{Reactions}
üéâ 

[09-Jul-19 03:37 AM] TonyL#3577
will improve this logic checks

{Reactions}
üññüèº 

[09-Jul-19 03:37 AM] hyperDEX#6586
Looks like komodod is running. Once it completes the start process i will kill it and try again


[09-Jul-19 03:38 AM] jl777c#5810
updated client side to fully validate notarizations locally. a bit of signature checking magic. only takes a few seconds extra and this avoids the attack vector of being fed fake tx. now the only validation missing is for KMD rewards amounts

{Reactions}
üöÄ 

[09-Jul-19 03:38 AM] jl777c#5810
start process of nSPV=1 is about 3 seconds, max


[09-Jul-19 03:39 AM] TonyL#3577
yes, nSPV daemon usually starting/connecting almost instantly and wallet can start daemon only with nSPV=1 param
@smkhound was it easy enough to connect and send tx?


[09-Jul-19 03:39 AM] jl777c#5810
@TonyL i came up with a shortcut way to validate, though it will have problems with pre-dec 15th notarizations

{Reactions}
üî• 

[09-Jul-19 03:40 AM] hyperDEX#6586
OK 

./main KMD
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668800
Komodo  server starting
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668802
Komodo  server starting
Error: Cannot obtain a lock on data directory /home/dev/.komodo. Komodo is probably already running.
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668804
Komodo  server starting
Error: Cannot obtain a lock on data directory /home/dev/.komodo. Komodo is probably already running.
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668806
Komodo  server starting
Error: Cannot obtain a lock on data directory /home/dev/.komodo. Komodo is probably already running.
KMD daemon is not started! Lets try to start
call komodo_args.(./komodod) NOTARY_PUBKEY.()
initialized  at 1562668808
Komodo  server starting
Error: Cannot obtain a lock on data directory /home/dev/.komodo. Komodo is probably already running.
daemon for KMD not started and can't start it. Exiting.


[09-Jul-19 03:40 AM] hyperDEX#6586
I made sure komodod was dead, then i ran that. The first command started komodod


[09-Jul-19 03:41 AM] TonyL#3577
and it's in a folder with komodod from latest jl777 or FSM?


[09-Jul-19 03:41 AM] hyperDEX#6586
2019-07-09 10:40:02 HTTP: starting 4 worker threads
2019-07-09 10:40:02 Using wallet wallet.dat
2019-07-09 10:40:02 init message: Verifying wallet...
2019-07-09 10:40:02 CDBEnv::Open: LogDir=/home/dev/.komodo/database ErrorFile=/home/dev/.komodo/db.log pathIn.(/home/dev/.komodo)
2019-07-09 10:40:02 Block index database configuration:
2019-07-09 10:40:02 * Using 1000 max open files
2019-07-09 10:40:02 * Compression is enabled
2019-07-09 10:40:02 Cache configuration:
2019-07-09 10:40:02 * Max cache setting possible 16384MiB
2019-07-09 10:40:02 * Using 56.2MiB for block index database
2019-07-09 10:40:02 * Using 106.4MiB for chain state database
2019-07-09 10:40:02 * Using 287.3MiB for in-memory UTXO set
2019-07-09 10:40:02 Opening LevelDB in /home/dev/.komodo/blocks/index
2019-07-09 10:40:02 Opened LevelDB successfully
2019-07-09 10:40:02 init message: Loading block index...
2019-07-09 10:40:02 Opening LevelDB in /home/dev/.komodo/blocks/index
2019-07-09 10:40:02 Opened LevelDB successfully
2019-07-09 10:40:02 Opening LevelDB in /home/dev/.komodo/chainstate
2019-07-09 10:40:02 Opened LevelDB successfully
2019-07-09 10:40:02 Opening LevelDB in /home/dev/.komodo/notarisations
2019-07-09 10:40:02 Opened LevelDB successfully
2019-07-09 10:40:02 LoadBlockIndexDB: start loading guts


[09-Jul-19 03:41 AM] smkhound#7640
yep, created address, logged in. only "issues" was no right click to copy/paste, and balance when sending didnt take fee into account. Also, balance didnt change after sent (until confirmed I assume), so wansnt sure I sent and tried 2x


[09-Jul-19 03:41 AM] hyperDEX#6586
Oh darn, i need to rebuild.


[09-Jul-19 03:41 AM] smkhound#7640
```RB1cm5mLgixJcDRqVLAmmjFZFQRDU8gS7i numutxos.1 balance 1.00000000
got txproof response 1562668405 size.1902 6e8789359fb8253bc1850692047dd5b767b182d10543321c026ee6d063783684 ht.1435186
sign 1 inputs 1.00000000 + interest 0.00000000 -> 1 outputs 0.99990000 change 0.00000000
got broadcast response 1562668440 size.37 fcea338207e7d285bbdee736c8014aa58ee71712e15d37662eca4ad98be210d5 retcode.1
got utxos response 1562668448 size.145
RB1cm5mLgixJcDRqVLAmmjFZFQRDU8gS7i numutxos.1 balance 1.00000000
got txproof response 1562668448 size.1902 6e8789359fb8253bc1850692047dd5b767b182d10543321c026ee6d063783684 ht.1435186
sign 1 inputs 1.00000000 + interest 0.00000000 -> 1 outputs 0.99990000 change 0.00000000
got broadcast response 1562668453 size.37 547de7e5ee5bd2a7db2a8f561d2b7394f74b81252e86e8757402e3e378f9c9cb retcode.0
```


[09-Jul-19 03:44 AM] smkhound#7640
too early to test rewards?


[09-Jul-19 03:44 AM] jl777c#5810
rewards work

{Reactions}
treasure 

[09-Jul-19 03:44 AM] jl777c#5810
max utxos allowed is 64


[09-Jul-19 03:44 AM] jl777c#5810
nLockTime should be set


[09-Jul-19 03:44 AM] TonyL#3577
`was no right click to copy/paste,` - aha, there is no implementation of it in this simple framework, need to write some code for it. But Ctrl+C Ctrl+V should work
`balance when sending didnt take fee into account` - Aha, I see what you mean, I'll add fees on confirmation popup and actual sum which I'll broadcast will be input + fee
`balance didnt change after sent` - and will update balance right after sending too


[09-Jul-19 03:45 AM] TonyL#3577
thank you for feedback!


[09-Jul-19 03:45 AM] jl777c#5810
it is just that you are currently trusting the fullnode for the interest calc. that is last validation i need to add


[09-Jul-19 03:45 AM] smkhound#7640
I'll send some and let it sit until acrued.


[09-Jul-19 03:45 AM] smkhound#7640
ctl-c, ctl-v worked ‚úÖ


[09-Jul-19 03:47 AM] smkhound#7640
if no rightclick, maybe a `copy` button?


[09-Jul-19 03:47 AM] smkhound#7640
it it tkinter?


[09-Jul-19 03:47 AM] TonyL#3577
yeah tkinter


[09-Jul-19 03:48 AM] TonyL#3577
easiest what I found to make wallet in one night without OOP at all üòÉ


[09-Jul-19 03:48 AM] smkhound#7640
havent used that for a couple years lol, but it is handy


[09-Jul-19 03:50 AM] smkhound#7640
maybe also autorefresh every 30sec ü§∑üèº


[09-Jul-19 03:52 AM] TonyL#3577
yes, it's worth to add. just need to solve microfreezes on RPC calls


[09-Jul-19 03:53 AM] TonyL#3577
to refresh balance you need to call listunspent and response taking ~1sec


[09-Jul-19 03:53 AM] hyperDEX#6586
@TonyL got it working, what should i do on it?


[09-Jul-19 03:53 AM] TonyL#3577
and now app became unresponsible until get response - but it's solvable for sure


[09-Jul-19 03:53 AM] jl777c#5810
dont spend time on removing 1 sec delays!


[09-Jul-19 03:53 AM] TonyL#3577
@hyperDEX you can try to generate new addy, broadcast some tx


[09-Jul-19 03:53 AM] jl777c#5810
this is just a testers gui and it is taking 1 second or 3, let the testers feel this delay


[09-Jul-19 03:54 AM] hyperDEX#6586
Ok will fund it and do some stupid things to try to break it


[09-Jul-19 03:54 AM] jl777c#5810
the real GUI will multithread things, and remove such delays


[09-Jul-19 03:54 AM] TonyL#3577
point is to feel how easy to use nSPV I believe rather than break my shitty GUI üòÉ


[09-Jul-19 03:55 AM] jl777c#5810
rpc calls take seconds if it calls the p2p network, to mask this you need to put it in a totally different thread


[09-Jul-19 03:55 AM] jl777c#5810
pushed a version that should properly validate presapling notarizations. the way to verify this is to spend a utxo that is older than last dec 15th


[09-Jul-19 03:55 AM] jl777c#5810
spends will now take about 3 seconds per utxo


[09-Jul-19 03:55 AM] TonyL#3577
yes, by adding threading freezes solvable. and good that 1sec limitation is for same messages, not in general


[09-Jul-19 03:56 AM] jl777c#5810
so this should be queued and processed in the background


[09-Jul-19 03:56 AM] jl777c#5810
yes, once we get more fullnodes, the 1 sec delay will go away


[09-Jul-19 03:56 AM] jl777c#5810
it is 1 sec delay per peer per message


[09-Jul-19 03:56 AM] jl777c#5810
and GUI delays, responsiveness, etc. it takes a lot of work to make it smooth, but that has nothing to do with finding rpc level bugs


[09-Jul-19 03:58 AM] hyperDEX#6586
What happens when the wif expires?


[09-Jul-19 03:58 AM] hyperDEX#6586
Are funds within that address gone?


[09-Jul-19 03:59 AM] jl777c#5810
?


[09-Jul-19 04:00 AM] jl777c#5810
how would that even be possible. the coins are in the blockchain


[09-Jul-19 04:00 AM] jl777c#5810
when the wif expires, it is deleted from memory, autologout


[09-Jul-19 04:00 AM] hyperDEX#6586
Oh üòÑ


[09-Jul-19 04:00 AM] hyperDEX#6586
So i just need to log back in


[09-Jul-19 04:01 AM] hyperDEX#6586
Sorry dealing with a dummy here


[09-Jul-19 04:01 AM] jl777c#5810
currently superlite client uses no permanent storage. it is stateless and starts from scratch each time


[09-Jul-19 04:02 AM] TonyL#3577
https://github.com/tonymorony/nspv_pywallet/releases/download/0.00001/nspv_pywallet_bundle_ubuntu.tar.gz Ubuntu bundle with compatible komodod


[09-Jul-19 04:03 AM] TonyL#3577
now will try to make Win and OSX


[09-Jul-19 04:04 AM] hyperDEX#6586
https://kmd.explorer.dexstats.info/address/RAmiPg9GpfpXBR7xvG9dKMncFApPXtNHai

This deposit has 4 confirms, in my GUi it still shows 0, how many confirms should it take to show up?


[09-Jul-19 04:04 AM] jl777c#5810
1 confirm should make it appear


[09-Jul-19 04:04 AM] TonyL#3577
try to press `refresh` button


[09-Jul-19 04:04 AM] hyperDEX#6586
i did


[09-Jul-19 04:05 AM] hyperDEX#6586
still nothing, i clicked login using the wif as well, no change to the balance


[09-Jul-19 04:05 AM] hyperDEX#6586
though the expire timer changes


[09-Jul-19 04:05 AM] TonyL#3577
try to check in cli `./komodo-cli nspv_listunspent`


[09-Jul-19 04:06 AM] TonyL#3577
actually refresh button calling it and fetching balance from this call output


[09-Jul-19 04:06 AM] hyperDEX#6586
./komdoo-cli nspv_listunspent
bash: ./komdoo-cli: No such file or directory


[09-Jul-19 04:06 AM] hyperDEX#6586
That is weird


[09-Jul-19 04:07 AM] TonyL#3577
there was a typo in initial command I wrote


[09-Jul-19 04:07 AM] TonyL#3577
`./komodo-cli`


[09-Jul-19 04:07 AM] hyperDEX#6586
hahah


[09-Jul-19 04:07 AM] hyperDEX#6586
./komodo-cli nspv_listunspent
{
  "result": "error",
  "error": "no utxos result"


[09-Jul-19 04:08 AM] hyperDEX#6586
So it isnt the GUI not displaying that


[09-Jul-19 04:08 AM] jl777c#5810
let me update my fullnode


[09-Jul-19 04:19 AM] smkhound#7640
just noticed coutdown refresh doesnt seem to work if timed out


[09-Jul-19 04:20 AM] smkhound#7640
so says 300 sec to go, but click refresh it still says 300 sec to go


[09-Jul-19 04:22 AM] hyperDEX#6586
Mine keeps going to 0, after i refresh it still doesnt mention that i have logged out.


[09-Jul-19 04:22 AM] hyperDEX#6586
Is that meant to be the case?


[09-Jul-19 04:24 AM] smkhound#7640
```Exception in Tkinter callback
Traceback (most recent call last):
  File "tkinter/__init__.py", line 1553, in __call__
  File "main.py", line 120, in refresh
KeyError: 'wifexpires'
```


[09-Jul-19 04:24 AM] TonyL#3577
Aha, it's GUI problem - checking wifexpires value on refresh but not checking if it presists in general or not. It's a visual issue - will fix


[09-Jul-19 04:24 AM] TonyL#3577
on timeout key just "dissapears" from nspv_getinfo call output so should handle it


[09-Jul-19 04:26 AM] TonyL#3577
Now trying to gentle ask windows to not take console stream on komodo start üòÉ


[09-Jul-19 04:26 AM] TonyL#3577
on windows even with -daemon param it starting not in background


[09-Jul-19 04:27 AM] jl777c#5810
reproduced missing balance issue, i think it is an issue with my node. still rebuilding, will check when it is updated

{Reactions}
üëçüèª 

[09-Jul-19 04:30 AM] TonyL#3577
pushed fix for expired timer on refresh, in 777 seconds will be able to test üòÉ


[09-Jul-19 04:43 AM] TonyL#3577
```.\komodod -nSPV=1 -addnode=23.254.165.16 -daemon
call komodo_args.(.\komodod) NOTARY_PUBKEY.()
nMaxConnections 384```

```.\komodo-cli getinfo
error code: -28
error message:
Loading block index...```


[09-Jul-19 04:43 AM] TonyL#3577
on windows daemon starting in usual mode with nSPV flag


[09-Jul-19 04:45 AM] jl777c#5810
rebooting node


[09-Jul-19 04:46 AM] jl777c#5810
did you have a previous ~/.komodo dir?


[09-Jul-19 04:46 AM] TonyL#3577
yes


[09-Jul-19 04:46 AM] jl777c#5810
so maybe it loads the index, i thought i fixed that


[09-Jul-19 04:46 AM] jl777c#5810
does it finish?


[09-Jul-19 04:47 AM] TonyL#3577
I've killed it because it's quite long on windows (and VM is tiny)


[09-Jul-19 04:47 AM] TonyL#3577
Can try to wait


[09-Jul-19 04:47 AM] jl777c#5810
mv the ~/.komodo dire


[09-Jul-19 04:47 AM] jl777c#5810
make sure it starts up fast


[09-Jul-19 04:47 AM] jl777c#5810
we can deal with skipping load after we make sure the basics work on windows


[09-Jul-19 04:48 AM] TonyL#3577
`i thought i fixed that` is fix in jl777 branch?


[09-Jul-19 04:48 AM] jl777c#5810
test with ILN


[09-Jul-19 04:48 AM] jl777c#5810
i fixed the scanning of blockindex last week

{Reactions}
üëå 

[09-Jul-19 04:52 AM] hyperDEX#6586
i have logout -808 cool üòÉ


[09-Jul-19 04:53 AM] hyperDEX#6586
no pnodes
no pnodes
no pnodes
on debug now


[09-Jul-19 04:53 AM] TonyL#3577
in latest commit indications on refresh when auto-logout is fixed


[09-Jul-19 04:53 AM] TonyL#3577
I wonder James updating nodes now, for ILN I got `no pnodes` too


[09-Jul-19 04:54 AM] jl777c#5810
yes


[09-Jul-19 04:54 AM] hyperDEX#6586
rebuilding latest, ah ok


[09-Jul-19 04:54 AM] TonyL#3577
`rebuilding latest, ah ok` oh, I mean latest commit into wallet repo üòÉ


[09-Jul-19 04:54 AM] TonyL#3577
so in next bundle it'll be fixed


[09-Jul-19 04:55 AM] hyperDEX#6586
üòÑ ah there were changes to the jl777 branch, i forgot your changes wont be included hehe


[09-Jul-19 04:56 AM] hyperDEX#6586
Will need a link to new build whenever you release the next one. Will also try to find a way to build it on 16.04


[09-Jul-19 04:56 AM] TonyL#3577
I'm bundling wallet on 16.04, but I had all deps preinstalled long time ago


[09-Jul-19 04:58 AM] jl777c#5810
KMD fullnode is running and it sees the balance for hyperDEX

{Reactions}
üéâ 

[09-Jul-19 05:01 AM] TonyL#3577
removed datadir on windows but it started to sync in usual mode


[09-Jul-19 05:01 AM] jl777c#5810
i guess it doesnt work in windows yet...


[09-Jul-19 05:01 AM] jl777c#5810
what about osx


[09-Jul-19 05:02 AM] TonyL#3577
will try osx now


[09-Jul-19 05:06 AM] hyperDEX#6586
Nice


[09-Jul-19 05:07 AM] hyperDEX#6586
Looks good can see the balance


[09-Jul-19 05:08 AM] jl777c#5810
can you spend?


[09-Jul-19 05:09 AM] SHossain#0007
updating my full node with jl777 branch


[09-Jul-19 05:11 AM] hyperDEX#6586
RAmiPg9GpfpXBR7xvG9dKMncFApPXtNHai numutxos.1 balance 29.98000000
got txproof response 1562674234 size.1957 1b73229b5d33b22ca43527a0ba29564d05516081b339384932cc792d2005819d ht.1435211
got ntzs response 1562674234 size.209 4abf2e53feadead4fb4d3beb332b9bb2beb50e34113b31541e87eedddc3c9dd8 prev.1435190, 307776594e9333f7d4706b2ea0f199793733b0a12b46c6eef07bc21c991e8a7e next.1435220
gettx ht.1435211 prev.1435190 next.1435220
couldnt find txid.1b73229b5d33b22ca43527a0ba29564d05516081b339384932cc792d2005819d/v1 or it was spent
sign 1 inputs 29.98000000 + interest 0.00003705 -> 2 outputs 29.00000000 change 0.97993705
got ntzproof response 1562674240 size.49366 prev.1435190 next.1435220
got broadcast response 1562674241 size.37 ffa65c6500bed3685b56eb3b691cbf8e9e2b209354455bce3e578f9983429214 retcode.0


[09-Jul-19 05:11 AM] hyperDEX#6586
Looks good, even reward taken into account


[09-Jul-19 05:11 AM] hyperDEX#6586
@TonyL It might be good to have a "tx sent" prompt or something


[09-Jul-19 05:12 AM] hyperDEX#6586
I got a prompt to confirm then nothing


[09-Jul-19 05:13 AM] TonyL#3577
if tx sent after you press confirm in popup you'll see info about tx in wallet window


[09-Jul-19 05:13 AM] TonyL#3577
same window where you getting json print when login


[09-Jul-19 05:13 AM] hyperDEX#6586
{'result': 'success', 'expected': 'ffa65c6500bed3685b56eb3b691cbf8e9e2b209354455bce3e578f9983429214', 'type': 'broadcast', 'broadcast': 'ffa65c6500bed3685b56eb3b691cbf8e9e2b209354455bce3e578f9983429214', 'retcode': 0}


[09-Jul-19 05:14 AM] jl777c#5810
seems it didnt make it to the network


[09-Jul-19 05:14 AM] jl777c#5810
need to broadcast it again


[09-Jul-19 05:15 AM] hyperDEX#6586
sent again


[09-Jul-19 05:15 AM] hyperDEX#6586
{'result': 'success', 'expected': '5cf188db81c7516494ab34dcbaff8d9be05ce15f1fb11c9a45e81bf9747368ec', 'type': 'timeout', 'broadcast': '0000000000000000000000000000000000000000000000000000000000000000', 'retcode': -2}


[09-Jul-19 05:17 AM] jl777c#5810
@TonyL can you stop the spam attack for now


[09-Jul-19 05:17 AM] TonyL#3577
I'm not running it for a last two days


[09-Jul-19 05:18 AM] jl777c#5810
oh, i still see 300+ peers


[09-Jul-19 05:18 AM] jl777c#5810
i will remove my peers.dat


[09-Jul-19 05:18 AM] TonyL#3577
hmm let me check, maybe I forgot to shutdown one server


[09-Jul-19 05:20 AM] TonyL#3577
yes, were peers on one server


[09-Jul-19 05:20 AM] jl777c#5810
i am seeing transactions, but there seems to be a problem getting it mined


[09-Jul-19 05:23 AM] jl777c#5810
@TonyL ILN fullnode had some very strange behavior, but now it is acting normally. i think under saturation some messages got messed up

{Reactions}
üëª 

[09-Jul-19 05:34 AM] TonyL#3577
just tried on OSX - stopped with such error

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/598129818361659393/unknown.png


[09-Jul-19 05:34 AM] TonyL#3577
sorry for screenshot - don't have shared clipboard with this VMs type


[09-Jul-19 05:38 AM] TonyL#3577
```Assertion failed: (px != 0), function operator*, file /Users/tonysierra/jl777_beta/komodo/depends/x86_64-apple-darwin17.7.0/share/../include/boost/smart_ptr/shared_ptr.hpp, line 728.

[1]+  Abort trap: 6           ./komodod -nSPV=1 -addnode=23.254.165.16```


[09-Jul-19 05:38 AM] TonyL#3577
it was HighSierra, let me try on Mojave also


[09-Jul-19 05:39 AM] TonyL#3577
same same


[09-Jul-19 05:41 AM] SHossain#0007
yes, on client node, when i use `./komodo-cli stop` the daemon stops with core dump


[09-Jul-19 05:41 AM] hyperDEX#6586
@jl777c just tried to send it again

{'result': 'success', 'expected': '4c5db7161d29e56b2e51571514f1f9f182a004addfa07b22354b051e120353fd', 'type': 'timeout', 'broadcast': '0000000000000000000000000000000000000000000000000000000000000000', 'retcode': -2}


[09-Jul-19 05:42 AM] TonyL#3577
`yes, on client node, when i use ./komodo-cli stop the daemon stops with core dump` it's daemon start in nSPV mode on OSX


[09-Jul-19 05:42 AM] hyperDEX#6586
I will be going offline, will be back in a few hours


[09-Jul-19 05:43 AM] jl777c#5810
there is no need to stop the superlite client, it doesnt use HDD


[09-Jul-19 05:43 AM] jl777c#5810
i will put a guard in the stop command


[09-Jul-19 05:43 AM] jl777c#5810
i think many commands will just crash


[09-Jul-19 05:57 AM] jl777c#5810
cant duplicate the crash after "stop"


[09-Jul-19 05:59 AM] TonyL#3577
try to press `Ctrl + C` in same window after `./komodo-cli -ac_name=ILN stop` execution


[09-Jul-19 06:00 AM] TonyL#3577
it should print ```[1]+  Segmentation fault      (core dumped) ./komodod -ac_name=ILN -ac_supply=10000000000 -ac_cc=2 -addressindex=1 -spentindex=1 -nSPV=1 -connect=5.9.102.210
```


[09-Jul-19 06:00 AM] jl777c#5810
no crash. need backtrace


[09-Jul-19 06:02 AM] TonyL#3577
```Thread 1 "ILN-shutoff" received signal SIGSEGV, Segmentation fault.
CDBWrapper::WriteBatch (this=this@entry=0x0, batch=..., fSync=fSync@entry=true) at dbwrapper.cpp:73
73        leveldb::Status status = pdb->Write(fSync ? syncoptions : writeoptions, &batch.batch);
(gdb) backtrace
#0  CDBWrapper::WriteBatch (this=this@entry=0x0, batch=..., fSync=fSync@entry=true) at dbwrapper.cpp:73
#1  0x000055555582bfb9 in CBlockTreeDB::WriteBatchSync (this=0x0, fileInfo=std::vector of length 1, capacity 1 = {...}, nLastFile=<optimized out>, 
    blockinfo=std::vector of length 1, capacity 1 = {...}) at txdb.cpp:295
#2  0x00005555556b0654 in FlushStateToDisk (state=..., mode=mode@entry=FLUSH_STATE_ALWAYS) at main.cpp:3941
#3  0x00005555556b0c44 in FlushStateToDisk () at main.cpp:3977
#4  0x0000555555626299 in Shutdown () at init.cpp:255
#5  0x00005555555dfc12 in AppInit (argc=<optimized out>, argv=<optimized out>) at bitcoind.cpp:263
#6  0x00005555555e03e9 in main (argc=8, argv=0x7fffffffe178) at bitcoind.cpp:275
```


[09-Jul-19 06:03 AM] jl777c#5810
ok, adding a guard against that


[09-Jul-19 06:11 AM] jl777c#5810
@TonyL pushed a bug to fix tx signing! that is why hyperDEX tx didnt propagate, it was signed incorrectly


[09-Jul-19 06:13 AM] TonyL#3577
Oh so txs sending not worked at all?  `pushed a bug` sounds scary üòÉ

{Reactions}
üòÇ (2) 

[09-Jul-19 06:14 AM] jl777c#5810
yes, i pushed a bug before


[09-Jul-19 06:14 AM] jl777c#5810
now the bug fix is pushed


[09-Jul-19 06:15 AM] jl777c#5810
it defaulted signing to legacy mode, instead of sapling


[09-Jul-19 06:15 AM] jl777c#5810
now all seems stable, other then when the ILN fullnode was being attacked


[09-Jul-19 06:16 AM] jl777c#5810
probably good to start the attack again, i think there are some memory/socket issues under high load


[09-Jul-19 06:16 AM] TonyL#3577
sure, let me update and start attack


[09-Jul-19 06:16 AM] jl777c#5810
i guess osx and windows are DOA though...


[09-Jul-19 06:17 AM] jl777c#5810
any chance of backtrace on osx?


[09-Jul-19 06:19 AM] TonyL#3577
will collect it


[09-Jul-19 06:21 AM] smkhound#7640

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/598141710954135563/unknown.png


[09-Jul-19 06:21 AM] smkhound#7640
rewarding :treasure:


[09-Jul-19 06:23 AM] jl777c#5810
did it display notarization validation?


[09-Jul-19 06:25 AM] TonyL#3577
On confirmation popup displaying "Input notarized" or "Input not notarized"


[09-Jul-19 06:25 AM] jl777c#5810
i assume there is a console where we can see all the prints?


[09-Jul-19 06:26 AM] jl777c#5810
we still need to verify a legacy (pre dec15) notarization can be validated properly


[09-Jul-19 06:26 AM] jl777c#5810
and also that the latest fast notarization validation is working


[09-Jul-19 06:27 AM] TonyL#3577
`i assume there is a console where we can see all the prints?` yes, console should display all daemon printouts


[09-Jul-19 06:34 AM] TonyL#3577
started part of spammers, brb to pc in a few hours


[09-Jul-19 06:42 AM] smkhound#7640
I saw popup, didnt screenshot tho


[09-Jul-19 06:43 AM] smkhound#7640
I think it was notarised. Funds were there for a while waiting for rewards to acrue


[09-Jul-19 06:51 AM] allbits#5898
noob question - how do i change to jl777 branch


[09-Jul-19 06:52 AM] jl777c#5810
git checkout jl777


[09-Jul-19 06:53 AM] allbits#5898
K thanks


[09-Jul-19 06:54 AM] jl777c#5810
git pull


[09-Jul-19 06:54 AM] jl777c#5810
make


[09-Jul-19 10:08 AM] Tylor zkFS#8280
nDEX  - mastered - get it...why is it open source?


[09-Jul-19 10:08 AM] jl777c#5810
komodo is an open source project


[09-Jul-19 10:11 AM] Tylor zkFS#8280
Why give it for free?


[09-Jul-19 10:11 AM] Tylor zkFS#8280
I love you but....this is mastery


[09-Jul-19 10:11 AM] Tylor zkFS#8280
You are making sick progress


[09-Jul-19 10:11 AM] Tylor zkFS#8280
Open source make ZK sence


[09-Jul-19 10:14 AM] Tylor zkFS#8280
Above and beyond anything fathomable


[09-Jul-19 10:14 AM] grewalsatinder#9653
You have to understand the meaning of "Free Open Source Software" FOSS


[09-Jul-19 10:15 AM] jl777c#5810
i am leveraging the bitcoin daemon, anyway i wont be discussing the open sourceness of things


[09-Jul-19 10:15 AM] jl777c#5810
i am not working for some for profit company


[09-Jul-19 10:15 AM] jl777c#5810
i have no problems if for profit companies use the code i write


[09-Jul-19 10:15 AM] Tylor zkFS#8280
I have to study FOSS


[09-Jul-19 10:16 AM] jl777c#5810
they just need to open source their changes, if any


[09-Jul-19 10:16 AM] Tylor zkFS#8280
You are creating incredible developments for free with no patents


[09-Jul-19 10:17 AM] jl777c#5810
exactly


[09-Jul-19 10:17 AM] Tylor zkFS#8280
It perplexes me


[09-Jul-19 10:17 AM] jl777c#5810
probably 50+ patents could have been made from my code in the last 5 years


[09-Jul-19 10:18 AM] jl777c#5810
a patent is one weekends work for me


[09-Jul-19 10:18 AM] Tylor zkFS#8280
I own 3


[09-Jul-19 10:18 AM] jl777c#5810
eventually some big company buys it and then uses it against others


[09-Jul-19 10:18 AM] jl777c#5810
by innovating ahead of the patents and disclosing it, it becomes unpatentable

{Reactions}
labs üññ 

[09-Jul-19 10:18 AM] Tylor zkFS#8280
Buys from where?


[09-Jul-19 10:19 AM] jl777c#5810
the world will be better off without software patents

{Reactions}
üíØ (3) ‚úÖ (2) 

[09-Jul-19 10:19 AM] Tylor zkFS#8280
L


[09-Jul-19 10:20 AM] jl777c#5810
it is hard enough to solve problems, without worrying about whether you have the proper licensing for whatever algorithm


[09-Jul-19 10:20 AM] jl777c#5810
i just write most of it all from scratch so rarely have to worry about existing patents


[09-Jul-19 10:20 AM] jl777c#5810
the idea is to create a mass market used crypto, not playing patent games


[09-Jul-19 10:21 AM] Tylor zkFS#8280
Because patents only pay lawyers


[09-Jul-19 10:22 AM] jl777c#5810
they do leave some crumbs for others, but not much


[09-Jul-19 10:22 AM] jl777c#5810
big companies can just violate whatever patents they want to violate and run over small companies


[09-Jul-19 10:22 AM] jl777c#5810
prosecuting a patent lawsuit costs millions


[09-Jul-19 10:22 AM] Tylor zkFS#8280
I can come to agree...


[09-Jul-19 10:22 AM] jl777c#5810
even if you win, you lose


[09-Jul-19 10:23 AM] jl777c#5810
and if you lose, you are totally broke


[09-Jul-19 10:23 AM] jl777c#5810
thanks, but no thanks. i can make new patents at anytime, they dont have any special value to me


[09-Jul-19 10:23 AM] Tylor zkFS#8280
I agree


[09-Jul-19 10:24 AM] Tylor zkFS#8280
No patent games


[09-Jul-19 10:24 AM] jl777c#5810
i make komodo scale to millions, secured by bitcoin. that will be worth 100x more than whatever patents


[09-Jul-19 10:25 AM] Tylor zkFS#8280
That's why you are James and I am Tylor


[09-Jul-19 10:25 AM] Tylor zkFS#8280
I love your work


[09-Jul-19 10:33 AM] Tylor zkFS#8280
This nSPV ..bruh..next level...


[09-Jul-19 10:34 AM] Tylor zkFS#8280
Sick


[09-Jul-19 10:49 AM] TonyL#3577
getting no info from `5.9.102.210` ILN node atm @jl777c (tried to point spammers on it)


[09-Jul-19 10:50 AM] TonyL#3577
oh and now it's back


[09-Jul-19 10:52 AM] TonyL#3577
I'm starting a little spammers and then starting to get no info in calls responses and `no pnodes` message, then after I stop it's fine on some point, nodes have `connection: 1` all the time


[09-Jul-19 07:23 PM] hyperDEX#6586
{'type': 'timeout', 'result': 'success', 'retcode': -2, 'expected': '2cb8a97d240d02e6700c8013f5055df6bac349bbbb6597d586148b186c6a4507', 'broadcast': '0000000000000000000000000000000000000000000000000000000000000000'}

Still getting this


[09-Jul-19 07:24 PM] hyperDEX#6586
I put sending amount as 28.999999999999999 but when confirming it just shows 29 (should it round up?)

Looks like it has gone through now 

{'type': 'broadcast', 'result': 'success', 'retcode': 0, 'expected': 'c0ae4d7405b58625dc79f458a029994b123b0c7fd09c5b6368e63c118fa13e5a', 'broadcast': 'c0ae4d7405b58625dc79f458a029994b123b0c7fd09c5b6368e63c118fa13e5a'}


[09-Jul-19 07:28 PM] hyperDEX#6586
Actually still nothing on the blockchain so maybe did not go through


[09-Jul-19 07:35 PM] allbits#5898
Did you do nspv-broadcast?


[09-Jul-19 11:50 PM] jl777c#5810
did you update to latest? there was a bug in the earlier version about signing improperly


[09-Jul-19 11:51 PM] jl777c#5810
5.9.102.210 does seem to go unpresponsive when being spam attacked. what are each of the clients doing?


[09-Jul-19 11:52 PM] TonyL#3577
nspv_getinfo, nspv_listunspent, nspv_notarizations, nspv_spentinfo, nspv_txproof, nspv_hdrsproof


[09-Jul-19 11:53 PM] jl777c#5810
in an infinite loop... ok, i will try to speed up fullnode processing


[09-Jul-19 11:53 PM] TonyL#3577
yep, since listunspent response was more than second I've not set any sleeps


[09-Jul-19 11:59 PM] jl777c#5810
might have to make listunspent delay more than a second


[09-Jul-19 11:59 PM] jl777c#5810
i will think on how to deal with this


[09-Jul-19 11:59 PM] jl777c#5810
ok, i have the answer


[09-Jul-19 11:59 PM] jl777c#5810
wont be a quick fix but will come in with the superlite 2.0 infrastructure

{Reactions}
üôè 

[10-Jul-19 12:06 AM] hyperDEX#6586
updating


[10-Jul-19 01:16 AM] TonyL#3577
```initialized  at 1562746548
nMaxConnections 384
Assertion failed: (px != 0), function operator*, file /Users/antonlysakov/nspv_test/komodo/depends/x86_64-apple-darwin18.6.0/share/../include/boost/smart_ptr/shared_ptr.hpp, line 728.
[New Thread 0x190f of process 86026]
[New Thread 0x1b03 of process 86026]
[New Thread 0x1c03 of process 86026]
[New Thread 0x1d03 of process 86026]
[New Thread 0x1e03 of process 86026]
[New Thread 0x2203 of process 86026]
[New Thread 0x2303 of process 86026]
[New Thread 0x2403 of process 86026]
[New Thread 0x2503 of process 86026]

Thread 2 received signal SIGABRT, Aborted.
0x00007fff65c8d2c6 in ?? () from /usr/lib/system/libsystem_kernel.dylib
(gdb) backtrace
#0  0x00007fff65c8d2c6 in ?? () from /usr/lib/system/libsystem_kernel.dylib
#1  0x00007fff65d48bf1 in pthread_kill () from /usr/lib/system/libsystem_pthread.dylib
#2  0x00007fff65bf76a6 in abort () from /usr/lib/system/libsystem_c.dylib
#3  0x00007ffeefbfe0f0 in ?? ()
#4  0x00007fffffffffdf in ?? ()
#5  0xffffffff01c00000 in ?? ()
#6  0x0000000100c07dd0 in boost::shared_ptr<boost::signals2::mutex>::operator*() const::__func__ ()
#7  0x00007ffeefbfe130 in ?? ()
#8  0x00007fff65bc020d in __assert_rtn () from /usr/lib/system/libsystem_c.dylib
Backtrace stopped: frame did not save the PC
```


[10-Jul-19 01:16 AM] TonyL#3577
OSX backtrace, not sure if it helpful


[10-Jul-19 01:17 AM] jl777c#5810
deep inside boost...


[10-Jul-19 01:42 AM] hyperDEX#6586
I tried to send it again with the latest 

{'type': 'timeout', 'expected': '2032af858073b078618836a7cbb87af1dfc2971894e2672d5232613f590395b6', 'retcode': -2, 'result': 'success', 'broadcast': '0000000000000000000000000000000000000000000000000000000000000000'}


[10-Jul-19 01:43 AM] hyperDEX#6586
got utxos response 1562748089 size.145
RAmiPg9GpfpXBR7xvG9dKMncFApPXtNHai numutxos.1 balance 29.98000000
got txproof response 1562748101 size.1957 1b73229b5d33b22ca43527a0ba29564d05516081b339384932cc792d2005819d ht.1435211
issue manual bracket
got ntzs response 1562748103 size.209 4abf2e53feadead4fb4d3beb332b9bb2beb50e34113b31541e87eedddc3c9dd8 prev.1435190, 307776594e9333f7d4706b2ea0f199793733b0a12b46c6eef07bc21c991e8a7e next.1435220
got ntzs response 1562748103 size.209 4abf2e53feadead4fb4d3beb332b9bb2beb50e34113b31541e87eedddc3c9dd8 prev.1435190, 307776594e9333f7d4706b2ea0f199793733b0a12b46c6eef07bc21c991e8a7e next.1435220
got ntzs response 1562748105 size.209 4abf2e53feadead4fb4d3beb332b9bb2beb50e34113b31541e87eedddc3c9dd8 prev.1435190, 307776594e9333f7d4706b2ea0f199793733b0a12b46c6eef07bc21c991e8a7e next.1435220
gettx ht.1435211 prev.1435190 next.1435220
couldnt find txid.1b73229b5d33b22ca43527a0ba29564d05516081b339384932cc792d2005819d/v1 or it was spent
sign 1 inputs 29.98000000 + interest 0.00354540 -> 2 outputs 20.00000000 change 9.98344540
got ntzproof response 1562748110 size.49366 prev.1435190 next.1435220
got broadcast response 1562748110 size.37 2032af858073b078618836a7cbb87af1dfc2971894e2672d5232613f590395b6 retcode.0


[10-Jul-19 01:44 AM] jl777c#5810
strange. couldnt find txid.1b73229b5d33b22ca43527a0ba29564d05516081b339384932cc792d2005819d/v1 or it was spent
that seems unexpected as it is valid utxo


[10-Jul-19 01:44 AM] jl777c#5810
maybe it is getting some timeouts?


[10-Jul-19 01:45 AM] jl777c#5810
DM me the wif and i will troubleshoot this


[10-Jul-19 01:46 AM] hyperDEX#6586
Done


[10-Jul-19 01:51 AM] hyperDEX#6586
@TonyL when you already have a wif in the login box and you double click the wif then paste a new wif, it does not replace what is there, it adds the pasted item to the end of the existing text in the box.


[10-Jul-19 01:56 AM] hyperDEX#6586
Same thing in the receiver section


[10-Jul-19 01:58 AM] hyperDEX#6586
@jl777c 

https://kmd.explorer.dexstats.info/address/RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8
This seems weird. I did a tx to send the 0.01 to my other address. Where was there another tx with a tx fee?


[10-Jul-19 01:59 AM] hyperDEX#6586
OH it looks like when i tried to send 19.55 to myself

{'type': 'broadcast and mempool', 'expected': 'd39a198ed00808f6b6a7454870b62cfe5c01e410d515adb228f714a46ba0ce98', 'retcode': 1, 'result': 'success', 'broadcast': 'd39a198ed00808f6b6a7454870b62cfe5c01e410d515adb228f714a46ba0ce98'}

got utxos response 1562749108 size.201
RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 numutxos.2 balance 19.96980000
got txproof response 1562749109 size.1933 a76b3fedda4d4e0d0b6e312ef7c2621da999466d3684fac08997ef156db3a652 ht.1436508
got ntzs response 1562749109 size.209 f67078a0a41ec00d2c88a243f9c2ebae2d606de97376dd08f1454d901cf16586 prev.1436490, 0000000000000000000000000000000000000000000000000000000000000000 next.0
got txproof response 1562749111 size.1933 a76b3fedda4d4e0d0b6e312ef7c2621da999466d3684fac08997ef156db3a652 ht.1436508
got ntzs response 1562749112 size.209 f67078a0a41ec00d2c88a243f9c2ebae2d606de97376dd08f1454d901cf16586 prev.1436490, 0000000000000000000000000000000000000000000000000000000000000000 next.0
sign 2 inputs 19.96980000 + interest 0.00000000 -> 2 outputs 19.55000000 change 0.41970000
got broadcast response 1562749116 size.37 d39a198ed00808f6b6a7454870b62cfe5c01e410d515adb228f714a46ba0ce98 retcode.1


[10-Jul-19 02:00 AM] hyperDEX#6586
Looks like the actual tx i wanted to do did not get sent but a tx with a tx fee was paid and broadcast


[10-Jul-19 02:01 AM] jl777c#5810
maybe best to test at cli level first?


[10-Jul-19 02:01 AM] jl777c#5810
it really isnt very hard to use


[10-Jul-19 02:01 AM] jl777c#5810
as it is, i have no idea what cli commands were issued


[10-Jul-19 02:01 AM] hyperDEX#6586
Sure is there a list of commands, i can play around with them


[10-Jul-19 02:02 AM] hyperDEX#6586
@TonyL maybe a debug box where we can see what commands are issued via the gui would be good too.

{Reactions}
üëç 

[10-Jul-19 02:02 AM] jl777c#5810
./komodo-cli help  | grep nspv


[10-Jul-19 02:02 AM] hyperDEX#6586
ok np will play with it


[10-Jul-19 02:02 AM] jl777c#5810
login, spend, broadcast are all that is needed


[10-Jul-19 02:03 AM] TonyL#3577
Sure, will log everything to console


[10-Jul-19 02:11 AM] hyperDEX#6586
./komodo-cli nsvp_login wif says the method is not found.

I started nsvp using the ./main KMD, if i use CLI do it need to start it differently?


[10-Jul-19 02:14 AM] jl777c#5810
nspv not nsvp


[10-Jul-19 02:14 AM] jl777c#5810
every character matters


[10-Jul-19 02:15 AM] hyperDEX#6586
my bad üò¶ works now


[10-Jul-19 02:18 AM] hyperDEX#6586
./komodo-cli nspv_listunspent RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8
{
  "result": "success",
  "utxos": [
    {
      "height": 1436510,
      "txid": "d39a198ed00808f6b6a7454870b62cfe5c01e410d515adb228f714a46ba0ce98",
      "vout": 0,
      "value": 19.55,
      "interest": 0
    },
    {
      "height": 1436510,
      "txid": "d39a198ed00808f6b6a7454870b62cfe5c01e410d515adb228f714a46ba0ce98",
      "vout": 1,
      "value": 0.4197,
      "interest": 0
    }
  ],
  "address": "RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8",
  "isCC": 0,
  "height": 1436518,
  "numutxos": 2,
  "balance": 19.9697,
  "interest": 0


[10-Jul-19 02:18 AM] hyperDEX#6586
https://kmd.explorer.dexstats.info/address/RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 why cant i see that tx for 19.55 ?


[10-Jul-19 02:19 AM] jl777c#5810
click the (+) https://kmd.explorer.dexstats.info/tx/d39a198ed00808f6b6a7454870b62cfe5c01e410d515adb228f714a46ba0ce98


[10-Jul-19 02:20 AM] hyperDEX#6586
Oh  i never knew that, so the other view summed up the amounts üòÑ


[10-Jul-19 02:27 AM] jl777c#5810
duplicated the txid not found, very strange


[10-Jul-19 02:27 AM] hyperDEX#6586
./komodo-cli nspv_broadcast 0400008085202f890198cea06ba414f728b2ad15d510e4015cfe2cb6704845a7b6f60808d08e199ad3000000006b483045022100e55762697e9c94882d0cd4e51088c294df792ce089135410e1c5519df94e29c402203a33ccc5e6782d3e187fa856b1f3d36d08efb766190f7b46af4e2f888e4d3398012102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936effffffff0280a2a366000000001976a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac3025e30d00000000232102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eacedab255d000000000000000000000000000000
{
  "result": "success",
  "expected": "39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a",
  "broadcast": "39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a",
  "retcode": 1,
  "type": "broadcast and mempool"

Cool seems easy enough to send and broadcast


[10-Jul-19 02:28 AM] jl777c#5810
yes, so if cli works and gui doesnt...


[10-Jul-19 02:29 AM] hyperDEX#6586
GUI worked before with my second wif, but if you are happy to answer idiotic questions from me i will keep playing with the CLI


[10-Jul-19 02:31 AM] hyperDEX#6586
./komodo-cli nspv_notarizations how do we get the height value in this method?


[10-Jul-19 02:33 AM] hyperDEX#6586
./komodo-cli nspv_getinfo 1436524
{
  "result": "success",
  "nSPV": "superlite",
  "address": "RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8",
  "pubkey": "02bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936e",
  "height": 1436524,
  "chaintip": "089deb33469a97ad39bffe4403bba3e2be686e4d224634bb163fe46e9961554e",
  "notarization": {
    "notarized_height": 1436510,
    "notarized_blockhash": "000000006731fffe412b4e5a8c9a207a5a0aa00fbcb9cebd157c6d1a69f582bf",
    "notarization_txid": "54fd1d42fb20a161a48af5505d3109483da4c28fdf6b369067ffb535521f59a6",
    "notarization_txidheight": 1436523,
    "notarization_desttxid": "67dd27650c268d4fa52ec18db46d23c2adcf4324ad9cc458cdc97e97e7b29fb6"
  },
  "header": {
    "height": 1436524,
    "blockhash": "089deb33469a97ad39bffe4403bba3e2be686e4d224634bb163fe46e9961554e",
    "hashPrevBlock": "00d1da6e79d269ca81db5b1a5d7b0ed08795693f8dfc6d90e246cf5bcdf9dc21",
    "hashMerkleRoot": "9d24f344b23c60cde03972dffe147cee99c1eb20dbc8d54f9acc8439cec2a2bf",
    "nTime": 1562751002,
    "nBits": 486626327
  }
}
 

./komodo-cli nspv_notarizations 1436510
{
  "result": "success",
  "prev": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"
  },
  "next": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"


[10-Jul-19 02:33 AM] jl777c#5810
you pass in the height you want to find the notarization bracket for


[10-Jul-19 02:33 AM] hyperDEX#6586
So i got the info above, then took the notarized_height value and passed that in, but got the above output


[10-Jul-19 02:33 AM] jl777c#5810
that is the last notarization, there isnt a next one


[10-Jul-19 02:33 AM] hyperDEX#6586
Oh


[10-Jul-19 02:34 AM] jl777c#5810
for a txid, it has a height


[10-Jul-19 02:34 AM] jl777c#5810
use the height of the txid to find the notarizations that bracket it


[10-Jul-19 02:34 AM] jl777c#5810
prevNtz, txid, next Ntz


[10-Jul-19 02:34 AM] hyperDEX#6586
Cool will give that a go


[10-Jul-19 02:40 AM] jl777c#5810
a few of the calls are low level calls, not really needed for users sending funds


[10-Jul-19 02:56 AM] hyperDEX#6586
login / spend / broadcast, not too hard if we disregard the other stuff


[10-Jul-19 03:04 AM] jl777c#5810
yes and considering how fast it is, well worth the tradeoffs. once we can get a dozen nodes and solve the conflicting info issue, it will be 10x more reliable and even faster


[10-Jul-19 03:40 AM] jl777c#5810
anyway, the bug with hyperDEX address is due to latency, blocking and fundamental structure issues. i think things are stable enough for now as it is basically writing an entirely new async i/o handling to solve this.


[10-Jul-19 03:42 AM] hyperDEX#6586
Ah ok, i replicated it again with another tx


[10-Jul-19 03:43 AM] hyperDEX#6586
./komodo-cli nspv_spend RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 1.5555555555555555555
{
  "txid": "7a5e6896dff3555353b287c8b227ff6ca4975162e8e83a700f98f66b99fff7b8",
  "overwintered": true,
  "version": 4,
  "versiongroupid": "892f2085",
  "locktime": 1562754305,
  "expiryheight": 0,
  "vin": [
    {
      "txid": "39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a",
      "vout": 1,
      "scriptSig": {
        "asm": "",
        "hex": ""
      },
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 1.55555555,
      "valueZat": 155555555,
      "n": 0,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 28fa8a1d009b41c1b8bb7671b1147d211c4885a5 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": [
          "RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8"
        ]
      }
    },
    {
      "value": 0.77424445,
      "valueZat": 77424445,
      "n": 1,
      "scriptPubKey": {
        "asm": "02bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936e OP_CHECKSIG",
        "hex": "2102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eac",
        "reqSigs": 1,
        "type": "pubkey",
        "addresses": [
          "RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8"
        ]
      }
    }
  ],
  "vjoinsplit": [
  ],
  "valueBalance": 0.00000000,
  "vShieldedSpend": [
  ],
  "vShieldedOutput": [
  ],
  "result": "success",
  "hex": "0400008085202f89012a09536438b8b20f9f0635dc8413a6be74252edd5d5164b5a3aebbc8778740390100000000ffffffff02e3964509000000001976a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac3d679d0400000000232102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eac01bd255d000000000000000000000000000000",
  "retcodes": [
    -1
  ]


[10-Jul-19 03:43 AM] hyperDEX#6586
./komodo-cli nspv_broadcast 0400008085202f89012a09536438b8b20f9f0635dc8413a6be74252edd5d5164b5a3aebbc8778740390100000000ffffffff02e3964509000000001976a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac3d679d0400000000232102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eac01bd255d000000000000000000000000000000
{
  "result": "success",
  "expected": "7a5e6896dff3555353b287c8b227ff6ca4975162e8e83a700f98f66b99fff7b8",
  "broadcast": "7a5e6896dff3555353b287c8b227ff6ca4975162e8e83a700f98f66b99fff7b8",
  "retcode": 0,
  "type": "broadcast"


[10-Jul-19 03:43 AM] jl777c#5810
no signatures


[10-Jul-19 03:43 AM] jl777c#5810
"scriptSig": {
        "asm": "",
        "hex": ""


[10-Jul-19 03:43 AM] hyperDEX#6586
RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 numutxos.3 balance 19.96960000
got txproof response 1562755083 size.1967 39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a ht.1436524
got ntzs response 1562755083 size.209 54fd1d42fb20a161a48af5505d3109483da4c28fdf6b369067ffb535521f59a6 prev.1436510, e5fa323ef34eea3d0fbeac2f9a7d14714eab88c5b3c96516d8818f12acfdcfb3 next.1436530
gettx ht.1436524 prev.1436510 next.1436530
couldnt find txid.39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a/v1 or it was spent
sign 1 inputs 2.32990000 + interest 0.00000000 -> 2 outputs 1.55555555 change 0.77424445
got ntzproof response 1562755090 size.34524 prev.1436510 next.1436530
got broadcast response 1562755119 size.37 7a5e6896dff3555353b287c8b227ff6ca4975162e8e83a700f98f66b99fff7b8 retcode.0
got broadcast response 1562755234 size.37 7a5e6896dff3555353b287c8b227ff6ca4975162e8e83a700f98f66b99fff7b8 retcode.0


[10-Jul-19 03:44 AM] jl777c#5810
i at least fixed that with latest version


[10-Jul-19 03:44 AM] hyperDEX#6586
cool will pull and try again


[10-Jul-19 03:44 AM] jl777c#5810
it also adds fields to show rewards as reported by the fullnode and as calculated locally

{Reactions}
üëçüèª 

[10-Jul-19 03:46 AM] jl777c#5810
which was the final validation needed


[10-Jul-19 03:46 AM] jl777c#5810
so now nSPV superlite client is almost as secure as fullnode if you get retcodes of all 0


[10-Jul-19 03:46 AM] jl777c#5810
of course for non-notarized utxo, it wont return a 0 retcode


[10-Jul-19 03:47 AM] jl777c#5810
and until i improve the networking, it wont even get all the data needed


[10-Jul-19 03:48 AM] jl777c#5810
so as a simplistic superlite, it is beta level, but for a production superlite it would be categorized as a solid alpha release


[10-Jul-19 03:53 AM] hyperDEX#6586
Should i keep trying to make txs or should leave it for now?


[10-Jul-19 03:54 AM] jl777c#5810
try to make and broadcast a tex


[10-Jul-19 03:54 AM] jl777c#5810
tx


[10-Jul-19 03:54 AM] jl777c#5810
it should work, just get non-zero retcodes


[10-Jul-19 03:56 AM] hyperDEX#6586
./komodo-cli nspv_spend RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 12
{
  "txid": "a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439",
  "overwintered": true,
  "version": 4,
  "versiongroupid": "892f2085",
  "locktime": 1562755312,
  "expiryheight": 0,
  "vin": [
    {
      "txid": "39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a",
      "vout": 0,
      "scriptSig": {
        "asm": "",
        "hex": ""
      },
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 12.00000000,
      "valueZat": 1200000000,
      "n": 0,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 28fa8a1d009b41c1b8bb7671b1147d211c4885a5 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac",
        "reqSigs": 1,
        "type": "pubkeyhash",
        "addresses": [
          "RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8"
        ]
      }
    },
    {
      "value": 5.21996846,
      "valueZat": 521996846,
      "n": 1,
      "scriptPubKey": {
        "asm": "02bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936e OP_CHECKSIG",
        "hex": "2102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eac",
        "reqSigs": 1,
        "type": "pubkey",
        "addresses": [
          "RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8"
        ]
      }
    }
  ],
  "vjoinsplit": [
  ],
  "valueBalance": 0.00000000,
  "vShieldedSpend": [
  ],
  "vShieldedOutput": [
  ],
  "result": "success",
  "hex": "0400008085202f89012a09536438b8b20f9f0635dc8413a6be74252edd5d5164b5a3aebbc8778740390000000000ffffffff02008c8647000000001976a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac2e0a1d1f00000000232102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eacf0c0255d000000000000000000000000000000",
  "retcodes": [
    -1
  ]


[10-Jul-19 03:56 AM] hyperDEX#6586
./komodo-cli nspv_broadcast 0400008085202f89012a09536438b8b20f9f0635dc8413a6be74252edd5d5164b5a3aebbc8778740390000000000ffffffff02008c8647000000001976a91428fa8a1d009b41c1b8bb7671b1147d211c4885a588ac2e0a1d1f00000000232102bb585199022de179618326e163208d7b054425ff1a1f4212047d959d26c5936eacf0c0255d000000000000000000000000000000
{
  "result": "success",
  "expected": "a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439",
  "broadcast": "a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439",
  "retcode": 0,
  "type": "broadcast"


[10-Jul-19 03:56 AM] jl777c#5810
still no signatures


[10-Jul-19 03:57 AM] hyperDEX#6586
Yeah


[10-Jul-19 03:57 AM] hyperDEX#6586
RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 numutxos.3 balance 19.96960000
got txproof response 1562756090 size.1967 39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a ht.1436524
got ntzs response 1562756091 size.209 54fd1d42fb20a161a48af5505d3109483da4c28fdf6b369067ffb535521f59a6 prev.1436510, e5fa323ef34eea3d0fbeac2f9a7d14714eab88c5b3c96516d8818f12acfdcfb3 next.1436530
gettx ht.1436524 prev.1436510 next.1436530
couldnt find txid.39408777c8bbaea3b564515ddd2e2574bea61384dc35069f0fb2b8386453092a/v0 or it was spent
sign 1 inputs 17.22000000 + interest 0.00006846 -> 2 outputs 12.00000000 change 5.21996846
got ntzproof response 1562756098 size.34524 prev.1436510 next.1436530
got broadcast response 1562756112 size.37 a1d055c6bd81caddf72d64c128fc7f6c57832079873933fd70b2c06e4a1a5439 retcode.0


[10-Jul-19 03:57 AM] jl777c#5810
are you sure you updated?


[10-Jul-19 03:57 AM] hyperDEX#6586
Getting the same error as before, utxo was spent


[10-Jul-19 03:57 AM] hyperDEX#6586
Yeah and rebuilt


[10-Jul-19 03:57 AM] hyperDEX#6586
im on jl777 branch


[10-Jul-19 03:58 AM] hyperDEX#6586
git pull
remote: Enumerating objects: 8, done.
remote: Counting objects: 100% (8/8), done.
remote: Compressing objects: 100% (8/8), done.
remote: Total 8 (delta 2), reused 2 (delta 0), pack-reused 0
Unpacking objects: 100% (8/8), done.
From https://github.com/jl777/komodo
   bc60137..52eec3e  FSM        -> origin/FSM
   1089c25..ce62d15  nSPV       -> origin/nSPV
Already up-to-date.

{Embed}
https://github.com/jl777/komodo
jl777/komodo
Komodo. Contribute to jl777/komodo development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[10-Jul-19 03:58 AM] jl777c#5810
try nSPV branch, that works for me


[10-Jul-19 03:59 AM] hyperDEX#6586
changed branches and rebuilding


[10-Jul-19 04:07 AM] hyperDEX#6586
much better now üòÉ


[10-Jul-19 04:07 AM] hyperDEX#6586
Even gives the full node IP üòÉ


[10-Jul-19 04:08 AM] jl777c#5810
you were able to spend?


[10-Jul-19 04:08 AM] hyperDEX#6586
yes on the new branch


[10-Jul-19 04:08 AM] hyperDEX#6586
https://kmd.explorer.dexstats.info/tx/88f14f91b6b2a2c0b312554e0a5ee39218bcab3124daf75876c3db987dd82b21


[10-Jul-19 04:09 AM] jl777c#5810
ok good. i will propagate it to jl777/FSM and then go into deep coding on nSPV


[10-Jul-19 04:11 AM] jl777c#5810
did it show "rewards" and "validated"?


[10-Jul-19 04:11 AM] hyperDEX#6586
I tried something silly, sent a tx using the biggest UTXO, before it was confirmed i did another TX that would have had to use that new UTXO, got retcode of 0


[10-Jul-19 04:12 AM] hyperDEX#6586
./komodo-cli nspv_spend RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 15
{
  "rewards": 8.802e-05,
  "validated": 8.802e-05,
  "txid": "88f14f91b6b2a2c0b312554e0a5ee39218bcab3124daf75876c3db987dd82b21",
  "overwintered": true,
  "version": 4,
  "versiongroupid": "892f2085",
  "locktime": 1562755999,
  "expiryheight": 0,


[10-Jul-19 04:12 AM] hyperDEX#6586
This was the working one


[10-Jul-19 04:13 AM] hyperDEX#6586
This is the non working one

./komodo-cli nspv_spend RD1sEykWfk8zR6ZUVKWDr1bLsrcnzrJQu8 14
{
  "rewards": 9.127999999999999e-05,
  "validated": 0,
  "txid": "57a64d2ff9d4cadfd1fe66a1d83e72d7ae5e46923c4fd091b47515138ea21193",
  "overwintered": true,
  "version": 4,
  "versiongroupid": "892f2085",
  "locktime": 1562756105,
  "expiryheight": 0,


[10-Jul-19 04:15 AM] jl777c#5810
ok, all branches in sync. superlite client has no idea about mempool, unconfirmed tx, etc.


[10-Jul-19 04:16 AM] jl777c#5810
be nice to it and it will be nice to you


[10-Jul-19 04:17 AM] hyperDEX#6586
:troll_thuglife:


[10-Jul-19 04:19 AM] hyperDEX#6586
https://kmd.explorer.dexstats.info/tx/7199bc0a605b0ba203d8038ef5b4860b446e5b1f9c0e2a449a93075b9bd72ca2 I caressed it and got a happy ending


[10-Jul-19 07:07 AM] jl777c#5810
@TonyL @SHossain before diving into multithreading (which would also force going to an opid sort of two step rpc process), i experimented with a simple caching. and it works pretty well. it is a hardforking update


[10-Jul-19 07:08 AM] jl777c#5810
the change is to issue the nspv_spend as long as the retcodes are changing or come back all 0


[10-Jul-19 07:09 AM] jl777c#5810
this uses the first nspv_spend to get most of what is needed into the cache. I have a few ideas for how to speed up addresses with small number of utxo and at that point it is still single threaded but fast enough for normal usage


[10-Jul-19 07:12 AM] TonyL#3577
First spend supposed to have same speed as before and next one faster?


[10-Jul-19 07:21 AM] jl777c#5810
yes


[10-Jul-19 07:33 AM] TonyL#3577
first nspv_spend `real    0m2.421s`, got retocde ```  "retcodes": [
    -2
  ]```

then without broadcast called again `real    0m2.819s`  ```  "retcodes": [
    0
  ]
```


[10-Jul-19 07:37 AM] TonyL#3577
next calls 1.7, 2.0, 2.8, 1.7 and so on


[10-Jul-19 07:37 AM] jl777c#5810
good and the big improvement is that it is retcode of 0, meaning fully validated, especially if you see the notarization bitmasks


[10-Jul-19 07:45 AM] TonyL#3577
and txs broadcasting fine on my side


[10-Jul-19 07:48 AM] jl777c#5810
yes, many bugs fixed today too. i think latest jl777/FSM is pretty stable


[10-Jul-19 07:49 AM] TonyL#3577
added to wallet all calls/responses printing to console, now will fix some stuff reported above


[10-Jul-19 07:52 AM] TonyL#3577
getting such retcode now and rapid responses ``` "retcodes": [
    -2004
  ]
}

real    0m0.003s
```


[10-Jul-19 07:55 AM] TonyL#3577
fresh not-notarized yet input used
broadcasted fine:
```{
  "result": "success",
  "expected": "2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258",
  "broadcast": "2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258",
  "retcode": 1,
  "type": "broadcast and mempool",
  "lastpeer": "23.254.165.16:7770"
}
```


[10-Jul-19 07:59 AM] jl777c#5810
-2004 means not notarized


[10-Jul-19 08:02 AM] TonyL#3577
wallet working much faster with latest komodod


[10-Jul-19 08:03 AM] TonyL#3577
tx broadcasting part


[10-Jul-19 08:03 AM] jl777c#5810
you can speed up the spend even more by doing the following on login:
nspv_listunspent
for each utxo, nspv_txproof


[10-Jul-19 08:03 AM] jl777c#5810
that will load into the cache your utxos and all the tx data


[10-Jul-19 08:03 AM] jl777c#5810
still some calls are needed, but only a few

{Reactions}
üî• 

[10-Jul-19 08:03 AM] TonyL#3577
aha, I'm doing nspv_listunspent on login and on each refresh button click (to fetch balance)


[10-Jul-19 08:04 AM] TonyL#3577
can add nspv_txproof call for each utxo on login


[10-Jul-19 08:11 AM] jl777c#5810
best to do it in the background if you are setup for that


[10-Jul-19 08:12 AM] TonyL#3577
threading time üòÉ


[10-Jul-19 08:13 AM] jl777c#5810
maybe just do it if there are less than 3 utxo


[10-Jul-19 08:13 AM] jl777c#5810
then it doesnt have to be threaded. it seems fast enough as it is


[10-Jul-19 08:20 AM] TonyL#3577
it was pretty fast for 9 utxos in my wallet - set 10 utxos limit for nspv_txproof for now


[10-Jul-19 08:21 AM] TonyL#3577
and then daemon saying that loading it from cache:
```FROM CACHE NSPV_txproof 9ab09345d428d90a0a8a72cd9e5169911fb77ce3acf8d3cdebb0163d82ec6505
{'height': 1436848, 'txid': '978b05a942550f9fb9693cc488cb482bc442b9cc88e4779c726afa7439f70c1c', 'vout': 0, 'value': 1, 'interest': 0}
FROM CACHE NSPV_txproof 978b05a942550f9fb9693cc488cb482bc442b9cc88e4779c726afa7439f70c1c
{'height': 1436858, 'txid': '2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258', 'vout': 0, 'value': 1, 'interest': 0}
FROM CACHE NSPV_txproof 2ad20d17657375486468c0cb98c85d44d445e29776e8bbe9b57c4a640f5f9258
{'height': 1436874, 'txid': '1b0e2de9c5156ca619937e9657af687dc00e42800166a15131afcc2dfefe4bab', 'vout': 0, 'value': 1, 'interest': 0}
FROM CACHE NSPV_txproof 1b0e2de9c5156ca619937e9657af687dc00e42800166a15131afcc2dfefe4bab
{'height': 1433334, 'txid': '3abed08f0d2a9dbb46c5da89518789805620e70a5d6770c0fd3e1042ff7c0ab8', 'vout': 1, 'value': 0.26016152, 'interest': 0}
FROM CACHE NSPV_txproof 3abed08f0d2a9dbb46c5da89518789805620e70a5d6770c0fd3e1042ff7c0ab8
```


[10-Jul-19 08:21 AM] TonyL#3577
so seems to work as expected


[10-Jul-19 08:22 AM] TonyL#3577
have to add txfees and rewards to confrimation popup - just noticed that there is new rewards field in spend output


[10-Jul-19 08:23 AM] jl777c#5810
yes, it shows the rewards that came in from the fullnode and a validated, which is what the local node calculates


[10-Jul-19 08:23 AM] jl777c#5810
avoids the attack of fullnode returning 0 interest and having the reward going to miner


[10-Jul-19 08:28 AM] TonyL#3577
rewards displaying added


[10-Jul-19 08:35 AM] TonyL#3577
`when you already have a wif in the login box and you double click the wif then paste a new wif, it does not replace what is there, it adds the pasted item to the end of the existing text in the box` pushed fix for it also (for all fields)

{Reactions}
rum (2) 

[11-Jul-19 05:16 AM] TonyL#3577
https://paste.ubuntu.com/p/5hZXrK7MGZ/ nspv_spend takes more than 20 seconds atm on my side (for whole balance) and getting a lot of prints


[11-Jul-19 05:17 AM] TonyL#3577
10 inputs combined takes a lot of time to prepare tx


[11-Jul-19 05:17 AM] jl777c#5810
2 seconds per vin


[11-Jul-19 05:17 AM] jl777c#5810
yes


[11-Jul-19 05:17 AM] jl777c#5810
still a little faster than syncing a fullnode


[11-Jul-19 05:18 AM] TonyL#3577
so it's better to not import to my wallet something like a NN operator privkey üòÉ


[11-Jul-19 05:18 AM] jl777c#5810
yes, likely it will break things


[11-Jul-19 05:18 AM] hyperDEX#6586
lol


[11-Jul-19 05:18 AM] jl777c#5810
64 utxo is max


[11-Jul-19 05:18 AM] jl777c#5810
no guards against such things yet


[11-Jul-19 05:20 AM] SHossain#0007
i sent yesterday 30 utxos. and worked fine including claiming accrued rewards


[11-Jul-19 05:20 AM] SHossain#0007
then, i sent to external address


[11-Jul-19 05:24 AM] SHossain#0007
and, a lot of prints for those 30 utxos


[11-Jul-19 05:24 AM] TonyL#3577
for 30 utxos should prepare tx for a like a minute üòÉ


[11-Jul-19 05:24 AM] SHossain#0007
yes it was


[11-Jul-19 05:24 AM] SHossain#0007
let me check how many utxos i have now and will time  it


[11-Jul-19 05:26 AM] SHossain#0007
i have 11 utxos


[11-Jul-19 05:28 AM] TonyL#3577
will take 30 seconds is my prediction


[11-Jul-19 05:29 AM] SHossain#0007
you are right


[11-Jul-19 05:30 AM] SHossain#0007
```
  "retcodes": [
    -2,
    -2,
    -2002,
    0,
    -2002,
    0,
    0,
    0,
    0,
    -2
  ]
}

real    0m26.305s
user    0m0.001s
sys    0m0.006s
```


[11-Jul-19 05:31 AM] SHossain#0007
2nd run
```
  "retcodes": [
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0
  ]
}

real    0m23.018s
user    0m0.004s
sys    0m0.000s
```


[11-Jul-19 05:33 AM] TonyL#3577
caching raised speed on 11%


[11-Jul-19 05:33 AM] TonyL#3577
üèé


[11-Jul-19 05:36 AM] SHossain#0007
and, all utxos validated


[11-Jul-19 06:02 AM] TonyL#3577
pushed patch to wallet which allows operations with big utxos amount (before underlaying RPC lib got connection timeout almost everytime in such long calls)


[11-Jul-19 06:03 AM] TonyL#3577
```'rewards': 44980600000000, 'validated': 44980600000000``` are rewards in nspv_getinfo supposed to be displayed in satoshis? if yes - too many digits there


[11-Jul-19 06:04 AM] TonyL#3577
`0.00449806` my actual rewards


[11-Jul-19 08:59 AM] jl777c#5810
pushed fix to jl777 branch


[11-Jul-19 09:05 AM] jl777c#5810
@TonyL caching is actually speeding it up 10x


[11-Jul-19 09:06 AM] jl777c#5810
each iteration it does more and more work as more data becomes available


[11-Jul-19 09:11 AM] TonyL#3577
hmm never notice such massive speedup on next calls after retcodes became 0, usually it's 1-2 seconds difference


[11-Jul-19 09:12 AM] jl777c#5810
it is doing notarization validation when retcode 0


[11-Jul-19 09:12 AM] jl777c#5810
if other retcode, it usually skips all that


[11-Jul-19 09:22 AM] TonyL#3577
rewards indication is fixed on latest jl777 `"rewards": "0.00522367"`


[13-Jul-19 02:35 AM] jl777c#5810
i made a hardforking update. please update all nodes. in the channel purpose at top of screen are the ways to start the NSPV chain . it has low diff so you can mine a few blocks to get coins, or just use faucetget. I also set up 10 KMD nSPV fullnodes, so it has a theoretical capacity of 8000 nodes saturating it, or likely 100,000+ normal usage nodes.
main improvements are bugfixes, 99% chance to get final rpc result on the first call, and initial CC support. so far faucet is working, along with a few of tokens calls, but havent been able to test a lot yet. each CC rpc is able to use any info in the daemon, and if it uses any but the most standard, it will need to be updated. no idea what percentage of calls this is. shossain has started testing and results from yesterdays version is https://docs.google.com/spreadsheets/d/1c4FHg33phx2u3ko8Pg8SamA7jBllwzY-_QCCF91PX4k/edit#gid=1636254260

{Embed}
https://docs.google.com/spreadsheets/d/1c4FHg33phx2u3ko8Pg8SamA7jBllwzY-_QCCF91PX4k/edit
nSPV-Antara-Modules-Test
Tokens

Token Contract
Availalble RPC calls,What does this Call do?,Example Test Command,Example Expected Output,What to Check?,Comments,Testing Result
assetsaddress [pubkey],./komodo-cli -ac_name=NSPV assetsaddress 0386c2f124da8eacdaef73ef61938f59fdc76a0da5d00c307fd5277ef62b...
https://images-ext-1.discordapp.net/external/WP5wWeY6pS7OY4qFgRff6F3aUZlO7zRJ1sX0i58kBck/https/lh4.googleusercontent.com/dzQFtPKHhVMs268s8K5F745Jsc6k8W34KMeG8k2ivUI56D0fCsqDu2yOd7-Vk3BycTBIIw%3Dw1200-h630-p

{Reactions}
üî• üöÄ 

[13-Jul-19 02:35 AM] jl777c#5810
there is also the ILN chain if you want to test notarization validation


[13-Jul-19 02:54 AM] jl777c#5810
nodes are 5.9.102.210, 5.9.253.195 to 5.9.253.203 you can addnode to all of those to get the most fullnodes and highest throughput


[13-Jul-19 06:41 AM] jl777c#5810
latest version supports nspv_listtransactions


[13-Jul-19 06:42 AM] SHossain#0007
did anyone notice yet that CC works with nSPV? üòâ

{Reactions}
üòÉ 

[13-Jul-19 09:14 AM] jl777c#5810
added skipcounts (max 127 for now) to listunspent and listtransactions


[13-Jul-19 09:15 AM] jl777c#5810
next item will take more time as it involves getting mempool state into nSPV, expected next release will be tuesday


[13-Jul-19 09:15 AM] jl777c#5810
will squeeze in bugfixes for CC rpc as they are reported


[13-Jul-19 10:29 AM] TonyL#3577
`did anyone notice yet that CC works with nSPV?`
thats just fantastic!


[13-Jul-19 10:30 AM] jl777c#5810
i still need to implement the mempool lookup functions to get to 90% coverage, currently i estimate 80% should work, at least mostly


[13-Jul-19 10:36 AM] jl777c#5810
not sure if the automated tests will work well enough with the current state of things, some calls might even crash


[13-Jul-19 10:38 AM] TonyL#3577
CC unit tests made with regtest so will not work with nSPV from a box


[13-Jul-19 10:44 AM] TonyL#3577
will work on making CC tests more flexible (possibility to run on any real chain, not only hardcoded regtest one) after hardfork  - should help for a lot in different cases and nSPV CCs testing as well


[13-Jul-19 11:02 AM] jl777c#5810
ok


[13-Jul-19 11:03 AM] TonyL#3577
using same peer/wif/commit as on Ubuntu (on ubuntu now spending works fine)


[13-Jul-19 11:03 AM] TonyL#3577
```./komodo-cli nspv_listunspent
{
  "result": "error",
  "error": "no utxos result"
}
```


[13-Jul-19 11:03 AM] jl777c#5810
does listunspent work?


[13-Jul-19 11:04 AM] jl777c#5810
i should add lastpeer to that error


[13-Jul-19 11:04 AM] TonyL#3577
last peer in nspv_getinfo ` "lastpeer": "23.254.165.16:7770"`


[13-Jul-19 11:06 AM] jl777c#5810
doex txproof work?


[13-Jul-19 11:07 AM] TonyL#3577
```./komodo-cli nspv_txproof  d712c3027c4e48d80ed42ff55fe383e11955a30c066d8c235a45ec32e26bd890 1441324
req txproof d712c3027c4e48d80ed42ff55fe383e11955a30c066d8c235a45ec32e26bd890/v0 at height.1441324
ADD CACHE txproof d712c3027c4e48d80ed42ff55fe383e11955a30c066d8c235a45ec32e26bd890
got txproof response 1563041250 size.3316 d712c3027c4e48d80ed42ff55fe383e11955a30c066d8c235a45ec32e26bd890 ht.1441324
{
  "txid": "d712c3027c4e48d80ed42ff55fe383e11955a30c066d8c235a45ec32e26bd890",
  "height": 1441324,
  "txlen": 1637,
  "txprooflen": 1622,
  "lastpeer": "23.254.165.16:7770"
}
```


[13-Jul-19 11:08 AM] jl777c#5810
nspv_notarizations?


[13-Jul-19 11:08 AM] jl777c#5810
nspv_hdrsproof?


[13-Jul-19 11:09 AM] TonyL#3577
both calls works


[13-Jul-19 11:09 AM] jl777c#5810
what about the NSPV chain, that is easier to debug


[13-Jul-19 11:10 AM] TonyL#3577
where NSPV chain params can be found? On channel top can see only link on medium article


[13-Jul-19 11:10 AM] Mark81#4505
is there windows version for komodd.exe that has iln support?


[13-Jul-19 11:10 AM] jl777c#5810
click it, it will bring up the rest

{Reactions}
üôè 

[13-Jul-19 11:10 AM] jl777c#5810
windows still has some issues (as usual)


[13-Jul-19 11:11 AM] Mark81#4505
hmmm is there site for like it used to be for latests komodod executables?


[13-Jul-19 11:11 AM] TonyL#3577
thank you for params üòÉ


[13-Jul-19 11:11 AM] TonyL#3577
when clicked link just link opened in browser


[13-Jul-19 11:12 AM] TonyL#3577
maybe I have different discord


[13-Jul-19 11:13 AM] jl777c#5810
use faucet


[13-Jul-19 11:13 AM] TonyL#3577
oh right


[13-Jul-19 11:14 AM] TonyL#3577
```./komodo-cli -ac_name=NSPV faucetget
got utxos response 1563041631 size.201
req txproof 002f8cbf6fe0a0ae371c1565c08d0450f19a89cbb5d1742083add9d6544bce00/v0 at height.0
ADD CACHE txproof 002f8cbf6fe0a0ae371c1565c08d0450f19a89cbb5d1742083add9d6544bce00
got txproof response 1563041632 size.368 002f8cbf6fe0a0ae371c1565c08d0450f19a89cbb5d1742083add9d6544bce00 ht.0
nValue too small or already spent in mempool
req txproof 8458898f3c6ef1d3be1670496901d1061fe18b32a72b70012a2927c05ef242f7/v0 at height.0
no pnodes
txproof timeout
txproof error 0000000000000000000000000000000000000000000000000000000000000000 != 8458898f3c6ef1d3be1670496901d1061fe18b32a72b70012a2927c05ef242f7
couldnt get tx
cant find faucet inputs
{
  "result": "error",
  "error": "couldnt create faucet get transaction"
}
```


[13-Jul-19 11:14 AM] jl777c#5810
no pnodes


[13-Jul-19 11:14 AM] jl777c#5810
this is osx?


[13-Jul-19 11:15 AM] TonyL#3577
On next call dont have error about pnodes:
```./komodo-cli -ac_name=NSPV faucetget
nValue too small or already spent in mempool
req txproof 8458898f3c6ef1d3be1670496901d1061fe18b32a72b70012a2927c05ef242f7/v0 at height.0
ADD CACHE txproof 8458898f3c6ef1d3be1670496901d1061fe18b32a72b70012a2927c05ef242f7
got txproof response 1563041679 size.291 8458898f3c6ef1d3be1670496901d1061fe18b32a72b70012a2927c05ef242f7 ht.0
nValue too small or already spent in mempool
cant find faucet inputs
{
  "result": "error",
  "error": "couldnt create faucet get transaction"
}
```


[13-Jul-19 11:15 AM] TonyL#3577
yes, now will try on Ubuntu


[13-Jul-19 11:16 AM] TonyL#3577
same on ubuntu


[13-Jul-19 11:16 AM] TonyL#3577
```./komodo-cli -ac_name=NSPV faucetget
got utxos response 1563041759 size.201
req txproof 002f8cbf6fe0a0ae371c1565c08d0450f19a89cbb5d1742083add9d6544bce00/v0 at height.0
ADD CACHE txproof 002f8cbf6fe0a0ae371c1565c08d0450f19a89cbb5d1742083add9d6544bce00
got txproof response 1563041759 size.368 002f8cbf6fe0a0ae371c1565c08d0450f19a89cbb5d1742083add9d6544bce00 ht.0
nValue too small or already spent in mempool
req txproof 8458898f3c6ef1d3be1670496901d1061fe18b32a72b70012a2927c05ef242f7/v0 at height.0
no pnodes
txproof timeout
txproof error 0000000000000000000000000000000000000000000000000000000000000000 != 8458898f3c6ef1d3be1670496901d1061fe18b32a72b70012a2927c05ef242f7
couldnt get tx
cant find faucet inputs
{
  "result": "error",
  "error": "couldnt create faucet get transaction"
}
```


[13-Jul-19 11:17 AM] TonyL#3577
oh on ubuntu version is not correct, updating. but on OSX is latest


[13-Jul-19 11:18 AM] jl777c#5810
without listunspent, it seems not many tx will work


[13-Jul-19 11:18 AM] jl777c#5810
sent you some funds


[13-Jul-19 11:20 AM] jl777c#5810
it seems i broke faucetget today, worked yesterday.


[13-Jul-19 11:20 AM] jl777c#5810
investigating


[13-Jul-19 11:21 AM] jl777c#5810
i just started a miner, its in mempool


[13-Jul-19 11:21 AM] TonyL#3577
at least it works (it OSX)


[13-Jul-19 11:21 AM] TonyL#3577
so maybe ```./komodo-cli nspv_listunspent
{
  "result": "error",
  "error": "no utxos result"
}
``` on KMD is just seednode issue


[13-Jul-19 11:21 AM] jl777c#5810
yes, i think some sort of packet alignment problem on osx, but it is mostly working


[13-Jul-19 11:22 AM] jl777c#5810
add the 5.9.253.199 to 203 peers


[13-Jul-19 11:26 AM] TonyL#3577
```./komodod -nSPV=1 -addnode=5.9.253.199 -addnode=5.9.253.200 -addnode=5.9.253.201 -addnode=5.9.253.202 -addnode=5.9.253.203 &
``` this way?


[13-Jul-19 11:26 AM] jl777c#5810
ok


[13-Jul-19 11:26 AM] jl777c#5810
you can verify via getpeerinfo


[13-Jul-19 11:26 AM] TonyL#3577
```./komodo-cli nspv_getinfo
no pnodes
{
  "result": "success",
  "nSPV": "superlite",
  "height": 0,
```


[13-Jul-19 11:27 AM] TonyL#3577
```./komodo-cli -ac_name=NSPV faucetinfo
nValue too small or already spent in mempool
req txproof cb96a0718faa3cde7385750df2e4f8e8502208709572dae5908b8fe16961c627/v0 at height.0
ADD CACHE txproof cb96a0718faa3cde7385750df2e4f8e8502208709572dae5908b8fe16961c627
got txproof response 1563042456 size.300 cb96a0718faa3cde7385750df2e4f8e8502208709572dae5908b8fe16961c627 ht.0
nValue too small or already spent in mempool
nValue too small or already spent in mempool
{
  "result": "success",
  "name": "Faucet",
  "funding": "0.00000000"
}```


[13-Jul-19 11:27 AM] TonyL#3577
maybe 0 balance is a problem?


[13-Jul-19 11:28 AM] jl777c#5810
i duplicated the faucet bug

{Reactions}
üëå 

[13-Jul-19 11:49 AM] jl777c#5810
pushed fix to nSPV branch


[13-Jul-19 11:50 AM] jl777c#5810
i added a too extreme error check, which basically broke all CC spends


[13-Jul-19 11:50 AM] jl777c#5810
should be much happier now


[13-Jul-19 12:01 PM] TonyL#3577
```./komodo-cli -ac_name=NSPV faucetget
found valid txid after 28020 iterations 1563044440
{
  "result": "success",
  "hex": "0400008085202f890100b00442ce59236297f3a4a205cf48ba0a14e15976fe580c26be7e1963e1fc00000000007b4c79a276a072a26ba067a565802103682b255c40d0cde8faee381a1a50bbb89980ff24539cb8518e294d3a63cefe128140be6cd0235a8ff85ba3f52dee940bad781af722bd8adaf807f65f64cf098cd6dd07f3d8e761100c65f2c8e47049b260a1413678d9ad48bfe9e4d2cfa118bab844a100af038001e4a10001ffffffff039048610200000000302ea22c8020e029c511da55523565835887e412e5a0c9b920801b007000df45e545f25028248103120c008203000401cc8096980000000000232103aa464529c190398d44017c3d7a71a854ad195a9d396bf84182679c242bb60085ac0000000000000000086a06e447cbdcad0e00000000000000000000000000000000000000"
}
```


[13-Jul-19 12:01 PM] TonyL#3577
```./komodo-cli -ac_name=NSPV nspv_broadcast 0400008085202f890100b00442ce59236297f3a4a205cf48ba0a14e15976fe580c26be7e1963e1fc00000000007b4c79a276a072a26ba067a565802103682b255c40d0cde8faee381a1a50bbb89980ff24539cb8518e294d3a63cefe128140be6cd0235a8ff85ba3f52dee940bad781af722bd8adaf807f65f64cf098cd6dd07f3d8e761100c65f2c8e47049b260a1413678d9ad48bfe9e4d2cfa118bab844a100af038001e4a10001ffffffff039048610200000000302ea22c8020e029c511da55523565835887e412e5a0c9b920801b007000df45e545f25028248103120c008203000401cc8096980000000000232103aa464529c190398d44017c3d7a71a854ad195a9d396bf84182679c242bb60085ac0000000000000000086a06e447cbdcad0e00000000000000000000000000000000000000
got broadcast response 1563044450 size.37 001f64980d6c276ae4253090ab89c9997c261b95399b7ae01b5ed1d93b972100 retcode.-3
{
  "result": "success",
  "expected": "001f64980d6c276ae4253090ab89c9997c261b95399b7ae01b5ed1d93b972100",
  "broadcast": "001f64980d6c276ae4253090ab89c9997c261b95399b7ae01b5ed1d93b972100",
  "retcode": -3,
  "type": "error adding to mempool",
  "lastpeer": "5.9.102.210:20266"
}
```


[13-Jul-19 12:02 PM] TonyL#3577
but tx was rejected - I wonder that because it's not fresh address (got one tx from you), let me try another one


[13-Jul-19 12:03 PM] TonyL#3577
```./komodo-cli -ac_name=NSPV nspv_broadcast 0400008085202f890100b00442ce59236297f3a4a205cf48ba0a14e15976fe580c26be7e1963e1fc00000000007b4c79a276a072a26ba067a565802103682b255c40d0cde8faee381a1a50bbb89980ff24539cb8518e294d3a63cefe1281409f01097ff54afc6b56e262353d2fd9042e4491e8eb88d7f207d7385064e3854c72e4ad58be58fac60a6f59cfc0462c491c6edd5b03f94a7e73485c37383894d7a100af038001e4a10001ffffffff039048610200000000302ea22c8020e029c511da55523565835887e412e5a0c9b920801b007000df45e545f25028248103120c008203000401cc8096980000000000232102a0fda1f679d5e8583c3d8d2b9a0efd3727838836b01fc7f19a3ba7ecb5a4d05fac0000000000000000086a06e447fc91ff0a00000000000000000000000000000000000000
got broadcast response 1563044609 size.37 0013c918fba43aaf81e8ffc70abb151e47fd42096ef124a6dace4119d854e600 retcode.1
{
  "result": "success",
  "expected": "0013c918fba43aaf81e8ffc70abb151e47fd42096ef124a6dace4119d854e600",
  "broadcast": "0013c918fba43aaf81e8ffc70abb151e47fd42096ef124a6dace4119d854e600",
  "retcode": 1,
  "type": "broadcast and mempool",
  "lastpeer": "5.9.102.210:20266"
}
``` aha, for a fresh address seems fine


[13-Jul-19 12:04 PM] TonyL#3577
now it's much easier to drain faucets with nspv btw - no need to restart wallet with new pubkey - can just nspv_login with new address


[13-Jul-19 12:04 PM] jl777c#5810
yes, that is how it should work. nSPV is pretty handy


[13-Jul-19 12:04 PM] jl777c#5810
oh, the nSPV branch has nspv_listtransactions


[13-Jul-19 12:04 PM] jl777c#5810
also i added skipcount parameter to that and listunspent


[13-Jul-19 12:05 PM] jl777c#5810
dont go above skipcount of 127 for now. i didnt want to hardfork the network twices in a day


[13-Jul-19 12:06 PM] TonyL#3577
now can make tx history in pywallet with this call


[13-Jul-19 12:06 PM] jl777c#5810
cool, it has -77.7 when you spend it!


[13-Jul-19 12:07 PM] jl777c#5810
maybe when the value is negative the "vout" should be "vin"?


[13-Jul-19 12:09 PM] TonyL#3577
yes some groupping would be helpful


[13-Jul-19 12:09 PM] TonyL#3577
to display vins and vouts of single tx together


[13-Jul-19 12:10 PM] jl777c#5810
what exact was b6ddd6254f2da7da6df6839ee92920e4192cb87a3a7a91f016e534979cfe2148


[13-Jul-19 12:11 PM] TonyL#3577
I sent 1 coin to myself


[13-Jul-19 12:11 PM] jl777c#5810
need all the vins and vouts to see how it maps to the above list


[13-Jul-19 12:11 PM] jl777c#5810
my guess is 1 vin0 for 77.7 and 2 vouts, 1 and 76.9999


[13-Jul-19 12:12 PM] jl777c#5810
there seems no way to link it to the 77.7 from bbb529a739a8ef70e7ce4e6f9f4e0473694de6f8f05ee61d172a8d7b610e8217


[13-Jul-19 12:13 PM] TonyL#3577
first `77.7` it's your tx, 
`-77.7` input in tx which I sent to myself `76.6999` change `1` actual tx amount


[13-Jul-19 12:13 PM] TonyL#3577
I wonder this way, let me make full node to check


[13-Jul-19 12:15 PM] jl777c#5810
it seems very complex to make it intelligible... maybe just list all entries for the same txid together, at least you can tell if a txid was a payment you made or a payment you did


[13-Jul-19 12:15 PM] TonyL#3577
https://paste.ubuntu.com/p/vvdzfTwhcP/


[13-Jul-19 12:15 PM] jl777c#5810
yes, so the "vout" should be "vin" when it is negative


[13-Jul-19 12:16 PM] jl777c#5810
pushed that fix


[13-Jul-19 12:17 PM] TonyL#3577
would be great if all vin/vouts of `b6ddd6254f2da7da6df6839ee92920e4192cb87a3a7a91f016e534979cfe2148` combined to single list


[13-Jul-19 12:17 PM] jl777c#5810
for now just display it as raw data


[13-Jul-19 12:17 PM] jl777c#5810
at least all the data is there without needing to do a bunch of gettransactions

{Reactions}
üíØ 

[13-Jul-19 12:18 PM] TonyL#3577
ok, in general I can iterate and just combine if next one txid is the same as previous one (so make such vin/vouts lists for txids on gui side)


[13-Jul-19 12:18 PM] jl777c#5810
any shortfall would be the payment to an external address


[13-Jul-19 12:18 PM] jl777c#5810
other than the txfee


[13-Jul-19 12:18 PM] jl777c#5810
a positive amount is change


[13-Jul-19 12:18 PM] jl777c#5810
negative amount is spending a utxo


[13-Jul-19 12:19 PM] jl777c#5810
so you spent 77.7, got change and payment of 1 and 76.9999, cant tell which is the change


[13-Jul-19 12:22 PM] TonyL#3577
```./komodo-cli -ac_name=NSPV nspv_listtransactions
got txids response 1563045724 size.265
{
  "result": "success",
  "txids": [
    {
      "height": 2668,
      "txid": "bbb529a739a8ef70e7ce4e6f9f4e0473694de6f8f05ee61d172a8d7b610e8217",
      "value": 77.7,
      "vout": 0
    },
    {
      "height": 2678,
      "txid": "b6ddd6254f2da7da6df6839ee92920e4192cb87a3a7a91f016e534979cfe2148",
      "value": 1,
      "vout": 0
    },
    {
      "height": 2678,
      "txid": "b6ddd6254f2da7da6df6839ee92920e4192cb87a3a7a91f016e534979cfe2148",
      "value": -77.7,
      "vin": 0
    },
    {
      "height": 2678,
      "txid": "b6ddd6254f2da7da6df6839ee92920e4192cb87a3a7a91f016e534979cfe2148",
      "value": 76.6999,
      "vout": 1
    }
```


[13-Jul-19 12:23 PM] TonyL#3577
parseable now üòÉ


[13-Jul-19 12:26 PM] jl777c#5810
do spends get to all 0 retcodes on the first time now?


[13-Jul-19 12:29 PM] TonyL#3577
on NSPV it's ```"retcodes": [
    -2004
  ]
``` have to check on ILN or KMD maybe


[13-Jul-19 12:30 PM] jl777c#5810
no rush, it does for me now, so it should work much more reliably in general

{Reactions}
üöÄ (2) 

[15-Jul-19 09:27 AM] jl777c#5810
updated to a new nSPV hardfork and changed the seed node for KMD, now there is a mempool query function that lets you get the full mempool, check if a specific txid is in the mempool, check if a specific utxo (txid/vout) is spent in the mempool, or even if a specific address received any funds with a mempool txid


[15-Jul-19 09:28 AM] jl777c#5810
still need to change all CC queries of mempool to use this function, but from what i can tell, once i do that we should have almost all CC rpc working as they should, though of course some will be quite slow


[17-Jul-19 05:34 AM] jl777c#5810
latest version supports most of the mempool usage inside CC, so most CC rpc calls should work, with just a few exceptions


[18-Jul-19 10:55 AM] dukeleto#7326
I have merged the latest FSM branch to Hush which includes nSPV, looking forward to playing with it on the Hush network in the future


[18-Jul-19 10:57 AM] jl777c#5810
let me make sure it is the latest version, there were some recent changes, especially to support CC


[18-Jul-19 11:01 AM] jl777c#5810
it wasnt


[18-Jul-19 11:02 AM] jl777c#5810
just updated FSM with support for most CC via nSPV, it also adds skipcount to listunspent and listtransactions


[18-Jul-19 07:28 PM] dukeleto#7326
i was having some issues syncing that merge to the network, so I will try to merge the latest stuff


[18-Jul-19 10:07 PM] jl777c#5810
strange, it shouldnt change behavior of normal mode sync


[19-Jul-19 12:33 AM] grewalsatinder#9653
Hey @Slyris 
Hope you doing well.
How's the progress going with nSPV implementation with breadwallet-core library? üôÇ


[19-Jul-19 01:04 AM] Slyris#2880
Hello @grewalsatinder I'm not on this part actually, i was working on the dashboard (back-end) project


[19-Jul-19 01:10 AM] Slyris#2880
As I am a beginner in the `komodo ecosystem`. I preferred to look into a more accessible project for a start. Now that I understand the ecosystem better and better I will be able to do more interesting things. I think I still do not have the knowledge for `nSPV`


[19-Jul-19 01:28 AM] grewalsatinder#9653
@Slyris oh I guess then I tagged mistakenly you thinking you are the dev working on breadwallet-core library for nSPV üòÖ


[19-Jul-19 01:29 AM] grewalsatinder#9653
don't remember who was that dev, and wish to get an update on it.


[19-Jul-19 01:29 AM] grewalsatinder#9653
@jl777c


[19-Jul-19 01:29 AM] Slyris#2880
nSPV interest me a lot, I talk about being able to participate at the beginning, finally I work on something else with @ca333


[19-Jul-19 01:30 AM] grewalsatinder#9653
hmm.... okay... so it was you?


[19-Jul-19 01:30 AM] grewalsatinder#9653
any idea if anyone working on breadwallet-core library?


[19-Jul-19 01:30 AM] Slyris#2880
And I think it's better like that, I still do not have enough knowledge to work on features like nSPV currently.


[19-Jul-19 01:30 AM] Slyris#2880
I have no idea to be honest with you


[19-Jul-19 01:30 AM] grewalsatinder#9653
no problem mate. thanks for quick reply üëç


[19-Jul-19 01:30 AM] Slyris#2880
Your welcome


[19-Jul-19 01:30 AM] grewalsatinder#9653
glad you still found something else to work on here üòâ


[19-Jul-19 01:31 AM] Slyris#2880
Yeah, i will work litteraly my whole time on Komodo soon

{Reactions}
üëç (2) 

[19-Jul-19 01:31 AM] grewalsatinder#9653
very exciting!


[19-Jul-19 01:31 AM] Slyris#2880
Ahah yes, let's build the future.

{Reactions}
üíØ (2) ‚úÖ (2) 

[19-Jul-19 01:41 AM] jl777c#5810
@grewalsatinder i decided not to use breadwallet and am making libnspv


[19-Jul-19 01:41 AM] jl777c#5810
based on libbtc


[19-Jul-19 01:43 AM] jl777c#5810
libbtc has a headers only SPV client in it, which means it also does all the p2p messaging


[19-Jul-19 01:43 AM] jl777c#5810
and that is really all that is needed to connect to the komodo_nSPV files

{Reactions}
üëç (2) üòÉ (2) üòé (2) KMD (2) 

[19-Jul-19 01:47 AM] grewalsatinder#9653
oh perfect! I can trust it'll be top class work since you are on to it @jl777c 
Thanks for answering üòÉ


[19-Jul-19 09:38 AM] dukeleto#7326
@jl777c libnspv based on libbtc sounds lovely. Great idea. I think that will also make it easier to use on embedded devices


[19-Jul-19 09:43 AM] jl777c#5810
pure C nSPV superlite

{Reactions}
üòé 

[20-Jul-19 07:05 AM] jl777c#5810 (pinned)
@TonyL  @grewalsatinder @dukeleto @Slyris   @Mihailo    i made a new nSPV client based on libbtc, i call it libnspv and my jl777 branch has all but nspv_spend working. you need to use curl to invoke it and only NSPV, KMD and BTC are supported. it should work with the existing nSPV fullnodes. for BTC it will behave as libbtc does, ie. as a headers only SPV. i guess i will add ILN next so I can verify the notarizations functions are working. Other than having to use curl vs. cli, the overall functionality should be very close (identical?) to the nSPV=1 clients, just without any CCtx ability

it is 100% in C and stripped executable size is 250kb, i think mem usage is very small. also, it should build in both osx and windows, it uses autogen.sh and ./configure

known bugs are: peers need to be in the seedlist and blockhash calc is wrong, spend is not implemented yet. single rpc call at a time, api is just to allow testing. userpass or any other measures is absent

~/libnspv/src/tools/nSPV_testvectors has a bunch of curl calls for NSPV chain. just change the port to call another chain, you can add a "coin" field for error checking, but basically if the nspv gets a request it will assume it is for it.

{Reactions}
shexy (2) üëç (2) üëè (2) üòé KMD üî• 

[20-Jul-19 07:08 AM] Slyris#2880
@jl777c I'm looking the code of nSPV_superlite.h right now


[20-Jul-19 07:09 AM] jl777c#5810
the files in libnspv are based on the ones in komodo repo, but i had to make changes to make it happy with pure C


[20-Jul-19 07:13 AM] Slyris#2880
https://github.com/jl777/libnspv/blob/3c016b58de87db7bd248cd52eca4e8e277d08630/src/tools/nSPV_superlite.h#L72

{Embed}
https://github.com/jl777/libnspv/blob/3c016b58de87db7bd248cd52eca4e8e277d08630/src/tools/nSPV_superlite.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[20-Jul-19 07:13 AM] Slyris#2880
`==` ??


[20-Jul-19 07:13 AM] Slyris#2880
is this a mistake you want to do `=` no ?


[20-Jul-19 07:14 AM] Slyris#2880
@jl777c


[20-Jul-19 07:14 AM] jl777c#5810
yes! a bug, replicated many places. fixing


[20-Jul-19 07:15 AM] Slyris#2880
We are looking it with a friend that code in C


[20-Jul-19 07:15 AM] Slyris#2880
i will report more with him if we found


[20-Jul-19 07:17 AM] jl777c#5810
oh, to run NSPV chain, just do ./nspv


[20-Jul-19 07:17 AM] jl777c#5810
for any other coin, ./nspv COIN


[20-Jul-19 07:18 AM] Slyris#2880
im not sure but https://github.com/jl777/libnspv/blob/3c016b58de87db7bd248cd52eca4e8e277d08630/src/tools/nSPV_superlite.h#L266 you initialize a second time at 0 n no ?

{Embed}
https://github.com/jl777/libnspv/blob/3c016b58de87db7bd248cd52eca4e8e277d08630/src/tools/nSPV_superlite.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[20-Jul-19 07:18 AM] Slyris#2880
@Doom Hello


[20-Jul-19 07:18 AM] Doom#9021
Hey !


[20-Jul-19 07:18 AM] jl777c#5810
ILN supported now


[20-Jul-19 07:18 AM] Slyris#2880
Thank's for spotting the `==` @Doom


[20-Jul-19 07:19 AM] Doom#9021
No prob @Slyris ‚ù§


[20-Jul-19 07:19 AM] jl777c#5810
thanks!


[20-Jul-19 07:19 AM] jl777c#5810
in C, it is not initialized if just declared

{Reactions}
üëç 

[20-Jul-19 07:19 AM] Slyris#2880
```c
int32_t i,n,flag = 0;
```


[20-Jul-19 07:19 AM] Slyris#2880
It initialize only flag here ?


[20-Jul-19 07:20 AM] Slyris#2880
https://github.com/jl777/libnspv/blob/3c016b58de87db7bd248cd52eca4e8e277d08630/src/tools/nSPV_superlite.h#L262

{Embed}
https://github.com/jl777/libnspv/blob/3c016b58de87db7bd248cd52eca4e8e277d08630/src/tools/nSPV_superlite.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[20-Jul-19 07:20 AM] Doom#9021
Yep I think so


[20-Jul-19 07:20 AM] jl777c#5810
yes, only flag is initialized. the rest are whatever values from the stack


[20-Jul-19 07:20 AM] Slyris#2880
Oh i was not aware, i was sure the 3 variable was initialized to zero in this case


[20-Jul-19 07:21 AM] Doom#9021
But since `n` is only used inside the `if` block, maybe its declaration could be moved to that scope too


[20-Jul-19 07:21 AM] jl777c#5810
in C++ i think so


[20-Jul-19 07:21 AM] jl777c#5810
@Doom my style is to declare all locals at the top of the function. that way i can easily see the stack usage of each function


[20-Jul-19 07:22 AM] jl777c#5810
maybe it doesnt matter so much now, but i used to have to get code working with 4kb stack


[20-Jul-19 07:22 AM] Slyris#2880
cJSON is your library @jl777c  ?


[20-Jul-19 07:22 AM] jl777c#5810
dave gamble made it, but i added convenience functions to it


[20-Jul-19 07:22 AM] Slyris#2880
ok


[20-Jul-19 07:24 AM] Doom#9021
@jl777c Makes sense for embedded systems, maybe less so if your code runs on a regular computer :p


[20-Jul-19 07:25 AM] jl777c#5810
i found that code for embedded systems runs on desktops, but not the other way around


[20-Jul-19 07:25 AM] Doom#9021
That sure is true :p


[20-Jul-19 07:25 AM] jl777c#5810
by coding to embedded systems as much as possible, it allows maximum coverage


[20-Jul-19 07:25 AM] jl777c#5810
libnspv uses libevent and tcp/ip sockets as the only system dependencies other than a system clock


[20-Jul-19 07:26 AM] jl777c#5810
it uses no HDD


[20-Jul-19 07:26 AM] Doom#9021
However, defining the platform you write for and taking advantage of its features is interesting too


[20-Jul-19 07:26 AM] jl777c#5810
unless using legacy BTC


[20-Jul-19 07:26 AM] Doom#9021
Depends what your target is with this library !


[20-Jul-19 07:26 AM] jl777c#5810
i want it to run everywhere


[20-Jul-19 07:27 AM] Slyris#2880
i have a question about the usage of     `memset(spenttxidp,0,sizeof(*spenttxidp));`

Why not use bzero @jl777c  ?


[20-Jul-19 07:27 AM] Doom#9021
Then minimizing dependencies is indeed crucial


[20-Jul-19 07:27 AM] Slyris#2880
Is this better to use memset ?


[20-Jul-19 07:27 AM] Doom#9021
`bzero` is deprecated @Slyris


[20-Jul-19 07:27 AM] Slyris#2880
üòÆ


[20-Jul-19 07:27 AM] jl777c#5810
bzero is for strings?


[20-Jul-19 07:28 AM] jl777c#5810
memset and memcpy have worked for decades, why change?


[20-Jul-19 07:28 AM] jl777c#5810
memcmp too


[20-Jul-19 07:28 AM] Doom#9021
Nah `bzero` works with raw data too


[20-Jul-19 07:28 AM] Slyris#2880
memcmp is great


[20-Jul-19 07:28 AM] Doom#9021
But it's considered legacy / deprecated


[20-Jul-19 07:28 AM] Doom#9021
The `mem*` functions are pretty good and heavily optimized, so they are cool üòÉ


[20-Jul-19 07:29 AM] Slyris#2880
okok n o problem, i'm still looking


[20-Jul-19 07:32 AM] Slyris#2880
Should we review : https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h too @jl777c  ?

{Embed}
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[20-Jul-19 07:33 AM] jl777c#5810
that isnt quite done yet, still need to convert all the blockchain specific functions to libbtc internals


[20-Jul-19 07:34 AM] Doom#9021
If the memory footprint is to be considered, the `bool` type could be used sometimes


[20-Jul-19 07:34 AM] Slyris#2880
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h#L572 still one vector here

{Embed}
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[20-Jul-19 07:34 AM] Doom#9021
(Might change nothing sometimes because of alignment, but it's still a good practice)


[20-Jul-19 07:34 AM] jl777c#5810
yes, but those almost always get expanded to a byte


[20-Jul-19 07:35 AM] jl777c#5810
@Slyris that is inside #ifdef later


[20-Jul-19 07:35 AM] Doom#9021
(They are always expanded to a byte, but a byte is better than a double word :p)


[20-Jul-19 07:35 AM] jl777c#5810
i use uint8_t for all bools


[20-Jul-19 07:35 AM] Slyris#2880
Ah yeah


[20-Jul-19 07:35 AM] jl777c#5810
maybe sometimes i used an int32_t temporarily


[20-Jul-19 07:35 AM] jl777c#5810
i would use bitfields but those seem to cause cross platform issues


[20-Jul-19 07:36 AM] Doom#9021
Yep I saw a few `uint32_t`s that could be `bool`s


[20-Jul-19 07:36 AM] Doom#9021
Also, I think using the plain `bool` type would be easier on the eyes than using `uint8_t` :p


[20-Jul-19 07:36 AM] jl777c#5810
for now, style and minor stack usage issues are not critical, bugs like i == vs i = are!


[20-Jul-19 07:37 AM] Doom#9021
Sure !


[20-Jul-19 07:37 AM] Slyris#2880
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h#L190 str can be const here

{Embed}
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[20-Jul-19 07:38 AM] Slyris#2880
but not critical too


[20-Jul-19 07:38 AM] jl777c#5810
i have historically had many compiler battles with const and large codebases


[20-Jul-19 07:38 AM] jl777c#5810
i tend to not use const, even though readonly property is indeed very valuable to reduce memory overwrites


[20-Jul-19 07:38 AM] jl777c#5810
my solution is to not have any memory overwrite bugs üòÉ


[20-Jul-19 07:38 AM] Slyris#2880
Since is not critical ^^'


[20-Jul-19 07:39 AM] Slyris#2880
im supposing for function like: https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h#L169

you dont want to use `alnum()`

{Embed}
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_utils.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[20-Jul-19 07:39 AM] Slyris#2880
Because you dont want any extra include


[20-Jul-19 07:40 AM] Slyris#2880
that can increase compile time ?


[20-Jul-19 07:40 AM] jl777c#5810
the fewer external code the better


[20-Jul-19 07:40 AM] jl777c#5810
especially for simple things that are easy to just write from scratch


[20-Jul-19 07:41 AM] jl777c#5810
100% compatibility and no chance of ending up on a system that doesnt have it and having to then support dual ways of doing it


[20-Jul-19 07:41 AM] Slyris#2880
okok, i try to spot critical things so now


[20-Jul-19 07:42 AM] jl777c#5810
this is just 2 days old, so still very early in the cycle


[20-Jul-19 12:30 PM] grewalsatinder#9653
Thanks for tagging me James üòÉ


[20-Jul-19 12:30 PM] grewalsatinder#9653
I woild like to use this as a lib and make a golang wrapper around this lib, and use those in my go code.


[20-Jul-19 12:31 PM] grewalsatinder#9653
Will be cimeing here for help as I progress.  Been already keeping eye on git commits. Very exciting! üòÄ


[21-Jul-19 10:41 PM] jl777c#5810
got spend api working, along with notarization validation. just need to add the merkleproof check and it will be feature complete. as fast as the komodo nSPV=1 was, ./nspv is faster. it is instant to boot, login and you can spend within a few seconds


[21-Jul-19 10:45 PM] jl777c#5810
at the bottom of nSPV_superlite.h is the api parser where you can get the naming of all the JSON fields, the testvectors has examples of most all of them. even the mempool functions seem to work, so that means you can get realtime indications


[21-Jul-19 10:45 PM] jl777c#5810
it still uses a single threaded model, but all commands other than spend are pretty fast


[21-Jul-19 10:46 PM] jl777c#5810
during this port to libnspv, found several bugs which i also fixed on the komodo nSPV side


[21-Jul-19 10:47 PM] jl777c#5810
so we now have 2 nSPV superlite clients, one via nSPV=1 with komodod and one with ./nspv (KMD, ILN, NSPV)


[21-Jul-19 10:48 PM] jl777c#5810
i will add a way to get more coins than the fixed list supported later this week. would be nice to get a list of bugs to fix in both the nSPV clients. it feels almost beta quality already, but really needs others testing it than me. also osx and windows builds, they might even work


[21-Jul-19 10:50 PM] jl777c#5810
plz make issues in libnspv branch for any issue, even for the nSPV=1 mode in komodod


[21-Jul-19 10:53 PM] jl777c#5810
you should be able to run all the differnet ./nspv COIN in parallel. i dont have rpcport customization yet, but will also add that so you can run many nodes for the same coin on a single node. code size bloated to 300kb


[21-Jul-19 10:55 PM] jl777c#5810
time from git clone to autogen.sh, ./configure, make is about a minute


[21-Jul-19 11:11 PM] jl777c#5810
i have the 10 fullnodes running for KMD, ILN and NSPV. will be offline rest of the day

{Reactions}
üëç (3) üÜí (2) KMD (3) 

[22-Jul-19 02:49 AM] dukeleto#7326
Latest FSM merged into HUSH3 and it seems happy with all nSPV changes. I know that it's not enabled, but it's still a nice very light test of the nspv code


[22-Jul-19 02:49 AM] dukeleto#7326
`nLocalServices 70000005 1, 1`


[22-Jul-19 02:50 AM] dukeleto#7326
@jl777c i can't prove it, but i saw a few tiny changes to ccenable in the latest FSM merge, and I wonder if that had something to do with my sync issues before. In any case, everything is happy and HUSH3 is in sync with latest FSM


[22-Jul-19 03:27 AM] jl777c#5810
FSM has relatively recent nSPV, so it is active and nSPV clients would be able to work


[22-Jul-19 10:44 AM] jl777c#5810
@gcharang can you document the api calls for libnspv in superlite mode? most should be self explanatory, just clone my libnspv repo, automake.sh, configure, make, ./nspv KMD


[22-Jul-19 10:44 AM] jl777c#5810
README.md has some info at the bottom of page


[22-Jul-19 10:53 AM] jl777c#5810
@grewalsatinder can you run nspv on your computer and test to see if you can issue commands via browser


[22-Jul-19 10:54 AM] jl777c#5810
i think http://127.0.0.1:port/?{"method":"getinfo"}


[22-Jul-19 10:54 AM] jl777c#5810
it might work


[22-Jul-19 08:09 PM] gcharang#6833
@jl777c on it


[22-Jul-19 09:45 PM] grewalsatinder#9653
@jl777c awesome! will test and be back üôÇ üëç


[22-Jul-19 09:48 PM] grewalsatinder#9653
on Mac it failed to compile


[22-Jul-19 09:49 PM] grewalsatinder#9653
@jl777c https://pastebin.com/Y0DZysu9

{Embed}
https://pastebin.com/Y0DZysu9
Satinders-MBP:libnspv satinder$ ls -lh  total 272  -rw-r--r--   1 ...
https://images-ext-1.discordapp.net/external/lZwHlcJYEP_-CeL744a7RSWVnhrIifPJgiIcmKkDuJY/https/pastebin.com/i/facebook.png


[22-Jul-19 09:49 PM] grewalsatinder#9653
Mac compile log


[22-Jul-19 09:49 PM] grewalsatinder#9653
will test on linux in a bit


[22-Jul-19 10:32 PM] gcharang#6833
@jl777c @TonyL 
how to specify userpass to the nspv binary?


[22-Jul-19 11:18 PM] grewalsatinder#9653
@jl777c tested on linux. getinfo command worked perfect! üòÉ


[22-Jul-19 11:25 PM] grewalsatinder#9653
tested login with wif, works.... still testing


[23-Jul-19 12:37 AM] jl777c#5810
install libsodium


[23-Jul-19 12:37 AM] jl777c#5810
that is what the error says


[23-Jul-19 12:37 AM] jl777c#5810
userpass is not implemented yet


[23-Jul-19 12:38 AM] jl777c#5810
so from browser you can issue commands?


[23-Jul-19 12:38 AM] jl777c#5810
i guess a simple test page with forms and buttons is possible?


[23-Jul-19 12:39 AM] jl777c#5810
i can then return that content from http://127.0.0.1:1233


[23-Jul-19 12:39 AM] jl777c#5810
or whatever the port is

{Reactions}
‚úÖ üíØ 

[23-Jul-19 05:54 AM] grewalsatinder#9653
@jl777c which branch should I be using on Mac?


[23-Jul-19 05:54 AM] grewalsatinder#9653
jl777 branch or beta ?


[23-Jul-19 05:55 AM] jl777c#5810
maybe we do things in dev?


[23-Jul-19 05:55 AM] grewalsatinder#9653
no, I'm trying to just compile libnspv on Mac again


[23-Jul-19 05:55 AM] grewalsatinder#9653
installed libsodium


[23-Jul-19 05:56 AM] jl777c#5810
all branches are pretty much in sync


[23-Jul-19 05:57 AM] grewalsatinder#9653
okay


[23-Jul-19 05:57 AM] jl777c#5810
jl777 is bleeding edge


[23-Jul-19 05:57 AM] grewalsatinder#9653
gonna try compiling dev branch


[23-Jul-19 05:57 AM] jl777c#5810
the others are snapshots of what seems to be stable


[23-Jul-19 06:00 AM] grewalsatinder#9653
cool! yes, it works perfectly fine on Mac as well. compiled dev branch and issued getinfo command  for KMD to confirm it works fine.


[23-Jul-19 06:00 AM] grewalsatinder#9653
will continue in the morning.


[23-Jul-19 06:01 AM] grewalsatinder#9653
thanks for help üôÇ üëç


[23-Jul-19 06:07 AM] jl777c#5810
can anybody try to build on windows?


[23-Jul-19 06:26 AM] dukeleto#7326
Can somebody explain how an existing chain like HUSH3 can start to use/test nSPV stuff? Is there a newbie guide? I have been trying to keep up, but I have failed


[23-Jul-19 06:30 AM] jl777c#5810
start with the README.md


[23-Jul-19 06:30 AM] dukeleto#7326
in which repo? :abusedsmily:


[23-Jul-19 06:31 AM] jl777c#5810
it should have all info needed to bootstrap a new nSPV nodes


[23-Jul-19 06:31 AM] jl777c#5810
libnspv repo


[23-Jul-19 06:31 AM] dukeleto#7326
https://github.com/jl777/libnspv

{Embed}
https://github.com/jl777/libnspv
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[23-Jul-19 06:31 AM] jl777c#5810
@grewalsatinder please rebuild osx version with latest dev branch, i tried to fix all the warnings


[23-Jul-19 06:33 AM] dukeleto#7326
is enabling nSPV on an existing mainnet a consensus change?


[23-Jul-19 06:34 AM] jl777c#5810
no


[23-Jul-19 06:34 AM] jl777c#5810
you need at least one nSPV fullnode


[23-Jul-19 06:34 AM] jl777c#5810
you can use that one as a seednode


[23-Jul-19 06:34 AM] jl777c#5810
update the coins file appropriately and then ./nspv HUSH3 will be a superlite client


[23-Jul-19 06:35 AM] jl777c#5810
~/src/tools/testvectors shows how to submit api requests


[23-Jul-19 06:35 AM] jl777c#5810
it is quite a simple model: login, spend, broadcast


[23-Jul-19 06:36 AM] jl777c#5810
with getinfo, listunpent being useful


[23-Jul-19 06:36 AM] jl777c#5810
also getnewaddress


[23-Jul-19 06:43 AM] dukeleto#7326
@jl777c thank you, that explains a lot. Very excited for HUSH to spread the good word of nSPV


[23-Jul-19 06:44 AM] dukeleto#7326
I think it's pretty amazing that it's not a consensus change, and that means adoption will come very fast

{Reactions}
üí™ 

[23-Jul-19 06:50 AM] jl777c#5810
just run a few nodes with FSM branch, use them as the "nSPV":"<ipaddr>, ..." in the coins file


[23-Jul-19 06:51 AM] jl777c#5810
then nSPV client can "login" and spend funds in seconds


[23-Jul-19 06:51 AM] jl777c#5810
you can even make requests via http://127.0.0.1:port/?{"method":"getinfo"}


[23-Jul-19 06:51 AM] jl777c#5810
in the browser


[24-Jul-19 12:10 AM] gcharang#6833
as port 20267 was used in the testvectors file, I thought that was the default port
started it like this to make it work with that port
```
./nspv KMD -p 20267
```


[24-Jul-19 12:10 AM] jl777c#5810
the port is whatever the port is


[24-Jul-19 12:11 AM] jl777c#5810
each coin has a default rpc port


[24-Jul-19 12:11 AM] jl777c#5810
the testvectors are mostly for NSPV chain, some for ILN


[24-Jul-19 12:11 AM] jl777c#5810
use 7771 for KMD


[24-Jul-19 12:12 AM] gcharang#6833
got it


[24-Jul-19 12:13 AM] jl777c#5810
i also changed the default chain to be KMD


[24-Jul-19 12:13 AM] jl777c#5810
but that is not in all branches yet


[24-Jul-19 12:17 AM] Slyris#2880
Hello


[24-Jul-19 12:18 AM] Slyris#2880
Still following the advancement, great job @jl777c what are the next steps ?


[24-Jul-19 12:19 AM] jl777c#5810
it is basically feature complete, just waiting on the merkleproof code from dimxy. i guess to make sure it builds on windows and bug fixing, though not heard of any bugs yet


[24-Jul-19 12:20 AM] jl777c#5810
i want to make a dynamically generated static html wallet, basically the nspv executable would generate html to reflect the current state and allow basic operations, but i need html templates to use


[24-Jul-19 12:22 AM] jl777c#5810
and documentations


[24-Jul-19 12:22 AM] Slyris#2880
Ok great !


[24-Jul-19 12:22 AM] Slyris#2880
Sound's really great


[24-Jul-19 12:22 AM] jl777c#5810
it seems ready to use, so little code and only dependencies are libevent and libsodium


[24-Jul-19 12:22 AM] Slyris#2880
Do you have bench any performance yet ?


[24-Jul-19 12:22 AM] Slyris#2880
Libsodium work on windows ?


[24-Jul-19 12:22 AM] jl777c#5810
99% of time depends on how long it takes for network response


[24-Jul-19 12:23 AM] jl777c#5810
so performance depends on network connections and the fullnodes you connect to


[24-Jul-19 12:23 AM] Slyris#2880
It's mingw by the way I hope it's will work well


[24-Jul-19 12:23 AM] jl777c#5810
oh, also need to figure out how to dynamically add peers. i have a list of new peers but havent figured out how to make it active


[24-Jul-19 01:33 AM] smkhound#7640
Can someone pls confirm syntax for nspv in browser? I'm getting expected result in console, but browser returns `{"error":"no method"}`


[24-Jul-19 01:33 AM] smkhound#7640

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603505096579350538/unknown.png


[24-Jul-19 01:47 AM] TonyL#3577
What tool is it for browser?


[24-Jul-19 01:49 AM] jl777c#5810
http://127.0.0.1:12345/?{"method":"getinfo"}


[24-Jul-19 01:50 AM] jl777c#5810
just construct url with http://... i guess you can make bookmarks or a simple html page


[24-Jul-19 01:50 AM] jl777c#5810
using static html without javascript should be quite secure to 127.0.0.1


[24-Jul-19 01:53 AM] jl777c#5810
let me know if it works


[24-Jul-19 01:56 AM] gcharang#6833
@jl777c the exact url you have posted (with the port corrected)
gives

Chrome:
```
This page isn‚Äôt working 
127.0.0.1 sent an invalid response.
ERR_INVALID_HTTP_RESPONSE
```

Firefox:
```
{"error":"no method"}
```


[24-Jul-19 01:58 AM] jl777c#5810
you used the right port for the nspv running?


[24-Jul-19 01:58 AM] gcharang#6833
yes


[24-Jul-19 01:59 AM] jl777c#5810
@grewalsatinder said it worked for him


[24-Jul-19 02:06 AM] smkhound#7640
I'm using firefox, sill getting no method error.  Console debugger says maybe char encoding err.

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603513300629716992/unknown.png


[24-Jul-19 02:06 AM] smkhound#7640
wil try opera


[24-Jul-19 02:09 AM] jl777c#5810
maybe use {


[24-Jul-19 02:09 AM] jl777c#5810
instead of %7B


[24-Jul-19 02:10 AM] jl777c#5810
i might need to return some html headers info


[24-Jul-19 02:15 AM] jl777c#5810
http://127.0.0.1:12345/api/?%7B%22method%22:%22getinfo%22%7D


[24-Jul-19 02:15 AM] jl777c#5810
try that


[24-Jul-19 02:16 AM] smkhound#7640
still no mothdo ü§∑üèº 
addressbar seems to transalate to { } automatically, headers sounds like whats needed.
I might change track and see how it goes via django + html templates


[24-Jul-19 02:17 AM] jl777c#5810
its just returning raw json, if you add /api it should return a header saying it is returning json


[24-Jul-19 02:19 AM] smkhound#7640

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603516597159854090/unknown.png


[24-Jul-19 02:20 AM] jl777c#5810
what about without the ?


[24-Jul-19 02:20 AM] smkhound#7640
same


[24-Jul-19 02:22 AM] jl777c#5810
/api/getinfo


[24-Jul-19 02:22 AM] jl777c#5810
/api/method/getinfo

{Reactions}
üëç (2) 

[24-Jul-19 02:22 AM] gcharang#6833
/api/method/getinfo works


[24-Jul-19 02:22 AM] smkhound#7640
beaut, got a winner üòÉ


[24-Jul-19 02:23 AM] jl777c#5810
ok, so it is a matter to construct the right way for the args


[24-Jul-19 02:23 AM] jl777c#5810
i think args can be added with ? & syntax


[24-Jul-19 02:23 AM] smkhound#7640
http://127.0.0.1:7771/api/method/getinfo/height/777 
returns result


[24-Jul-19 02:24 AM] jl777c#5810
its been years since i did this code, i think there are many ways to get the params into the api processor


[24-Jul-19 02:24 AM] jl777c#5810
after method, pairs of height/777 will make key:value for the json


[24-Jul-19 02:25 AM] jl777c#5810
ultimately it is all converted to a JSON request that is the same as via curl


[24-Jul-19 02:25 AM] jl777c#5810
at least we can now have browser based interactions with nSPV api


[24-Jul-19 02:25 AM] jl777c#5810
so run ./nspv, click a bunch of localhost urls to do wallet functions


[24-Jul-19 02:25 AM] smkhound#7640
http://127.0.0.1:7771/api/method/login/wif/UrJUbSqsb1chYxmQvScdnNhVc2tEJEBDUPMcxCCtgoUYuvyvLKvB üëçüèº


[24-Jul-19 02:26 AM] smkhound#7640
```{"result":"success","status":"wif will expire in 777 seconds","address":"RYPzyuLXdT9JYn7pemYaX3ytsY3btyaATY","pubkey":"03e2619d87be65ea2488ad4ad2658853b06cf4a400ca1cb039e65b73709cd3b634","wifprefix":188,"compressed":1}
```


[24-Jul-19 02:27 AM] jl777c#5810
it seems almost too easy


[24-Jul-19 02:27 AM] jl777c#5810
i guess we want to clear browser history

{Reactions}
üíØ 

[24-Jul-19 02:28 AM] smkhound#7640
cant trust the cookies


[24-Jul-19 02:28 AM] jl777c#5810
if there is a way to use POST to do the api request, it avoids the problem


[24-Jul-19 02:29 AM] smkhound#7640
I'll work on doing via django form, that'll post to python and allow for soem gui tempating


[24-Jul-19 05:22 AM] dukeleto#7326
yes, POSTing data will prevent it from appearing in any local caches, good idea


[24-Jul-19 07:12 AM] dukeleto#7326
Looking for alpha-testers for nSPV + HUSH, and will pay bounties for testing/etc. I figure most people interested are in this room. Later today I will post details of public HUSH nSPV servers that can be used. I would also be interested in HUSH spearheading the writing of more tests + docs for nSPV, and HUSH can provide bounties in additional to any other projects that might want to


[24-Jul-19 09:27 AM] allbits#5898
Any use if a cli noob helps test. I'm not looking for bounties, just fun


[24-Jul-19 09:28 AM] allbits#5898
I already did a bit of nspv with komodo


[24-Jul-19 09:44 AM] jl777c#5810
sure


[24-Jul-19 09:44 AM] jl777c#5810
you get to use curl, or form 127.0.0.1 url


[24-Jul-19 09:44 AM] jl777c#5810
just updated to a new nSPV protocol that supports more CC


[24-Jul-19 09:44 AM] jl777c#5810
libnspv doesnt support CC, but it needs to match the fullnode side to be compatible


[24-Jul-19 09:45 AM] jl777c#5810
also now all validations are active and it is indeed properly validating the merkleproof for the utxo txid


[24-Jul-19 09:45 AM] jl777c#5810
@dukeleto @SHossain you need to update


[24-Jul-19 09:46 AM] jl777c#5810
i think with the merkle proof implemented along with a decent number of CC, the core protocol should stabilize, so i hope there wont be (m)any more protocol changes


[24-Jul-19 09:47 AM] jl777c#5810
the nSPV code is limited to the nSPV, jl777 and FSM branches for komodod


[24-Jul-19 11:04 AM] dukeleto#7326
thanks, latest `FSM` branch is merged into HUSH `duke` branch


[24-Jul-19 11:05 AM] jl777c#5810
the browser REST like interface is working, so this will be a very easy way to install a wallet


[24-Jul-19 11:05 AM] jl777c#5810
just run nspv and open a local page with localhost url


[24-Jul-19 11:06 AM] jl777c#5810
and if the html has no javascript, the it should be as secure as a cli wallet as traffic to 127.0.0.1 does not go to the network


[24-Jul-19 11:07 AM] jl777c#5810
just need to POST any wif and/or clear browser history


[24-Jul-19 11:08 AM] jl777c#5810
0.0% CPU 3.1MB


[24-Jul-19 11:09 AM] jl777c#5810
so 300x nspv processes per GB of RAM, literally thousands of instances per node would be possible


[24-Jul-19 11:09 AM] dukeleto#7326
pretty amazing


[24-Jul-19 11:09 AM] jl777c#5810
i have a feeling nspv will open up some new possibilities


[24-Jul-19 11:09 AM] jl777c#5810
it also might even work on a 32 bit CPU


[24-Jul-19 11:10 AM] jl777c#5810
or even 16 bit, as long as the int64_t type is supported


[24-Jul-19 11:10 AM] dukeleto#7326
nSPV brings superlite wallets to some very resource-constrained devices


[24-Jul-19 11:10 AM] dukeleto#7326
fascinating stuff


[24-Jul-19 12:17 PM] allbits#5898
What should I be downloading to test hush nspv?


[24-Jul-19 12:31 PM] jl777c#5810
best to start with KMD


[24-Jul-19 12:31 PM] jl777c#5810
clone my nspv repo


[24-Jul-19 12:32 PM] jl777c#5810
./autogen.sh


[24-Jul-19 12:32 PM] jl777c#5810
./configure


[24-Jul-19 12:32 PM] jl777c#5810
make


[24-Jul-19 12:32 PM] jl777c#5810
./nspv


[24-Jul-19 12:32 PM] jl777c#5810
now you can issue curl commands as in ~/src/tools/testvectors


[24-Jul-19 12:34 PM] allbits#5898
K. I'll look at this when I get back to keyboard. Open to stupid noob questions when I do?


[24-Jul-19 12:41 PM] jl777c#5810
of course


[24-Jul-19 01:38 PM] CMaurice#1685
compiled and working on sid with libevent-dev and libsodium-dev `curl --url "http://127.0.0.1:7771" --data "{\"userpass\":\"$userpass\",\"method\":\"stop\"}"
{"result":"success"}` is as far as I got


[24-Jul-19 01:46 PM] Deleted User#0000
https://github.com/blackjok3rtt/libnspv/commit/a0b3ab38313a697110111ad2b7311d86c74d7e4f
Peer propagation seems to work, but not sure if it may break somehthing else. Had to filter already known IPs otherwise it just filled it with dupes.

{Embed}
https://github.com/blackjok3rtt/libnspv/commit/a0b3ab38313a697110111ad2b7311d86c74d7e4f
peer propagation ¬∑ blackjok3rtt/libnspv@a0b3ab3
https://images-ext-2.discordapp.net/external/lu64DQK93KlyiFHOc2R5yqOF7xkNx4h_y9OO2TTLCZA/%3Fs%3D200%26v%3D4/https/avatars1.githubusercontent.com/u/30971146

{Reactions}
üëç 

[24-Jul-19 02:03 PM] CMaurice#1685
got a nice address: RMWd232338H1fumQEwshs4MdEuEFMwHack


[24-Jul-19 05:31 PM] Deleted User#0000
So far this KMD superlite is working as expected except for this error: 
```NSPV_txextract btc_tx_deserialize error datalen.0
couldnt find txid.xxxxxx/v0 or it was spent retcode.-1
```
Its not spent. Seems a bug.


[24-Jul-19 08:55 PM] Deleted User#0000
https://github.com/jl777/libnspv/pull/17/files
fixed it it seems. üòÑ

{Embed}
https://github.com/jl777/libnspv/pull/17/files
getpeerinfo and automatic peer propagation  by blackjok3rtt ¬∑ Pul...
https://images-ext-2.discordapp.net/external/H9TDr69kM7mmxGBcENY3FInyORgkC6up-3NZ7sRUihU/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/30971146


[24-Jul-19 08:57 PM] Deleted User#0000
Will be quite a bit of work to add CC tx to this, but I think it can be done without that much effort.


[24-Jul-19 10:05 PM] TonyL#3577
Pinned a message.


[24-Jul-19 10:14 PM] jl777c#5810
error datalen.0


[24-Jul-19 10:14 PM] TonyL#3577 (pinned)
To start use libnspv:
```git clone https://github.com/jl777/libnspv
cd libnspv
./autogen.sh
./configure
make
./nspv
now you can issue curl commands as in ~/src/tools/nSPV_testvectors```


[24-Jul-19 10:14 PM] TonyL#3577
Pinned a message.


[24-Jul-19 10:14 PM] jl777c#5810
a timeout would create no data, error message is just not accurate

{Reactions}
üëå 

[24-Jul-19 10:22 PM] jl777c#5810
@Deleted User nice PR! dynamic peers, getpeerinfo and a bugfix for my opreturn extract!


[24-Jul-19 10:22 PM] Deleted User#0000
Yes I surprised myself, getting it done so fast. üòÉ Long day though.

{Reactions}
rum 

[24-Jul-19 10:23 PM] jl777c#5810
all in C, no magic


[24-Jul-19 10:23 PM] jl777c#5810
makes it easy to get to the bottom of things


[24-Jul-19 10:23 PM] Deleted User#0000
That slowed me down a fair bit, some crazy pointers used in there to get the duplicate peer fitler to work.


[24-Jul-19 10:24 PM] jl777c#5810
better than buried in some template for a class for some data type that isnt even clear what structure it has


[24-Jul-19 10:25 PM] Deleted User#0000
This is true, I had to use libevent code to get the correct structures.


[24-Jul-19 10:25 PM] jl777c#5810
anyway, as you see, it is very easy to add new api, so feel free to port over whatever is useful from iguana as i want to use libnspv as the codebase for useful crypto things


[24-Jul-19 10:26 PM] jl777c#5810
next step is to get a html wallet, but only using static html and having nspv dynamically generate it. that was there is no attack surface outside of nspv


[24-Jul-19 10:26 PM] jl777c#5810
mihailo is adding CC support to the komodod -nSPV=1 and it seems most all can be ported, but that is indeed a lot of custom tx construction


[24-Jul-19 10:26 PM] jl777c#5810
still for a specific CC, it wouldnt be that much work to add nspv support for it


[24-Jul-19 10:27 PM] jl777c#5810
unless it needs a lot of blockchain data


[24-Jul-19 10:27 PM] Deleted User#0000
Yes, my idea was to just make a seperate libnspv for each contract. Hopefully get the lotto thing I made for LABS working with nSPV in new few weeks


[24-Jul-19 10:27 PM] jl777c#5810
the trick to solve that was to add fullnode p2p message support for getting the data more efficiently


[24-Jul-19 10:27 PM] Deleted User#0000
Although that pulls thousands of utxos for the first validation ü§î


[24-Jul-19 10:28 PM] jl777c#5810
can just make a new api function with the tx construction. nspv does not have to validate


[24-Jul-19 10:29 PM] jl777c#5810
listunspent/listtransactions got a new "filter" parameter that can be used to have the fullnode filter out the big list of unspents/txids and return only what fits. it is 32 bits total and i think 16bits might be allocated already


[24-Jul-19 10:29 PM] jl777c#5810
on the build side, i think it works in osx now. also windows and even 32 bit CPU might work


[24-Jul-19 10:30 PM] Deleted User#0000
Could always moce those heavy calls to a full node?


[24-Jul-19 10:30 PM] Deleted User#0000
or that is not practical?


[24-Jul-19 10:30 PM] jl777c#5810
yes, can always add a new p2p message


[24-Jul-19 10:31 PM] jl777c#5810
that does require defining the structure (request and response), (de)serializer, issuing, global results and the message handling and the actual function that does it,


[24-Jul-19 10:31 PM] jl777c#5810
all the existing messages follow the same pattern, so it shouldnt be too hard to figureout (after you are having the sleep)


[24-Jul-19 10:32 PM] Deleted User#0000
yes üòÉ very much needed.


[24-Jul-19 10:32 PM] jl777c#5810
it is a "hardfork", so if any new messages are needed, sooner is better than after it spreads to the wild


[24-Jul-19 10:32 PM] jl777c#5810
can have differentl level of fullmodes via the NODE_NSPV nService bits


[24-Jul-19 10:32 PM] jl777c#5810
anyway, great work!


[24-Jul-19 10:33 PM] jl777c#5810
you are up to speed on nspv


[24-Jul-19 10:33 PM] Deleted User#0000
In 1 day üòÑ


[24-Jul-19 10:33 PM] jl777c#5810
it is 300kb of code total, just the pure essentials for doing transaction


[24-Jul-19 10:34 PM] jl777c#5810
borrowed heavily from iguana though


[24-Jul-19 10:34 PM] Deleted User#0000
Its really nice i like it. Simple and eas to follow, as long as you understand pointers


[24-Jul-19 10:34 PM] jl777c#5810
sort of the new iguana


[24-Jul-19 10:34 PM] jl777c#5810
it is C, and assumed you understand pointers


[24-Jul-19 10:34 PM] jl777c#5810
but yes, mosts coders i guess are afraid of them


[24-Jul-19 10:35 PM] jl777c#5810
but use them indirectly and then cant figure out what is going on as they dont understand what is actually happening


[24-Jul-19 10:36 PM] Deleted User#0000
yep, üòÉ well I should get some rest. Let all this information sink in before I forget it


[24-Jul-19 11:30 PM] Slyris#2880
@jl777c C pointers are not that hard.


[24-Jul-19 11:30 PM] Slyris#2880
But yeah for novices sometimes it's can make you afraid


[25-Jul-19 12:25 AM] Deleted User#0000
@Slyris  
`if ( memcmp(&((struct sockaddr_in*)&existing_node->addr)->sin_addr, &((struct sockaddr_in*)&node->addr)->sin_addr, sizeof(&((struct sockaddr_in*)&existing_node->addr)->sin_addr)) == 0 ) ` I was reffering to this line in particular. Took me a while to get that right üòÖ


[25-Jul-19 12:26 AM] Slyris#2880
yeah common c stuffs which are boring to read i agree with you


[25-Jul-19 12:27 AM] Slyris#2880
which just mean i compare the memory of two pointers with the size of this pointer.


[25-Jul-19 12:42 AM] gcharang#6833
I am not able to broadcast this hex
```bash
curl --url "http://127.0.0.1:7771" --data "{\"userpass\":\"$userpass\",\"method\":\"broadcast\",\"hex\":\"0400008085202f890155c894ada147bf184bb7dff790ca429e6860775d3bb471dc0f69a28f080977e0010000006a473044022074796d0391cda193a75960e0107c2884919e669091e280efa29290ca7a411ec1022032545e6728a8c15855f12f692a85cec0e8ebee138051118d28f29fde79f4dea901210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ffffffff0280969800000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88acc842620b0000000023210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ac6a5e385d000000000000000000000000000000\"}"
```
response:
```json
{"result":"success","expected":"4fc9c5835817dc859e2f8daf829e3b307ceaf27778bea2cc5905adb01348afc8","broadcast":"0000000000000000000000000000000000000000000000000000000000000000","retcode":-2,"type":"timeout","lastpeer":"nodeid.1"}
```


[25-Jul-19 01:22 AM] Deleted User#0000
Seems a timeout? I think we wil need some extra error handling added for this in future. Did it work if you try again?


[25-Jul-19 01:28 AM] gcharang#6833
I've tried many times
it didn't work at all @Deleted User


[25-Jul-19 01:46 AM] Deleted User#0000
on KMD?


[25-Jul-19 01:47 AM] Deleted User#0000
Could be plenty of things, other calls work? Just not broadcast? I didnt actually test sending anything just the building txns


[25-Jul-19 02:16 AM] jl777c#5810
@gcharang have you documented both the nSPV=1 for komodod and nspv?
nSPV=1 if added to the standard komodod puts it in nSPV superlite mode. it can also do most of the CC tx


[25-Jul-19 02:17 AM] jl777c#5810
with nspv you specify the coin. it currently doesnt have a cli (though somebody could write such a program without much trouble)


[25-Jul-19 02:17 AM] jl777c#5810
curl of the JSON is one way


[25-Jul-19 02:17 AM] jl777c#5810
http GET via url construction http://127.0.0.1:8901/method/getinfo


[25-Jul-19 02:18 AM] jl777c#5810
another way is POST, but not sure how to do that via browser


[25-Jul-19 02:18 AM] jl777c#5810
i am also adding a json 2.0 compatible way of having a "params":[] array with the arguments inside it


[25-Jul-19 02:19 AM] jl777c#5810
and i think all the different ways needs to have specific examples to make it easy.  i heard using params array there are many existing tools to issue the api requests


[25-Jul-19 02:19 AM] jl777c#5810
also a few details that might not be apparent. for txproof if you dont pass in the height, it wont return the merkleproof, but just the rawtx, so it is like getrawtransaction


[25-Jul-19 02:20 AM] jl777c#5810
list commands (unspent transactions) have a skipcount that lets you skip the first n entries, but it will always return the last entry, so it is an easy way to see if any new funds came in and confirmed, ie wait for the most recent utxo to change


[25-Jul-19 02:22 AM] jl777c#5810
it also has a new filter field, which will be used to filter the list using filter specific defined values. this is to allow efficient support for CC tx creation that often has to search through many tx. also there is a CCflag that specifies whether you are looking for a CC address or a normal (p2pk, p2pkh, p2sh) address


[25-Jul-19 02:22 AM] jl777c#5810
new mempool functions exist which range from returning the entire mempool, but also able to have a subset matching search parameters returned. please ask if anything is unclear


[25-Jul-19 02:23 AM] jl777c#5810
@Deleted User i think having an api call that exposes the internal gettransaction is a good new api to add as that will allow to get the specific retcode for that utxo. 0 means it is notarized, many errors possible during the notarization validation

{Reactions}
üëç 

[25-Jul-19 02:28 AM] jl777c#5810
@Bryan_Beus not sure about your workload, but nspv has come a long ways pretty quick and is close to being beta, so getting it properly documented seems a good idea. focus on rapid integration to anything that wants to securely connect to any of the ecosystem coin networks directly and do transactions, or just get explorer level data


[25-Jul-19 02:29 AM] gcharang#6833
I am working on documenting the libnspv


[25-Jul-19 02:30 AM] jl777c#5810
most all of the functionality is the same with nSPV=1, so it might make sense to document them both with the same? just have a section on how to use each one, which is where the main difference is


[25-Jul-19 02:44 AM] gcharang#6833
@jl777c I will reuse the content
but I think documenting them "komodod -nspv=1" and "./nspv" seperately is better

for komodod it will go along with the komodo-api
for libnspv, installation is different and command names are different so, having a seperate space for it makes things easier


[25-Jul-19 02:45 AM] jl777c#5810
-nSPV=1 not -nspv

{Reactions}
üëç 

[25-Jul-19 02:45 AM] jl777c#5810
ok, separate is fine, you know best the way to document


[25-Jul-19 02:47 AM] gcharang#6833
I am not able to broadcast this hex
```
curl --url "http://127.0.0.1:7771" --data "{\"userpass\":\"$userpass\",\"method\":\"broadcast\",\"hex\":\"0400008085202f890155c894ada147bf184bb7dff790ca429e6860775d3bb471dc0f69a28f080977e0010000006a473044022074796d0391cda193a75960e0107c2884919e669091e280efa29290ca7a411ec1022032545e6728a8c15855f12f692a85cec0e8ebee138051118d28f29fde79f4dea901210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ffffffff0280969800000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88acc842620b0000000023210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ac6a5e385d000000000000000000000000000000\"}"
```
response:
```
{"result":"success","expected":"4fc9c5835817dc859e2f8daf829e3b307ceaf27778bea2cc5905adb01348afc8","broadcast":"0000000000000000000000000000000000000000000000000000000000000000","retcode":-2,"type":"timeout","lastpeer":"nodeid.1"}
```

@jl777c any idea why this could be happening?
I am using the libnspv repo 
master branch
for the KMD coin
rest of the calls are working


[25-Jul-19 02:57 AM] Deleted User#0000
master may not be right, I was using jl777 branch, and make my PR to dev.


[25-Jul-19 03:01 AM] jl777c#5810
problem is tx is too big. currently it seems it only supports <254 byte tx. needs to be fixed

{Reactions}
üëå üëç 

[25-Jul-19 03:07 AM] gcharang#6833
@jl777c 
```bash
curl --url "http://127.0.0.1:7771" --data "{\"userpass\":\"$userpass\",\"method\":\"broadcast\",\"hex\":\"0400008085202f890155c894ada147bf184bb7dff790ca429e6860775d3bb471dc0f69a28f080977e00100000000ffffffff0200e1f505000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88ac48f804060000000023210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ac807b395d000000000000000000000000000000\"}"
```
```json
{"result":"success","expected":"2015d49eda9dfb1986c9f3e434af0f140c0b1aea2b0fe34a7fd94fa6579f8466","broadcast":"2015d49eda9dfb1986c9f3e434af0f140c0b1aea2b0fe34a7fd94fa6579f8466","retcode":-3,"type":"error adding to mempool","lastpeer":"nodeid.1"}
```
jl777 branch
KMD coin


[25-Jul-19 03:09 AM] jl777c#5810
are all inputs unspent?


[25-Jul-19 03:10 AM] gcharang#6833
yes
I just created the hex using the spend rpc
this is the address: https://kmdexplorer.io/address/RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb
last txn was 3 days back


[25-Jul-19 03:12 AM] jl777c#5810
please decode it


[25-Jul-19 03:12 AM] jl777c#5810
look at the scriptSig


[25-Jul-19 03:12 AM] jl777c#5810
notice you have no signature


[25-Jul-19 03:13 AM] jl777c#5810
what was the response when you did the spend api


[25-Jul-19 03:13 AM] jl777c#5810
what retcodes


[25-Jul-19 03:14 AM] gcharang#6833
```json
{
  "rewards": "0.00000000",
  "validated": "0.00000000",
  "tx": {
    "nVersion": 4,
    "vin": [
      {
        "txid": "e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855",
        "vout": 1,
        "scriptSig": "",
        "sequenceid": 4294967295
      }
    ],
    "vout": [
      {
        "value": 1,
        "scriptPubKey": "76a9144726f2838fc4d6ac66615e10604e18926e9b556e88ac"
      },
      {
        "value": 1.00989,
        "scriptPubKey": "210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ac"
      }
    ],
    "nLockTime": 1564048346,
    "nExpiryHeight": 0,
    "valueBalance": 0
  },
  "result": "success",
  "hex": "0400008085202f890155c894ada147bf184bb7dff790ca429e6860775d3bb471dc0f69a28f080977e00100000000ffffffff0200e1f505000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88ac48f804060000000023210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06acda7b395d000000000000000000000000000000",
  "retcodes": [-1],
  "lastpeer": "nodeid.1"
}
```


[25-Jul-19 03:14 AM] gcharang#6833
retcode -1


[25-Jul-19 03:14 AM] Deleted User#0000
You need the stdout prints just before it gave you that, I saw the same problem randomly.


[25-Jul-19 03:14 AM] Deleted User#0000
Wasnt able to isolate it and put it down to bad full nodes


[25-Jul-19 03:15 AM] gcharang#6833
do I need to sign the hex using another rpc?


[25-Jul-19 03:17 AM] Deleted User#0000
no its bugged out

{Reactions}
üëç 

[25-Jul-19 03:17 AM] Deleted User#0000
I found restarting enough times eventually made it work for me.


[25-Jul-19 03:17 AM] gcharang#6833
```
got broadcast response 1564049787 size.37 2015d49eda9dfb1986c9f3e434af0f140c0b1aea2b0fe34a7fd94fa6579f8466 retcode.-3
```
this is the stdout print when when I broadcast the txn that gives retcode -3


[25-Jul-19 03:17 AM] Deleted User#0000
Its not the broadcast thats failing but the creation of the tx


[25-Jul-19 03:18 AM] gcharang#6833
aha ok


[25-Jul-19 03:22 AM] gcharang#6833
I used the spend rpc again
stdout:
```
ADD CACHE txproof e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855
got txproof response 1564049904 size.1956 e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855 ht.1453881
ADD CACHE ntzsresp req.1453881
got ntzs response 1564049905 size.213 d1cb409da9df970f6d76772949b95bf0426669c4302a02ec1fa293b5dbd37e61 prev.1453860, 073badddc89d1dba8d63f83a62d3a1b838b56f95451f9ab579d81f192910f2a4 next.1453890
>>>>> gettx ht.1453881 prev.1453860 next.1453890
got ntzproof response 1564049910 size.49363 prev.1453860 next.1453890
 ntzht.1453890 09972e40397716f1b10391461fec47ae3fb15f30e0a9cfa02f6a0a8329fc0e92 <- size.74
got ntzproof response 1564049911 size.49363 prev.1453860 next.1453890
 ntzht.1453860 06d3e950d67a605eb34f19c2bb78712db60da7277685284d8fa25c6465c3f7a4 <- size.74
e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855 merkleproof validated!
304402206774ff903a8a4b73bcd5a79fe5c744f34d2263160cd8877c198c2228c66a8a42022063e1d2d6403c395e3472a6a509f01cbff0b90e3413bc6f7bc492649302a4a640 sighash d99eee9af952262317fab23ca49f0d9e9b085537dc33b46aedbc40ffdd1f6d07, sigerr.0 siglen.106
sign 1 inputs 2.00999000 + interest 0.00000000 -> 2 outputs 1.00000000 change 1.00989000
```
response came with retcode 0 now

but the hex seems to be too large
```
len.292 overflow for 1 byte varint
```


[25-Jul-19 03:24 AM] jl777c#5810
"scriptSig": "",


[25-Jul-19 03:24 AM] jl777c#5810
that is invalid tx, no signatures


[25-Jul-19 03:24 AM] jl777c#5810
retcode of -1 is a failure


[25-Jul-19 03:24 AM] jl777c#5810
0 means notarized


[25-Jul-19 03:24 AM] jl777c#5810
-200x means it is mostly ok, just not notarized


[25-Jul-19 03:24 AM] jl777c#5810
pushed a fix for overflow 1 byte varint


[25-Jul-19 03:26 AM] jl777c#5810
jl777 branch


[25-Jul-19 03:27 AM] gcharang#6833
building


[25-Jul-19 03:27 AM] jl777c#5810
nspv uses a single threaded model, sometimes the network request doesnt come back in time


[25-Jul-19 03:27 AM] jl777c#5810
reissuing the command will usually fix it as it will use things from the local RAM cache and avoid the timeout


[25-Jul-19 03:28 AM] jl777c#5810
if you get retcodes of all 0, then it is ready to broadcast


[25-Jul-19 03:28 AM] jl777c#5810
even if you dont, as long as it has scriptSig for all vins, it should still work


[25-Jul-19 03:29 AM] jl777c#5810
max of 64 vins, so this is not for any address with a lot of small utxo


[25-Jul-19 03:29 AM] gcharang#6833
got it
it worked
```bash
curl --url "http://127.0.0.1:$port" --data "{\"userpass\":\"$userpass\",\"method\":\"broadcast\",\"hex\":\"0400008085202f890155c894ada147bf184bb7dff790ca429e6860775d3bb471dc0f69a28f080977e0010000006a47304402206774ff903a8a4b73bcd5a79fe5c744f34d2263160cd8877c198c2228c66a8a42022063e1d2d6403c395e3472a6a509f01cbff0b90e3413bc6f7bc492649302a4a64001210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ffffffff0200e1f505000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88ac48f804060000000023210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ace77e395d000000000000000000000000000000\"}"
```
```json
{"result":"success","expected":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","broadcast":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","retcode":1,"type":"broadcast and mempool","lastpeer":"nodeid.1"}
```
`https://kmdexplorer.io/tx/c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a`

{Reactions}
üëç 

[25-Jul-19 03:30 AM] jl777c#5810
good, so the fix for oversize tx worked. still there is a 64kb limit now, but that should be sufficient for all <64 utxo tx with normal vins.


[25-Jul-19 03:30 AM] jl777c#5810
certainly possible to make some edge case >64kb tx, but those will not be supported by nspv


[25-Jul-19 03:31 AM] jl777c#5810
@Deleted User i added a NSPV_methods[] array that describes how to map values in a params[] array to key:value json fields. when adding a new api call with parameters you need to add the appropriate entry in the NSPV_methods array


[25-Jul-19 03:33 AM] Deleted User#0000
Nice, started looking at GetTransaction, will do this tonight


[25-Jul-19 03:54 AM] jl777c#5810
@gcharang can you test the params array?


[25-Jul-19 03:54 AM] jl777c#5810
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_superlite.h##L754

{Embed}
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_superlite.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[25-Jul-19 03:55 AM] jl777c#5810
that defines the order of the parameters and what type they need to be it will print the updated argjson after creating new fields based on the params array, so internally it is always using the "key":value


[25-Jul-19 03:55 AM] jl777c#5810
i was told using a params array makes it compatible with json 2.0 and a lot of tools


[25-Jul-19 03:55 AM] gcharang#6833
testing


[25-Jul-19 03:56 AM] jl777c#5810
first just study that NSPV_methods array to make sure all the fields are sane

{Reactions}
üëç 

[25-Jul-19 03:56 AM] gcharang#6833
```bash
curl --url "http://127.0.0.1:$port" --data "{\"userpass\":\"$userpass\",\"method\":\"getnewaddress\"}"
```

```json
{
  "wif": "Uxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
  "address": "Rxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
  "pubkey": "03xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
  "wifprefix": 188,
  "compressed": 1
}
```

is `"compressed": 1` a boolean?
is it saying whether the wif is of a compressed private key?


[25-Jul-19 03:58 AM] jl777c#5810
it is integer value of 1


[25-Jul-19 03:58 AM] jl777c#5810
yes, it says the wif is for compressed pubkey


[25-Jul-19 03:58 AM] jl777c#5810
uncompressed is not supported


[25-Jul-19 03:59 AM] gcharang#6833
got it


[25-Jul-19 04:00 AM] jl777c#5810
you can look in the _NSPV_JSON function  all api calls


[25-Jul-19 04:00 AM] jl777c#5810
if ( strcmp(method,"apiname") == 0 ) <- that means it is an api call


[25-Jul-19 04:01 AM] jl777c#5810
i guess i can add all the methods without parameters to the methods array so we have a single place with all active ones

{Reactions}
üëå 

[25-Jul-19 04:02 AM] Deleted User#0000
Thats not a bad idea, keep things all the same


[25-Jul-19 04:02 AM] jl777c#5810
adding


[25-Jul-19 04:10 AM] gcharang#6833
```bash
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "broadcast", "params": [0400008085202f890155c894ada147bf184bb7dff790ca429e6860775d3bb471dc0f69a28f080977e0010000006a47304402206774ff903a8a4b73bcd5a79fe5c744f34d2263160cd8877c198c2228c66a8a42022063e1d2d6403c395e3472a6a509f01cbff0b90e3413bc6f7bc492649302a4a64001210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ffffffff0200e1f505000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88ac48f804060000000023210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ace77e395d000000000000000000000000000000] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
```
@jl777c is this the correct syntax?


[25-Jul-19 04:13 AM] jl777c#5810
for strings need to put in quotes \ "


[25-Jul-19 04:13 AM] jl777c#5810
or maybe dont need the \


[25-Jul-19 04:13 AM] jl777c#5810
but why do you ask me?\


[25-Jul-19 04:14 AM] jl777c#5810
why not just test it


[25-Jul-19 04:15 AM] gcharang#6833
it gave 
```
curl: (52) Empty reply from server
```
this is my way of asking you to correct me üòÖ


[25-Jul-19 04:18 AM] jl777c#5810
doest listunspent work? that worked for me


[25-Jul-19 04:18 AM] jl777c#5810
you need to put it in quotes

{Reactions}
üëç 

[25-Jul-19 04:22 AM] gcharang#6833
```
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "broadcast", "params": ["0400008085202f890155c894ada147bf184bb7dff790ca429e6860775d3bb471dc0f69a28f080977e0010000006a47304402206774ff903a8a4b73bcd5a79fe5c744f34d2263160cd8877c198c2228c66a8a42022063e1d2d6403c395e3472a6a509f01cbff0b90e3413bc6f7bc492649302a4a64001210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ffffffff0200e1f505000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88ac48f804060000000023210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ace77e395d000000000000000000000000000000"] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
```
this worked for me

just had to add quotes to the hex


[25-Jul-19 04:27 AM] jl777c#5810
{
    "result": "success",
    "methods": [{
        "method": "stop",
        "fields": []
    }, {
        "method": "help",
        "fields": []
    }, {
        "method": "logout",
        "fields": []
    }, {
        "method": "getnewaddress",
        "fields": []
    }, {
        "method": "getpeerinfo",
        "fields": []
    }, {
        "method": "login",
        "fields": [{
            "wif": "string"
        }]
    }, {
        "method": "broadcast",
        "fields": [{
            "hex": "string"
        }]
    }, {
        "method": "listunspent",
        "fields": [{
            "address": "string"
        }, {
            "isCC": "uint32_t"
        }, {
            "skipcount": "uint32_t"
        }, {
            "filter": "uint32_t"
        }]
    }, {
        "method": "listtransactions",
        "fields": [{
            "address": "string"
        }, {


[25-Jul-19 04:27 AM] jl777c#5810
"isCC": "uint32_t"
        }, {
            "skipcount": "uint32_t"
        }, {
            "filter": "uint32_t"
        }]
    }, {
        "method": "notarizations",
        "fields": [{
            "height": "uint32_t"
        }]
    }, {
        "method": "hdrsproof",
        "fields": [{
            "prevheight": "uint32_t"
        }, {
            "nextheight": "uint32_t"
        }]
    }, {
        "method": "getinfo",
        "fields": [{
            "hdrheight": "uint32_t"
        }]
    }, {
        "method": "txproof",
        "fields": [{
            "txid": "hash"
        }, {
            "vout": "uint32_t"
        }, {
            "height": "uint32_t"
        }]
    }, {
        "method": "spentinfo",
        "fields": [{
            "txid": "hash"
        }, {
            "vout": "uint32_t"
        }]
    }, {
        "method": "spend",
        "fields": [{
            "address": "string"
        }, {
            "amount": "float"
        }]
    }, {
        "method": "mempool",
        "fields": [{
            "address": "string"
        }, {
            "isCC": "uint32_t"
        }, {
            "memfunc": "uint32_t"
        }, {
            "txid": "hash"
        }, {
            "vout": "uint32_t"
        }, {
            "evalcode": "uint32_t"
        }, {
            "CCfunc": "uint32_t"
        }]
    }],
    "num": 16
}


[25-Jul-19 04:27 AM] jl777c#5810
implemented help api

{Reactions}
üëå (2) 

[25-Jul-19 04:52 AM] jl777c#5810
@TonyL can you verify that nspv builds for windows and works?

{Reactions}
üëç 

[25-Jul-19 04:53 AM] TonyL#3577
libnspv, right?


[25-Jul-19 04:53 AM] jl777c#5810
yes


[25-Jul-19 04:54 AM] jl777c#5810
it uses mingw so it should just work


[25-Jul-19 04:54 AM] jl777c#5810
libevent and libsodium are the only dependencies


[25-Jul-19 04:55 AM] Deleted User#0000
I like this `NSPV_methods` thing üòÉ


[25-Jul-19 05:05 AM] gcharang#6833
@jl777c 
all the methods in 
`struct NSPV_methodarg NSPV_methods[] =`
are working with the json2.0 syntax


[25-Jul-19 05:13 AM] jl777c#5810
thanks! now you should also have a very good idea of the api that exists and whenever a new one is added it will create a new entry

{Reactions}
üëç 

[25-Jul-19 05:26 AM] gcharang#6833
how is **hdrsproof prevheight nextheight** used?
```bash
curl --url "http://127.0.0.1:$port" --data "{\"userpass\":\"$userpass\",\"method\":\"hdrsproof\",\"prevheight\":1456692,\"nextheight\":1456694}"
```
gives headers from 1456680 to 1456700


[25-Jul-19 05:27 AM] smkhound#7640
what does  `'retcodes': [-5]` indicate?
on `spend` method


[25-Jul-19 05:29 AM] jl777c#5810
hdrsproof scans backwards from the prevheight to find the first notarization, forward from nextheight for the first notarization


[25-Jul-19 05:30 AM] jl777c#5810
then it gets both notarizations


[25-Jul-19 05:30 AM] jl777c#5810
and all the headers in between are returned


[25-Jul-19 05:30 AM] jl777c#5810
sp this way you can validate that all the blocks link back to each other and both endpoints of the segment are notarized

{Reactions}
üëç 

[25-Jul-19 05:31 AM] jl777c#5810
@smkhound the error codes are in the nSPV_wallet.h code only, somebody needs to dig into it and document each one

{Reactions}
üôèüèº 

[25-Jul-19 05:31 AM] Deleted User#0000
Are you sure the heights those scans do are right? Not 100% sure but I think last night while trying to fix overflow, it was gibing diffrent numbers to explorer?


[25-Jul-19 05:32 AM] jl777c#5810
-5 is a failure for NSPV_notarizationextract


[25-Jul-19 05:32 AM] jl777c#5810
the heights are the starting point for the scan


[25-Jul-19 05:32 AM] Deleted User#0000
Never mind, I will re check it while doing getransaction API. Oh thanks üòÉ


[25-Jul-19 05:32 AM] jl777c#5810
the first height with a notarization stops the search


[25-Jul-19 05:33 AM] jl777c#5810
i err on the side of getting a larger range of blocks between notarizations


[25-Jul-19 05:33 AM] Deleted User#0000
Yes I rember that it was a little confusing as the function returns the block the nota is in, rather than the notarized ht.


[25-Jul-19 05:33 AM] jl777c#5810
doesnt hurt too much to send back 20 hdrs vs 10 hdrs


[25-Jul-19 05:33 AM] jl777c#5810
as you know the exact location of notarization txid is not deterministic


[25-Jul-19 05:34 AM] jl777c#5810
though we do know that a notarization for height must happen after that height


[25-Jul-19 05:34 AM] Deleted User#0000
Yes and  as there could be reorged notas under rare circumstance more range is much safer./


[25-Jul-19 05:34 AM] jl777c#5810
reorgs wont matter if the txid is valid as it has the signatures


[25-Jul-19 05:34 AM] Deleted User#0000
it is if you ahev 100% of the hash rate and just ant to break it :troll:


[25-Jul-19 05:35 AM] Deleted User#0000
wonder where he is @Alright


[25-Jul-19 05:35 AM] jl777c#5810
even if the txid is in the mempool, the signed notarization would still be treated as vali


[25-Jul-19 05:35 AM] jl777c#5810
valid


[25-Jul-19 05:35 AM] Deleted User#0000
ahh, so they can be confirmed out of order or it checks for that and skips to next one?


[25-Jul-19 05:36 AM] jl777c#5810
i search until i find that the prevnotarized height is both <= desired height and the next notarized height is >= desired height


[25-Jul-19 05:36 AM] jl777c#5810
dereference the notarization txid to the height it has


[25-Jul-19 05:37 AM] jl777c#5810
to not confused my self, i just made it simple and not optimally efficient


[25-Jul-19 05:37 AM] Deleted User#0000
ü§î  maybe im a bit tired to get this, Im sure I will figure out how it works while using it.


[25-Jul-19 05:37 AM] jl777c#5810
given a txid at height ht


[25-Jul-19 05:37 AM] jl777c#5810
scan backwards to find the first notarization of ntzht <= ht


[25-Jul-19 05:37 AM] jl777c#5810
scan forward for first notarization ntzht >= ht


[25-Jul-19 05:38 AM] jl777c#5810
get all the headers in between


[25-Jul-19 05:38 AM] Deleted User#0000
yes thats perfect


[25-Jul-19 05:38 AM] jl777c#5810
seems pretty foolproof and doesnt matter the order onchain of the notarizations


[25-Jul-19 05:38 AM] Deleted User#0000
no it doesnt, no MoMoM headaches


[25-Jul-19 05:38 AM] jl777c#5810
and now we have yet another way to do cross chain for notarized chains


[25-Jul-19 05:39 AM] jl777c#5810
just spin up a nspv for each chain


[25-Jul-19 05:39 AM] jl777c#5810
use the nSPV method to validate the tx on the other chain


[25-Jul-19 05:39 AM] jl777c#5810
then submit the proofs required using dimxy backup method from importcoins


[25-Jul-19 05:40 AM] jl777c#5810
since you can dynamically spin up and connect to a new chain via nspv in seconds, there isnt even a need to stay connected to all the chains in the cluster, can just do it on demand


[25-Jul-19 05:40 AM] jl777c#5810
which would be a very cool crosschain wallet


[25-Jul-19 05:40 AM] jl777c#5810
make a cluster of N chains


[25-Jul-19 05:41 AM] jl777c#5810
then do crosschain burns 100% via nspv


[25-Jul-19 05:41 AM] Deleted User#0000
:PeepoThink:


[25-Jul-19 05:41 AM] jl777c#5810
of course the fullnode will use the dimxy baggage claim method


[25-Jul-19 05:41 AM] jl777c#5810
but the multichain client would be able to construct the required proofs as gettransaction returns the txproof


[25-Jul-19 05:42 AM] jl777c#5810
now we are not even limited by 65536 ports!


[25-Jul-19 05:42 AM] Deleted User#0000
ha yes


[25-Jul-19 05:42 AM] jl777c#5810
any chain to any chain can be connected to dynamically and disconnect when done, freeing up the port, so the same port can be for arbitrary number of otherwise conflicting chains


[25-Jul-19 05:43 AM] jl777c#5810
scaling to millions without breaking a sweat


[25-Jul-19 05:43 AM] jl777c#5810
scaling to billions, with a little bit of crosschain nspv magic


[25-Jul-19 05:44 AM] Deleted User#0000
sounds like we have a lot of work to do


[25-Jul-19 05:44 AM] jl777c#5810
with libnspv, most development will go 10x faster


[25-Jul-19 05:45 AM] Deleted User#0000
maybe for you!


[25-Jul-19 05:45 AM] Deleted User#0000
Going to take some getting used to


[25-Jul-19 05:45 AM] jl777c#5810
its less than 10,000 lines of code


[25-Jul-19 05:45 AM] SHossain#0007
adoption you mean?


[25-Jul-19 05:46 AM] Deleted User#0000
All the functions I usually use are now diffrnet, take many days/.weeks until I know this code base like I do komodod


[25-Jul-19 05:46 AM] Deleted User#0000
that said it is much smaller yes


[25-Jul-19 05:46 AM] jl777c#5810
5400 lines of nSPV_*.h code


[25-Jul-19 05:46 AM] jl777c#5810
libbtc stuff is pretty easy to figure out


[25-Jul-19 05:47 AM] Deleted User#0000
yes, most of it is ok, I have a few things to research and mess with but will be ok


[25-Jul-19 05:47 AM] jl777c#5810
5400 lines of code is all the code and half of it is repetitive stuff, so really just a couple thousand lines, experienced blockchain devs can come up to speed in a day, if C is not so strong, then add time to learn enough C

{Reactions}
üíØ (2) 

[25-Jul-19 05:51 AM] gcharang#6833 (pinned)
docs: https://docs.komodoplatform.com/nSPV/

{Reactions}
3040_kingpeepo (2) 

[25-Jul-19 05:51 AM] gcharang#6833
it is still wip
should be done in 2 hrs


[25-Jul-19 05:51 AM] gcharang#6833
Pinned a message.


[25-Jul-19 05:54 AM] jl777c#5810
@gcharang nice! dont forget to document how to add new coins to the coins file and how to invoke it for a new coin, also the -p <port> option is quite useful


[25-Jul-19 05:55 AM] gcharang#6833
will do


[25-Jul-19 05:58 AM] jl777c#5810
@gcharang also the variations on how to issue the api is missing

{Reactions}
üëç 

[25-Jul-19 05:58 AM] TonyL#3577
Had to setup VPN to download MinGW packages from sourceforge because most of suorceforge servers are blocked by isp it seems - now installation started. Welcome to Kazakhstan...


[25-Jul-19 05:58 AM] jl777c#5810
ancillary things that would be nice would be a cli wrapper that allows cli to issue the curl, and language bindings


[25-Jul-19 06:00 AM] jl777c#5810
@SD maybe your students can make language bindings for nspv?


[25-Jul-19 06:42 AM] dukeleto#7326
I wouldn't mind mentoring some smart students on nSPV stuff


[25-Jul-19 06:44 AM] gcharang#6833
```bash
curl --url "http://127.0.0.1:$port" --data "{\"userpass\":\"$userpass\",\"method\":\"listtransactions\",\"address\":\"RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb\"}"
```
```json
{"result":"success","txids":[{"height":1453830,"txid":"04df7641f114c14fa4fbe2ec6e8ef5b55417f78fd12ef90b1217fcf512cb5ec2","interest":2.98,"vout":1}, {"height":1453881,"txid":"e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855","interest":-2.98,"vin":0}, {"height":1453881,"txid":"e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855","interest":2.00999,"vout":1}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","interest":1,"vout":0}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","interest":-2.00999,"vin":0}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","interest":1.00989,"vout":1}],"address":"RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb","isCC":0,"height":1458233,"numtxids":6,"skipcount":0,"filter":0,"lastpeer":"nodeid.11"}
```
why is the amount of coins in (vin/vout) being called interest?
@jl777c


[25-Jul-19 06:48 AM] gcharang#6833
does the `"isCC":0` tell if the address belongs to a cc module like a 1of2 address or a global address?


[25-Jul-19 06:52 AM] dukeleto#7326
that seems likely. Internally, there are some flags/data in transactions that only CC's have, so that looks like a boolean that caches that data instead of the raw hex needing to be analyzed again. Most likely an optimization

{Reactions}
üëç 

[25-Jul-19 06:53 AM] dukeleto#7326
jl777 never saw an optimization he didn't like


[25-Jul-19 06:53 AM] smkhound#7640
listunspent has different keys for interest / balance 
```json
{'result': 'success', 'utxos': [{'height': 1458056, 'txid': '013695c762809ee30215fb9f3cad21741c66e2497c4e243a2c650d00ab149b89', 'vout': 0, 'value': 11, 'interest': 0.00014976}], 'address': 'RYPzyuLXdT9JYn7pemYaX3ytsY3btyaATY', 'isCC': 0, 'height': 1458229, 'numutxos': 1, 'balance': 11, 'interest': 0.00014976, 'lastpeer': 'nodeid.1'}
```


[25-Jul-19 06:54 AM] gcharang#6833
yeah, the rpc I was looking at was listtransactions


[25-Jul-19 06:55 AM] smkhound#7640
I noticed it too, just mentioing the diff. Not sure on the reason


[25-Jul-19 06:56 AM] jl777c#5810
bug in listtransactions


[25-Jul-19 06:57 AM] jl777c#5810
there are 2 types of addresses in address index DB


[25-Jul-19 06:57 AM] jl777c#5810
normal and CC


[25-Jul-19 06:57 AM] jl777c#5810
that is the purpose of the isCC flag


[25-Jul-19 06:58 AM] gcharang#6833
got it
@jl777c 
if it isn't a huge trouble, maybe change interest to rewards?


[25-Jul-19 06:58 AM] jl777c#5810
fixed


[25-Jul-19 07:02 AM] Deleted User#0000
noticed that myuself. Almost have gettransaction ready to test, but fair warning its not working too well yet.


[25-Jul-19 07:03 AM] gcharang#6833
@jl777c 
```
  CC       src/tools/nspv-nspv.o
In file included from src/tools/nspv.c:110:0:
src/tools/nSPV_structs.h: In function ‚ÄòNSPV_txidresp_json‚Äô:
src/tools/nSPV_structs.h:618:48: error: ‚Äòstruct NSPV_txidresp‚Äô has no member named ‚Äòextradata‚Äô
         jaddnum(item,"rewards",(double)utxos[i].extradata/COIN);
                                                ^
Makefile:1548: recipe for target 'src/tools/nspv-nspv.o' failed
make[1]: *** [src/tools/nspv-nspv.o] Error 1
make[1]: Leaving directory '/home/gcharang/gitrepos/libnspv'
Makefile:1957: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
```


[25-Jul-19 07:07 AM] jl777c#5810
fixed

{Reactions}
üëç 

[25-Jul-19 07:12 AM] TonyL#3577
it seems that besides of libevent and libsodium specific windows lib needed:
```In file included from src/tools/nspv.c:114:0:
src/tools/nSPV_rpc.h:30:10: fatal error: WinSock2.h: No such file or directory
 #include <WinSock2.h>
          ^~~~~~~~~~~~
```


[25-Jul-19 07:12 AM] Deleted User#0000
windows :troll:


[25-Jul-19 07:13 AM] TonyL#3577
http://www.cplusplus.com/forum/general/12785/ started to google - like this dude answer back from 2009 üòÉ

{Reactions}
üòÇ 

[25-Jul-19 07:16 AM] jl777c#5810
yes winsock is needed for windows


[25-Jul-19 07:28 AM] dukeleto#7326
Couldn't help myself

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603956637807542301/windsock.jpg

{Reactions}
üòÖ (2) 

[25-Jul-19 07:28 AM] TonyL#3577
seems I passed trough dependencies (WinSock2.h -> winsock2.h helped)
now getting such errors on make: https://paste.ubuntu.com/p/NrZWJSrSB7/


[25-Jul-19 07:29 AM] dukeleto#7326
`src/tools/OSlibs/win/sched.h:142:8: error: redefinition of ‚Äòstruct sched_param‚Äô`


[25-Jul-19 07:29 AM] dukeleto#7326
sounds bad


[25-Jul-19 07:29 AM] dukeleto#7326
like header included multiple times or different versions of same header included/etc


[25-Jul-19 07:30 AM] TonyL#3577
```src/tools/OSlibs/win/sched.h:142:8: error: redefinition of ‚Äòstruct sched_param‚Äô
 struct sched_param {
        ^~~~~~~~~~~
In file included from ./include/nSPV_defs.h:29:0,
                 from src/tools/nspv.c:50:
/usr/share/mingw-w64/include/pthread.h:239:8: note: originally defined here
 struct sched_param {```


[25-Jul-19 07:30 AM] TonyL#3577
yeah I think I'm including pthread from two places


[25-Jul-19 07:32 AM] jl777c#5810
maybe OSlibs/win isnt right....


[25-Jul-19 07:34 AM] gcharang#6833
```
    { "listtransactions", { { "address", NSPV_STR }, { "isCC", NSPV_UINT }, { "skipcount", NSPV_UINT }, { "filter", NSPV_UINT } } },
```
how are skipcount and filter used?


[25-Jul-19 07:35 AM] jl777c#5810
skipcount skips that many entries, except the last one


[25-Jul-19 07:35 AM] jl777c#5810
filter will be used to filter the list based on CC specific requirements TBD

{Reactions}
üëç 

[25-Jul-19 07:37 AM] dukeleto#7326
@jl777c would you say nSPV uses "skip lists" internally at all? What is the most advanced data structure used internally?


[25-Jul-19 07:37 AM] dukeleto#7326
does nSPV use something like this? `https://en.wikipedia.org/wiki/Skip_list`


[25-Jul-19 07:39 AM] dukeleto#7326
I am not fully sure the relation between MMRs and Skip Lists, but they seem related


[25-Jul-19 07:39 AM] dukeleto#7326
MerkleMountainRanges feels like a skip list of merkle trees to me


[25-Jul-19 07:40 AM] jl777c#5810
nothing fancy, just if ( i < skipcount ) continue in the iteration loop


[25-Jul-19 07:40 AM] gcharang#6833
```
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "listtransactions", "params": ["RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb"] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "listtransactions", "params": ["RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb",0,4] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "listtransactions", "params": ["RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb",0,6] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
```
are all giving the same response 
```
{"result":"success","txids":[{"height":1453830,"txid":"04df7641f114c14fa4fbe2ec6e8ef5b55417f78fd12ef90b1217fcf512cb5ec2","value":2.98,"vout":1}, {"height":1453881,"txid":"e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855","value":-2.98,"vin":0}, {"height":1453881,"txid":"e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855","value":2.00999,"vout":1}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","value":1,"vout":0}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","value":-2.00999,"vin":0}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","value":1.00989,"vout":1}],"address":"RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb","isCC":0,"height":1458285,"numtxids":6,"skipcount":0,"filter":0,"lastpeer":"nodeid.1"}
```

`"numtxids":6,"skipcount":0`


[25-Jul-19 07:40 AM] jl777c#5810
try using the "skipcount":4 and not params array


[25-Jul-19 07:41 AM] dukeleto#7326
@jl777c ok. are you iterating on linked lists which have multiple connections to other nodes?


[25-Jul-19 07:41 AM] dukeleto#7326
or even simpler?


[25-Jul-19 07:41 AM] jl777c#5810
to debug params array, i need to see the new argjson print


[25-Jul-19 07:41 AM] jl777c#5810
@dukeleto on the full node, it does a addressindex lookup and just iterates with if ( i < skipcount) continue


[25-Jul-19 07:42 AM] jl777c#5810
much simpler, look at the code in komodo_nSPV_fullnode.h


[25-Jul-19 07:42 AM] dukeleto#7326
so simple, much wow


[25-Jul-19 07:42 AM] jl777c#5810
linear search for the caching also


[25-Jul-19 07:42 AM] Deleted User#0000
its so simple, such wow.. very fast to develop with


[25-Jul-19 07:43 AM] jl777c#5810
what most coders dont realize is that doing a linear scan of 1000 entries is VERY fast as it all comes from the CPU L1/2/3 cache


[25-Jul-19 07:43 AM] gcharang#6833
```
new argjson.({"jsonrpc":"2.0","id":"curltest","method":"listtransactions","params":["RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb", 0, 4],"address":"RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb","isCC":0,"skipcount":4,"filter":0})
got txids response 1564065775 size.369 RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb CC.0 num.6
```
for
```
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "listtransactions", "params": ["RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb",0,4] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
```


[25-Jul-19 07:44 AM] jl777c#5810
ok, skipcount is set


[25-Jul-19 07:44 AM] gcharang#6833
but the response has skipcount: 0


[25-Jul-19 07:44 AM] gcharang#6833
```json
{"result":"success","txids":[{"height":1453830,"txid":"04df7641f114c14fa4fbe2ec6e8ef5b55417f78fd12ef90b1217fcf512cb5ec2","value":2.98,"vout":1}, {"height":1453881,"txid":"e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855","value":-2.98,"vin":0}, {"height":1453881,"txid":"e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855","value":2.00999,"vout":1}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","value":1,"vout":0}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","value":-2.00999,"vin":0}, {"height":1458037,"txid":"c76fede03fd821cf718b8ca7de898b95d04d7b9f7fcaeda89ccc00519476ec4a","value":1.00989,"vout":1}],"address":"RFmQiF4Zbzxchv9AG6dw6ZaX8PbrA8FXAb","isCC":0,"height":1458290,"numtxids":6,"skipcount":0,"filter":0,"lastpeer":"nodeid.1"}
```


[25-Jul-19 07:45 AM] jl777c#5810
yes, it seems i broke skipcount when i added filter


[25-Jul-19 07:45 AM] jl777c#5810
investigating

{Reactions}
üëç 

[25-Jul-19 07:46 AM] dukeleto#7326
@jl777c have you seen this? https://github.com/therealyingtong/zips/blob/master/zip-0221.rst

{Embed}
https://github.com/therealyingtong/zips/blob/master/zip-0221.rst
therealyingtong/zips
Zcash Improvement Proposals. Contribute to therealyingtong/zips development by creating an account on GitHub.
https://images-ext-2.discordapp.net/external/n47JkPHLz2ru8iyG3MlhCh-b7O43KK3yAglEz4N9FLA/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/14323671


[25-Jul-19 07:46 AM] dukeleto#7326
FlyClient ZIP for ZEC


[25-Jul-19 07:46 AM] dukeleto#7326
I just stumbled across it


[25-Jul-19 07:46 AM] dukeleto#7326
@jl777c i think nSPV needs a whitepaper soon. FlyClient got so much fame, but they never wrote any usable code. nSPV basically works in production right now, already


[25-Jul-19 07:47 AM] Deleted User#0000
*just works*


[25-Jul-19 07:49 AM] dukeleto#7326
https://twitter.com/_prestwich/status/1145695836619194368

{Embed}
James Prestwich (@_prestwich)
https://twitter.com/_prestwich/status/1145695836619194368
I co-authored a ZIP with @therealyingtong and @gakonst and the @summa_one team

ZIP-0221 aims to improve ZCash light clients, and enable FlyClient and cross-chain relays. As mostly ETH/BTC devs, we're excited about cross-chain cooperation + interop

üëÄ
https://t.co/eKKUR...
Twitter


[25-Jul-19 07:49 AM] dukeleto#7326
If we really want to show off nSPV, we should compare ourselves to that ZIP


[25-Jul-19 07:49 AM] dukeleto#7326
and tell people how much better our tech is


[25-Jul-19 07:50 AM] jl777c#5810
flyclient is good tech


[25-Jul-19 07:50 AM] jl777c#5810
it is just a lot more complex


[25-Jul-19 07:50 AM] dukeleto#7326
Agreed


[25-Jul-19 07:50 AM] dukeleto#7326
It's more general, for chains without DPoW


[25-Jul-19 07:51 AM] dukeleto#7326
We don't have to attack FlyClient. We can compare + contrast


[25-Jul-19 07:51 AM] jl777c#5810
yes, a fine solution for non-dPoW chains


[25-Jul-19 07:51 AM] jl777c#5810
but what year will they finish flyclient?


[25-Jul-19 07:51 AM] dukeleto#7326
and I think it's safe to say nSPV was "inspired" by FlyClient, right?


[25-Jul-19 07:51 AM] Deleted User#0000
what about a checkpointed chain liek BCH ? would it work on that?


[25-Jul-19 07:51 AM] dukeleto#7326
and yes, Benedikt is mostly an academic. He wants papers


[25-Jul-19 07:52 AM] jl777c#5810
yes, i thought of it when getting lost in all the flyclient math


[25-Jul-19 07:52 AM] dukeleto#7326
so there is no real FlyClient working code, that I can see


[25-Jul-19 07:52 AM] jl777c#5810
@Deleted User a checkpointed chain has the problem of who do you trust to give you the checkpoints


[25-Jul-19 07:52 AM] jl777c#5810
some random node on the internet?


[25-Jul-19 07:52 AM] dukeleto#7326
@Deleted User centralized checkpoints help FlyClient. the biggest problems are choosing a valid chain, which dpow solves


[25-Jul-19 07:53 AM] dukeleto#7326
and yeah, the centralized checkpoints could be wrong, but FlyClient needs to know which chain to trust in case of forks/reorgs


[25-Jul-19 07:53 AM] Deleted User#0000
yes but I didnt BCH make their chain automatically checkpoint evey 10 blocks? so it would work ther right?


[25-Jul-19 07:53 AM] dukeleto#7326
they added a re-org limit of 10, maybe


[25-Jul-19 07:53 AM] dukeleto#7326
not automatic checkpoints every 10 blocks, slightly different


[25-Jul-19 07:53 AM] dukeleto#7326
i think they manually add checkpoints often, tho


[25-Jul-19 07:53 AM] dukeleto#7326
because BSV attacks/etc


[25-Jul-19 07:54 AM] Deleted User#0000
hmm not sure who told me that now, im confused lol


[25-Jul-19 07:59 AM] jl777c#5810
saying that a fullnode wont reorg more than 10 blocks is not a checkpoint


[25-Jul-19 08:00 AM] jl777c#5810
it also is subject to a chain split attack if a 10 block reorg is broadcast to half the network at just the right time


[25-Jul-19 08:00 AM] jl777c#5810
a superlite client relies on fullnode to tell it what the current chain is. so which node will it trust?


[25-Jul-19 08:00 AM] jl777c#5810
it has no way to know which fullnode is on the mainchain or the attacker chain


[25-Jul-19 08:01 AM] jl777c#5810
with nSPV, all the signatures are validated (using a purely local bruteforce validation of the notarization tx)


[25-Jul-19 08:01 AM] Deleted User#0000
yes, understood.


[25-Jul-19 08:01 AM] dukeleto#7326
superlite clients follow the chain that their server follows, just like Electrum


[25-Jul-19 08:01 AM] Deleted User#0000
I spent about 3H last night getting that notarization validation working


[25-Jul-19 08:01 AM] Deleted User#0000
clever stuff


[25-Jul-19 08:02 AM] dukeleto#7326
@jl777c does nSPV randomly choose to connect to different servers or is it possible to get "stuck" on one "malicious" node?


[25-Jul-19 08:02 AM] Deleted User#0000
it randomy chooses most of the time, We need more nodes though.


[25-Jul-19 08:02 AM] dukeleto#7326
Electrum has such problems with evil servers


[25-Jul-19 08:03 AM] Deleted User#0000
I would say all notaries at least  right?


[25-Jul-19 08:03 AM] Deleted User#0000
Or does that allow people to dos them ü§î


[25-Jul-19 08:05 AM] dukeleto#7326
we can use Cloudflare


[25-Jul-19 08:05 AM] dukeleto#7326
use DNS and have that DNS record point to various NN ip's


[25-Jul-19 08:06 AM] dukeleto#7326
spiritually similar to a DNS seed


[25-Jul-19 08:06 AM] Deleted User#0000
the client finds peers just like a normal, node does. Then connects to up to 1000 of them I think.


[25-Jul-19 08:06 AM] Deleted User#0000
I got that working last night aswell


[25-Jul-19 08:06 AM] dukeleto#7326
@jl777c that ZIP requires changing the tx header format, ugh


[25-Jul-19 08:08 AM] smkhound#7640
got some basic functionality up at http://oracle.earth/nspv_login/
totally unsecure tho :D
needs a bit more error handling too, crashed out a couple of times when method times out


[25-Jul-19 08:10 AM] jl777c#5810
currently, it updates the current height based on getinfo height being higher than the last


[25-Jul-19 08:11 AM] jl777c#5810
we do need to add validation that the new height prevBlockhash -> prev -> ... latest notarization


[25-Jul-19 08:11 AM] TonyL#3577
yay! let's test :)
```ls | grep .exe
nspv.exe```

{Reactions}
üôè yassinheart 

[25-Jul-19 08:11 AM] jl777c#5810
if it is the max height and traces back to the most recent notarization, it seems it is the right chain and right height


[25-Jul-19 08:11 AM] jl777c#5810
as the latest notarization is updated, that also needs to be validated


[25-Jul-19 08:12 AM] jl777c#5810
with those two validations, you just need to have one honest peer to get onto the mainchain


[25-Jul-19 08:12 AM] jl777c#5810
this is similar to the PoW risk profile. a 100% eclipsed node, well not much can be done if all your peers are evil, but a single honest peer against 1000 evil nodes, that single honest peer is enough to get onto the main chain. this is the power of PoW


[25-Jul-19 08:13 AM] jl777c#5810
@Deleted User does this make sense? it is fundamental to the PoW concept


[25-Jul-19 08:13 AM] Deleted User#0000
yes I get it.


[25-Jul-19 08:13 AM] jl777c#5810
single honest node overpowering all the evil nodes, just due to the PoW work. in our case, due to knowing about the latest notarization


[25-Jul-19 08:13 AM] jl777c#5810
maybe you want to take a stab at updating the getinfo logic?


[25-Jul-19 08:14 AM] jl777c#5810
in superlite.h, where it gets the getinfo message, right now it just checks the height


[25-Jul-19 08:14 AM] jl777c#5810
that needs to be changed to tracing back the headers and also updating the latest notarization


[25-Jul-19 08:14 AM] Deleted User#0000
yes. That seems to be giving me some problems elswhere aswell.


[25-Jul-19 08:14 AM] jl777c#5810
sort of fits into the gettransaction logic


[25-Jul-19 08:14 AM] jl777c#5810
and this will filter out bad nodes that are bad just because they are not in sync


[25-Jul-19 08:14 AM] Deleted User#0000
for gettransaction if you dont  enter a height I made it use the tip. Which means the tx wont validate. because it canot scan forwards.


[25-Jul-19 08:15 AM] TonyL#3577
```.\nspv.exe
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash KMD
Start NSPV_rpcloop.7771
getaddrinfo(0.0.0.0) returned error
[warn] evsig_init_: socketpair: ‚ïö—ã—à —è–Å—à—ã—é—Ü—Ö—ç—à—Ö —ç—Ö —Ç‚àö—á—Ç—Ä—ã—é WSAStartup, —à—ã—à —è–Å—é—à—á—é¬∞—ã—Ä —é¬∞—à—Å—ä—Ä —Ç WSAStartup.
Discover KMD peers...setnode.(5.9.253.195) -> 5.9.253.195:7770
setnode.(5.9.253.196) -> 5.9.253.196:7770
setnode.(5.9.253.197) -> 5.9.253.197:7770
setnode.(5.9.253.198) -> 5.9.253.198:7770
setnode.(5.9.253.199) -> 5.9.253.199:7770
setnode.(5.9.253.200) -> 5.9.253.200:7770
setnode.(5.9.253.201) -> 5.9.253.201:7770
setnode.(5.9.253.202) -> 5.9.253.202:7770
setnode.(5.9.253.203) -> 5.9.253.203:7770
end of client runloop
[err] bufferevent.c:692: Assertion bufev_private->refcnt > 0 failed in bufferevent_decref_and_unlock_
getaddrinfo(0.0.0.0) returned error
getaddrinfo(0.0.0.0) returned error
getaddrinfo(0.0.0.0) returned error``` 

seems close but crash :/ not sure why it speak with me on broken russian


[25-Jul-19 08:15 AM] jl777c#5810
if you dont know the height at least it can get the height from the first call and then call it again


[25-Jul-19 08:16 AM] jl777c#5810
@TonyL does libbtc work for windows


[25-Jul-19 08:16 AM] jl777c#5810
with the BTC chain


[25-Jul-19 08:16 AM] TonyL#3577
Let me try


[25-Jul-19 08:16 AM] jl777c#5810
getaddrinfo(0.0.0.0) returned error <- that seems suspicious


[25-Jul-19 08:17 AM] Deleted User#0000
Windsocks fault


[25-Jul-19 08:19 AM] TonyL#3577
https://github.com/tonymorony/libnspv/commit/26fabd508d7db7b95d419af84d6c06c17b74aad4 maybe it was too dirty

{Embed}
https://github.com/tonymorony/libnspv/commit/26fabd508d7db7b95d419af84d6c06c17b74aad4
rm dead depend ¬∑ tonymorony/libnspv@26fabd5
https://images-ext-1.discordapp.net/external/_FZ-6atALXBjBvMLVC1JBeWG05jXc2w_TXrppH7V6kE/%3Fs%3D200%26v%3D4/https/avatars3.githubusercontent.com/u/24797699


[25-Jul-19 08:19 AM] jl777c#5810
we need decker for this


[25-Jul-19 08:19 AM] Deleted User#0000
`EVUTIL_ASSERT(bufev_private->refcnt > 0);` Failed here in libevent


[25-Jul-19 08:20 AM] jl777c#5810
maybe libbtc doenst work in windows and we need to fix it, or i broke it adding nspv


[25-Jul-19 08:20 AM] TonyL#3577
I dont see any binaries/manuals and etc for windows in libbtc repo


[25-Jul-19 08:21 AM] Deleted User#0000
I dont think so, because its failing in the DNS seeder part on startup, pretty sure I didnt change that at all either.


[25-Jul-19 08:21 AM] jl777c#5810
same autogen configure process


[25-Jul-19 08:21 AM] jl777c#5810
for windows. i didnt do anything to make it windows compatible


[25-Jul-19 08:22 AM] TonyL#3577
there was a typo https://github.com/tonymorony/libnspv/commit/217ca6f663f222e688c6e8ea26a9fddf1e74bf06 which failed crosscompilation

{Embed}
https://github.com/tonymorony/libnspv/commit/217ca6f663f222e688c6e8ea26a9fddf1e74bf06
fix typo ¬∑ tonymorony/libnspv@217ca6f
https://images-ext-1.discordapp.net/external/_FZ-6atALXBjBvMLVC1JBeWG05jXc2w_TXrppH7V6kE/%3Fs%3D200%26v%3D4/https/avatars3.githubusercontent.com/u/24797699


[25-Jul-19 08:22 AM] TonyL#3577
if it original libbtc code - dont think someone tried to build it on win recently üòÉ


[25-Jul-19 08:23 AM] TonyL#3577
or it's not typo ü§î


[25-Jul-19 08:23 AM] jl777c#5810
that is my file


[25-Jul-19 08:23 AM] jl777c#5810
are you sure it should reverse the ifdef to ifndef


[25-Jul-19 08:25 AM] TonyL#3577
```In file included from src/tools/nspv.c:114:0:
src/tools/nSPV_rpc.h:41:0: warning: "EADDRINUSE" redefined
 #define EADDRINUSE WSAEADDRINUSE
 
In file included from /usr/share/mingw-w64/include/pthread.h:63:0,
                 from ./include/nSPV_defs.h:29,
                 from src/tools/nspv.c:50:
/usr/share/mingw-w64/include/errno.h:86:0: note: this is the location of the previous definition
 #define EADDRINUSE 100
 
In file included from src/tools/nspv.c:114:0:
src/tools/nSPV_rpc.h:95:0: warning: "EAFNOSUPPORT" redefined
 #define EAFNOSUPPORT WSAEAFNOSUPPORT
 
In file included from /usr/share/mingw-w64/include/pthread.h:63:0,
                 from ./include/nSPV_defs.h:29,
                 from src/tools/nspv.c:50:
/usr/share/mingw-w64/include/errno.h:82:0: note: this is the location of the previous definition
 #define EAFNOSUPPORT 102
 
In file included from src/tools/nspv.c:114:0:
src/tools/nSPV_rpc.h:98:8: error: redefinition of ‚Äòstruct sockaddr_in6‚Äô
 struct sockaddr_in6 {
        ^~~~~~~~~~~~
In file included from /usr/share/mingw-w64/include/ws2tcpip.h:18:0,
                 from ./include/btc/protocol.h:40,
                 from ./include/btc/net.h:34,
                 from src/tools/nspv.c:31:
/usr/share/mingw-w64/include/ws2ipdef.h:41:8: note: originally defined here
 struct sockaddr_in6 {
        ^~~~~~~~~~~~
```


[25-Jul-19 08:25 AM] TonyL#3577
build throwing this with ifdef


[25-Jul-19 08:25 AM] TonyL#3577
and passing fine with ifndef, so decided it's a typo


[25-Jul-19 08:32 AM] jl777c#5810
lets assume its not a typo and comment out the include file that it complains about


[25-Jul-19 08:32 AM] jl777c#5810
comment out line 114


[25-Jul-19 08:35 AM] jl777c#5810
@gcharang added a protocolversion field to getinfo return

{Reactions}
üëç 

[25-Jul-19 08:35 AM] TonyL#3577
if comment out `#include <nSPV_defs.h>` it doesnt know about functions from it
```In file included from src/tools/nspv.c:111:0:
src/tools/nspv.c: At top level:
src/tools/nSPV_superlite.h:41:22: error: storage size of ‚ÄòNSPV_inforesult‚Äô isn‚Äôt known
 struct NSPV_inforesp NSPV_inforesult;
``` and etc


[25-Jul-19 08:35 AM] jl777c#5810
this allows clients to just not query out of date fullnodes for new messages


[25-Jul-19 08:36 AM] jl777c#5810
@TonyL the problem is inside that filke


[25-Jul-19 08:36 AM] jl777c#5810
from ./include/nSPV_defs.h:29,


[25-Jul-19 08:36 AM] jl777c#5810
line 29


[25-Jul-19 08:36 AM] jl777c#5810
maybe #ifndef _WINDOWS around that?


[25-Jul-19 08:37 AM] TonyL#3577
will play with it


[25-Jul-19 08:37 AM] jl777c#5810
it is the pthread.h that is being included so guard that to make sure windows doesnt include it


[25-Jul-19 08:38 AM] jl777c#5810
i guess it is              #ifndef __MINGW


[25-Jul-19 08:39 AM] jl777c#5810
#include <pthread.h>


[25-Jul-19 08:39 AM] jl777c#5810
#endif


[25-Jul-19 08:39 AM] TonyL#3577
https://github.com/tonymorony/libnspv/commit/634afe0d784dae013dc384c299269963dfb51237 I have such change on my side

{Embed}
https://github.com/tonymorony/libnspv/commit/634afe0d784dae013dc384c299269963dfb51237
this dependencie conflict with determenistic build one ¬∑ tonymoro...
https://images-ext-1.discordapp.net/external/_FZ-6atALXBjBvMLVC1JBeWG05jXc2w_TXrppH7V6kE/%3Fs%3D200%26v%3D4/https/avatars3.githubusercontent.com/u/24797699


[25-Jul-19 08:40 AM] TonyL#3577
before it thrown an error so compiler definetly trying to include it


[25-Jul-19 08:40 AM] jl777c#5810
ok, whatever gets past the double inclusion of pthread.h


[25-Jul-19 08:41 AM] gcharang#6833
@jl777c not sure if this is useful
```
In file included from src/tools/nspv.c:110:0:
src/tools/nSPV_structs.h: In function ‚ÄòNSPV_getinfo_json‚Äô:
src/tools/nSPV_structs.h:572:38: warning: passing argument 3 of ‚Äòjaddstr‚Äô makes pointer from integer without a cast [-Wint-conversion]
     jaddstr(result,"protocolversion",ptr->version);
                                      ^~~
In file included from ./include/nSPV_defs.h:56:0,
                 from src/tools/nspv.c:50:
./include/komodo_cJSON.h:88:10: note: expected ‚Äòchar *‚Äô but argument is of type ‚Äòuint32_t {aka unsigned int}‚Äô
     void jaddstr(cJSON *json,char *field,char *str);
```


[25-Jul-19 08:41 AM] jl777c#5810
fixing

{Reactions}
üëç 

[25-Jul-19 08:42 AM] jl777c#5810
fixed

{Reactions}
üëç 

[25-Jul-19 09:00 AM] dukeleto#7326
TDD = Tony-Driven Development

{Reactions}
üòÜ (2) 

[25-Jul-19 09:02 AM] jl777c#5810
getinfo now returns protocolversion. oldernodes are backward compatible and will just return 0


[25-Jul-19 09:09 AM] jl777c#5810
@Deleted User we did some saturation load tests and with 850+ peers doing full saturation requests, the fullnode did go up to 150% CPU load, but that is a crazy level of peers as normal superlites would be doing 1% that level, so that is estimated 100,000 normal superlite clients per fullnode. my 10 nodes i have setup could well support 1 million superlite clients


[25-Jul-19 09:10 AM] jl777c#5810
i will call the superlite that does crosschain between any two chains in a cluster the "superwallet" as it is a superset of the existing wallet

{Reactions}
üëå üëç üíØ üòé (2) KMD (3) 

[25-Jul-19 09:10 AM] Deleted User#0000
nice. I have pulled down those changes I think. just reading some code for this headers thing, gettransaction works, but its not very user friendly atm, returns some unexpected things.


[25-Jul-19 09:11 AM] Deleted User#0000
it will fetch the tx, but using a tip height isnt any good without the check forwards from the last notarization.


[25-Jul-19 09:11 AM] jl777c#5810
yes, that is why i suggest the height /hdrs validation


[25-Jul-19 09:12 AM] Deleted User#0000
just trying to find what to use, still have a more to get up to speed on


[25-Jul-19 09:13 AM] jl777c#5810
once you understand hdrsproof (which is a subset of gettransaction), then the hdrs validation wont be so bad, it is just the same logic to do for the prevblockhash checking


[25-Jul-19 09:14 AM] Deleted User#0000
yes.


[25-Jul-19 09:14 AM] jl777c#5810
probably would be good to share code for doing the backwards headers thing


[25-Jul-19 09:14 AM] Deleted User#0000
Yes I thaught something liek that already may exist. But it doesnt so thats what im trying to work out


[25-Jul-19 09:14 AM] jl777c#5810
maybe we need a special mode on the fullnode side to just return a specific set of headers, like if the nextheight is 0, that would tell the fullnode to return all the headers until the latest notarization


[25-Jul-19 09:16 AM] jl777c#5810
aha! currently fullnode getntzsproofresp returns error if there is no nextht


[25-Jul-19 09:16 AM] jl777c#5810
so you just need to add code there to special case it and have it return all the most recent headers. the superlite side should be able to gracefully handle missing ntz tx data


[25-Jul-19 09:17 AM] jl777c#5810
komodo_nSPV_fullnode.h (you do need to become familiar with the fullnode handling of the superlite client requests to do such changes) line 463 is a good place for this


[25-Jul-19 09:18 AM] jl777c#5810
internally it is a hash that is sent to the getntzsproofresp function, not a height, this avoids the confusion about what height the notarization is at vs what it notarized


[25-Jul-19 09:18 AM] jl777c#5810
but not very friendly from a user api basis


[25-Jul-19 09:18 AM] jl777c#5810
notarizations is a good api call to make to find the right hash to use


[25-Jul-19 09:18 AM] jl777c#5810
if that is needed


[25-Jul-19 09:19 AM] jl777c#5810
updated my KMD, ILN and NSPV fullnodes with latest version

{Reactions}
üëç 

[25-Jul-19 09:33 AM] Deleted User#0000
I think we should move teh fetch of the headers to a seperate API in the daemon. This should make it reasonably easy.


[25-Jul-19 09:34 AM] Deleted User#0000
Currently it only fetches between 2 notarizations so if you cant scan forwards because it doesnt exist yet. So the notarizations should just be returned then those 2 heights used to call a function for headers


[25-Jul-19 09:35 AM] Deleted User#0000
That may change a bit much stuff though ü§î


[25-Jul-19 09:36 AM] jl777c#5810
getinfo has an optional hdrheight parameter


[25-Jul-19 09:37 AM] jl777c#5810
you can query for individual header


[25-Jul-19 09:37 AM] jl777c#5810
why not use that?


[25-Jul-19 09:37 AM] jl777c#5810
it is actually more efficient to do 10 smaller tx than one big one, due to packet switching characteristics


[25-Jul-19 09:38 AM] jl777c#5810
i think a single getinfo might actually fit into a single tcp/ip packet, but not sure


[25-Jul-19 09:38 AM] Deleted User#0000
IUt will use lots of nodes aswell and spread it around


[25-Jul-19 09:38 AM] jl777c#5810
yes, it is better to request headers one at a time


[25-Jul-19 09:42 AM] Deleted User#0000
Its constantly getting sent them by all nodes. So really in not much time of being online it has almost enough headers received, just doesnt save them anywhere


[25-Jul-19 09:44 AM] Deleted User#0000
Should be enough to just check the previous header and save them back to he last notarizatrion


[25-Jul-19 09:45 AM] jl777c#5810
yes, just storing the most recent 100 headers will be enough in 99.9% of cases


[25-Jul-19 09:45 AM] jl777c#5810
just rotate the buffer and request any that are missing


[25-Jul-19 09:45 AM] jl777c#5810
any new block should just connect right up to the chain tip to become the new chaintip


[25-Jul-19 09:46 AM] jl777c#5810
in case of reorg, then might need to wait for notarization to resolve things, as longest chain will be fighting each other until we get a notarization


[25-Jul-19 09:46 AM] Deleted User#0000
hmm yes, it currently wouldnt go backwards lol


[25-Jul-19 09:47 AM] jl777c#5810
yes, it is quite primitive


[25-Jul-19 09:48 AM] Deleted User#0000
I mean as long as the chain is still moving, it would eventually be ok...


[25-Jul-19 09:48 AM] jl777c#5810
i guess maybe reorg handling would be good, ie. if a longer chain comes in, then need to request the missing headers until it connects to the notarized chain


[25-Jul-19 09:48 AM] Deleted User#0000
but yes the  headers it has would then be wrong. and need to be checked


[25-Jul-19 09:48 AM] jl777c#5810
i think that is all that needs to be done. so if a new longer chain arrives that doesnt connect, then query the prior heights to fill in the missing headers


[25-Jul-19 09:49 AM] jl777c#5810
or can rely on reorgs being rare enough, to just clear the entire cache if it is detected


[25-Jul-19 09:49 AM] jl777c#5810
then scanning back to the notarization will automatically fill it with the valid headers


[25-Jul-19 09:50 AM] Deleted User#0000
That might be a lot easier, not that the chain tip is that imporant, most utxos are actually notarised


[25-Jul-19 09:51 AM] TonyL#3577
https://github.com/jl777/libnspv/blob/master/src/tools/nSPV_rpc.h#L1206 as I understand so far - some specific windows case winsocket initialisation is needed here  (similar to this one https://stackoverflow.com/questions/28027937/cross-platform-sockets)

{Embed}
https://github.com/jl777/libnspv/blob/master/src/tools/nSPV_rpc.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559

{Embed}
https://stackoverflow.com/questions/28027937/cross-platform-sockets)
Cross-platform sockets
I know, Windows doesn't use UNIX sockets while Mac OS does. Until this point my software was cross-platform without any code changes. But now I want it to do some network communication. I know about
https://images-ext-1.discordapp.net/external/dP07hBXxuorGcvXU609uJ_e6ZgPlIdBxqG8OjQQiAyY/%3Fv%3D73d79a89bded/https/cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon%402.png


[25-Jul-19 09:53 AM] jl777c#5810
aha! WSAStartup! ok, adding it


[25-Jul-19 09:53 AM] TonyL#3577
```getaddrinfo(0.0.0.0) returned error
[warn] evsig_init_: socketpair: ‚ïö—ã—à —è–Å—à—ã—é—Ü—Ö—ç—à—Ö —ç—Ö —Ç‚àö—á—Ç—Ä—ã—é WSAStartup, —à—ã—à —è–Å—é—à—á—é¬∞—ã—Ä —é¬∞—à—Å—ä—Ä —Ç WSAStartup.```


[25-Jul-19 09:54 AM] TonyL#3577
yep, print which I'm getting on binary startup contains "WSAStartup" word and some abrakadabra üòÉ


[25-Jul-19 09:55 AM] jl777c#5810
updated


[25-Jul-19 09:56 AM] jl777c#5810
hope it builds


[25-Jul-19 10:00 AM] TonyL#3577
I'm connected!

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603995116239060997/unknown.png


[25-Jul-19 10:03 AM] jl777c#5810
wow! can you open the browser to http://127.0.0.1:7771


[25-Jul-19 10:04 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603995942353633286/unknown.png


[25-Jul-19 10:04 AM] TonyL#3577
In browser "cant find index.html" should I put it to the same dir with binary?


[25-Jul-19 10:05 AM] jl777c#5810
yes, it needs to be run from ~/libnspv


[25-Jul-19 10:05 AM] TonyL#3577
on windows PC have only binary - will test a little bit later


[25-Jul-19 10:05 AM] TonyL#3577
but curl calls works


[25-Jul-19 10:06 AM] jl777c#5810
you need to make html dir with those files


[25-Jul-19 10:06 AM] jl777c#5810
can do the same browser test in unix


[25-Jul-19 10:06 AM] jl777c#5810
it doesnt work yet, so dont get too excited

{Reactions}
üëç 

[25-Jul-19 10:07 AM] jl777c#5810
but it looks pretty good on osx


[25-Jul-19 10:08 AM] jl777c#5810
but if windows can do spend, that means we are already cross platform


[25-Jul-19 10:08 AM] jl777c#5810
for installing, all that is needed is to launch the executable and open the browser to the 127.0.0.1 page


[25-Jul-19 10:10 AM] TonyL#3577
on windows

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603997468593487879/unknown.png


[25-Jul-19 10:10 AM] TonyL#3577
is it some stub?


[25-Jul-19 10:11 AM] jl777c#5810
yes, do you have the css file in the html dir?


[25-Jul-19 10:12 AM] TonyL#3577
yes


[25-Jul-19 10:12 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603997950695309407/unknown.png


[25-Jul-19 10:12 AM] jl777c#5810
so the bootstrap.min.css file is there?


[25-Jul-19 10:13 AM] TonyL#3577
yes, both bootstrap and favicon


[25-Jul-19 10:13 AM] jl777c#5810
what about unix?


[25-Jul-19 10:15 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/603998792353579141/unknown.png


[25-Jul-19 10:15 AM] TonyL#3577
on unix it looks cool


[25-Jul-19 10:16 AM] jl777c#5810
yes,the same for osx


[25-Jul-19 10:16 AM] jl777c#5810
seems windows is the blacksheep again


[25-Jul-19 10:16 AM] jl777c#5810
what browser did you use in windows?


[25-Jul-19 10:16 AM] TonyL#3577
chrome


[25-Jul-19 10:16 AM] jl777c#5810
maybe it is browser specific


[25-Jul-19 10:17 AM] TonyL#3577
and chrome on unix too


[25-Jul-19 10:17 AM] TonyL#3577
maybe something is on my side, checking


[25-Jul-19 10:20 AM] TonyL#3577
it seems like a pathes windows specific issue


[25-Jul-19 10:21 AM] TonyL#3577
on windows it showing this not pretty html only when html page files and binary locating in same directory


[25-Jul-19 10:21 AM] jl777c#5810
but it is finding the index.html


[25-Jul-19 10:21 AM] jl777c#5810
so it should be finding the .css file too


[25-Jul-19 10:22 AM] TonyL#3577
yes, thats strange


[25-Jul-19 10:24 AM] jl777c#5810
a mystery for some windows browser familiar person to help fix


[25-Jul-19 10:27 AM] jl777c#5810
what if you try 127.0.0.1:7771/bootstrap.min.css


[25-Jul-19 10:27 AM] jl777c#5810
it should direcly load the css file


[25-Jul-19 10:27 AM] jl777c#5810
unix vs win would show if it is a file not found issue or something else


[25-Jul-19 10:28 AM] TonyL#3577
http://127.0.0.1:7771/bootstrap.min.css returns ERR_INVALID_HTTP_RESPONSE so it's on server (nspv binary) side I wonder


[25-Jul-19 10:28 AM] TonyL#3577
but no prints in nspv console


[25-Jul-19 10:28 AM] TonyL#3577
ah, it static html it seems nvm üòÉ


[25-Jul-19 10:29 AM] jl777c#5810
what happens on unix


[25-Jul-19 10:30 AM] TonyL#3577
on unix website working fine


[25-Jul-19 10:30 AM] jl777c#5810
it loads the css data?


[25-Jul-19 10:30 AM] TonyL#3577
yes


[25-Jul-19 10:31 AM] TonyL#3577
beauty screenshot above it's from unix


[25-Jul-19 10:31 AM] jl777c#5810
http://127.0.0.1:7771/bootstrap.min.css  should just return a bunch of html


[25-Jul-19 10:31 AM] jl777c#5810
not graphics


[25-Jul-19 10:33 AM] TonyL#3577
ah, you've asked about css request


[25-Jul-19 10:33 AM] TonyL#3577
yes, it return file

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/604003311129067540/unknown.png


[25-Jul-19 10:34 AM] TonyL#3577
it should be a problem somewhere on my side I think because it's super strange, but not sure yet where there might be a problem


[25-Jul-19 10:35 AM] jl777c#5810
i think i know the problem


[25-Jul-19 10:35 AM] jl777c#5810
it needs a MIME type


[25-Jul-19 10:36 AM] TonyL#3577
`type="text/css"` I've tried to set it


[25-Jul-19 10:39 AM] jl777c#5810
pushed fix


[25-Jul-19 10:43 AM] TonyL#3577
ok, it's time to move from master to jl777 branch as I understand


[25-Jul-19 10:43 AM] jl777c#5810
yes


[25-Jul-19 10:44 AM] TonyL#3577
https://github.com/jl777/libnspv/pull/24/files opened PR to build jl777 branch for windows

{Embed}
https://github.com/jl777/libnspv/pull/24/files
Windows build script by tonymorony ¬∑ Pull Request #24 ¬∑ jl777/li...
https://images-ext-2.discordapp.net/external/IULxymVak7WPV8PZwfkPCOyLSBf6KKjfvRL8wa24Vjc/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/24797699


[25-Jul-19 10:51 AM] TonyL#3577
unfortunately its the same on my side now


[25-Jul-19 10:53 AM] jl777c#5810
merged and got it working on osx


[25-Jul-19 10:53 AM] jl777c#5810
i think it should build in windows


[25-Jul-19 10:54 AM] TonyL#3577
it's building but css not working still


[25-Jul-19 10:54 AM] jl777c#5810
any errors


[25-Jul-19 10:54 AM] jl777c#5810
i had to fiddle with the ifdefs


[25-Jul-19 10:54 AM] jl777c#5810
does jl777 branch build now?


[25-Jul-19 10:54 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/604008662410723368/unknown.png


[25-Jul-19 10:54 AM] TonyL#3577
yes, jl777 branch building for windows


[25-Jul-19 10:54 AM] TonyL#3577
let me check for unix


[25-Jul-19 10:56 AM] jl777c#5810
interesting that it shows :7771/bootstrap.min.css


[25-Jul-19 10:56 AM] jl777c#5810
let me add a hack to allow that to be mapped also


[25-Jul-19 10:58 AM] TonyL#3577
upd unix building fine too on latest jl777


[25-Jul-19 10:59 AM] jl777c#5810
ok, try on windows now


[25-Jul-19 11:04 AM] TonyL#3577
yay!

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/604011166548885515/unknown.png


[25-Jul-19 11:04 AM] TonyL#3577
btw maybe it worked on previous commit too (messed up with upstreams hehe)


[25-Jul-19 11:05 AM] TonyL#3577
can check previous commit if needed


[25-Jul-19 11:06 AM] TonyL#3577
windows is os for puzzle lovers as I understand üòÉ


[25-Jul-19 11:08 AM] jl777c#5810
it works now, that is all that matters


[25-Jul-19 11:09 AM] jl777c#5810
there are thousands of older commits, but if the latest version is working better than the rest, who cares about them


[25-Jul-19 11:09 AM] jl777c#5810
the problem is that windows is searching for a DIFFERENT filename, prepending :7771 to it!


[25-Jul-19 11:09 AM] jl777c#5810
gotta love all these deviations from sanity to lock people into an obsolete system

{Reactions}
üöÄ (2) KMD (2) 

[25-Jul-19 11:11 AM] jl777c#5810
@TonyL pushed fix so it will work for non-KMD coins too


[25-Jul-19 11:12 AM] jl777c#5810
also do you know how to add a new coin to coins file? it is good to know how to do


[25-Jul-19 11:12 AM] jl777c#5810
and now we just need a cross platform installer that can launch ./nspv and open the 127.0.0.1:port page


[25-Jul-19 11:13 AM] jl777c#5810
i am working with satinder to get the html wallet actually working, but as far as installer goes as long as the html files are in html directory where the ./nspv is when launched, it will work


[25-Jul-19 11:14 AM] jl777c#5810
and my analysis is that the localhost html will be pretty much as secure as cli, the only exception is if your browser has some sort of localhost intercept exploit


[25-Jul-19 11:14 AM] jl777c#5810
it is totally static .html


[25-Jul-19 11:14 AM] jl777c#5810
no javascript


[25-Jul-19 11:14 AM] jl777c#5810
all dynamically generated from inside nspv


[25-Jul-19 11:15 AM] jl777c#5810
so we can get what looks like a webwallet, with electrum server speed, nearly fullnode cli security

{Reactions}
shexy (3) 

[25-Jul-19 11:15 AM] jl777c#5810
that is fully decentralized

{Reactions}
üôè (3) 

[25-Jul-19 11:15 AM] TonyL#3577
thats very cool! 

`also do you know how to add a new coin to coins file? it is good to know how to do` are you syncing coins file in libnspv with this one https://github.com/jl777/coins/blob/master/coins ?

{Embed}
https://github.com/jl777/coins/blob/master/coins
jl777/coins
coin parameters and all files needed for GUI support - jl777/coins
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[25-Jul-19 11:31 AM] jl777c#5810
i will be making PR from libnspv to my coins repo and then rebasing


[25-Jul-19 11:31 AM] jl777c#5810
so for immediate effect make the PR to the libnspv coins file. but either way it will end up in libnspv


[25-Jul-19 11:52 AM] dukeleto#7326
hard to keep up on all the awesome stuff happening here! Keep it up, folks


[25-Jul-19 11:52 AM] jl777c#5810
years of progress, compressed into 3 weeks

{Reactions}
üññ 

[25-Jul-19 11:56 AM] jl777c#5810
@radix42 could you check to see if libnspv builds and runs on 32bit arm?


[25-Jul-19 12:17 PM] radix42#3743
I can fire up my 32 bit arm machine later yes


[25-Jul-19 12:20 PM] radix42#3743
where's the repo to build @jl777c


[25-Jul-19 12:22 PM] jl777c#5810
https://github.com/jl777/libnspv


[25-Jul-19 12:22 PM] jl777c#5810
it has about 300kb executable size, 3MB RAM usage when it is a superlite client


[25-Jul-19 12:43 PM] radix42#3743
builds cleanly on a 32bit raspberry pi! @jl777c

{Reactions}
üöÄ (3) 

[25-Jul-19 01:03 PM] jl777c#5810
nice! does it work?


[25-Jul-19 01:04 PM] jl777c#5810
./nspv should just connect to KMD nodes


[25-Jul-19 01:06 PM] radix42#3743
doh! i disconnected that box, but i just built on a 64 bit arm and will try on that


[25-Jul-19 01:07 PM] jl777c#5810
if we can verify it works on arm and especially 32bit arm, that opens up iot usage for nspv


[25-Jul-19 01:08 PM] radix42#3743
i can reconnect my 32 bit arm machine later, i had to steal a keyboard from one of my kids to fire it up lol


[25-Jul-19 01:08 PM] radix42#3743
what does success look like? it connects and disconnected from two nodes


[25-Jul-19 01:09 PM] jl777c#5810
it should just print some ipaddresses


[25-Jul-19 01:09 PM] radix42#3743
```
./nspv 
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash KMD
Start NSPV_rpcloop.7771
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:7771 bind sock.3 API enabled at unixtime.1564085212 <<<<<<<<<
Discover KMD peers...nServices.0 disconnect from node 23: /MagicBean:2.0.15-rc2/ (0)
Disconnect node 23
nServices.5 disconnect from node 18: /MagicBean:2.0.15-rc2/ (1458613)
Disconnect node 18
```


[25-Jul-19 01:09 PM] jl777c#5810
real test is if you can send curl requests to it


[25-Jul-19 01:09 PM] jl777c#5810
https://docs.komodoplatform.com/nSPV/#introduction


[25-Jul-19 01:09 PM] jl777c#5810
yes those are non-nSPV fullnodes


[25-Jul-19 01:10 PM] jl777c#5810
you can issue a getinfo or getpeerinfo via curl


[25-Jul-19 01:10 PM] jl777c#5810
or if it has a browser, via http://127.0.0.1:7771/api/method/getinfo


[25-Jul-19 01:10 PM] jl777c#5810
http://127.0.0.1:7771 might bring up a wallet html


[25-Jul-19 01:11 PM] jl777c#5810
the fact it went up to node 18 and 23 means it has over 10 peers


[25-Jul-19 01:12 PM] jl777c#5810
so you should be able to login with wif, send funds to it, listunspent to see it and spend to sign a valid tx


[25-Jul-19 01:13 PM] radix42#3743
I can do a getpeerinfo curl just fine!


[25-Jul-19 01:14 PM] radix42#3743
I'll try it on the 32 bit arm later


[25-Jul-19 01:14 PM] jl777c#5810
nice!


[25-Jul-19 01:18 PM] radix42#3743
here's my getinfo curl:
```
{
  "result": "success",
  "nSPV": "superlite",
  "height": 1458623,
  "chaintip": "0a79bc99dddff919164169b35c765a82e49fac6997719d106dbbbd77787fe841",
  "notarization": {
    "notarized_height": 1458610,
    "notarized_blockhash": "0b900006509bac1d4ce8220524f9e88c5344c1e6c374c0b0b0582cc90d2e2ab6",
    "notarization_txid": "ad670886cad93aa5d9cf9d0c08cc562264cbcb9a2df9dc9ec6cabd0062e198c4",
    "notarization_txidheight": 1458622,
    "notarization_desttxid": "c088e5452b6509a5b231b9822de334d8b47f23d098200cbd05cd748956425872"
  },
  "header": {
    "height": 1458623,
    "blockhash": "0a79bc99dddff919164169b35c765a82e49fac6997719d106dbbbd77787fe841",
    "hashPrevBlock": "000000009a8f937e46b7bfa9bbb9e2c7ffeb589ea5a9c45083162a8d2a9d8309",
    "hashMerkleRoot": "699651e35fa53dae850510683b53ff3074f95ccdf4ef120970c837f6a7de0db5",
    "nTime": 1564085757,
    "nBits": 486623038
  },
  "protocolversion": 0,
  "lastpeer": "nodeid.11"
}```


[25-Jul-19 01:19 PM] radix42#3743
this is on a rock64 running armbian


[25-Jul-19 01:41 PM] jl777c#5810
its working!


[25-Jul-19 01:42 PM] jl777c#5810
most likely you can do proper spends on it


[25-Jul-19 01:58 PM] radix42#3743
nice


[25-Jul-19 09:07 PM] dukeleto#7326
https://twitter.com/dukeleto/status/1154603039807954944

{Embed}
Duke Leto (@dukeleto)
https://twitter.com/dukeleto/status/1154603039807954944
These amazing #superlite wallets are coming quickly to $HUSH, which also has smart contracts enabled that #nSPV can interact with. It's really exciting to see something drastically better than Electrum evolve in a matter of weeks.
Time to throw Electrum away, very soon. ht...
Twitter

{Reactions}
üî• 

[25-Jul-19 09:08 PM] dukeleto#7326
I can't say enough good things about nSPV


[25-Jul-19 09:20 PM] jl777c#5810
there is no CC support in nspv yet, in komodod -nSPV=1 mode there is most of the CC supported. so it is indeed possible, just not done yet


[25-Jul-19 09:21 PM] jl777c#5810
adding skipcount and search filters would allow electrum to support addresses with a lot more utxo, not sure why they dont


[25-Jul-19 09:45 PM] dukeleto#7326
@jl777c by the time people read that tweet, you will have written most of the code üòÉ

{Reactions}
‚ö° 

[25-Jul-19 09:57 PM] jl777c#5810
i made the nSPV_CCtx.h file with a stub for faucet get, but i will leave it to mihailo and blackjok3r to implement. now that we have utxo selection with CCflag, it really is just a matter to construct the tx and sign it. i guess the cryptoconditions signing code needs to be ported too... maybe i will get the first one working as an example, but next step is the secure html wallet


[25-Jul-19 10:51 PM] Deleted User#0000
might have to rethink how Im doing this validation. I should have slept before starting it. its a total mess


[26-Jul-19 12:03 AM] Deleted User#0000
Dont know what I have done or  if its the main nodes, but the hashPrevBlock and blockhash seem to be the same üò¶


[26-Jul-19 12:04 AM] Deleted User#0000
Guess I will start my own full nodes to isolate it


[26-Jul-19 10:32 AM] gcharang#6833
@jl777c 
how is txproof used?
```bash
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "txproof", "params": ["e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855",0,1453881 ] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
```
```json
{
  "txid": "e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855",
  "height": 1453881,
  "txlen": 244,
  "txprooflen": 1655,
  "lastpeer": "nodeid.1"
}
```


[26-Jul-19 11:29 AM] jl777c#5810
i should add the actual hex of the tx and txproof, it is more an internal function so it wasnt critical, there will be a gettransaction api that will work for getting rawtx bytes


[26-Jul-19 11:30 AM] gcharang#6833
got it


[26-Jul-19 11:30 AM] jl777c#5810
i will add a "hex" field for the rawtransaction bytes an "proof" for the txproof

{Reactions}
üëç 

[26-Jul-19 07:47 PM] Deleted User#0000
Going to have to totally start again and add more code to daemon to make the validation work. Simply cannot make it sync backwards won't fetch the headers, I spent 2 entire days messing with it and got not very far. Best thing to do will be to fetch all of the headers from say 3     random nodes, all in one call, because getinfo spam just breaks everything.


[26-Jul-19 08:00 PM] dukeleto#7326
What if 1 or 2 nodes disagree on headers, or all 3 are malicious? Electrum is dealing with problems just like this, so I think it's important to design for that threat scenario


[26-Jul-19 09:08 PM] Deleted User#0000
I tried to make it fetch blocks randomly from all nodes, but it just wont handle the load


[26-Jul-19 09:08 PM] Deleted User#0000
Either there is some fatal flaw in how it all works, or I did something wrong, but it doesnt seem to me you can quickly request blocks from some X% of nodes


[26-Jul-19 09:11 PM] Deleted User#0000
As things are that is. I think an extra call needs to be made that can fetch a range of headers from 1 node. 
Then the client can request the range from multiple nodes, then compare them to make sure they match. We only need to find 1 notarization that all nodes agree on I think, but that doesnt mean a node and just make fake block headers, after this notarization


[26-Jul-19 09:12 PM] Deleted User#0000
So you need to have data from many nodes ..


[26-Jul-19 09:12 PM] Deleted User#0000
Even then, many nodes could be malicious.


[26-Jul-19 09:13 PM] Deleted User#0000
The other way to do it, is just make people wait ü§£  
You just cant make any tx or do anything until it has enough received blocks.


[26-Jul-19 09:15 PM] dukeleto#7326
We want to make the average attack scenario more costly for the attacker while not reducing user-visible features, if possible


[26-Jul-19 09:16 PM] dukeleto#7326
@Deleted User choose 10 nodes randomly each startup, and I would say that is pretty good. If it isn't, you are being Sybil-attacked and probably have worse problems


[26-Jul-19 09:16 PM] dukeleto#7326
James explained that you only need 1 good server to prove the other 9 wrong


[26-Jul-19 09:17 PM] Deleted User#0000
Yes, but you need allthe data from ALL the nodes to do that


[26-Jul-19 09:18 PM] Deleted User#0000
so you ned a full node basically


[26-Jul-19 09:18 PM] dukeleto#7326
that means only 10% of network needs to be good servers, on average, to protect against 90% evil servers


[26-Jul-19 09:18 PM] Deleted User#0000
When it starts up, there is onyl 1 node


[26-Jul-19 09:18 PM] Deleted User#0000
james's


[26-Jul-19 09:18 PM] Deleted User#0000
then his node sends you the rest


[26-Jul-19 09:18 PM] dukeleto#7326
what about the concept of a DNS seed?


[26-Jul-19 09:18 PM] Deleted User#0000
at start up I cant randomly choose a few nodes because they are not there


[26-Jul-19 09:18 PM] dukeleto#7326
a hostname which returns many IPs, trusted seed nodes


[26-Jul-19 09:19 PM] dukeleto#7326
baked into src code


[26-Jul-19 09:19 PM] Deleted User#0000
its already there, james just didnt use it


[26-Jul-19 09:19 PM] Deleted User#0000
so I assume that will drop right in


[26-Jul-19 09:19 PM] Deleted User#0000
in any case thats not really important


[26-Jul-19 09:19 PM] dukeleto#7326
what problem are you trying to solve, exactly?


[26-Jul-19 09:19 PM] Deleted User#0000
How it works now,. is all node you are connected to send you the `getinfo` call


[26-Jul-19 09:20 PM] Deleted User#0000
this allows you to know the chain tip, and the last notarization


[26-Jul-19 09:20 PM] Deleted User#0000
but not the blocks inbetween


[26-Jul-19 09:20 PM] Deleted User#0000
what I needed to do was take the chain tip and validate the blockhash->prevblockhash back to the last notarization


[26-Jul-19 09:21 PM] Alright#0419
I'm struggling to understand how that will work


[26-Jul-19 09:21 PM] Deleted User#0000
I made it very badly, cant antually be used, but I needed something to experiment with to see what works and what doesnt. And basically, when you start to reqest a lot of blocks all peers get very mad at you and everything breaks


[26-Jul-19 09:21 PM] Alright#0419
normal SPV can weed out bad peers by going "oh look this peer has the most POW" by just looking at headers


[26-Jul-19 09:21 PM] Alright#0419
then assume any other peer with less POW is evil


[26-Jul-19 09:22 PM] Alright#0419
we need the full block to do that with dpow, no?


[26-Jul-19 09:22 PM] Alright#0419
or at least the notarizations


[26-Jul-19 09:22 PM] Deleted User#0000
notarizations can be got with a very lightweight call, but it totally fails on chaintip, becaue there is no future notarization


[26-Jul-19 09:23 PM] Deleted User#0000
Im really thinking it just cant really work on chain tip


[26-Jul-19 09:23 PM] Alright#0419
how can you trust that a peer is showing you the latest notarization?


[26-Jul-19 09:23 PM] Alright#0419
that's what I mean


[26-Jul-19 09:24 PM] Deleted User#0000
by asking a whole bunch of them I think.... But thats really not seeming to be a working solution


[26-Jul-19 09:24 PM] Deleted User#0000
It would require removing a whole heap of rate limiters and  weell... that is totaly stupid


[26-Jul-19 09:26 PM] Alright#0419
yea I guess what I said doesn't really make sense


[26-Jul-19 09:26 PM] Alright#0419
if you have at least 1 honest peer showing you latest, you're good?


[26-Jul-19 09:26 PM] Alright#0419
same concept as SPV really


[26-Jul-19 09:26 PM] Deleted User#0000
yes, you have all peers sending getinfo and latest headers..


[26-Jul-19 09:27 PM] Deleted User#0000
but I cant get it to fetch blocks in reversee... There is data missing in the getinfo+headers call


[26-Jul-19 09:28 PM] Deleted User#0000
So I had to make structures and loops and all kinds of stupid shit, to filter results and sort them and build the correct info by iterating in reverse


[26-Jul-19 09:28 PM] Deleted User#0000
Slow as all fuck. doesnt work.


[26-Jul-19 09:28 PM] Deleted User#0000
Going to just change daemon


[26-Jul-19 09:28 PM] Deleted User#0000
Cant work with these limitations


[26-Jul-19 09:29 PM] Deleted User#0000
ü§î  lol just realised something


[26-Jul-19 09:30 PM] Deleted User#0000
You can get the block hash fromt he header itself


[26-Jul-19 09:30 PM] Deleted User#0000
ü§¶


[26-Jul-19 09:30 PM] Deleted User#0000
Its not actually there


[26-Jul-19 09:30 PM] Deleted User#0000
but you can hash it to get it


[26-Jul-19 09:30 PM] Alright#0419
still don't understand what it is you're trying to do


[26-Jul-19 09:30 PM] Deleted User#0000
wait i'll show you the problem


[26-Jul-19 09:31 PM] Deleted User#0000
https://github.com/blackjok3rtt/libnspv/blob/master/src/tools/nSPV_superlite.h#L237

{Embed}
https://github.com/blackjok3rtt/libnspv/blob/master/src/tools/nSPV_superlite.h
blackjok3rtt/libnspv
Tiny Bitcoin Library written in C, with nSPV added - blackjok3rtt/libnspv
https://images-ext-2.discordapp.net/external/H9TDr69kM7mmxGBcENY3FInyORgkC6up-3NZ7sRUihU/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/30971146


[26-Jul-19 09:31 PM] Deleted User#0000
here


[26-Jul-19 09:31 PM] Deleted User#0000
it doesnt validate anything, and if a reorg happens it cannot go in reverse


[26-Jul-19 09:31 PM] Deleted User#0000
https://github.com/blackjok3rtt/libnspv/blob/master/src/tools/nSPV_superlite.h#L246
trying to fix what this comment says

{Embed}
https://github.com/blackjok3rtt/libnspv/blob/master/src/tools/nSPV_superlite.h
blackjok3rtt/libnspv
Tiny Bitcoin Library written in C, with nSPV added - blackjok3rtt/libnspv
https://images-ext-2.discordapp.net/external/H9TDr69kM7mmxGBcENY3FInyORgkC6up-3NZ7sRUihU/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/30971146


[26-Jul-19 09:32 PM] Deleted User#0000
I think Im just going to make it so that you have to wait until enough blocks arrive.


[26-Jul-19 09:32 PM] Deleted User#0000
Doesnt seem worth the100 hours work to reqwrite half of it to be able to request blocks from the past.


[26-Jul-19 09:33 PM] Deleted User#0000
All the tx shit works with past blocks already, not sure what the chain tip even does


[26-Jul-19 09:33 PM] Alright#0419
need a much higher level explanation or I'll be no help üòõ


[26-Jul-19 09:34 PM] Deleted User#0000
I cant explain it any mroe than that. Basically it needs:
` blockhash == hashprevblock`


[26-Jul-19 09:34 PM] Deleted User#0000
but that cant work for a reorg so jl used heights only


[26-Jul-19 09:35 PM] Alright#0419
`what I needed to do was take the chain tip and validate the blockhash->prevblockhash back to the last notarization` why?


[26-Jul-19 09:35 PM] Deleted User#0000
you tell me thats what he asked me to do


[26-Jul-19 09:36 PM] Alright#0419
getting off for the day, lmk what he says üòÑ


[26-Jul-19 09:37 PM] Alright#0419
not sure I understand, but it seems like you trust the notarization to tell you the chain is the correct chain, why would you need to validate blocks back to the previous notarization?


[26-Jul-19 09:37 PM] Alright#0419
how does that help?


[26-Jul-19 09:37 PM] Deleted User#0000
this is on chain tip, there is no notarizxation, only the last one you see,


[26-Jul-19 09:37 PM] Deleted User#0000
dont need to go back another


[26-Jul-19 09:58 PM] Deleted User#0000
ok I think I figured out how to do it. 
I need a hash table to stick the headers in. The block hash can be hashed from the header, there is a function already for this. Then it shuold be fast and easy to just iterate  backwards to the last notarization on each block header received.


[26-Jul-19 09:58 PM] Deleted User#0000
This seems the onyl viable way to be able to validate the headers nodes are sending you are real, while not destroying the network


[26-Jul-19 09:59 PM] Deleted User#0000
This definally means though that a node will not know its on the right chain until it receives a notarized header.


[26-Jul-19 09:59 PM] Deleted User#0000
unless I make a new API call.


[26-Jul-19 10:11 PM] jl777c#5810
you are way overcomplicating this


[26-Jul-19 10:12 PM] jl777c#5810
given the chaintip height, just requests the getinfo for the 10 or so blocks to the most recent notarization


[26-Jul-19 10:12 PM] jl777c#5810
10 getinfo is not any large overhead


[26-Jul-19 10:13 PM] jl777c#5810
in fact, you are already making getinfo calls to all the peers, just with asking for the chaintip. so without any extra overhead you can get the most recent 10 headers via the getinfo calls you are doing anyway


[26-Jul-19 10:13 PM] jl777c#5810
why would this cause any performance issue? also each chain has about 10 seed nodes


[26-Jul-19 10:18 PM] jl777c#5810
so just change the hdrheight being requested on the background getinfo calls


[26-Jul-19 10:18 PM] jl777c#5810
then as they come in just calculate its blockhash and make sure its prev matches the blockhash of the prior block


[26-Jul-19 10:19 PM] jl777c#5810
i would start from the last notarization + 1, and just increment it until you reach the chain tip


[26-Jul-19 10:20 PM] jl777c#5810
then as it comes in you can validate that it connects to the notarization.


[26-Jul-19 10:20 PM] jl777c#5810
just use a rotating buffer of 100 hashes or so to track the current mainchain.


[26-Jul-19 10:21 PM] jl777c#5810
if you see a new height greater than chaintip that doesnt link back, then clear the rotating buffer and do it again, or you can be a bit more fancy and track multiple forks


[26-Jul-19 10:23 PM] jl777c#5810
when a new notarization comes in, reset the rotating buffer as we have the checkpoint


[26-Jul-19 10:31 PM] Deleted User#0000
I did that and no nodes respond to me


[26-Jul-19 10:32 PM] jl777c#5810
this should not be a lot of code at all. just an incrementing variable for the hdrheight being requested


[26-Jul-19 10:32 PM] Deleted User#0000
Maybe sending too many requests just breaks it I dont know


[26-Jul-19 10:32 PM] jl777c#5810
you are limited to 1 request per message per second per peer


[26-Jul-19 10:32 PM] jl777c#5810
if you have 10 peers, you can make 10 getinfo calls per second


[26-Jul-19 10:33 PM] jl777c#5810
find the place where it makes the getinfo requests already, just set the hdrheight to a useful one


[26-Jul-19 10:34 PM] jl777c#5810
on processing, just call an update header function that updates the buffer of recent blockhashes


[26-Jul-19 10:34 PM] Deleted User#0000
The main issue is that its doing this validation inside the fuinction that processes repoonse, making new requests in there doesnt really work as it seems to spawn a new thread and everything gets messed up


[26-Jul-19 10:34 PM] jl777c#5810
it is tricky to make recursive requests


[26-Jul-19 10:34 PM] jl777c#5810
just update state when a new getinfo comes in


[26-Jul-19 10:35 PM] jl777c#5810
make it request a useful hdrheight in the getinfo calls it is already doing


[26-Jul-19 10:35 PM] Deleted User#0000
Thats why I just wanted it to stick everything into some data stucture, I used and array and loops but its just too slow


[26-Jul-19 10:35 PM] jl777c#5810
you need to incrementally update state based on the new data that comes in


[26-Jul-19 10:35 PM] jl777c#5810
not trigger some brute force validation in the message completion function


[26-Jul-19 10:36 PM] jl777c#5810
that wont work


[26-Jul-19 10:36 PM] Deleted User#0000
no it doesnt, but I needed to do something to understand how it all fit together. I think I get how it works now.


[26-Jul-19 10:36 PM] jl777c#5810
yes


[26-Jul-19 10:36 PM] jl777c#5810
piggy back onto the getinfo requests that are already being made


[26-Jul-19 10:37 PM] jl777c#5810
then when a new header comes in, you just update the state of the recent headers


[26-Jul-19 10:37 PM] Deleted User#0000
I tried to do that and failed badly. I reset all my code back to jl777 and starting agin, maybe I breoke it somwher along the line


[26-Jul-19 10:37 PM] jl777c#5810
once you catch up to chaintip, when the header for the next block comes in, you just need to make sure its prevhash is the prior block


[26-Jul-19 10:38 PM] jl777c#5810
if it isnt, then just reset to the most recent notarization


[26-Jul-19 10:38 PM] Deleted User#0000
Need to work out how to make it request a particular header without iussueing new getinfo calls, because new getinfo calls just dont woirk, it will only make the ones it is already making


[26-Jul-19 10:39 PM] jl777c#5810
NSPV_periodic


[26-Jul-19 10:39 PM] Deleted User#0000
maybe a global vector they can be pushed to and it just takes off the top with each request?


[26-Jul-19 10:39 PM] jl777c#5810
it is making reqht == 0 for all calls


[26-Jul-19 10:39 PM] Deleted User#0000
yes it fetches tip each time


[26-Jul-19 10:40 PM] jl777c#5810
just make it request notarization height +1, +2, +3, ...


[26-Jul-19 10:40 PM] jl777c#5810
so this way there is a stream of useful new headers to update state. ZERO extra overhead


[26-Jul-19 10:40 PM] jl777c#5810
get that working first


[26-Jul-19 10:40 PM] Deleted User#0000
ok I think I understand, now. Man i was over thinking it.


[26-Jul-19 10:40 PM] jl777c#5810
then when you see the headers for +1, +2, +3,... chaintip then you will realize than a simple array is all that is needed in most all the cases


[26-Jul-19 10:41 PM] Deleted User#0000
Yea that makes sense. Store last notarized height and keep requesting all blocks from that height over and over until the next notarization then start again.


[26-Jul-19 10:41 PM] jl777c#5810
yes


[26-Jul-19 10:41 PM] jl777c#5810
and if a reorg happens, just clear to the prior notarization


[26-Jul-19 10:42 PM] jl777c#5810
in the event to two competing forks, you will likely be resetting to notarization over and over. which is maybe a good signal to not do any tx as there is an active fork


[26-Jul-19 10:42 PM] Deleted User#0000
getinfo stuff isnt validating the notarizations though right? just assumign the getinfo call has the right data?


[26-Jul-19 10:43 PM] jl777c#5810
getinfo just returns the raw data


[26-Jul-19 10:43 PM] Deleted User#0000
yes so  how do wer know that the notarization we are trusting to tell us the chain is real?


[26-Jul-19 10:43 PM] jl777c#5810
for each notarization, you would want to do the notarization validation code


[26-Jul-19 10:43 PM] jl777c#5810
that likely needs to be a new api call


[26-Jul-19 10:44 PM] jl777c#5810
gettransaction does prevntz and nextntz


[26-Jul-19 10:44 PM] Deleted User#0000
yea, in this case it can only do prev so that code doesnt work as is


[26-Jul-19 10:44 PM] jl777c#5810
it needs to be setup so you can validate just a single notarization


[26-Jul-19 10:44 PM] jl777c#5810
make a more surgical function that just validates a single notarization


[26-Jul-19 10:44 PM] Deleted User#0000
understood


[26-Jul-19 10:44 PM] jl777c#5810
then the gettransaction can call it twice


[26-Jul-19 10:45 PM] jl777c#5810
the headers tracking just calls it once when it sees a new notarization


[26-Jul-19 10:45 PM] jl777c#5810
so the new api for validating a notarization, is just using the similar code to what is in gettransaction, then changing gettransaction to use that twice. that will not increase code


[26-Jul-19 10:45 PM] jl777c#5810
now there will be a function that validates a notarization in isolation


[26-Jul-19 10:46 PM] jl777c#5810
hdrheight is updated to get +1, +2, +3, ...


[26-Jul-19 10:46 PM] jl777c#5810
getinfo processing just updates the non-notarized blockhashes array


[26-Jul-19 10:47 PM] jl777c#5810
anything wonky, and reset to last notarization. that will deal with reorgs, but end in a meta (un)stable state when there is a competing fork, but in such cases best to not do tx anyway


[26-Jul-19 10:47 PM] jl777c#5810
at some point a new notarization comes in and it all starts over


[26-Jul-19 10:47 PM] jl777c#5810
so it is really a matter to process the chaintip for 10 to 20 blocks


[26-Jul-19 10:49 PM] Deleted User#0000
it could be more than that at times, anyway I understand what to do now.


[26-Jul-19 10:49 PM] silence#8008
https://tenor.com/view/tyrone-biggums-crackhead-drug-thirsty-itchy-gif-13961806

{Embed}
https://tenor.com/view/tyrone-biggums-crackhead-drug-thirsty-itchy-gif-13961806
https://images-ext-2.discordapp.net/external/suxn388p9h77iQzfjyayUn4PXDNcfS8Vhmk9lTixMl0/https/media.tenor.co/images/6257bd674f0c5929e4a5bb4d4da71b81/tenor.png


[26-Jul-19 10:53 PM] jl777c#5810
@Deleted User i think if getinfo returned the number of times the non-notarized blockhashes array has been reset, it will give an indication if there is an active fork/attacker


[26-Jul-19 10:53 PM] jl777c#5810
you cant just make up an invalid blockheader, so that eliminates trusting the fullnode


[26-Jul-19 10:54 PM] jl777c#5810
there is an edgecase of notary mined blocks, which if needed we can validate did not mine more than once in the last 65 blocks


[26-Jul-19 11:01 PM] jl777c#5810
in any case, dont go too crazy with lots of code for this. we just need something simple to track the non-notarized chain. anybody doing large amounts should wait for everything to be notarized anyway, so it is more a detector for current chain conditions


[27-Jul-19 02:00 AM] Deleted User#0000
I've got most of it working already, but the main limitation is that it currently requests the blocks in order, and as such pulls all of them from all nodes.
I had it so that it just pulled them all, but then they arrive out of order, and its much harder to sort them out.


[27-Jul-19 02:00 AM] Deleted User#0000
Also doing them all at once, some nodes return bad data or nothing and u end up with gaps.


[27-Jul-19 02:02 AM] Deleted User#0000
The main problem I see is on start up if there is no notarizations for like the last 20-30 blocks it takes quite a while to fill the array.


[27-Jul-19 02:45 AM] jl777c#5810
just let it trickle in


[27-Jul-19 02:45 AM] jl777c#5810
one request per height


[27-Jul-19 02:45 AM] jl777c#5810
in a few minutes you will have all. i guess you need to cache the entire header, not just the hash, so you can hande things out of order


[27-Jul-19 02:46 AM] jl777c#5810
as long as each getinfo hdrheight is for a height you dont have, then you are getting numpeers*2 headers per minute


[27-Jul-19 02:47 AM] jl777c#5810
for getting a backlinked non-notarized chain a few minutes is fine. unless your utxo are notarized, it isnt notarized anyway, regardless of the state of the non-notarized chain


[27-Jul-19 02:47 AM] jl777c#5810
so only if you are doing non-notarized tx, then you would need the non-notarized blocks


[27-Jul-19 02:48 AM] jl777c#5810
nSPV is designed to scale to millions of users. having nodes blasting away to get optional data in a few seconds is not worth increasing the maxload


[27-Jul-19 02:53 AM] jl777c#5810
i dont understand this part "as such pulls all of them from all nodes"


[27-Jul-19 02:54 AM] jl777c#5810
there is no need to get duplicates as long as the headers end up linking back to the notarization. so in NSPV_periodic, increment to the next height for each request, that will get a different one from each peer


[27-Jul-19 02:54 AM] jl777c#5810
once you get to the chaintip-1, set a flag that you made all the requests


[27-Jul-19 02:55 AM] jl777c#5810
if this flag is set, then on each NSPV_periodic, scan from the notarization to the first header that doesnt exist


[27-Jul-19 02:56 AM] jl777c#5810
separately, have a function that validates the backlinks, maybe when displaying the local getinfo result, you can just display the status of the headers array


[27-Jul-19 02:56 AM] jl777c#5810
before doing a non-notarized spend, then also use this to determine if we have all headers and it is reasonably safe


[27-Jul-19 04:21 AM] Deleted User#0000
The problem is that it calls the same height from every node at the same time,  if you place the counter in the function that does the calls it will request them all , and then they arrive out of order, with headers missing.


[27-Jul-19 04:22 AM] Deleted User#0000
We can fetch them like this, but then we need to sort them and try and request missing ones, gets complicated.


[27-Jul-19 04:24 AM] Deleted User#0000
My understanding from your description was to just fetch them one at a time and store them in order, but is very slow and only uses the first response it gets, as all peers send the same thing


[27-Jul-19 07:10 AM] Deleted User#0000
I think I have it pretty close now.


[27-Jul-19 08:40 AM] jl777c#5810
they will return the value of hdrheight


[27-Jul-19 08:41 AM] jl777c#5810
just change the value you request for each peer, ie. have some shared global variable that increments each time a hdrheight is requested


[27-Jul-19 08:41 AM] jl777c#5810
then each peer will return a different height


[27-Jul-19 08:41 AM] jl777c#5810
you should be able to get it after the first batch


[27-Jul-19 08:41 AM] jl777c#5810
just on request, increment. dont wait for it to arrive


[27-Jul-19 08:42 AM] jl777c#5810
handle out of order by just copying the entire header to a headers[] array


[27-Jul-19 08:42 AM] jl777c#5810
separate out functions that validate the headers array


[27-Jul-19 08:43 AM] jl777c#5810
allocate the buffer where [0] is the most recent notarization, [1] is the next height, etc.


[27-Jul-19 08:43 AM] jl777c#5810
dont worry about processing it on the fly, but if you do get a conflicting one, then maybe ignore it for now. most peers will send the correct value


[27-Jul-19 09:59 AM] Deleted User#0000
I already have it working


[27-Jul-19 10:00 AM] Deleted User#0000
https://github.com/blackjok3rtt/libnspv/commit/b05c0f6be504ade433da45fcffbd785225ac432c

{Embed}
https://github.com/blackjok3rtt/libnspv/commit/b05c0f6be504ade433da45fcffbd785225ac432c
working chain tip validation ¬∑ blackjok3rtt/libnspv@b05c0f6
https://images-ext-2.discordapp.net/external/lu64DQK93KlyiFHOc2R5yqOF7xkNx4h_y9OO2TTLCZA/%3Fs%3D200%26v%3D4/https/avatars1.githubusercontent.com/u/30971146


[27-Jul-19 10:00 AM] Deleted User#0000
shoul;d also handle reorgs just fine I think


[27-Jul-19 10:01 AM] Deleted User#0000
almost impossible to validate the notarization without any data so I just made it count peers that agree before updating


[27-Jul-19 10:01 AM] Deleted User#0000
seems very fast and appears to work fine so far


[27-Jul-19 10:01 AM] jl777c#5810
cant you validate the notarization with txproof and using how it is done in gettransaction?


[27-Jul-19 10:02 AM] jl777c#5810
being very fast is good


[27-Jul-19 10:02 AM] Deleted User#0000
I gave to get the tx first lol, that data doestn exist


[27-Jul-19 10:02 AM] jl777c#5810
i guess we need to test reorg handling


[27-Jul-19 10:02 AM] Deleted User#0000
I think it will work, but im not sure
Basically it just hashes hte blopck header, saves that along with the hashprevblock and height


[27-Jul-19 10:04 AM] Deleted User#0000
I think I can optimize it a bit more stil, because on KMD it takes liek 10 blocks for a nota to be seen as valid, so all those blocks are lost and have to be fetched again when one comes in.


[27-Jul-19 10:04 AM] jl777c#5810
what do you mean by "I gave to get the tx first lol, that data doestn exist" ?


[27-Jul-19 10:04 AM] jl777c#5810
dont you know the notarization txid


[27-Jul-19 10:05 AM] Deleted User#0000
yes but I need to get the tx, which node to I get it from?


[27-Jul-19 10:05 AM] Deleted User#0000
all of them?


[27-Jul-19 10:05 AM] jl777c#5810
just one is enough


[27-Jul-19 10:05 AM] jl777c#5810
you hash the raw tx data and if it matches the txid and it also has notarization opereturn data, it is a valid notarization


[27-Jul-19 10:05 AM] Deleted User#0000
If all nodes agree the notariztion is valid what does it matter?


[27-Jul-19 10:06 AM] jl777c#5810
because by actually validating you can protect against an eclipse attack where all your peers are evil


[27-Jul-19 10:06 AM] jl777c#5810
you can validate a notarization 100% locally once you get the rawtxbytes


[27-Jul-19 10:06 AM] Deleted User#0000
yes, but you can only fertch the tx from one of those peers üòÑ


[27-Jul-19 10:06 AM] Deleted User#0000
so they can fke it


[27-Jul-19 10:07 AM] jl777c#5810
if they send an invalid raw hex, then it is rejected


[27-Jul-19 10:07 AM] Deleted User#0000
what if they make one?


[27-Jul-19 10:07 AM] jl777c#5810
make one that is signed by all the notarize


[27-Jul-19 10:07 AM] jl777c#5810
notaries


[27-Jul-19 10:07 AM] Deleted User#0000
ü§î


[27-Jul-19 10:07 AM] jl777c#5810
did you look at the notarization valiation code?


[27-Jul-19 10:07 AM] Deleted User#0000
yes, but its deep inside many functions


[27-Jul-19 10:08 AM] jl777c#5810
given the rawtx for a notarization, it validates it locally that it is a valid notarization


[27-Jul-19 10:08 AM] Deleted User#0000
I need an easy way to fetch just the tx, but doesnt seem to be one


[27-Jul-19 10:08 AM] jl777c#5810
txproof


[27-Jul-19 10:08 AM] jl777c#5810
that gets the tx


[27-Jul-19 10:08 AM] jl777c#5810
txproof without height, gets only the rawtx


[27-Jul-19 10:08 AM] Deleted User#0000
I looked at that... Guess I look again


[27-Jul-19 10:08 AM] jl777c#5810
with the height, it gets the rawtx and the txproof


[27-Jul-19 10:08 AM] jl777c#5810
but for notarization, we dont need the txproof


[27-Jul-19 10:09 AM] jl777c#5810
just the rawtx


[27-Jul-19 10:09 AM] jl777c#5810
it is selfcontained and validatable


[27-Jul-19 10:09 AM] Deleted User#0000
ahah, I read the output of that RPC wrong.. .I thaught it was all 000 with no height, but it does have a txid


[27-Jul-19 10:09 AM] Deleted User#0000
cool


[27-Jul-19 10:10 AM] jl777c#5810
NSPV_notarizationextract that calls the opretextract and fastnotaries count


[27-Jul-19 10:10 AM] Deleted User#0000
yes I found all that easy enough. just needed the tx


[27-Jul-19 10:10 AM] jl777c#5810
you should just be able to setup to call NSPV_notarizationextract given the txproof ntztxid ht 0 returned valie


[27-Jul-19 10:11 AM] jl777c#5810
lets make nspv as streamlined and efficient as possible


[27-Jul-19 10:11 AM] jl777c#5810
it is so close to perfection


[27-Jul-19 10:11 AM] Deleted User#0000
Im pretty sure that this is so far.


[27-Jul-19 10:12 AM] jl777c#5810
see if you can take advantage of the locally validated notarization to make it even more efficient


[27-Jul-19 10:12 AM] jl777c#5810
it sounds like you are now making efficient getinfo requests


[27-Jul-19 10:12 AM] Deleted User#0000
yes it just rotates though the headers from last notarize to tip


[27-Jul-19 10:13 AM] Deleted User#0000
doesnt stop trying to fetch them, because it must fetch it anyway


[27-Jul-19 10:13 AM] jl777c#5810
exactly!


[27-Jul-19 10:13 AM] jl777c#5810
and it doesnt need to be any voting based system as all can be validated


[27-Jul-19 10:14 AM] Deleted User#0000
once it has enough then it can validate the chain tip, that said, once a noa happens it must fetch a heap of them again, I will fix that though doesnt seem hard


[27-Jul-19 10:15 AM] jl777c#5810
just shifting the array should work as you should already have up to the chain tip and the new notarization is 5 to 10 blocks behind, but all those headers are alrady there


[27-Jul-19 10:16 AM] jl777c#5810
now just need to have reorg detection, which since building the data to chaintip is fast enough, can just reset the headers and start again


[27-Jul-19 10:16 AM] jl777c#5810
have a counter for how many times it had to be reset for this notarization and display in the local getinfo


[27-Jul-19 10:16 AM] jl777c#5810
when we see this as 1 or more, we know something funny is going on with the chain


[27-Jul-19 10:16 AM] Deleted User#0000
not sure it needs that tbh, as it saves all the headers it sees, and just  loops backwards from blockhash to block hash, ignoring any that may no longer be in the main chain


[27-Jul-19 10:17 AM] jl777c#5810
i guess even over a full day, RAM usage would only be 2MB. i was thinking of using fixed size buffer to limit ram usage


[27-Jul-19 10:17 AM] Deleted User#0000
I wish it could loop forwards form a notarizations, but you just cant üò¶


[27-Jul-19 10:18 AM] Deleted User#0000
I clears them after a notarization


[27-Jul-19 10:18 AM] Deleted User#0000
shouldnt use much at all, one sec I'll check it


[27-Jul-19 10:19 AM] jl777c#5810
aha! yes, all the block headers between notarizations, shouldnt be much at all!


[27-Jul-19 10:19 AM] jl777c#5810
just free up all the memory and not matter how long it runs, will just be 20 to 40 headers, even if a chain split


[27-Jul-19 10:19 AM] jl777c#5810
get to where you feel it is efficient as can be and will be able to handle actively being reorged


[27-Jul-19 10:20 AM] jl777c#5810
then we can test it on ILN


[27-Jul-19 10:21 AM] Deleted User#0000
reorg detection should be as simple as detecting that the tiptime is not advancing


[27-Jul-19 10:22 AM] Deleted User#0000
but I may be missing something


[27-Jul-19 10:24 AM] jl777c#5810
it is a reorg if a new height comes in that doesnt link back to the old chaintip


[27-Jul-19 10:24 AM] jl777c#5810
in this case, treat it like a new notarization came in and reset to the latest notarization and build the data from scratch


[27-Jul-19 10:25 AM] jl777c#5810
that way, no matter how deep the reorg. it will get back to the chaintip


[27-Jul-19 10:25 AM] jl777c#5810
certainly if many reorgs are happening, then this will be in a volatile state, but as soon as we get the next notarization, it all stabilizes


[27-Jul-19 10:42 AM] Deleted User#0000
the problem with that is that, we dont know if its just that we are missing a block, or if the chain doesnt actually linkj though. 
I thaught about this for quite a long time.


[27-Jul-19 10:43 AM] Deleted User#0000
the solution I came up with was to just flag that the chain is either in sync or is not.


[27-Jul-19 10:43 AM] Deleted User#0000
if it wont link back, its not in sync. if it does then it is


[27-Jul-19 10:50 AM] Deleted User#0000
unless all of your peers are on the wrong chain, it will eventually find the right one and flag its in sync


[27-Jul-19 11:27 AM] Deleted User#0000
ok I have it working without gaps now. Once a notarization comes in,  it just stays in sync, without needing to fetch previous headers


[27-Jul-19 05:17 PM] Deleted User#0000
https://github.com/blackjok3rtt/libnspv/tree/blackjok3r
Seems to work perfectly so far.

{Embed}
https://github.com/blackjok3rtt/libnspv/tree/blackjok3r
blackjok3rtt/libnspv
Tiny Bitcoin Library written in C, with nSPV added - blackjok3rtt/libnspv
https://images-ext-2.discordapp.net/external/H9TDr69kM7mmxGBcENY3FInyORgkC6up-3NZ7sRUihU/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/30971146

{Reactions}
üòç labs1 

[27-Jul-19 11:11 PM] jl777c#5810
great job!


[27-Jul-19 11:12 PM] jl777c#5810
awaiting PR


[27-Jul-19 11:14 PM] jl777c#5810
with this, it seems the only thing left is adding CC support. starting with cross chain migrates. probably need to have a separate executable/thread and is coordinating multiple nspv instances. that gets chain cluster support to mobile


[27-Jul-19 11:30 PM] Deleted User#0000
Still want to mess with it a bit more, Will make PR soon. Be good to test reorgs, as I cant really do that using KMD just running on tip.


[28-Jul-19 12:20 AM] jl777c#5810
use ILN


[28-Jul-19 12:20 AM] jl777c#5810
to test reorgs as it is notarized and low hashrate


[28-Jul-19 12:21 AM] jl777c#5810
no rush, this sort of thing it needs to be precise


[28-Jul-19 03:42 AM] Deleted User#0000
Got node banning working üòÉ


[28-Jul-19 03:42 AM] Deleted User#0000
Once it is synced, it checks the headers being sent are in the main chain, and if not after 10 bad headers removes the node.


[28-Jul-19 03:43 AM] Deleted User#0000
There is one node that is sending garbage or NULL for the headers in getinfo, so it made it quite easy.


[28-Jul-19 03:48 AM] Deleted User#0000
I think also I have the network code to remove peers who stop responding activated again.


[28-Jul-19 05:52 AM] jl777c#5810
probably some fullnode on an ancient version


[28-Jul-19 05:52 AM] jl777c#5810
there is also a version field returned with getinfo now, it is set to 1


[28-Jul-19 05:52 AM] jl777c#5810
anytime any of the strutures are changed, this will be changed and this allows to immediately detect an obsolete node


[28-Jul-19 05:53 AM] jl777c#5810
the other type would be a honest node, that is just not in sync yet. they can still provide useful info, so storing the height each node is at (many calls return that nodes height) and using that to filter height dependent requests


[28-Jul-19 05:58 AM] Deleted User#0000
Problem is that height doesnt nessarily mean that its the same block as other peers.


[28-Jul-19 06:02 AM] Deleted User#0000
If they dont send you a header at all, how can you validate that they are on the correct chain, you can only assume that hte blockhash they sent is correct


[28-Jul-19 06:14 AM] Deleted User#0000
Pushed latest version, seems to be working very well for me, and should not crash  if there are no notarizations for over 100 blocks.


[28-Jul-19 06:30 AM] Deleted User#0000
I assumed that they reson to keep track of the chain tip was to make sure you are only connected to nodes on the real chain. ?


[28-Jul-19 06:30 AM] Deleted User#0000
@jl777c


[28-Jul-19 06:34 AM] jl777c#5810
with nSPV there really isnt that much need for it, but it is always nice to know which peers are on the chaintip and returning valid data


[28-Jul-19 06:35 AM] jl777c#5810
feel free to keep improving it, the nspv will set the standard for superlite clients, i think primarily as it is the first one that is more than a whitepaper


[28-Jul-19 06:36 AM] jl777c#5810
but might as well make it as good as we can so the best anybody else can do is be second with one that is not any better


[28-Jul-19 06:39 AM] Deleted User#0000
https://github.com/jl777/libnspv/pull/25

{Embed}
https://github.com/jl777/libnspv/pull/25
chain tip validation and some bug fixes by blackjok3rtt ¬∑ Pull Re...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[28-Jul-19 06:42 AM] Deleted User#0000
Also, could the nSPV be used to validate the notarizaittion txid on the chain being notarized to?


[28-Jul-19 06:42 AM] Deleted User#0000
Like just connect to some peers and pull the txid and validate it?


[28-Jul-19 06:56 AM] jl777c#5810
yes!


[28-Jul-19 06:56 AM] jl777c#5810
now that the single coin nspv is basically complete (other than CC)


[28-Jul-19 06:56 AM] jl777c#5810
we can move to all the cool things having multiple nspv instances active at once


[28-Jul-19 06:57 AM] jl777c#5810
the current design is just a single coin active, but most things are setup to be able to run multiple coins from a single instance


[28-Jul-19 06:57 AM] jl777c#5810
however it might be easier to make a different layer that uses multiple other nspv instances at the api level


[28-Jul-19 06:58 AM] jl777c#5810
ALL globals would need to be put into a globalvars structure and ALL functions that access any global will need to have the globals pointer passed into it to support multicoins in a single instance


[28-Jul-19 06:58 AM] Deleted User#0000
ü§î


[28-Jul-19 06:59 AM] Deleted User#0000
I dont think I habe anything else I need to do until the 2nd ... Maybe I will try this? Or should porting CC stuff be more important?


[28-Jul-19 07:00 AM] jl777c#5810
which way feels better?


[28-Jul-19 07:00 AM] Deleted User#0000
Or should I go the iguana changes?


[28-Jul-19 07:00 AM] Deleted User#0000
See if I can get delay working?


[28-Jul-19 07:00 AM] jl777c#5810
ah, just adding a big delay would solve the NN bickering


[28-Jul-19 07:00 AM] jl777c#5810
that shouldnt take long, so maybe get that out of the way


[28-Jul-19 07:01 AM] jl777c#5810
putting all globals in a globals structure and passing the globals pointer into all functions, it is just a lot of code changes, but nothing too difficult to do


[28-Jul-19 07:01 AM] Deleted User#0000
One idea I had was to make it so that no nodes can receive any packets until the height has advanced one block past the block they agree on... That way its a fixed refernace point


[28-Jul-19 07:02 AM] Deleted User#0000
could be avery long delay though


[28-Jul-19 07:02 AM] jl777c#5810
since we are validating notarizations for all utxo, the current chaintip is more a comfort thing


[28-Jul-19 07:02 AM] jl777c#5810
oh, for the notary side


[28-Jul-19 07:02 AM] Deleted User#0000
yes sorry.


[28-Jul-19 07:02 AM] jl777c#5810
yes, can just delay by one block


[28-Jul-19 07:02 AM] jl777c#5810
something simple and brute force


[28-Jul-19 07:03 AM] Deleted User#0000
Guess I'll have a look at that. I asked @Alright  to help me test reorgs on nSPV, so while waiting I will have a look at iguan see what I can work out.


[28-Jul-19 07:04 AM] Deleted User#0000
Being able to have nSPV connect to multiple chains at once, seems a worthy thing to spend some time on though aswell.


[28-Jul-19 07:06 AM] jl777c#5810
yes


[28-Jul-19 07:06 AM] jl777c#5810
you understand the method that is needed to make nspv multicoin?


[28-Jul-19 07:14 AM] Deleted User#0000
Kind of.


[28-Jul-19 07:19 AM] jl777c#5810
let me clarify


[28-Jul-19 07:20 AM] jl777c#5810
currently a specific coin is connected to a specific p2p network based on the chainparams


[28-Jul-19 07:20 AM] jl777c#5810
it then updates various global variables, mostly the NSPV_result structures


[28-Jul-19 07:20 AM] jl777c#5810
and now also the headers structures


[28-Jul-19 07:21 AM] jl777c#5810
so by making an all in one globals structure, like iguanas iguana_info struct


[28-Jul-19 07:21 AM] jl777c#5810
then all functions that update state of any global or even just need access to it must have a pointer to the right globals structure


[28-Jul-19 07:22 AM] jl777c#5810
the code can be transformed in place to have identical functionality, just with a globals structure allocated and passed to all functions


[28-Jul-19 07:22 AM] jl777c#5810
once that works, then a new "addcoin" api will then allow to dynamically add a new coin


[28-Jul-19 07:23 AM] jl777c#5810
once that is in place, then all the api calls would be done via each coins rpc port to determine which coin


[28-Jul-19 07:23 AM] jl777c#5810
but for things that span more than one coin, it would probably use a different port, or maybe use a "coin":"multi" parameter


[28-Jul-19 07:24 AM] jl777c#5810
iguana basically does this multicoin handling


[28-Jul-19 07:25 AM] Deleted User#0000
Yes, I pretty much understand how iguana is doing it. Doenst seema huge diffrence here.


[28-Jul-19 07:26 AM] jl777c#5810
to get nspv working quickly, i used a lot of globals, so first step is to sweep all of them and i mean 100% all of them into a massive globals structure


[28-Jul-19 07:26 AM] jl777c#5810
and then pass the coins pointer to its globals down into each function that needs it and all global access goes through the globals pointer


[28-Jul-19 07:27 AM] jl777c#5810
seems this will be a good practice for you to transform a codebase from a single instance to multiinstance capable


[28-Jul-19 07:27 AM] jl777c#5810
really it goes quite fast, just a lot of adding NSPV_globals *gp, to all the functions that need it


[28-Jul-19 07:29 AM] Deleted User#0000
Yes understood. Will definatly have a go at it.


[28-Jul-19 07:31 AM] jl777c#5810
multi-coin nspv would then enable the cross chain notarization validation and also the chains cluster cross chain migrate


[28-Jul-19 07:31 AM] jl777c#5810
so definitely makes sense as the next step forward in nspv land


[28-Jul-19 07:32 AM] jl777c#5810
it goes from the best superlite client to a multicoin superlite and once we get the html wallet pages working, it will even be easy to use


[28-Jul-19 07:41 AM] Deleted User#0000
@jl777c  
Notarizaions not validating on ILN, but work on KMD just fine. Its not recognising any of the sigs


[28-Jul-19 07:42 AM] Deleted User#0000
looked up txid on explorer and it definatly is a vlaid notarization


[28-Jul-19 07:42 AM] Deleted User#0000
```vini.0 numsigs.0
vini.1 numsigs.0
vini.2 numsigs.0
vini.3 numsigs.0
vini.4 numsigs.0
vini.5 numsigs.0
vini.6 numsigs.0
vini.7 numsigs.0
vini.8 numsigs.0
vini.9 numsigs.0
vini.10 numsigs.0
vini.11 numsigs.0
vini.12 numsigs.0
need to implement fastnotaries count, numsigs.0 error
got txproof response 1564324714 size.1794 5c25fdced93498cc3b6058ead10a9a4e985cfe686470d87caeb3257749ae04f3 ht.-1
```


[28-Jul-19 07:45 AM] jl777c#5810
strange, i used ILN to validate notarizations. let me check


[28-Jul-19 07:45 AM] Deleted User#0000
not sure if I broke something or not, because I tested on KMD only...


[28-Jul-19 07:47 AM] Alright#0419
ready for reorgs, just tag me


[28-Jul-19 07:47 AM] jl777c#5810
ILN is broken for me


[28-Jul-19 07:47 AM] Deleted User#0000
any idea why it would do that?


[28-Jul-19 07:48 AM] Deleted User#0000
its fgailing the sig check, but it passes on KMD


[28-Jul-19 07:49 AM] jl777c#5810
dev branch is broken too, so not your changes


[28-Jul-19 07:49 AM] Deleted User#0000
hmm ok


[28-Jul-19 07:51 AM] jl777c#5810
let me update the fullnodes


[28-Jul-19 07:52 AM] jl777c#5810
probably was that fix of the hardcoded access into the pubkey structure in the notarization validate func


[28-Jul-19 07:52 AM] Deleted User#0000
found it


[28-Jul-19 07:52 AM] Deleted User#0000
I think its using height instead of timestamp to select notary nodes


[28-Jul-19 07:52 AM] jl777c#5810
aha! yes that would do it. can you fix it?


[28-Jul-19 07:52 AM] Deleted User#0000
I can try


[28-Jul-19 07:53 AM] Deleted User#0000
may be wrong but i;lkl check it out


[28-Jul-19 07:55 AM] Deleted User#0000
yes its using season 1. I will just hardocde it now to test reortgs then try fix after that


[28-Jul-19 07:55 AM] Deleted User#0000
I know the problem, its calling blocktime function which is a remote call


[28-Jul-19 07:55 AM] jl777c#5810
but ILN was validating before... very strange


[28-Jul-19 07:55 AM] jl777c#5810
oh and blocktime isnt cached, so it if times out it wont know in time


[28-Jul-19 07:56 AM] Deleted User#0000
yes... the code I have needs to request the data then validat it when it arrives


[28-Jul-19 07:56 AM] Deleted User#0000
you cant call it inside a receive of something else


[28-Jul-19 07:56 AM] Deleted User#0000
doenst work,... took me a LONG time to get the txid for notarzxations validating


[28-Jul-19 07:57 AM] jl777c#5810
so the timestamp needs to be passed into the notarization function


[28-Jul-19 07:57 AM] Deleted User#0000
yes


[28-Jul-19 07:57 AM] Deleted User#0000
it works fine with hardcoded season


[28-Jul-19 07:59 AM] jl777c#5810
so you know how to fix it?


[28-Jul-19 07:59 AM] Deleted User#0000
I think I can yes; @Alright  I have it working for reorg test at least


[28-Jul-19 07:59 AM] Alright#0419
now?


[28-Jul-19 07:59 AM] Deleted User#0000
```[8] last ntz.4216 currentht.4219 hdrheight.4218 est headers until sync.2
[9]: synced at height.4219
[4]: synced at height.4219
[7]: synced at height.4219
[2]: synced at height.4219
[1]: synced at height.4219
[5]: synced at height.4219
```


[28-Jul-19 08:00 AM] Alright#0419
need me to keep an eye on anything in specific or just reorg a few blocks?


[28-Jul-19 08:01 AM] Deleted User#0000
I think we just need to see if my nSPV node will stay inm sync if blocks are going backwards


[28-Jul-19 08:02 AM] Deleted User#0000
if that makes sense? just reorg it üòÉ


[28-Jul-19 08:02 AM] Deleted User#0000
chain isnt moving atm though


[28-Jul-19 08:02 AM] jl777c#5810
need to set up a tx sender to get the chain moving


[28-Jul-19 08:05 AM] Alright#0419
reorged 4 blocks


[28-Jul-19 08:05 AM] Alright#0419
back to the last notarization


[28-Jul-19 08:05 AM] Deleted User#0000
```[9]: synced at height.4219
[2] last ntz.4216 currentht.4220 hdrheight.4220 est headers until sync.0
[4] last ntz.4216 currentht.4220 hdrheight.4220 est headers until sync.-1
[3] last ntz.4216 currentht.4221 hdrheight.4217 est headers until sync.0
[6]: synced at height.4221
```


[28-Jul-19 08:05 AM] Alright#0419
sorry 3


[28-Jul-19 08:05 AM] Deleted User#0000
no owrries with 3 blocks


[28-Jul-19 08:06 AM] Alright#0419
well?


[28-Jul-19 08:06 AM] Alright#0419
keep doing them or what


[28-Jul-19 08:07 AM] Deleted User#0000
yes


[28-Jul-19 08:07 AM] Deleted User#0000
I think maybe need more than 3 to be sure


[28-Jul-19 08:07 AM] Deleted User#0000
Im 99% sure under heavy reorg it will just say its no longer in sync until the reorg is over.


[28-Jul-19 08:09 AM] jl777c#5810
assuming that is the case, just not doing tx when it isnt in sync is decent protection, for big amounts wait for all utxo to be notarized


[28-Jul-19 08:10 AM] Deleted User#0000
It has sync detection for the chain globally and for each peer


[28-Jul-19 08:10 AM] Deleted User#0000
If the chain tip links back to the last notarizaion its in sync.


[28-Jul-19 08:10 AM] Deleted User#0000
if a block with a lower height arrives it ignores it


[28-Jul-19 08:10 AM] Deleted User#0000
and waits for the chain to advance


[28-Jul-19 08:11 AM] jl777c#5810
this is quite an improvement over electrum clients!


[28-Jul-19 08:11 AM] Deleted User#0000
It saves all block hashes, just incase it needs them to link back if the main chains order changes from reorg


[28-Jul-19 08:12 AM] Deleted User#0000
up to a max of 128 blocks, when it gets to 128 blocksit clears the oldest 64 and waits for the next notarization


[28-Jul-19 08:14 AM] Alright#0419
you just want perpetual reorgs?


[28-Jul-19 08:15 AM] Alright#0419
will script it and leave it running if you want


[28-Jul-19 08:15 AM] Deleted User#0000
yes, I guess evena  censorship attack lol


[28-Jul-19 08:15 AM] Alright#0419
lost my scripts for that üò≠


[28-Jul-19 08:15 AM] Alright#0419
man I had them tweaked so well


[28-Jul-19 08:15 AM] Deleted User#0000
meh, I think that would totally fuck it anyway


[28-Jul-19 08:15 AM] Deleted User#0000
or well it would just not be able to sync until you stopped


[28-Jul-19 08:16 AM] Alright#0419
I'll redo them if you think it's relevant


[28-Jul-19 08:16 AM] Alright#0419
censorship


[28-Jul-19 08:16 AM] Deleted User#0000
dont think it is really, not something that ever happens


[28-Jul-19 08:18 AM] Alright#0419
**use POS**


[28-Jul-19 08:25 AM] Alright#0419
@Deleted User did like 5 or 6


[28-Jul-19 08:25 AM] Alright#0419
stopping right now to script this then will just leave it running


[28-Jul-19 08:26 AM] Deleted User#0000
Seems like its handling it ok, 50% of ndoes say not in sync


[28-Jul-19 08:27 AM] Deleted User#0000
It wont fix itslef on a chain that doesnt move forwards though


[28-Jul-19 08:27 AM] Alright#0419
**use POS**


[28-Jul-19 08:29 AM] Deleted User#0000
wihtout someone else minign the chain its hard to way what just happened  lol


[28-Jul-19 08:29 AM] Alright#0419
someone else is


[28-Jul-19 08:29 AM] Alright#0419
not all those orphans are mine


[28-Jul-19 08:29 AM] Alright#0419
https://iln.explorer.dexstats.info/blocks look at this btw ü§£


[28-Jul-19 08:30 AM] Deleted User#0000
```[4]: synced at height.4224
[8] last ntz.4222 currentht.4225 hdrheight.4225 est headers until sync.-2
[2] last ntz.4222 currentht.4225 hdrheight.4225 est headers until sync.-3
Disconnect node 3
[8] last ntz.4222 currentht.4226 hdrheight.4224 est headers until sync.-5
Disconnect node 10
Disconnect node 6
nServices.5 disconnect from node 17: /MagicBean:2.0.15-rc2/ (4226)
Disconnect node 17
[8] last ntz.4222 currentht.4227 hdrheight.4223 est headers until sync.-8
Disconnect node 1
[8] last ntz.4222 currentht.4229 hdrheight.4228 est headers until sync.-10

max rpc threads spawned and alive 0 <- 1
[14] last ntz.4222 currentht.4230 hdrheight.4230 est headers until sync.-14
q[2] last ntz.4222 currentht.4230 hdrheight.4230 est headers until sync.-15
Disconnect node 5
[9] last ntz.4222 currentht.4230 hdrheight.4230 est headers until sync.-15
Disconnect node 13```


[28-Jul-19 08:30 AM] Deleted User#0000
and then it stopped becaus the chain did


[28-Jul-19 08:33 AM] Deleted User#0000
restarting with a change, can you do it again


[28-Jul-19 08:34 AM] Deleted User#0000
Something I added today I thaught would help seems it made it ban peers


[28-Jul-19 08:36 AM] Alright#0419
ok worth my time to script this so I can leave it running indefinitely


[28-Jul-19 08:36 AM] Deleted User#0000
not really no


[28-Jul-19 08:36 AM] Alright#0419
ard, won't


[28-Jul-19 08:41 AM] Deleted User#0000
IM synced again


[28-Jul-19 09:56 AM] Deleted User#0000
`https://github.com/blackjok3rtt2/komodo/commit/914349db60539f386eb6d6dcb8155a6c2c980423`
`https://github.com/blackjok3rtt/libnspv/commit/477455baf4d48fee424118b02d222a9948a37862` 
@jl777c  
This seems the easiest way to fix it, its working for me with my own ILN node, but I assume its hard forking. Fetching another request and then being able to match them up on the nSPV side is tricky and prone to error


[28-Jul-19 09:57 AM] Deleted User#0000
It should simply not use the timestamp variable for the other notarizaions. Only fills it for getinfo call


[28-Jul-19 09:59 AM] jl777c#5810
it is a new version for nspv. if you are confident this will fix it, do the two PR, bump the protocol version and i will update all the fullnodes


[28-Jul-19 10:12 AM] Deleted User#0000
is there somehwer to se protocol version in the daemon?


[28-Jul-19 10:14 AM] jl777c#5810
getinfo


[28-Jul-19 10:14 AM] jl777c#5810
oh, for fullnode side?


[28-Jul-19 10:16 AM] jl777c#5810
there is nowhere yet, maybe it should be added to getinfo on the fullnode side too


[28-Jul-19 10:16 AM] jl777c#5810
updating the fullnodes


[28-Jul-19 10:26 AM] Deleted User#0000
Doesdnt seem to break anything here, but I dont have any ILN to spend to test it.


[28-Jul-19 10:26 AM] Deleted User#0000
txproof works


[28-Jul-19 10:26 AM] jl777c#5810
what is your address


[28-Jul-19 10:27 AM] Deleted User#0000
one sec


[28-Jul-19 10:27 AM] Deleted User#0000
`RBsDcLKapgTgcD2crUPhHxXFq5ULHddzYq`


[28-Jul-19 10:29 AM] Deleted User#0000
dont send need new address


[28-Jul-19 10:29 AM] Deleted User#0000
RSpoakus6u24T9LEvD2FCJVZyj2jqVAtYd


[28-Jul-19 10:30 AM] jl777c#5810
already sent


[28-Jul-19 10:30 AM] Deleted User#0000
lol


[28-Jul-19 10:30 AM] jl777c#5810
will send to second address, i got plenty


[28-Jul-19 10:30 AM] Deleted User#0000
thanks


[28-Jul-19 10:42 AM] jl777c#5810
initial tx stuck in mempool


[28-Jul-19 10:42 AM] jl777c#5810
so cant make a valid new tx until a block is mined


[28-Jul-19 10:43 AM] jl777c#5810
ouch difficulty is 49k??


[28-Jul-19 10:44 AM] jl777c#5810
ok blocks appeard


[28-Jul-19 10:45 AM] Deleted User#0000
I got Alright to mine it


[28-Jul-19 10:45 AM] jl777c#5810
but it isnt mining the tx in the mempool


[28-Jul-19 10:45 AM] jl777c#5810
i guess i will rebroadcast it


[28-Jul-19 10:46 AM] jl777c#5810
tx ce79... broadcast


[28-Jul-19 10:47 AM] Deleted User#0000
thaniks. looks like with chain advancing I am seeing notarizations working now


[28-Jul-19 10:47 AM] jl777c#5810
mine is still saying only 2 numsigs


[28-Jul-19 10:47 AM] Deleted User#0000
hmmm


[28-Jul-19 10:48 AM] jl777c#5810
i saw other tx hit the mempool and get mined, but mine still stuck


[28-Jul-19 10:49 AM] jl777c#5810
0400008085202f890158a8773ba4ba543c57d2b4372fda4ea3f5d220716b4e697587ded7139bf7da0f0100000048473044022009e384ce7668341a00afb68f648630b4ef17e1bdf1eddcb2ae78712843509fe002201341c81b7f20abe506f37476c3692a959fcb7bfcdb364df9401e531f52a0588501ffffffff024014502e000000001976a9141c5fac2d76de69ab79d59d3cebf95c605cbe3d3488ac60dad1f3cf0c000023210286de5bd7831baacc55b87cdf14a1938b2f2ab905529c739c82709c2993cfeafcac00000000000000000000000000000000000000


[28-Jul-19 10:49 AM] Deleted User#0000
It will probably depends on which node it fetches the tx from


[28-Jul-19 10:49 AM] jl777c#5810
maybe can sendrawtransaction on the mining node


[28-Jul-19 10:49 AM] jl777c#5810
to make sure it gets into the mining node mempool


[28-Jul-19 10:51 AM] Alright#0419
moment


[28-Jul-19 10:53 AM] Alright#0419
mined it


[28-Jul-19 10:54 AM] Alright#0419
what I normally do for lowering diff steadily isn't working atm, using a new stratum implementation, setting port diff high doesn't seem to have any effect


[28-Jul-19 10:54 AM] jl777c#5810
thanks. i think notarization should happen soon, will wait to make sure that works


[28-Jul-19 10:54 AM] Deleted User#0000
```new notarization at height.4240
got txproof response 1564335979 size.1758 2dfe4f3c6fce832ff35372e6caa8404fc5cd0c53506982916a9f7b53b0a0fb0a ht.-1
```


[28-Jul-19 10:54 AM] Deleted User#0000
already had one here, bit it would depend on which node sent you the tx


[28-Jul-19 10:54 AM] Alright#0419
@ComputerGenie how do I actually edit port diff in KMD solo pool?


[28-Jul-19 10:55 AM] Alright#0419
I edit it in config.json, during boot it shows the correct value, but it produces blocks at minimum diff no matter what


[28-Jul-19 10:56 AM] jl777c#5810
@Deleted User sent funds to the second address, its in mempool now


[28-Jul-19 10:56 AM] Deleted User#0000
yes I see it


[28-Jul-19 10:57 AM] Deleted User#0000
on full node and superlite üí™


[28-Jul-19 10:58 AM] Deleted User#0000
```RSpoakus6u24T9LEvD2FCJVZyj2jqVAtYd numutxos.1 balance 7.77000000
ADD CACHE txproof 609dfd2512f2610bdebdc30ea0f6bd80c4be317d0878e38aca49fe7fe161b930
got txproof response 1564336678 size.1867 609dfd2512f2610bdebdc30ea0f6bd80c4be317d0878e38aca49fe7fe161b930 ht.4253
[1]: synced at height.4253
ADD CACHE ntzsresp req.4253
got ntzs response 1564336678 size.221 7743062cf47b2577af33e5f5f43340db9d0a1e538e65fd85d4d21df8c4440d3c prev.4204, 0000000000000000000000000000000000000000000000000000000000000000 next.0
304402203169cfdaa61dbb3024de7b9d6a524010ae68783cec67a5478cac3e787e92c43c022059689d2fd9909cdd86176d28c5c9d601f17bca0ffe0bb084b044146d2a1a1acb sighash 96357551f3b73cb4ce48a08c1dac9d10f43bdb29de63ae8aa39a7335b83971aa, sigerr.0 siglen.106
sign 1 inputs 7.77000000 + interest 0.00000000 -> 2 outputs 0.00100000 change 7.76890000
```


[28-Jul-19 10:58 AM] Deleted User#0000
seems ok here


[28-Jul-19 10:59 AM] jl777c#5810
i still get a numsigs 2 error


[28-Jul-19 10:59 AM] Deleted User#0000
it broadcast ok here aswell


[28-Jul-19 10:59 AM] jl777c#5810
yes,  it will broadcast, but it is in an unvalidated state


[28-Jul-19 10:59 AM] Deleted User#0000
yes.


[28-Jul-19 11:00 AM] Deleted User#0000
need to wait for a notarization yes?


[28-Jul-19 11:00 AM] jl777c#5810
not sure. i am doing a tx with an older utxo. will dig into what season it thinks it should be


[28-Jul-19 11:01 AM] Alright#0419
please ping me if you notice blocks happening quicker than 1 minute


[28-Jul-19 11:01 AM] Alright#0419
just wrote a janky script to try to limit it, not that confident it'll work üòÇ


[28-Jul-19 11:08 AM] jl777c#5810
@Deleted User it is being passed in timestamp.0 for a notarization height 2702


[28-Jul-19 11:08 AM] jl777c#5810
the txproof response shows it as the right timestamp


[28-Jul-19 11:08 AM] Deleted User#0000
hmmm


[28-Jul-19 11:08 AM] Deleted User#0000
ok


[28-Jul-19 11:08 AM] jl777c#5810
it is right after got ntzproof response that has the timestamp of 0


[28-Jul-19 11:09 AM] jl777c#5810
maybe the non-zero timestamp needs to be stored from the got txproof response


[28-Jul-19 11:09 AM] jl777c#5810
i guess it is already there?


[28-Jul-19 11:10 AM] jl777c#5810
it is all part of the same spend process


[28-Jul-19 11:11 AM] jl777c#5810
we need to pass in the two timestamps for prev/next ntz into NSPV_validatehdrs


[28-Jul-19 11:13 AM] Deleted User#0000
yes, I I made them 0 and then used the existing code that fetched the timestamp. lazy way, will fix


[28-Jul-19 11:14 AM] jl777c#5810
if this is hard to do i have a backup way that can bruteforce it


[28-Jul-19 11:14 AM] jl777c#5810
but that is ugly, especially if it can be done cleany


[28-Jul-19 11:14 AM] Deleted User#0000
I think I can do it ok, just need to spend a bit of time


[28-Jul-19 11:15 AM] Deleted User#0000
the timestamp should already be there from the daemon, saves an extra remote call aswell


[28-Jul-19 11:15 AM] jl777c#5810
yes, i was thinking about a cache of notarizations


[28-Jul-19 11:15 AM] jl777c#5810
this will also save re-fetching already validated notarizations


[28-Jul-19 11:16 AM] jl777c#5810
you can see i have several things cached at the top of superlite.h


[28-Jul-19 11:16 AM] Deleted User#0000
yes


[28-Jul-19 11:16 AM] jl777c#5810
making a new cache is a matter to replicate what is done for the existing


[28-Jul-19 11:16 AM] Deleted User#0000
I already made one when I was messing around a few days ago.


[28-Jul-19 11:16 AM] Deleted User#0000
for the block headers


[28-Jul-19 11:17 AM] jl777c#5810
just need to make sure if a partial entry is cached that when a full entry comes in, it overrides it


[28-Jul-19 11:17 AM] jl777c#5810
for functions that always return all the data, there is no such issue


[28-Jul-19 11:17 AM] jl777c#5810
it seems you are pretty up to speed on nspv now!


[28-Jul-19 11:17 AM] Deleted User#0000
Getting close.


[28-Jul-19 11:17 AM] Deleted User#0000
maybe


[28-Jul-19 11:17 AM] jl777c#5810
oh, one more very cool feature would be to skip utxo that is in the mempool


[28-Jul-19 11:18 AM] jl777c#5810
there is a mempool search function, so you can pass in txid/vout and if it is in the mempool, it will return it


[28-Jul-19 11:18 AM] jl777c#5810
but also this info comes back in the txproof call, so bettter to get it from there as it saves a call.


[28-Jul-19 11:19 AM] jl777c#5810
that will get you into the tx construction code, which is about the only part you havent been into yet


[28-Jul-19 11:19 AM] jl777c#5810
error -2002 means it is already spent. so if that is detected, then the utxo can be removed from the list of utxos and a new tx recalculated


[28-Jul-19 11:20 AM] jl777c#5810
in order to get the change utxo, you can search mempool by address. this will only work if there is just one utxo in the mempool that pays the address, as there is only one vout field that is returned (the last one)


[28-Jul-19 11:20 AM] jl777c#5810
for the user model of all funds in a single (or few utxo), it should still work most of the time, so you can create tx that spends mempool utxo


[28-Jul-19 11:25 AM] Deleted User#0000
It seems that sometimes it refuses to validate a notarizaion. if it fetches it from an old node.. might limit it to my own node for now to isolate it


[28-Jul-19 11:25 AM] jl777c#5810
yes for debugging, best to limit to your own fullnode


[28-Jul-19 11:42 AM] Deleted User#0000
ok sweet reproduced it here üòÉ


[28-Jul-19 01:25 PM] jl777c#5810
did you do ./autogen.sh


[28-Jul-19 01:25 PM] jl777c#5810
and then ./configure


[28-Jul-19 01:25 PM] jl777c#5810
that is really all you need to do to build it, assuming you have the dependencies


[28-Jul-19 01:25 PM] jl777c#5810
git clone, autogen.sh, configure, make


[28-Jul-19 01:28 PM] allbits#5898
Yes I did autogen and configure


[28-Jul-19 01:28 PM] jl777c#5810
any errors?


[28-Jul-19 01:28 PM] jl777c#5810
is there a Makefile


[28-Jul-19 01:28 PM] jl777c#5810
what directory are you in?


[28-Jul-19 01:29 PM] allbits#5898
Ah yes, didn't see that. In configure. "libevent headers missing"


[28-Jul-19 01:30 PM] jl777c#5810
probably you need to install libevent


[28-Jul-19 01:30 PM] jl777c#5810
libevent-dev


[28-Jul-19 01:31 PM] jl777c#5810
whatever the package is


[28-Jul-19 01:31 PM] jl777c#5810
just google


[28-Jul-19 01:31 PM] allbits#5898
K


[28-Jul-19 01:33 PM] Deleted User#0000
@jl777c  PR to komodod and libnspv. That fixes it.


[28-Jul-19 01:39 PM] jl777c#5810
confirmed! works now


[28-Jul-19 01:40 PM] Deleted User#0000
the gettransaction is a little annoying as you need to try lots of heights, if its not exactly right it will fail silently with missing data and thien thigns crash.


[28-Jul-19 01:41 PM] jl777c#5810
at worst you can do a txproof and get the height from that


[28-Jul-19 01:41 PM] jl777c#5810
also, it shouldnt crash


[28-Jul-19 01:41 PM] Deleted User#0000
yes ive added some extra checks that hopefully covers the last oif them


[28-Jul-19 01:43 PM] jl777c#5810
all updated

{Reactions}
üëå 

[28-Jul-19 01:50 PM] jl777c#5810
@Deleted User great PRs today!


[28-Jul-19 01:50 PM] Deleted User#0000
np


[28-Jul-19 01:56 PM] allbits#5898
So, configure worked and I was able to invoke make. But it failed

Fatal error: sodium/crypto_generichash_blake2b.h
No such file or directory


[28-Jul-19 01:56 PM] Deleted User#0000
what OS?


[28-Jul-19 01:57 PM] allbits#5898
Debian 9


[28-Jul-19 01:57 PM] Deleted User#0000
sudo apt-get libsodium-dev


[28-Jul-19 01:57 PM] Deleted User#0000
I think thats what it is


[28-Jul-19 01:57 PM] allbits#5898
K


[28-Jul-19 01:58 PM] allbits#5898
Working :)


[28-Jul-19 02:17 PM] Deleted User#0000
nice


[28-Jul-19 02:17 PM] Deleted User#0000
its pretty sweet, but there is a LOT of work to to stil lol


[28-Jul-19 10:34 PM] TonyL#3577
https://github.com/jl777/libnspv/pull/31 üòä

{Embed}
https://github.com/jl777/libnspv/pull/31
remove binary... by tonymorony ¬∑ Pull Request #31 ¬∑ jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[29-Jul-19 01:10 PM] radix42#3743
@jl777c just confirmed that my build of nspv on 32bit raspberry pi works!

{Reactions}
‚ô• (3) KMD (3) 

[29-Jul-19 10:40 PM] jl777c#5810
!! so it seems to have universal compatibility


[30-Jul-19 01:08 AM] Sir Seven#7158
Looks like a bug.
On latest master: commit: 3cc8d2aaa0abec7253825b50a080988b0b37c27f 

```shell
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "hdrsproof", "params": [1456592, 1456694 ] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/
```
```json
{"result":"success","prevht":1456570,"nextht":1456570,"prevtxid":"93a1c7d75fd84366c742bfdc3ab6a8c640df5d020113b55f3288b942e045feb3","prevtxidht":0,"prevtxlen":0,"nexttxid":"848b861cf11f30e4e62ac3567fa553ace89b1fbde7ffaefaa4f94926f3561928","nexttxidht":1456584,"nexttxlen":263774,"numhdrs":1,"headers":[{"height":1456570,"blockhash":"0055343953285e73c52d6fb5526ffb04260beac51d4b50ee6da82766f64b847d","hashPrevBlock":"000000007c95cf32cd13fb4692ad6fee85027fcd12139f02ed393a9579918bdd","hashMerkleRoot":"845ea63252ee2323217b44f9ff72975680abee693800665070465811102b5cba","nTime":1563961526,"nBits":486607149}],"lastpeer":"nodeid.30"}
```

hdrsproof call always returns only one block header - one below prevheight parameter.
Response always contains prevheight == next height, "numhdrs":1


[30-Jul-19 01:19 AM] Sir Seven#7158
This is probably a cause of above:

```shell
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "notarizations", "params": [1456592] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/
```
```json
{"result":"success","prev":{"notarized_height":0,"notarized_blockhash":"0000000000000000000000000000000000000000000000000000000000000000","notarization_txid":"0000000000000000000000000000000000000000000000000000000000000000","notarization_txidheight":0,"notarization_desttxid":"0000000000000000000000000000000000000000000000000000000000000000"},"next":{"notarized_height":0,"notarized_blockhash":"0000000000000000000000000000000000000000000000000000000000000000","notarization_txid":"0000000000000000000000000000000000000000000000000000000000000000","notarization_txidheight":0,"notarization_desttxid":"0000000000000000000000000000000000000000000000000000000000000000"},"lastpeer":"nodeid.32"}
```

Zero output for any height notarizations call.


[30-Jul-19 01:30 AM] Sir Seven#7158
Oh. Plz nevermind, had a problems with synchronization.
Daemon restart helped.


[30-Jul-19 01:30 AM] Deleted User#0000
Nice, it needs some more error correction/detection. For sure


[30-Jul-19 01:31 AM] Sir Seven#7158
Yet I'm not sure why daemon was not in sync. Hm.


[30-Jul-19 01:31 AM] Deleted User#0000
It seems to have undefined behaviour sometimes, I saw the same myself.


[30-Jul-19 01:33 AM] Deleted User#0000
What chain are you using? And also after the latest changes there may be old nodes that return bad data, unless u have your own daemon you know is on correct version?


[30-Jul-19 01:34 AM] Deleted User#0000
I had to edit source to make it only connect to a single node, may need a connect= option.


[30-Jul-19 01:36 AM] TonyL#3577
It is KMD chain. I wonder reason is some bad peer/s and on reconnect you connected to another peer  maybe which return correct headers info @Sir Seven


[30-Jul-19 01:37 AM] Deleted User#0000
Yes that will be it, we hard forked, but there is no way to detect peers are correct version yet


[30-Jul-19 01:40 AM] Sir Seven#7158
Was connected to nodes 29. 30, 31.
ATM: 28, 1, 11, 22, etc. None of the above.
Not sure of their IPs.


[30-Jul-19 01:41 AM] Deleted User#0000
Nodeid changes, and currently there is no way to detect the node version. Its something I'll add, I think as I for see many needed changes daemon side over time until we get it into a state that is useable.


[30-Jul-19 01:42 AM] Sir Seven#7158
If problem repeats, I'll record node ips.


[30-Jul-19 01:42 AM] Deleted User#0000
Getpeerinfo will tell u they nodes ips,


[30-Jul-19 01:42 AM] Sir Seven#7158
Yeah.


[30-Jul-19 01:42 AM] Sir Seven#7158
Just don't have old record to check previous node ips.


[30-Jul-19 01:42 AM] Deleted User#0000
But really, to test properly u need to be connected to a known good peer


[30-Jul-19 01:42 AM] Deleted User#0000
For now


[30-Jul-19 01:46 AM] jl777c#5810
why cant you use the version field to see if peers are using latest?


[30-Jul-19 01:46 AM] jl777c#5810
i added it to getinfo response


[30-Jul-19 01:46 AM] Deleted User#0000
Can do then yes


[30-Jul-19 01:47 AM] jl777c#5810
also hdrsproof is really an internal function as to properly do a notarization proof you need the txid of the 2 notarizations


[30-Jul-19 01:48 AM] jl777c#5810
at the cli level it is passed a height, and it scans backwards and forwards to find notarizations, but maybe it wont be the ideal ones


[30-Jul-19 01:48 AM] jl777c#5810
and there is the case of having no next notarization, in this case the data returned is not complete, probably we should make it return all headers to the current height


[30-Jul-19 01:49 AM] jl777c#5810
so quite a few loose ends, which i hope @Deleted User can fix


[30-Jul-19 01:49 AM] Deleted User#0000
There are many, yes. I have some ideas, but I don't want to rush these things.


[30-Jul-19 01:50 AM] jl777c#5810
yes, no need to rush, it works quite well as it is and we want to make each improvement solid


[30-Jul-19 01:50 AM] jl777c#5810
lets make github issues for all the things we want to enhance


[30-Jul-19 01:50 AM] Deleted User#0000
Yes good idea


[30-Jul-19 01:53 AM] jl777c#5810
basically i want to handoff the libnspv to you for the continued enhancements. it seems there are a lot of cool things we can do to make it more efficient and have more functionality. i am surprised that the single threaded nature of it is not creating any significant performance issues, even with the rate limiter. if we can keep it that way, it will simplify the internal control flow and also he complexity of any new additions


[30-Jul-19 01:56 AM] Deleted User#0000
I was honestly thinking of making it multi threaded, so we can submit requests on one thread and have another thread handle the incoming stuff.


[30-Jul-19 01:57 AM] jl777c#5810
multicoin makes it multithreaded, but single threaded per coin


[30-Jul-19 01:57 AM] jl777c#5810
you will open up an incredibly complicated state space the moment you multithread the single coin


[30-Jul-19 01:57 AM] Deleted User#0000
Yes true..


[30-Jul-19 01:58 AM] jl777c#5810
instead of being able to linearly (quickly) track down a bug, each bug could become chasing the exact timing of the different threads


[30-Jul-19 01:58 AM] jl777c#5810
keep it simple as long as you can


[30-Jul-19 01:58 AM] Deleted User#0000
OK. Sounds like a good plan


[30-Jul-19 01:58 AM] jl777c#5810
i think adding more caching will solve most performance issues


[30-Jul-19 01:58 AM] Deleted User#0000
Cache needs work yes


[30-Jul-19 01:59 AM] jl777c#5810
splitting out some of the long sequences that do everything, into separate pieces that can be done independently, and then calling those pieces in a sequence


[30-Jul-19 01:59 AM] jl777c#5810
then that allows reusing all the smaller actions


[30-Jul-19 02:00 AM] jl777c#5810
i think once the code is such that for any specific action, there is a dedicated function to do it and a specific globals structure that has its state updated (based on whatever logic is needed), then at any point in time, you can look at the current state and make decent decisions on what to do, especially if there is a recent mempool search


[30-Jul-19 02:01 AM] jl777c#5810
i fear that if we go to multicoin and each one is multithreaded, within weeks it will become very difficult to debug anything


[30-Jul-19 02:01 AM] jl777c#5810
let the rust guys who will refactor all this (if needed) deal with such things


[30-Jul-19 02:01 AM] Deleted User#0000
Yes, need to keep thing simple


[30-Jul-19 02:01 AM] jl777c#5810
with an html wallet interacting to the nspv instance for a coin, as long as most of the time things respond in a second or two, that is sufficient


[30-Jul-19 02:02 AM] jl777c#5810
please let me know before you try to do anything too ambitious. we have a stable working baseline now and it is single threaded. so adding any new feature should just be a matter of adding it and debugging it. then we get a new better working baseline


[30-Jul-19 02:03 AM] jl777c#5810
iterate this N times and soon we will struggle to find any other improvements to do


[30-Jul-19 02:03 AM] Deleted User#0000
No worries


[30-Jul-19 02:04 AM] Deleted User#0000
In was thinking, we should add some kind of uuid or something for a call, so its easy to tell when it arrives it is one you have been waiting for.


[30-Jul-19 02:04 AM] jl777c#5810
the usecase for nspv is the individual user, not for people that want to use it to run an exchange (even though you can make a pretty lightweight CEX of komodo ecosystem coins with nspv), exchange usecase is the only one i can think of that requires multithreading on a per coin basis. but what do we think of a CEX that isnt running fullnodes


[30-Jul-19 02:05 AM] jl777c#5810
@Deleted User a uuid would allow to have a universal way for all the NSPV issuing functions to tell the response came in, as compared to the current method of checking the results structure


[30-Jul-19 02:06 AM] jl777c#5810
the advantage of being single threaded is that when the response comes in, we know what request it was for, as we only had a single request


[30-Jul-19 02:06 AM] jl777c#5810
remember, we want to scale to millions (or billions) of superlite nodes


[30-Jul-19 02:06 AM] jl777c#5810
if they are spewing out tons of requests, they are not superlite anymore and we cant achieve the scale and it defeats its primary purpose


[30-Jul-19 02:07 AM] jl777c#5810
the html gui will be via static html dynamically generated inside nspv. I am working with satinder on that. no javascript and certainly no node.js


[30-Jul-19 02:08 AM] jl777c#5810
@Sir Seven please carefully read all this to understand the libnspv philosophy


[30-Jul-19 02:08 AM] jl777c#5810
we do need automated tests to make sure when we update that we didnt break anythings


[30-Jul-19 02:09 AM] jl777c#5810
my understanding is that @Sir Seven will be making those

{Reactions}
‚úÖ 

[30-Jul-19 02:10 AM] jl777c#5810
@Deleted User since we can currently achieve the effect of uuid, we save the overhead of sending it both ways by not having it. i think for superlite that is a more important issue


[30-Jul-19 02:11 AM] Deleted User#0000
OK so currently it submits a request and iterates until it has arrived, I was going to add a queue to the send requests with some uuid, so that when it arrives we know what request it was. Otherwise the single thread is always just sleeping and can't achieve much, and when it fails, then we have no way to request it again except for brute forcing more calls


[30-Jul-19 02:13 AM] jl777c#5810
but what is there to achieve?


[30-Jul-19 02:13 AM] jl777c#5810
the only background task is the getinfo calls


[30-Jul-19 02:14 AM] Sir Seven#7158
We are currently on it.
Preparing basic functional tests and build test.
There will be a lot of changes with arrival of html GUI-page.


[30-Jul-19 02:14 AM] Sir Seven#7158
On our test-side at least.


[30-Jul-19 02:14 AM] jl777c#5810
html page will be hard to do automated tests, but it is just static html, so i think once all the buttons work, then it should be stable


[30-Jul-19 02:15 AM] jl777c#5810
and it will just be using the same api calls


[30-Jul-19 02:15 AM] jl777c#5810
@Deleted User what other things do you want the superlite to be doing while it is waiting for a response?


[30-Jul-19 02:15 AM] Deleted User#0000
Well I guess.it doesn't


[30-Jul-19 02:15 AM] Deleted User#0000
So it can wait


[30-Jul-19 02:16 AM] jl777c#5810
once you make it go to a serialized request queue with uuid, when it comes back, then you need to resume what was waiting for it. so what will you use? setjump and longjump? there is only one thread per coin anyway


[30-Jul-19 02:17 AM] Deleted User#0000
Its just when working on dicecc u told me the correct way to handle sleeps and waits was to make a queue and a different thread.


[30-Jul-19 02:17 AM] jl777c#5810
different higher level constraints


[30-Jul-19 02:17 AM] jl777c#5810
when you are constrained to a single thread, making a queue in a different thread violates that


[30-Jul-19 02:18 AM] jl777c#5810
please believe me that things will get 10x to 100x harder to deal with the moment we abandon being single threaded


[30-Jul-19 02:18 AM] jl777c#5810
instead of amazing things getting done in days, it will slow to weeks


[30-Jul-19 02:18 AM] Deleted User#0000
Yes I agree, I just taught that was the proper way to handle it, don't want to make things harder than they need to be, so single thread it is


[30-Jul-19 02:19 AM] jl777c#5810
in dice CC, we are in a multithread environment anyway


[30-Jul-19 02:19 AM] TonyL#3577
`html page will be hard to do automated tests` - for wallet probably might be good to make simple E2E tests in future (click on buttons in some transactional case and get expected results yep). But wallet is under development atm @Sir Seven 
What is needed at first is RPC calls unit-tests coverage


[30-Jul-19 02:19 AM] jl777c#5810
the multithreading is ok for multicoins, one thread per coin


[30-Jul-19 02:19 AM] Deleted User#0000
Yes


[30-Jul-19 02:19 AM] Deleted User#0000
That is required


[30-Jul-19 02:20 AM] jl777c#5810
also the other advantage of single threaded is that it can run in firmware without a feature rich mulithreading os


[30-Jul-19 02:21 AM] jl777c#5810
for clarity there is two threads, one that does the nspv stuff and the api thread


[30-Jul-19 02:22 AM] jl777c#5810
for multicoin, we can continue to have 2 threads per coin plus a special global api thread, but at that point we do need to use mutex to serialize requests


[30-Jul-19 02:23 AM] jl777c#5810
therefore it might actually be better to have a special new dapp multinspv, that launches the various single threaded nspv and just makes api requests to each of them

{Reactions}
üî• 

[30-Jul-19 02:24 AM] jl777c#5810
it will be a bit less efficient as api calls would be needed for each interaction, but i dont forsee there needing to be thousands of interactions per second


[30-Jul-19 02:24 AM] jl777c#5810
yes, this will be much simpler. making nspv handle multicoins per instance will make it have to deal with mutex issues


[30-Jul-19 02:25 AM] jl777c#5810
though the only internally generated event now is the getinfo call, so maybe it isnt so bad, but as it grows, maybe we put more in the NSPV_periodic and each additional thing that is done is potentially in a race condition with the multicoin logic


[30-Jul-19 02:26 AM] jl777c#5810
the multinspv of course should be multithreaded


[30-Jul-19 02:26 AM] jl777c#5810
but like iguana it is just talking to the existing daemons


[30-Jul-19 02:26 AM] Deleted User#0000
So for more coins you want to launch a new process?


[30-Jul-19 02:27 AM] jl777c#5810
why not? a 3MB footprint is no big deal


[30-Jul-19 02:28 AM] jl777c#5810
its not like it has a 3GB footprint


[30-Jul-19 02:28 AM] jl777c#5810
being so small, what makes no sense normally starts making sense


[30-Jul-19 02:28 AM] Deleted User#0000
Yes doesn't seem a problem, I actually thought of that myself, just have it luanhc a new nspv instance for the coin it needs to connect to andd wait until it sends the response


[30-Jul-19 02:28 AM] jl777c#5810
you need to recalculate all the reasons for most everything


[30-Jul-19 02:29 AM] jl777c#5810
usually you dont want to spawn a new executable due to its overhead


[30-Jul-19 02:29 AM] jl777c#5810
but if the overhead is 3MB, you can spawn 100 of them, literally and be the same as a single komodod footprint


[30-Jul-19 02:30 AM] jl777c#5810
what is the name of the smallest lizard, like a microscopic one


[30-Jul-19 02:30 AM] Deleted User#0000
For the multichain stuff though, if an import tx happens all nodes will need to connect to the other chain to verify the proof


[30-Jul-19 02:31 AM] Deleted User#0000
We have geckos? And skinks?


[30-Jul-19 02:31 AM] Deleted User#0000
Skinks are tiny


[30-Jul-19 02:31 AM] jl777c#5810
In 2001, scientists discovered a tiny lizard on a tiny island off the coast of the Dominican Republic. The Jaragua lizard measures about three quarters of an inch in length, or 16 millimeters, from the tip of his snout to the base of his tail. To get a good idea of just how small this fellow is, picture a dime with the lizard curled up around its perimeter.


[30-Jul-19 02:31 AM] jl777c#5810
what do you mean all nodes?


[30-Jul-19 02:33 AM] Deleted User#0000
Wait sorry, no the proof is part of the import and linked back to notaries. Sorry


[30-Jul-19 02:34 AM] jl777c#5810
i imagine that to do a crosschain, you need to spawn the two chains (if they are not already running)


[30-Jul-19 02:34 AM] jl777c#5810
do what you need to do on each chain to issue and validate it is all happy


[30-Jul-19 02:35 AM] jl777c#5810
then can even disconnect from the originating chain


[30-Jul-19 02:35 AM] Deleted User#0000
Yes I figured it would work the same, but would not all nodes who need to verify that tx need tondo the same?


[30-Jul-19 02:36 AM] jl777c#5810
all the fullnodes would be doing the validating


[30-Jul-19 02:36 AM] jl777c#5810
it gets mined


[30-Jul-19 02:37 AM] jl777c#5810
notarized


[30-Jul-19 02:37 AM] jl777c#5810
then nspv can verify it is notarized


[30-Jul-19 02:37 AM] jl777c#5810
why would all nspv nodes have to do anything about some random other nodes crosschain tx?


[30-Jul-19 02:37 AM] jl777c#5810
nspv nodes only care about a single address at a time


[30-Jul-19 02:37 AM] Deleted User#0000
No I was meaning for full nodes


[30-Jul-19 02:38 AM] jl777c#5810
if the nspv is making a valid tx, what is the problem?


[30-Jul-19 02:38 AM] jl777c#5810
when nspv makes a tx and broadcasts it, all fullnodes validate it


[30-Jul-19 02:38 AM] jl777c#5810
how is a crosschain CC tx any different?


[30-Jul-19 02:39 AM] Deleted User#0000
OK so full node just uses momom?


[30-Jul-19 02:39 AM] jl777c#5810
nspv can get the notarization tx right?


[30-Jul-19 02:40 AM] jl777c#5810
that notarization tx has MoMoM data


[30-Jul-19 02:40 AM] Deleted User#0000
If u can find it


[30-Jul-19 02:40 AM] jl777c#5810
we might need a bit of fullnode help to achieve this


[30-Jul-19 02:40 AM] jl777c#5810
adding a new p2p message is not hard, just a lot of places to add things to


[30-Jul-19 02:41 AM] jl777c#5810
or we could use the baggage claim path, which might be less work and possible without any extra fullnode support


[30-Jul-19 02:41 AM] jl777c#5810
the power of nspv is that given a txid, we can prove it happened


[30-Jul-19 02:41 AM] jl777c#5810
which means we can prove the burn happened


[30-Jul-19 02:41 AM] Deleted User#0000
That path requires a proof from x notaries


[30-Jul-19 02:41 AM] Deleted User#0000
Yes


[30-Jul-19 02:42 AM] jl777c#5810
ah, forgot that detail...


[30-Jul-19 02:42 AM] jl777c#5810
ok so what is needed to use MoMoM for this case


[30-Jul-19 02:42 AM] Deleted User#0000
Any node can prove, a tx happened on another chain as long as they can spawn an nspv and validate it


[30-Jul-19 02:43 AM] jl777c#5810
what is required to create a valid import?


[30-Jul-19 02:43 AM] jl777c#5810
that seems the harder half


[30-Jul-19 02:43 AM] Deleted User#0000
Momom will do it, as long as the node that creates the tx gives a momom hash that exists on the target


[30-Jul-19 02:43 AM] jl777c#5810
or given a valid burn and a properly constructed import, will the fullnodes automatically be able to validate it as it is


[30-Jul-19 02:44 AM] jl777c#5810
nspv nodes can get momom hashes from the notarizations, it is in the opreturn. so the opreturn parsing needs to expand to extract the momom data


[30-Jul-19 02:45 AM] jl777c#5810
are all the pieces there already do to a momom cross chain?


[30-Jul-19 02:46 AM] Deleted User#0000
Yes I think I got it. Right now a successful momom transfer needs kmd node to get the momom and add it to the import tx, it keeps trying this until it gets the right hash, nspv has less work to do there


[30-Jul-19 02:46 AM] jl777c#5810
if not, maybe txproof request can also return whatever missing momom data needed


[30-Jul-19 02:46 AM] Deleted User#0000
Yes


[30-Jul-19 02:47 AM] jl777c#5810
so the KMD fullnode can do the scan of momom given a txid and return the correct momom to use, and with just adding a single field it seems nspv gets all the data with almost no overhead on the superlite side. maybe we only do this on the fullnode side if there is a specific flag set


[30-Jul-19 02:48 AM] jl777c#5810
which means multinspv needs to spawn KMD, oldchain, newchain, so 9MB overhead


[30-Jul-19 02:50 AM] jl777c#5810
there can literally be thousands of chains in the cluster and any user would just need to occasionally spawn some new nspv instances to deal with the crosschain and at most run the nspv for the chains they have coins on. or even launch them only as needed, as it takes no time to launch a new nspv instance


[30-Jul-19 02:50 AM] jl777c#5810
can even be stateless locally, ie. no data needed on HDD. to manage coins that can be in any of 8192 chains, but at that scale it might make sense to have a list of which chains we know we have coins on


[30-Jul-19 02:51 AM] jl777c#5810
what all this means is we dont need to make a globals structure!


[30-Jul-19 02:52 AM] Deleted User#0000
No I don't think we need to either


[30-Jul-19 02:52 AM] Deleted User#0000
That's a lot of work


[30-Jul-19 02:52 AM] jl777c#5810
we can simply use global variables in nspv, very easy


[30-Jul-19 02:52 AM] jl777c#5810
i estimate it would take me a full day and it doesnt give any real benefits


[30-Jul-19 02:53 AM] Deleted User#0000
Take me longer than that, I estimated about a week lol


[30-Jul-19 02:54 AM] jl777c#5810
ok, so you think you can tackle the crosschain via nspv using a multinspv (maybe we call it the jaragua client)


[30-Jul-19 02:55 AM] Deleted User#0000
Yeah, I think we can do that, have some master process that spawns what ever chain it needs and RPC to it


[30-Jul-19 02:55 AM] jl777c#5810
yes, pretty sure iguana already does this


[30-Jul-19 02:55 AM] jl777c#5810
making it cross platform and working in windows might be a bit of a trick


[30-Jul-19 02:56 AM] jl777c#5810
but i think even windows is able to launch executables


[30-Jul-19 02:56 AM] Deleted User#0000
Maybe it can just spawn itself as a thread?


[30-Jul-19 02:56 AM] Deleted User#0000
Not sure if possible


[30-Jul-19 02:57 AM] jl777c#5810
in unix and osx you can just do system("./nspv KMD");


[30-Jul-19 02:58 AM] jl777c#5810
pretty sure windows has a similar method, so for now, just use that to spawn the nspv instances


[30-Jul-19 02:58 AM] jl777c#5810
that gets the rpc port active and you can just libcurl the api requests


[30-Jul-19 02:59 AM] Deleted User#0000
Its like boost::thread or something, komodod does it for blocknotify


[30-Jul-19 02:59 AM] Deleted User#0000
Np


[30-Jul-19 03:00 AM] jl777c#5810
thankfully we cant contaminate libnspv with boost!


[30-Jul-19 03:00 AM] Deleted User#0000
Yes, lol


[30-Jul-19 03:01 AM] Deleted User#0000
But the call exists in boost so it will work, just need to find out what it is that call calls


[30-Jul-19 03:01 AM] jl777c#5810
good luck with that. windows docs are probably a faster way, or just ask decker


[30-Jul-19 03:02 AM] Deleted User#0000
Why not just depreciate windows ü§£


[30-Jul-19 03:03 AM] jl777c#5810
anyway, glad we talked this out. we now have a clear mandate to keep things as simple as possible and single threaded nspv will work fine, in a multi nspv instance environment. one jaragua to manage the many nspv, which means the nspv is smaller than a jaragua


[30-Jul-19 03:04 AM] Deleted User#0000
Hmm


[30-Jul-19 03:05 AM] Deleted User#0000
So what will nspv be called? Not a lizard I guess


[30-Jul-19 03:09 AM] jl777c#5810
likely people wont directly use nspv, but rather the multicoin variant, jaragua.


[30-Jul-19 03:10 AM] jl777c#5810
since people like multicoin wallets, it seems that is the level they will interact. similar to nspv jaragua can spawn an rpc port and serve html in the same style and interlinked with the nspv html


[30-Jul-19 04:54 AM] TonyL#3577

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/605729833644720130/dwarf-gecko.png


[30-Jul-19 05:18 AM] grewalsatinder#9653
"jaragua client" üòç


[30-Jul-19 05:29 AM] jl777c#5810
a pizza sized coin?


[30-Jul-19 05:30 AM] TonyL#3577
just zoomed photo üòÖ


[30-Jul-19 05:35 AM] jl777c#5810
@Deleted User your validate_notarization function is passing in the notarization value but not using it. maybe it needs to be checked against NSPV_inforesult.notarization.txid also?

{Reactions}
üëç 

[30-Jul-19 06:40 AM] Sir Seven#7158
Noticed while writing tests:
Some time after starting nspv daemon (~60s or so), mempool,  listunspent, listtransactions and spentinfo calls will return error:
```json
{"result":"error","error":"timeout"}
```
Same calls work just fine executed right after getinfo call.

A simple script to reproduce it:
```python
    while True:
        rpc_call = tf.nspv_getinfo()
        tf.assert_success(rpc_call)
        rpc_call = tf.nspv_mempool()
        tf.assert_success(rpc_call)
        time.sleep(70)
        rpc_call = tf.nspv_mempool()
        tf.assert_success(rpc_call)
        time.sleep(70)
```
Always fails on second mempool call.


[30-Jul-19 06:41 AM] jl777c#5810
there is a rate limiter of one request per second per peer, for each message


[30-Jul-19 06:42 AM] jl777c#5810
depending on how many peers you have, it will determine how many requests you can blast away


[30-Jul-19 06:42 AM] Sir Seven#7158
Hm. Still, 70 seconds sounds legit.


[30-Jul-19 06:44 AM] jl777c#5810
you shouldnt have to sleep for any more than 1 second


[30-Jul-19 06:44 AM] jl777c#5810
can you make a set of curl requests that reproduces the problem


[30-Jul-19 06:54 AM] Sir Seven#7158
Like this:
```
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "getinfo", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/
sleep 1
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "mempool", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/
sleep 70
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "mempool", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/```


[30-Jul-19 06:55 AM] Sir Seven#7158
2nd mempool tends to fail.


[30-Jul-19 07:20 AM] jl777c#5810
i will try to reproduce. how many peers do you have


[30-Jul-19 07:27 AM] Sir Seven#7158
Usually 8 to 10.


[30-Jul-19 07:29 AM] jl777c#5810
any other calls get timeout?


[30-Jul-19 07:31 AM] Sir Seven#7158
listunspent, listtransactions and spentinfo
Didn't see timeout error with other calls.


[30-Jul-19 07:33 AM] jl777c#5810
pushed a new test version to my jl777 branch of libnspv


[30-Jul-19 07:34 AM] jl777c#5810
plz see which calls timeout, even without any sleep in script


[30-Jul-19 07:37 AM] Sir Seven#7158
Sure. Will check it soon.


[30-Jul-19 08:01 AM] Sir Seven#7158
Looks good.
Set script to spam calls with no sleep.
No timeouts so far. Even for 5 minutes non-stop spamming.

Rpc response wait time is a bit higher, doesn't feel too slow yet.


[30-Jul-19 08:21 AM] jl777c#5810
i just increased the internal timeout, what is happening is that occasionally a single peer is just slow. every once in a while it will happen


[30-Jul-19 08:21 AM] jl777c#5810
but even with the large timeout, as soon as the response comes in, it is done so most of the time there wont be any difference


[30-Jul-19 10:03 AM] jl777c#5810
@Sir Seven can you also test the nSPV=1 mode of komodod?


[30-Jul-19 10:03 AM] jl777c#5810
from my nSPV branch of komodo


[30-Jul-19 10:04 AM] jl777c#5810
basically we have a C++ komodod based nSPV superlite client and a C based libnspv based superlite client and both should have very similar (functionality(


[30-Jul-19 10:08 AM] TonyL#3577
@Sir Seven needed calls you can get (after nSPV mode client start) from `./komodo-cli help | grep nspv_*` 

Some additional materials üòÉ :
https://github.com/jl777/komodo/blob/FSM/qa/rpc-tests/src/nspv_client_test.py there you can find some tests example (would be great to update it / continue to support, and I think I've put it to `src` subfolder by mistake üòÉ )
https://github.com/tonymorony/nspv_pywallet tesing wallet which interact with nSPV mode komodod

{Embed}
https://github.com/jl777/komodo/blob/FSM/qa/rpc-tests/src/nspv_client_test.py
jl777/komodo
Komodo. Contribute to jl777/komodo development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559

{Embed}
https://github.com/tonymorony/nspv_pywallet
tonymorony/nspv_pywallet
simple Python wallet based on Komodo nSPV technology - tonymorony/nspv_pywallet
https://images-ext-2.discordapp.net/external/IULxymVak7WPV8PZwfkPCOyLSBf6KKjfvRL8wa24Vjc/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/24797699


[30-Jul-19 10:09 AM] TonyL#3577
https://github.com/tonymorony/komodo-cctools-python/tree/master/scripts
stress test on full node example also (probably something similar you can use to stresstest master node via nspvlib): 
```nspv_clients_spawn.py
nspv_calls.sh
start_spam.sh```

{Embed}
https://github.com/tonymorony/komodo-cctools-python/tree/master/scripts
tonymorony/komodo-cctools-python
Python libs and interfaces for Komodo cryptoconditions consensus modules - tonymorony/komodo-cctools-python
https://images-ext-1.discordapp.net/external/Holp9AfaeFvGp5-FK21tFWPUG6Vhnnx7aN2SJk6LnTA/https/repository-images.githubusercontent.com/151382224/5007df00-6c99-11e9-8f36-dfd6d7e8d715


[30-Jul-19 10:59 AM] Sir Seven#7158
@jl777c @TonyL  Sure. Will check it tomorrow.

{Reactions}
üî• 

[31-Jul-19 02:30 AM] Sir Seven#7158
Failing komodod build from nSPV branch:
```shell
In file included from cryptoconditions/src/asn/Condition.h:14:0,
                 from cryptoconditions/src/cryptoconditions.c:17:
cryptoconditions/src/asn/SimpleSha256Condition.h:14:10: fatal error: OCTET_STRING.h: No such file or directory
 #include <OCTET_STRING.h>
          ^~~~~~~~~~~~~~~~
compilation terminated.
Makefile:2468: recipe for target 'cryptoconditions/src/cryptoconditions.o' failed
make[2]: *** [cryptoconditions/src/cryptoconditions.o] Error 1
make[2]: *** Waiting for unfinished jobs....
rm -f src/stamp-h1
In file included from cryptoconditions/src/asn/Condition.h:14:0,
                 from cryptoconditions/src/cryptoconditions.c:17:
cryptoconditions/src/asn/SimpleSha256Condition.h:14:10: fatal error: OCTET_STRING.h: No such file or directory
 #include <OCTET_STRING.h>
          ^~~~~~~~~~~~~~~~
compilation terminated.
```

Am I missing something?


[31-Jul-19 02:31 AM] gcharang#6833
@Sir Seven 
./zcutil/build.sh
2 - 3 times


[31-Jul-19 02:31 AM] Sir Seven#7158
Okay.


[31-Jul-19 02:49 AM] TonyL#3577
nspv client crashed on my side when I've tried to prepare rawtransaction by `spend`:

```curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "spend", "params": ["RXcUjam1KC8mA1hj33vXaX877jf7GgvKzt",0.1 ] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/
```

backtrace: https://paste.ubuntu.com/p/Xv4MQkbYfP/
client prints: https://paste.ubuntu.com/p/twBmr7Rjmn/


[31-Jul-19 02:50 AM] TonyL#3577
tried twice so far and both times it crashed


[31-Jul-19 03:03 AM] Sir Seven#7158
Seems to randomly crash on spend method.
1 of 4 transactions lead to crash for me.


[31-Jul-19 03:54 AM] jl777c#5810
likely due to #4  0x0000555555576142 in btc_tx_deserialize (tx_serialized=<optimized out>, inlen=263775, tx=0x7ffff0406920, consumed_length=0x0, allow_witness=<optimized out>)


[31-Jul-19 03:54 AM] jl777c#5810
very large tx


[31-Jul-19 03:55 AM] jl777c#5810
ADD CACHE ntzsresp req.1944794279
ADD CACHE ntzsresp req.-1962925822


[31-Jul-19 03:56 AM] jl777c#5810
seems garbage data is coming in somehow


[31-Jul-19 03:56 AM] jl777c#5810
how exactly did you make this happen. need to duplicate it


[31-Jul-19 03:56 AM] TonyL#3577
I'll DM you my wif now, maybe it can help


[31-Jul-19 03:57 AM] jl777c#5810
yes, please the specific curl requests that cause that sequence


[31-Jul-19 04:39 AM] TonyL#3577
`skipcount - skips the specified number of transactions starting from the oldest; always returns the latest transaction`
0 will skip 0 transactions from the end I believe (other words display all)


[31-Jul-19 04:39 AM] TonyL#3577
can you try not 0 but 1 or 10 ? (ah, first number is isCC, nvm) but anyway this address have less than 100 txs as I can see


[31-Jul-19 04:54 AM] Sir Seven#7158
Hm. nSPV lists 144+ txs for addr above. Will check with different one.


[31-Jul-19 06:53 AM] Sir Seven#7158
Checked skipcount=30 with 60+ txs address.
Still no effect.

Created a wallet with 70+ utxos.
When trying to create transaction to spend 64+ of them in single transaction I get error:
```json
{"result":"error","error":"couldnt create tx","lastpeer":"nodeid.1"}

```

Still, can't crash nspv this way.


[31-Jul-19 09:13 AM] jl777c#5810
last i checked skipcount worked, but some code changed in that function, "filter" was added so maybe it broke


[31-Jul-19 09:13 AM] jl777c#5810
if it is reproducible please make an issue. i wont be able to fix bugs in realtime this week


[31-Jul-19 01:26 PM] jl777c#5810
@TonyL can you test that nSPV=-1 disables a node from being a fullnode, but that it doesnt break anything obvious. no need for any extensive regression test, but just to run some nodes with that and see if you run into unexpected problems


[31-Jul-19 01:26 PM] jl777c#5810
that is for fullnodes that want to not be an nSPV fullnode

{Reactions}
üëç 

[01-Aug-19 04:07 AM] Sir Seven#7158
@jl777c What is expected behaviour of node with `-nSPV=-1`?
So far i can conenct to it from node2 like `./komodod -nSPV=1 -connect=node1`, with no errors. node1 will not response to nsvp_calls tho.
The quetion is: should node2 be able to connect at all to node1 in this case?


[01-Aug-19 04:08 AM] jl777c#5810
it should be like a pre-NSPV fullnode


[01-Aug-19 04:08 AM] jl777c#5810
so it would be a normal peer, but not serve the nSPV data. what is the nServices value for that peer?


[01-Aug-19 04:18 AM] Sir Seven#7158
`nLocalServices 40000005 0, 0`
And same in peerinfo:
`"services": "0000000040000005"`


[01-Aug-19 04:52 AM] jl777c#5810
ok, that is a bug, fixing


[01-Aug-19 04:52 AM] jl777c#5810
it should be 5


[01-Aug-19 04:53 AM] Sir Seven#7158
On node with -nSPV=-1 not nspv_ rpc seems to work fine.


[01-Aug-19 05:19 AM] jl777c#5810
what do you mean


[01-Aug-19 05:30 AM] TonyL#3577
On full node started with `-nSPV=-1` param non-nspv basic calls working fine


[01-Aug-19 05:31 AM] TonyL#3577
We also testing nSPV light-client komodod now (on ILN chain) and catching some strange states when after numerous calls client starting to permanently print `no pnodes` and not getting any info in responses


[01-Aug-19 05:34 AM] TonyL#3577
Aha, seems ILN nSPV fullnode not alive on `5.9.102.210` atm


[01-Aug-19 05:36 AM] Deleted User#0000
yes, need to add more detection for bad nodes.


[01-Aug-19 05:37 AM] TonyL#3577
we've started daemon in tests with -connect=5.9.102.210 rather than -addnode, was a mistake, with such param  usage no any detection can help üòÇ


[01-Aug-19 05:44 AM] jl777c#5810
with -nSPV=-1 then all non-nspv calls should work, ok, so there is no bug


[01-Aug-19 05:45 AM] jl777c#5810
still sidetracked by adaptivepow, but that seems ready and even mostly attack proof


[01-Aug-19 05:45 AM] jl777c#5810
hope to see why it is getting that strange data for just that address


[01-Aug-19 05:49 AM] gcharang#6833
```
curl --user $rpcuser:$rpcpassword --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "nspv_txproof", "params": ["ae234c7f47bcb5adbe7c5c5661051865be0ce61422328de90fe5a3f8fa8b7c60", "4322"] }' -H 'content-type: text/plain;' http://127.0.0.1:$rpcport/
```
komodod with `-nSPV=1`
it is expecting the second param `4322` to be quoted

libnspv doesn't need `4322` to be quoted

should I document the behaviour as is, or will this be changed?


[01-Aug-19 06:10 AM] jl777c#5810
i think there is a way to make komodo autoconvert. just get me a list of all rpc and params that need the conversion


[01-Aug-19 06:11 AM] jl777c#5810
oh, wait. i did that in the code. probably i can fix this. likely all integer parameters are affected

{Reactions}
üëç 

[01-Aug-19 09:47 PM] Deleted User#0000
`https://github.com/jl777/libnspv/pull/38/files` 
Pushed an update that removes bad peers, if they report older version, or if they are reporting a lower block height they are disconnected. Seem to only have 3 good peers right now on KMD chain.


[02-Aug-19 04:57 AM] jl777c#5810
@TonyL the latest version with blackjok3r fix, fixes the strange results with that special address

{Reactions}
üëç 

[02-Aug-19 05:05 AM] Sir Seven#7158
Longer internal timeout helped a lot, yet there were still timeout errors from time to time.
Will check libnspv build with blackjok3r fix to see if it solves the problem.


[02-Aug-19 05:40 AM] TonyL#3577
In getinfo I get info that login for this address, also by some reason ```  "sync_status": "not_synced",
  "estimated_headers_left": 0```


[02-Aug-19 05:41 AM] TonyL#3577
```curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "notarizations", "params": [77777] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/ | jq
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   775    0   693  100    82     17      2  0:00:41  0:00:40  0:00:01   161
{
  "result": "success",
  "prev": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"
  },
  "next": {
    "notarized_height": 0,
    "notarized_blockhash": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txid": "0000000000000000000000000000000000000000000000000000000000000000",
    "notarization_txidheight": 0,
    "notarization_desttxid": "0000000000000000000000000000000000000000000000000000000000000000"
  },
  "lastpeer": "nodeid.1"
}
```


[02-Aug-19 05:42 AM] TonyL#3577
worked 40 seconds and gave me zeroes


[02-Aug-19 05:43 AM] TonyL#3577
stdout on `notarizations` call
```parsing.(/)
,new argjson.({"jsonrpc":"2.0","id":"curltest","method":"notarizations","params":[77777],"height":77777})
got ntzs response 1564749753 size.221 0000000000000000000000000000000000000000000000000000000000000000 prev.0, 0000000000000000000000000000000000000000000000000000000000000000 next.0
got ntzs response 1564749763 size.221 0000000000000000000000000000000000000000000000000000000000000000 prev.0, 0000000000000000000000000000000000000000000000000000000000000000 next.0
got ntzs response 1564749773 size.221 0000000000000000000000000000000000000000000000000000000000000000 prev.0, 0000000000000000000000000000000000000000000000000000000000000000 next.0
```


[02-Aug-19 05:43 AM] TonyL#3577
on my side it's kinda "nothing works"  state atm it seems


[02-Aug-19 05:46 AM] TonyL#3577
```curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "listunspent", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/ | jq
{
  "result": "error",
  "error": "timeout",
  "lastpeer": "nodeid.24"
}
```


[02-Aug-19 05:46 AM] jl777c#5810
what about ILN


[02-Aug-19 05:46 AM] TonyL#3577
listunspent timeout in 100% cases and nodes changing in lastpeer


[02-Aug-19 05:46 AM] TonyL#3577
let me try


[02-Aug-19 05:46 AM] jl777c#5810
the KMD servers are very weak


[02-Aug-19 05:52 AM] TonyL#3577
on ILN still cant get response from listunspent
```curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "listunspent", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:12986/ | jq
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   134    0    59  100    75     19     24  0:00:03  0:00:03 --:--:--    44
{
  "result": "error",
  "error": "timeout",
  "lastpeer": "nodeid.6"
}
```


[02-Aug-19 05:53 AM] TonyL#3577
but in getinfo synced status now:
```  },
  "protocolversion": 2,
  "lastpeer": "nodeid.6",
  "sync_status": "synced"
}
```


[02-Aug-19 05:53 AM] TonyL#3577
https://paste.ubuntu.com/p/P6W9TgWpxZ/ nodes I'm connected to


[02-Aug-19 06:00 AM] TonyL#3577
Even tried with brand new address (getnewaddres -> login -> listunspent), timeout anyway


[02-Aug-19 06:01 AM] Deleted User#0000
synced only means the node is giving you a chaintip that can be verified to link back to the last notarization


[02-Aug-19 06:01 AM] Deleted User#0000
I will have a look at this soon. See oif I can reproduce

{Reactions}
üî• 

[02-Aug-19 07:20 AM] Deleted User#0000
Problem is that nodes dont have correct indexes. I think i have a KMD node here with them, testing now.


[02-Aug-19 08:26 AM] Deleted User#0000
@jl777c  https://github.com/jl777/komodo/pull/1666

{Embed}
https://github.com/jl777/komodo/pull/1666
fix NSPV by blackjok3rtt ¬∑ Pull Request #1666 ¬∑ jl777/komodo
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[02-Aug-19 08:31 AM] Deleted User#0000
@TonyL  If you use your own node with that commit things should be working agian. Let me know if any more problems


[02-Aug-19 08:37 AM] jl777c#5810
merged


[02-Aug-19 08:37 AM] jl777c#5810
looks like important fixes!


[02-Aug-19 08:40 AM] Deleted User#0000
I think so, I had a node not in sync and it was returning garbage, so I figured it shouldnt respond ...


[02-Aug-19 08:40 AM] Deleted User#0000
handling what node to try and fetch the info from is the hardest... Cant assume they are all honest.


[02-Aug-19 09:20 AM] Deleted User#0000
seems some RPC calls still dont work. :/


[03-Aug-19 01:19 AM] TonyL#3577
`If you use your own node with that commit things should be working agian. Let me know if any more problems` is there some way to test libnspv with connection to single full node only? (report above is for libnspv)


[03-Aug-19 01:21 AM] jl777c#5810
would need to change the seeds in coins file to a single seed and then disable peer discovery, add a 0 && to the if statement on line 389 in netspv.c


[03-Aug-19 01:21 AM] jl777c#5810
basically have one seed and dont process "addr" messages


[03-Aug-19 01:21 AM] TonyL#3577
thank you! @Sir Seven ^^


[03-Aug-19 04:00 AM] Deleted User#0000
That's how I was doing it yes, I still saw broken calls but listunspent was working again


[03-Aug-19 04:01 AM] Sir Seven#7158
So far:
All nSPV RPC calls on komodod and libnspv work as expected when connected to a reliable full node. AE -connect=
When we just use -addnode PRC calls tend to fail.
And pretty much nothing works withought adding/connecting a known good node.

{Reactions}
üëå 

[03-Aug-19 04:02 AM] Sir Seven#7158
Testsed both nSPV client and full node with your changes. @Deleted User


[03-Aug-19 04:03 AM] Deleted User#0000
Great, that's helpful. I have a fair idea of what to do but need a few days to sort it out.


[03-Aug-19 04:06 AM] Sir Seven#7158
The most problematic calls are:
listunspent, listtransasctions, notarizations.
3rd one tends to return garbage data when connected to bad nodes.


[03-Aug-19 04:11 AM] Deleted User#0000
It wasnt working for me at all the last one.


[05-Aug-19 07:39 AM] Sir Seven#7158
A question for listunspent call:

After user is automatically log out (777s passed) or used nspv_logout call:
nspv_litunspent withought parameters will still return unspent utxos of user's address.

```json
1. login

curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "login", "params": ["_wif_"] }' -H 'content-type: text/plain;' http://127.0.0.1:$rpcport/

{"result":"success","status":"wif will expire in 777 seconds","address":"_address_","pubkey":"_pubkey_","wifprefix":188,"compressed":1}

2. logout

curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "logout", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:$rpcport/

{"result":"success"}

3. send listunspent

curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "listunspent", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:$rpcport/

{"result":"success","utxos":[{"height":2717,"txid":"_actual_tx","vout":0,"value":1,"rewards":0}, {"height":4328,"txid":"actual_tx","vout":1,"value":0.6692,"rewards":0},],"address":"_address_","isCC":0,"height":5624,"numutxos":24,"balance":_balance_,"rewards":0,"skipcount":0,"filter":0,"lastpeer":"nodeid.1"}
```

So. Is it intended?


[05-Aug-19 07:43 AM] jl777c#5810
yes, you can see listunspent of any address


[05-Aug-19 07:43 AM] jl777c#5810
so why not default to the most recent logged in address?


[05-Aug-19 07:51 AM] Sir Seven#7158
I just expected to see error if no user is actually logged in.
There is no problem in this case.


[07-Aug-19 03:56 AM] gcharang#6833
@jl777c 
```bash
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "getpeerinfo", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:$port/
```

```json
  {
    "nodeid": 1,
    "protocolversion": 2,
    "ipaddress": "5.9.253.195",
    "port": 7770,
    "lastping": 1565175111,
    "time_started_con": 1565174366,
    "time_last_request": 1565175123,
    "services": 0,
    "missbehavescore": 0,
    "bestknownheight": 1476663,
    "in_sync": "not_synced"
  }
```
what is `"services": 0,` and ` "in_sync": "not_synced"` this node has the same bestknownheight as other nodes that don't have the "in_sync" property


[07-Aug-19 03:59 AM] jl777c#5810
not_synced is based on the info it sent back, maybe it is lagging a bit?


[07-Aug-19 03:59 AM] jl777c#5810
services 0 means its not an nSPV fullnode, which seems wrong


[07-Aug-19 04:00 AM] jl777c#5810
does it remain a peer?


[07-Aug-19 04:00 AM] jl777c#5810
with services 0, it seems it wont respond as a valid nSPV fullnode, which would not allow it to achieve in_sync status


[07-Aug-19 04:01 AM] gcharang#6833
@jl777c 
this is the whole output
https://paste.ubuntu.com/p/PX3fvWQgfc/
all nodes have services: 0
all have same bestknownheight
only 2 have "in_sync": "not_synced"


[07-Aug-19 04:02 AM] jl777c#5810
plz ask @Deleted User that was his update


[07-Aug-19 04:02 AM] gcharang#6833
will do


[07-Aug-19 06:46 AM] daemonfox#6136
With nSPV all dPOW coins can be "lite" sent... can it be used on BTC itself?


[07-Aug-19 06:47 AM] jl777c#5810
no, it needs to be a komodo based coin AND with dPoW, both


[07-Aug-19 06:49 AM] daemonfox#6136
so there is no way the Bitcoin SPV mode in AGAMA will ever work with nSPV?


[07-Aug-19 06:49 AM] daemonfox#6136
its on the wrong end of the validation notarizations?


[07-Aug-19 06:52 AM] jl777c#5810
i am 100% sure BTC legacy devs will reject any PR to add the nSPV functionality into the bitcoind


[07-Aug-19 06:53 AM] jl777c#5810
i guess we could make our own custom bitcoind with nSPV support as it isnt a consensus change, but really i dont feel like doing that. just too much work to help make a legacy coin have more tech. probably would make BTC price plummet

{Reactions}
üòÇ (5) 

[07-Aug-19 06:53 AM] daemonfox#6136
HAHAHA


[07-Aug-19 06:54 AM] daemonfox#6136
oh man i wasnt expecting that last part


[07-Aug-19 06:54 AM] daemonfox#6136
but i was thinking the same thing... bitcoind could be slightly modified so KMD had its own nSPV capable BTC nodes


[07-Aug-19 06:58 AM] jl777c#5810
it is not a "slight" modification


[07-Aug-19 07:56 PM] Deleted User#0000
services I think is reading the wrong variable, I will fix it. Synced means that it has the block header from that node for the chain tip and it links back to the last notarization.After its been running a while all nodes should be synced to the same block.


[07-Aug-19 07:56 PM] Deleted User#0000
@gcharang

{Reactions}
üëç 

[08-Aug-19 12:21 AM] gcharang#6833
got it


[08-Aug-19 08:09 AM] dukeleto#7326
FYI HUSH has merged in latest nSPV updates from `FSM` branch

{Reactions}
üòé 

[11-Aug-19 09:31 AM] jl777c#5810
@gcharang fixed the services value

{Reactions}
üëç 

[11-Aug-19 09:33 AM] jl777c#5810
also we just achieved the first web wallet broadcast. still it is very rough and many fields are not being generated but it should be simple to use and able to create and broadcast valid tx


[11-Aug-19 10:25 AM] jl777c#5810
@allbits maybe you might want to try it. just start nspv and then go to browser http://127.0.0.1:<rpcport>


[11-Aug-19 11:18 AM] allbits#5898
K. Will do later today. Thanks. I'll have to remember how to update my nspv haha


[11-Aug-19 11:21 AM] Deleted User#0000
git pull
make


[11-Aug-19 11:27 AM] allbits#5898
Yeah. Thanks üòÄ


[11-Aug-19 11:27 AM] allbits#5898
How do I check what branch I'm in. I haven't updated in a while


[11-Aug-19 11:32 AM] Deleted User#0000
git branch


[11-Aug-19 11:47 AM] allbits#5898
Thanks


[11-Aug-19 12:08 PM] jl777c#5810
in the jl777 branch


[11-Aug-19 12:32 PM] allbits#5898
Was just going to ask that!


[11-Aug-19 01:19 PM] allbits#5898
Am I doing libnspv?


[11-Aug-19 01:20 PM] jl777c#5810
yes


[11-Aug-19 01:20 PM] jl777c#5810
just like when you did the cli testing, just can use the browser now


[11-Aug-19 01:22 PM] allbits#5898
Updated. I did ./nspv. What rpc port in the browser?


[11-Aug-19 01:22 PM] jl777c#5810
what coin


[11-Aug-19 01:22 PM] Deleted User#0000
-port= work?


[11-Aug-19 01:23 PM] allbits#5898
I just did ./nspv without surviving anything else


[11-Aug-19 01:23 PM] Deleted User#0000
then it will be 7771


[11-Aug-19 01:23 PM] jl777c#5810
then it is KMD, port 7771


[11-Aug-19 01:23 PM] jl777c#5810
-port should work


[11-Aug-19 01:23 PM] Deleted User#0000
-port seems like a good idea so all coins are the same port


[11-Aug-19 01:23 PM] jl777c#5810
no


[11-Aug-19 01:23 PM] jl777c#5810
each nspv is a separate process


[11-Aug-19 01:24 PM] jl777c#5810
only one can bind any specific rpc port


[11-Aug-19 01:24 PM] allbits#5898
I get error: no method returned in the browser


[11-Aug-19 01:24 PM] Deleted User#0000
yes. But to test, just set port so all scripts will just work, with alll coins


[11-Aug-19 01:24 PM] jl777c#5810
http://127.0.0.1:7771


[11-Aug-19 01:25 PM] jl777c#5810
you are right, seems i just broken it


[11-Aug-19 01:25 PM] jl777c#5810
no it works


[11-Aug-19 01:25 PM] allbits#5898
Ok


[11-Aug-19 01:25 PM] jl777c#5810
i am just not running it for KMD


[11-Aug-19 01:26 PM] allbits#5898
I get error: no method


[11-Aug-19 01:26 PM] jl777c#5810
./nspv ILN


[11-Aug-19 01:26 PM] jl777c#5810
try ILN


[11-Aug-19 01:26 PM] jl777c#5810
it is port 12986


[11-Aug-19 01:27 PM] allbits#5898
Same result


[11-Aug-19 01:28 PM] jl777c#5810
does cli respond?


[11-Aug-19 01:28 PM] allbits#5898
Cli output seems normal. What kind of commands can I test on cli


[11-Aug-19 01:28 PM] jl777c#5810
nothing has changed on cli


[11-Aug-19 01:30 PM] jl777c#5810
try http://127.0.0.1:12986/method/getinfo


[11-Aug-19 01:31 PM] allbits#5898
Oooh that worked! Looks pretty


[11-Aug-19 01:31 PM] allbits#5898
Except for my ILN balance


[11-Aug-19 01:32 PM] jl777c#5810
you can try with KMD now it works


[11-Aug-19 01:32 PM] jl777c#5810
but only test amounts


[11-Aug-19 01:33 PM] allbits#5898
There it is!


[11-Aug-19 01:53 PM] allbits#5898
So I generated new address, logged in, received funds. Then tested send but sent full amount (without accounting for fee). This created a crash when I tried to broadcast the transaction. There was also lots of unformed data on that broadcast page - variable names instead of numbers


[11-Aug-19 01:53 PM] jl777c#5810
try sending a bit less


[11-Aug-19 01:57 PM] allbits#5898
Tried sending less and it aborted when I hit send transaction (the step before broadcast)


[11-Aug-19 01:57 PM] jl777c#5810
update to latest, i just fixed some bugs


[11-Aug-19 01:57 PM] allbits#5898
K


[11-Aug-19 01:59 PM] allbits#5898
Success!


[11-Aug-19 02:02 PM] allbits#5898
Funds received ok. But nspv wallet not updating - not showing updated balance or the transaction in the transaction history


[11-Aug-19 02:02 PM] jl777c#5810
this has no javascript


[11-Aug-19 02:02 PM] allbits#5898
I hit refresh but it doesn't update


[11-Aug-19 02:02 PM] jl777c#5810
oh, seems it is in the cache. if you logout and login again is the balance ok?


[11-Aug-19 02:02 PM] grewalsatinder#9653
```$ ./nspv MORTY
couldnt match coin, defaulting to KMD chain
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash KMD
Start NSPV_rpcloop.7771
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:7771 bind sock.3 API enabled at unixtime.1565557344 <<<<<<<<<
Discover KMD peers...^C```


[11-Aug-19 02:02 PM] grewalsatinder#9653
trying RICK or MORTY goes to 7771


[11-Aug-19 02:03 PM] grewalsatinder#9653
I guess it doesn't has those params


[11-Aug-19 02:03 PM] jl777c#5810
coins entry is needed


[11-Aug-19 02:03 PM] grewalsatinder#9653
I just wanted to test the test chain, instead of real KMD or other assetchains etc


[11-Aug-19 02:03 PM] jl777c#5810
look at ILN, it shows what fields are needed


[11-Aug-19 02:03 PM] grewalsatinder#9653
okay


[11-Aug-19 02:03 PM] allbits#5898
Logout and login didn't fix


[11-Aug-19 02:03 PM] jl777c#5810
did the tx confirm?


[11-Aug-19 02:04 PM] allbits#5898
Yes.


[11-Aug-19 02:05 PM] jl777c#5810
@grewalsatinder latest has the vin/vout working. but for vin we need to remove the amount field


[11-Aug-19 02:07 PM] jl777c#5810
as of now, web wallet is feature complete, of course there will be bugs


[11-Aug-19 02:08 PM] grewalsatinder#9653
https://raw.githubusercontent.com/jl777/SuperNET/beta/iguana/coins/rick_7776


[11-Aug-19 02:08 PM] grewalsatinder#9653
trying to find `magic` value for RICK


[11-Aug-19 02:09 PM] jl777c#5810
"netmagic\":\"f60d75fd


[11-Aug-19 02:09 PM] grewalsatinder#9653
ah it's netmagic ?


[11-Aug-19 02:09 PM] grewalsatinder#9653
got it


[11-Aug-19 02:09 PM] grewalsatinder#9653
üëç


[11-Aug-19 02:09 PM] jl777c#5810
it might be byte reversed fd750df6


[11-Aug-19 02:09 PM] jl777c#5810
just try it one way and if it doesnt work, the other way


[11-Aug-19 02:10 PM] grewalsatinder#9653
```JSON
{
    "coin": "RICK",
    "asset": "RICK",
    "fname": "RICK",
    "rpcport": 25435,
    "mm2": 1,
    "p2p": 25434,
    "magic":"f60d75fd",
    "nSPV": "78.47.196.146"
  },
```


[11-Aug-19 02:10 PM] grewalsatinder#9653
does this seed node has to be running with nSPV=1 or something?


[11-Aug-19 02:10 PM] jl777c#5810
yes


[11-Aug-19 02:10 PM] jl777c#5810
and that is not a good address for seed node


[11-Aug-19 02:11 PM] jl777c#5810
it is my node address and i am not running RICK on it


[11-Aug-19 02:11 PM] grewalsatinder#9653
okay


[11-Aug-19 02:11 PM] jl777c#5810
oh, it just needs to be a recent  dev branch or below


[11-Aug-19 02:11 PM] jl777c#5810
as long as nSPV=-1 is not set


[11-Aug-19 02:11 PM] jl777c#5810
so the default fullnode will support nSPV clients


[11-Aug-19 02:12 PM] grewalsatinder#9653
nice!


[11-Aug-19 02:12 PM] jl777c#5810
just launch it normally and you can . use it as a seed


[11-Aug-19 02:12 PM] grewalsatinder#9653
trying to find RICK explorer


[11-Aug-19 02:12 PM] grewalsatinder#9653
may be if I could get some nodes IP from there


[11-Aug-19 02:15 PM] grewalsatinder#9653
https://github.com/jl777/coins/blob/master/electrums/RICK

{Embed}
https://github.com/jl777/coins/blob/master/electrums/RICK
jl777/coins
coin parameters and all files needed for GUI support - jl777/coins
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[11-Aug-19 02:15 PM] grewalsatinder#9653
used IPs from this coins files


[11-Aug-19 02:16 PM] grewalsatinder#9653
```$ ./nspv RICK
Found (RICK) magic.f60d75fd, p2p.25434 seeds.(27.102.107.29, 27.102.107.28, 27.102.107.27)
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash RICK
Start NSPV_rpcloop.25435
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:25435 bind sock.3 API enabled at unixtime.1565558160 <<<<<<<<<
Discover RICK peers...end of client runloop
```


[11-Aug-19 02:16 PM] grewalsatinder#9653
üòÑ


[11-Aug-19 02:17 PM] allbits#5898
Ok. So if I login to a completely different WIF, and then log back in to the original, then it shows me updated balances and transactions


[11-Aug-19 02:17 PM] jl777c#5810
yes, fixing it now


[11-Aug-19 02:24 PM] jl777c#5810
latest version fixes it


[11-Aug-19 02:33 PM] allbits#5898
I did another send transaction. Hitting refresh but balances not updating and new transaction not showing. Transaction has been confirmed


[11-Aug-19 02:37 PM] allbits#5898
Actually the balance updated fine but not seeing the transaction in the history


[11-Aug-19 02:39 PM] grewalsatinder#9653
```BASH
$ du -h
 28K    ./html/images
908K    ./html
1.6M    .
```


[11-Aug-19 02:39 PM] grewalsatinder#9653
that's just 1.6Mb of SuperLite client! üòÉ


[11-Aug-19 02:41 PM] jl777c#5810
i need to refresh the history too


[11-Aug-19 02:41 PM] grewalsatinder#9653
```
$ tree
.
‚îú‚îÄ‚îÄ html
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ bootstrap.min.css
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ bootstrap.min.css.map
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ broadcast
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ custom.css
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ favicon.ico
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ getinfo
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ getpeerinfo
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ getpeerinfo_table_row.inc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ images
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ antara150x150.png
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ sub-header-logo-min.png
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ index
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ login
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ logout
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ send_confirm
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ send_validate
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ send_validate_txvin_table_row.inc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ send_validate_txvout_table_row.inc
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ txidinfo
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ wallet
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ wallet_tx_history_table_row.inc
‚îî‚îÄ‚îÄ nspv

2 directories, 21 files
```


[11-Aug-19 02:41 PM] jl777c#5810
strip the nspv executable


[11-Aug-19 02:42 PM] jl777c#5810
i guess it doesnt do much, 600kb


[11-Aug-19 02:42 PM] jl777c#5810
the html is more than double the size of the code


[11-Aug-19 02:42 PM] grewalsatinder#9653
```
$ ls -lh
total 1200
drwxr-xr-x  21 satinder  staff   672B 12 Aug 09:37 html
-rwxr-xr-x   1 satinder  staff   597K 12 Aug 09:42 nspv

$ du -h
 28K    ./html/images
908K    ./html
1.5M    .

```


[11-Aug-19 02:43 PM] jl777c#5810
almost fits on those 1.44MB floppy


[11-Aug-19 02:44 PM] grewalsatinder#9653
just has to format the floppy a bit to extend it's storage üòÑ


[11-Aug-19 02:44 PM] jl777c#5810
bootstrap.min.css files are 80% of the html


[11-Aug-19 02:44 PM] grewalsatinder#9653
let me see if I can make some custom bootstrap min file a stripped down version from official site. I know they have such tools etc.


[11-Aug-19 02:47 PM] grewalsatinder#9653
couldn't find it... anyway... already small enough client!


[11-Aug-19 02:48 PM] jl777c#5810
@allbits updated so it should refresh the txids on wallet refresh, also i reversed the order so it shows most recent first


[11-Aug-19 02:52 PM] jl777c#5810
@Sir Seven html wallet is ready for testing. should be feature complete and so far no known bugs, anything that would make the cli crash, would also make the html wallet crash though


[11-Aug-19 02:52 PM] jl777c#5810
also updated servers with possible fix for skipcount


[11-Aug-19 02:58 PM] Sir Seven#7158
Got it.


[11-Aug-19 03:07 PM] allbits#5898
Yes worked


[12-Aug-19 02:49 AM] smkhound#7640

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610409618182635521/unknown.png


[12-Aug-19 02:50 AM] smkhound#7640
goes to this by default at 127.0.0.0:7771


[12-Aug-19 02:51 AM] smkhound#7640
logout, login, refresh and transactions buttons return a page.


[12-Aug-19 02:52 AM] smkhound#7640
login with a new address wif returns same page and tx history as shown in screen above


[12-Aug-19 02:52 AM] smkhound#7640
info, send, recieve, details, previous page and next page buttons return `{"error":"no method"}`


[12-Aug-19 02:54 AM] Sir Seven#7158
Hm. On ILN  127.0.0.1:12986 returns `{"error":"no method"}` you should use a valid method like getinfo or getpeers to see web UI.


[12-Aug-19 02:55 AM] Sir Seven#7158
IE `http://127.0.0.1:12986/api/method/getinfo`


[12-Aug-19 02:55 AM] smkhound#7640
yeap, that returns valid json


[12-Aug-19 03:03 AM] Sir Seven#7158
Hm. Just to be sure, are you checking latest version from jl777 branch?


[12-Aug-19 03:04 AM] Sir Seven#7158
UI hass different layout for me.


[12-Aug-19 03:05 AM] smkhound#7640
yeah I had old version, did git pull and make clean. after that, rm -rf'd it, and cloned new. not jl777 branch tho, copy pasted from @jl777c post in #üí¨‚îÉgeneral

{Reactions}
üëå 

[12-Aug-19 03:05 AM] smkhound#7640
I see now it's been updated to use that branch, will try again üëçüèº


[12-Aug-19 03:09 AM] jl777c#5810
just pushed update to all branches, they are all the same now


[12-Aug-19 03:24 AM] Sir Seven#7158
There are some inconsistences uing old calls like   ` http://127.0.0.1:$port/api/method/$method/$params`

Like getpeerinfo or getinfo returns UI page for it:


[12-Aug-19 03:24 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610418344759263232/getpeer.png


[12-Aug-19 03:24 AM] Sir Seven#7158
`api/login/wif/$wif`
returns broken page:


[12-Aug-19 03:25 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610418479127986186/login.png


[12-Aug-19 03:25 AM] Sir Seven#7158
And some api methods just return json


[12-Aug-19 03:25 AM] jl777c#5810
i need to fix the api path to just return the json


[12-Aug-19 03:25 AM] jl777c#5810
fixing


[12-Aug-19 03:25 AM] Sir Seven#7158
Yep.


[12-Aug-19 03:25 AM] Sir Seven#7158
The biggest problem for now from my point.


[12-Aug-19 03:28 AM] jl777c#5810
pushed possible fix


[12-Aug-19 03:33 AM] Sir Seven#7158
WebUI works good, no issues with presented functionality.
A few notes/thoughts:

- just opening `http://127.0.0.1:$port/` always opens `To continue, log in to your account.` page. Even if you are logged in.
- will be nice to have help page and/or api decription page
- there is no options to call `stop` from webUI, or I just can't find one :)
- no mempool either
- spending has a nice flow: create prototype -> revize -> create tx -> broadcast, but just broadcast field looks weird on info page. Quite counter-intuitive.


[12-Aug-19 03:35 AM] jl777c#5810
broadcast field is at the bottom of the page, most people wont even see it


[12-Aug-19 03:35 AM] jl777c#5810
mempool requests will create a lot of load


[12-Aug-19 03:35 AM] Sir Seven#7158
Logout is a separarte button on top. shouldn't it be inside Account page?


[12-Aug-19 03:35 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610421188430135303/unknown.png


[12-Aug-19 03:36 AM] jl777c#5810
make a help page and i can display it


[12-Aug-19 03:36 AM] Sir Seven#7158
Ok.


[12-Aug-19 03:36 AM] jl777c#5810
yes, the login/logout/index is a bit of a kludge


[12-Aug-19 03:36 AM] jl777c#5810
just a side effect of not having enough time to get all the kinks out


[12-Aug-19 03:36 AM] jl777c#5810
there is no stop from GUI


[12-Aug-19 03:37 AM] jl777c#5810
the memory and CPU usage is quite low


[12-Aug-19 03:37 AM] jl777c#5810
anyway the html templates are there, feel free to make PR with improved appearance, help, etc.


[12-Aug-19 03:38 AM] jl777c#5810
change in control flow will require some changes in the C code


[12-Aug-19 03:38 AM] jl777c#5810
i had the logout button in the upper right to allow instant logout, in case time is urgent


[12-Aug-19 03:38 AM] jl777c#5810
it wipes all the data from RAM


[12-Aug-19 03:39 AM] Sir Seven#7158
Got it.


[12-Aug-19 03:39 AM] jl777c#5810
i think better text can fix most all your issues


[12-Aug-19 03:39 AM] Sir Seven#7158
The memory and CPU usage is pretty much too low. :)


[12-Aug-19 03:40 AM] jl777c#5810
it is so far down the list of processes, i dont think people will complain it is running


[12-Aug-19 03:40 AM] jl777c#5810
and there is no installer


[12-Aug-19 03:40 AM] jl777c#5810
maybe there is some installer that makes the install process easy which can have a stop function


[12-Aug-19 03:42 AM] Sir Seven#7158
Oh. One more note:
Going to account page, each time generates new addr. It's not a problem, just feels strange.


[12-Aug-19 03:42 AM] jl777c#5810
maybe you can make some screenshots of the flow


[12-Aug-19 03:42 AM] jl777c#5810
i actually like it, it goes fast enough you can generate lots of addresses quickly


[12-Aug-19 03:43 AM] jl777c#5810
but there is a way to hide that part until the generate new address button is clicked


[12-Aug-19 03:48 AM] Sir Seven#7158
Latest commit fixed processing of `/api/method/` calls.
WIth one problem:
opening `http://127.0.0.1:port/` returns `{"error":"no method"}` now.


[12-Aug-19 03:54 AM] jl777c#5810
that syntax is invalid


[12-Aug-19 03:55 AM] Sir Seven#7158
Ops. Typo


[12-Aug-19 03:55 AM] jl777c#5810
i see what you mean, investigating


[12-Aug-19 03:56 AM] Sir Seven#7158
Correct link looks like `http://127.0.0.1:port/method/index?`


[12-Aug-19 03:56 AM] jl777c#5810
it should work from root too, fixing


[12-Aug-19 04:01 AM] jl777c#5810
pushed fix


[12-Aug-19 04:01 AM] jl777c#5810
please test for memory leaks after prolonged active usage


[12-Aug-19 04:01 AM] smkhound#7640
layout looks real nice üòç


[12-Aug-19 04:02 AM] jl777c#5810
all due to @grewalsatinder


[12-Aug-19 04:02 AM] jl777c#5810
easy to use for beginner, but has all the info needed for advanced user


[12-Aug-19 04:07 AM] jl777c#5810
does it work on windows?


[12-Aug-19 04:19 AM] jl777c#5810
@Sir Seven the other reason i left the getnewaddress output on the first screen is to minimize the steps needed to onboard a new user.
basically it is run ./nspv, browse 127.0.0.1:port
copy the wif, login
have somebody send funds, click refresh
then can send funds. basically onboarded pretty much instantly


[12-Aug-19 04:19 AM] jl777c#5810
i just dont like having to keep clicking many times to do the main thing i want to do. and once you have a wif, you just use it to login


[12-Aug-19 04:20 AM] jl777c#5810
of course wif are not user friendly, so this probably needs to be changed to some standard set of 12 words...


[12-Aug-19 04:20 AM] jl777c#5810
think of it as a low level GUI. given the screen shots and control flow of the current, some UX specialist can specify the changes needed


[12-Aug-19 04:21 AM] Sir Seven#7158
Sounds reasonable. Still there are UI improvements to make.
Will recheck soon on WIndows.


[12-Aug-19 04:21 AM] jl777c#5810
i am certainly no UI dev, let alone UX. the goal was to make a decent html wallet that is as secure as cli


[12-Aug-19 04:22 AM] jl777c#5810
now we have it, we make sure it is solid and document it clearly, so the next iteration can be defined


[12-Aug-19 04:28 AM] jl777c#5810
it seems without prebuilt binaries or installers, most people are unable to run it.


[12-Aug-19 04:29 AM] jl777c#5810
@Sir Seven are you able to build such things?


[12-Aug-19 04:30 AM] jl777c#5810
i dont think we need much documentation, just the screenshots should almost be enough as there really isnt much you can do with a superlite


[12-Aug-19 04:30 AM] Sir Seven#7158
I think so at least.


[12-Aug-19 04:30 AM] jl777c#5810
we need to fully test the fullnode side to make sure it is ready to be pushed to beta branch


[12-Aug-19 04:31 AM] jl777c#5810
it is up to the dev branch so far and i havent heard of any issues


[12-Aug-19 04:33 AM] Sir Seven#7158
When creating a non-valid transaction. Guess should be an error page.

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610435569255841792/unknown.png


[12-Aug-19 04:38 AM] jl777c#5810
i need html for an error page


[12-Aug-19 04:38 AM] jl777c#5810
the C code only substitutes values in the html template files


[12-Aug-19 04:38 AM] jl777c#5810
so all possible error pages needs a separate html template


[12-Aug-19 04:38 AM] jl777c#5810
plz identify them all and we an add them

{Reactions}
üëå 

[12-Aug-19 04:54 AM] Sir Seven#7158
Will contact @grewalsatinder later for errors page.


[12-Aug-19 04:55 AM] jl777c#5810
maybe its just one error page for send error as not sure what else can go wrong with the current pages


[12-Aug-19 05:26 AM] dukeleto#7326
the screenshot above is pretty awesome


[12-Aug-19 05:26 AM] Sir Seven#7158
Well, generally there are 3 inputs and 3 errors possible:
incorrect send, incorrect broadcast and non-valid wif to login with.
Plus random path like `http://127.0.0.1:&port/random/path/here` - might be good idea to redirect it.
Is it possible to pass internal error messages like `error: invalid address or amount too small` to standard error page?


[12-Aug-19 05:26 AM] dukeleto#7326
y'all keep impressing me


[12-Aug-19 06:02 AM] jl777c#5810
@Sir Seven any sort of error page can be shown on any sort of condition. just look at what the nspv is doing now. generating in realtime state based html


[12-Aug-19 06:03 AM] jl777c#5810
yesterday was literally the first day it went from displaying mockup data to live data


[12-Aug-19 06:03 AM] jl777c#5810
so it is still very young


[12-Aug-19 07:40 AM] dukeleto#7326
FYI I will post at least a 1000 HUSH bounty for somebody to help HUSH use all the latest/greatest superlite nSPV stuff GUI stuff. We have all the full node internals merged in. I know things are in flux and want to help development. 1000 HUSH is just to get a basic superlite gui Hush wallet using nSPV. More bounties are available for additional work


[12-Aug-19 07:45 AM] jl777c#5810
you just need to make a coins file entry like ILN has


[12-Aug-19 07:45 AM] jl777c#5810
then you can ./nspv HUSH3


[12-Aug-19 07:45 AM] jl777c#5810
and it will appear on the localhost:hushrpcport


[12-Aug-19 07:49 AM] jl777c#5810
really you just need a single fullnode running the latest dev branch or below


[12-Aug-19 07:49 AM] jl777c#5810
use that as a seed


[12-Aug-19 07:49 AM] jl777c#5810
and getting the netmagic added to coins file


[12-Aug-19 07:49 AM] jl777c#5810
then nspv will automatically configure to connect to the p2p network and http://127.0.0.1:port will display the GUI


[12-Aug-19 07:50 AM] jl777c#5810
so far it has worked seamlessly between KMD, NSPV and ILN chains


[12-Aug-19 08:00 AM] jl777c#5810
@dukeleto i think if you just run it, you will see what i mean.


[12-Aug-19 08:01 AM] jl777c#5810
./nspv and http://127.0.0.1:7771


[12-Aug-19 08:44 AM] smkhound#7640
gave it a shot, but no nodes wanting to play 
``` ./nspv HUSH
Found (HUSH) magic.6ed394d3, p2p.18030 seeds.(66.11.124.12, 188.165.212.101, 136.243.227.142, 5.9.224.250, 92.12.152.148, 192.99.19.160, 104.152.206.137, 70.163.218.71)
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash HUSH
Start NSPV_rpcloop.18031
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:18031 bind sock.3 API enabled at unixtime.1565624411 <<<<<<<<<
Discover HUSH peers...nServices.5 disconnect from node 6: /MagicBean:2.0.15-rc2/ (69430)
Disconnect node 6
nServices.5 disconnect from node 1: /MagicBean:2.0.15-rc2/ (69430)
Disconnect node 1
nServices.5 disconnect from node 2: /GoldenSandtrout:3.0.0-beta2/ (69430)
Disconnect node 2
max rpc threads spawned and alive 0 <- 1
no nodes
no nodes
no nodes
no nodes
no nodes
no nodes
end of client runloop
```


[12-Aug-19 08:45 AM] smkhound#7640
sleep now, but I think this should be the right magic etc in coins file
```  {
    "coin": "HUSH",
    "asset": "HUSH3",
    "fname": "Hush",
    "rpcport": 18031,
    "p2p": 18030,
    "magic":"6ed394d3",
    "nSPV":"66.11.124.12, 188.165.212.101, 136.243.227.142, 5.9.224.250",
    "mm2": 1
  }```


[12-Aug-19 08:50 AM] jl777c#5810
you need to make sure the nSPV nodes are running the latest dev branch or lower


[13-Aug-19 01:47 AM] jl777c#5810
@grewalsatinder a few improvements for the html:
need error pages for: incorrect send, incorrect broadcast and non-valid wif to login with.
maybe a single error page where i can just display some text, or can even be three different error pages, whichever is easier

also on the wallet page, a new row below the coin/balance/address that has a mempool section. so a button like "Update" which would send the mempool query and then it would show a list of txids for any incoming funds. this will also catch sends if there was any change, so only tx that are sent but have not change will not appear. it seems a good compromise. maybe it will be like the txid history in how it is displayed


[13-Aug-19 01:49 AM] grewalsatinder#9653
okay, mocking up error page in few min


[13-Aug-19 02:41 AM] grewalsatinder#9653
@jl777c need error outputs for these errors please


[13-Aug-19 02:44 AM] jl777c#5810
"There was an error sending. $SENDERROR"


[13-Aug-19 02:44 AM] grewalsatinder#9653
making general error page for now


[13-Aug-19 02:44 AM] grewalsatinder#9653
I guess if just displaying a single text line is the purpose, generic error page should do


[13-Aug-19 02:44 AM] jl777c#5810
"The hex couldnt be broadcast."


[13-Aug-19 02:45 AM] jl777c#5810
"The wif used is invalid"


[13-Aug-19 02:45 AM] grewalsatinder#9653
got it, was just getting idea by the error output. thanks üëç


[13-Aug-19 02:45 AM] jl777c#5810
i think for broadcast, there is only one error


[13-Aug-19 02:45 AM] jl777c#5810
so no need for variable. for send error, i will replace $SENDERROR with appropriate message


[13-Aug-19 02:48 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610771747322724372/Screen_Shot_2019-08-13_at_9.48.28_PM.png


[13-Aug-19 02:48 AM] grewalsatinder#9653
made this generic error page


[13-Aug-19 02:49 AM] grewalsatinder#9653
using $ERROR_OUTPUT


[13-Aug-19 02:54 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/70

{Embed}
https://github.com/jl777/libnspv/pull/70
generic error html page by satindergrewal ¬∑ Pull Request #70 ¬∑ j...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[13-Aug-19 02:55 AM] jl777c#5810
thanks! did you understand about the mempool?


[13-Aug-19 02:56 AM] jl777c#5810
maybe we say "unconfirmed" transactions


[13-Aug-19 02:56 AM] grewalsatinder#9653
not too clearly ü§î


[13-Aug-19 02:56 AM] jl777c#5810
right now the mempool is invisible to nspv


[13-Aug-19 02:56 AM] jl777c#5810
but it has the ability to scan the mempool for transactions coming into any specific address


[13-Aug-19 02:56 AM] jl777c#5810
like your addresss


[13-Aug-19 02:56 AM] jl777c#5810
but this is a network request


[13-Aug-19 02:57 AM] jl777c#5810
so like the "refresh" button is required to refresh the history


[13-Aug-19 02:57 AM] jl777c#5810
we have an "update" button to refresh the "unconfirmed transactions" section


[13-Aug-19 02:57 AM] jl777c#5810
basically a transaction history like section that is for "Unconfirmed Transactions"


[13-Aug-19 02:58 AM] jl777c#5810
user finds out someone is supposed to have sent him funds, but it doesnt show in his balance or history


[13-Aug-19 02:58 AM] jl777c#5810
he can then click "update" and see if the tx was already sent or not


[13-Aug-19 02:58 AM] jl777c#5810
does this make sense?


[13-Aug-19 02:58 AM] grewalsatinder#9653
yes, makes better sense now


[13-Aug-19 02:58 AM] grewalsatinder#9653
what info should be displaying for that page


[13-Aug-19 02:59 AM] grewalsatinder#9653
exaclty like the tx history table?


[13-Aug-19 02:59 AM] jl777c#5810
yes, that seems the easiest, we can see how it works and tweak it


[13-Aug-19 03:00 AM] jl777c#5810
but i think the only difference is that you wont see any "OUT" tx as the mempool search only sees "IN" transactions


[13-Aug-19 03:00 AM] jl777c#5810
but it will see the change coming in, so only the "OUT" tx without any change will be invisible


[13-Aug-19 03:00 AM] jl777c#5810
oh, it should have a slightly different row


[13-Aug-19 03:01 AM] jl777c#5810
it needs to display the amount


[13-Aug-19 03:01 AM] jl777c#5810
maybe even sender and receiver address


[13-Aug-19 03:01 AM] jl777c#5810
ok, so it is totally different


[13-Aug-19 03:01 AM] grewalsatinder#9653
do you suggest to make a new page for this or just another table showing on same wallet page?


[13-Aug-19 03:01 AM] jl777c#5810
same wallet page


[13-Aug-19 03:01 AM] jl777c#5810
just a table ABOVE the tx history


[13-Aug-19 03:02 AM] grewalsatinder#9653
okay, so it'll have columns like:
Direction, Confirms, Amount, Height, TxID, Sender/Receiver


[13-Aug-19 03:03 AM] jl777c#5810
each row would have  destination address, amount, txid


[13-Aug-19 03:03 AM] jl777c#5810
no height, as it isnt mined yet


[13-Aug-19 03:03 AM] grewalsatinder#9653
okay


[13-Aug-19 03:03 AM] jl777c#5810
no confirms as it isnt confirmed yet


[13-Aug-19 03:03 AM] grewalsatinder#9653
ah okay


[13-Aug-19 03:04 AM] grewalsatinder#9653
Direction, Dest. Address, Amount, TxID


[13-Aug-19 03:04 AM] jl777c#5810
a totally different set of columns


[13-Aug-19 03:04 AM] jl777c#5810
direction is always IN


[13-Aug-19 03:04 AM] jl777c#5810
but I can add the right badges


[13-Aug-19 03:04 AM] grewalsatinder#9653
got it, should I display it or ignore displaying it.


[13-Aug-19 03:05 AM] grewalsatinder#9653
okay, for badges I should keep that column then üôÇ


[13-Aug-19 03:05 AM] jl777c#5810
I guess we can have Type, destination, Amount txid


[13-Aug-19 03:05 AM] grewalsatinder#9653
alrighty!


[13-Aug-19 03:05 AM] grewalsatinder#9653
on it now


[13-Aug-19 03:09 AM] grewalsatinder#9653
@jl777c what should be the Update URL for this table?
$URL/method/wallet?nexturl=mempool


[13-Aug-19 03:10 AM] jl777c#5810
it is the same wallet page


[13-Aug-19 03:10 AM] jl777c#5810
no change


[13-Aug-19 03:10 AM] jl777c#5810
just add stuff to the existing wallet page


[13-Aug-19 03:10 AM] grewalsatinder#9653
ok


[13-Aug-19 03:10 AM] jl777c#5810
most of the time it will be blank


[13-Aug-19 03:19 AM] grewalsatinder#9653
@jl777c pushed update for wallet page


[13-Aug-19 05:14 AM] gcharang#6833
@jl777c what does the `services` key in getpeerinfo's response mean?
```
  {
    "nodeid": 54,
    "protocolversion": 2,
    "ipaddress": "145.239.150.174",
    "port": 7770,
    "lastping": 1565698386,
    "time_started_con": 1565693756,
    "time_last_request": 1565698410,
    "services": 1073741829,
    "missbehavescore": 0,
    "bestknownheight": 1485272,
    "in_sync": "synced"
  },
```


[13-Aug-19 05:22 AM] jl777c#5810
it should be 70000005 (not sure how many 0s)


[13-Aug-19 05:23 AM] jl777c#5810
the 7 means nSPV support with both addressindex and spent index


[13-Aug-19 05:23 AM] jl777c#5810
that node appears to be returning some random value


[13-Aug-19 05:23 AM] jl777c#5810
are you running latest version, i fixed the services field recently


[13-Aug-19 05:25 AM] gcharang#6833
yes, I built libnspv, branch - jl777    3 hours back
most of the nodes are sending the same value: 1073741829
https://paste.ubuntu.com/p/6Zh2Y9WvG9/

will build again and check


[13-Aug-19 05:28 AM] gcharang#6833
@jl777c getting the same response as before


[13-Aug-19 05:29 AM] gcharang#6833
the html ui is giving a different response

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610812205780434954/Screenshot_from_2019-08-13_17-59-04.png


[13-Aug-19 05:44 AM] jl777c#5810
the html ui value is correct


[13-Aug-19 05:53 AM] jl777c#5810
@gcharang the difference is decimal in the api output, gui is displaying in hex


[13-Aug-19 05:53 AM] jl777c#5810
they are the same numbers


[13-Aug-19 05:59 AM] jl777c#5810
@grewalsatinder is there a way to add a ?update=1 and ?refresh=1 value to the wallet url depending on which button was pressed? Also the "Mempool Transactions" should be "Unconfirmed Transactions".


[13-Aug-19 05:59 AM] jl777c#5810
"Dest. Addr" -> "Destination"


[13-Aug-19 06:00 AM] jl777c#5810
would be good to line up the Amount and Txid columns with the "Transaction history" rows if possible


[13-Aug-19 06:01 AM] gcharang#6833
got it
so services starting with 7 means nSPV support with both addressindex and spent index
starting with 4? just nspv with no addressindex and spent index ?
ending with 5?


[13-Aug-19 06:02 AM] jl777c#5810
correct


[13-Aug-19 06:02 AM] jl777c#5810
5 is the normal nServices value for fullnodes


[13-Aug-19 06:02 AM] jl777c#5810
@grewalsatinder can we hyperlink the txid in the vin array?


[13-Aug-19 06:02 AM] gcharang#6833
got it


[13-Aug-19 06:41 AM] grewalsatinder#9653
@jl777c pushed update for them: https://github.com/jl777/libnspv/pull/71

{Embed}
https://github.com/jl777/libnspv/pull/71
update refresh button URL params added, txidinfo vin table txid li...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[13-Aug-19 06:41 AM] jl777c#5810
thanks!


[13-Aug-19 06:42 AM] grewalsatinder#9653
üôÇ üëç


[13-Aug-19 06:57 AM] dukeleto#7326
@smkhound could you run that Hush nspv script again?


[13-Aug-19 06:58 AM] dukeleto#7326
@smkhound i will try again soon myself, but now the main Hush seed node should be running the latest nSPV code


[13-Aug-19 06:59 AM] smkhound#7640
can try, need a sync'd node IP that is ready tho. I've begun syncing on one of my servers


[13-Aug-19 07:06 AM] Sir Seven#7158
Currently web version and API work fine.
No error pages yet.

@smkhound @dukeleto  if you can provide me with good node IP, i can add HUSH to automated tests for libnspv.


[13-Aug-19 07:06 AM] dukeleto#7326
@smkhound i am restarting the hush seed node with very latest FSM code right now


[13-Aug-19 07:07 AM] dukeleto#7326
and we are now on the very latest FSM code as of 3 minutes ago


[13-Aug-19 07:07 AM] dukeleto#7326
188.165.212.101 has nSPV services enabled

{Reactions}
üî• 

[13-Aug-19 07:08 AM] jl777c#5810
PR working coins file to libnspv

{Reactions}
üëçüèΩ 

[13-Aug-19 07:14 AM] dukeleto#7326
@Sir Seven thanks! If you join Hush discord, it makes it easy to tip you via the tip bot üòÉ


[13-Aug-19 07:14 AM] smkhound#7640
looks to be working :)

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610838596231888896/unknown.png


[13-Aug-19 07:14 AM] dukeleto#7326
whoa!


[13-Aug-19 07:15 AM] dukeleto#7326
Impressed by the GUI already


[13-Aug-19 07:15 AM] smkhound#7640
except the `$MEMP_ROW_ARRAY` bit ü§∑üèΩ


[13-Aug-19 07:15 AM] dukeleto#7326
saw that üòÉ


[13-Aug-19 07:15 AM] dukeleto#7326
Just a tiny spot of dried blood on the bleeding edge, it's gonna happen


[13-Aug-19 07:16 AM] jl777c#5810
just use master branch to avoid blood


[13-Aug-19 07:17 AM] jl777c#5810
just got the html a few hours ago havent had a chance to enable the mempool queries


[13-Aug-19 07:17 AM] jl777c#5810
totally optional (but useful) feature


[13-Aug-19 07:19 AM] allbits#5898
Trying to run in chromebook with Linux enabled. When I do ./autogen.sh it says autoreconf not found


[13-Aug-19 07:20 AM] jl777c#5810
can you install autoreconf


[13-Aug-19 07:20 AM] smkhound#7640
PR for coins file submitted in jl777 branch


[13-Aug-19 07:22 AM] jl777c#5810
merged and am already running nspv HUSH!

{Reactions}
üî• (2) Hush ‚ô• 

[13-Aug-19 07:22 AM] dukeleto#7326
woooo


[13-Aug-19 07:22 AM] jl777c#5810
the dev cycle is so fast with such little code size


[13-Aug-19 07:22 AM] jl777c#5810
only libevent and libsodium are external libs, the rest is all source code in the libnspv repo


[13-Aug-19 07:22 AM] dukeleto#7326
@allbits which kind of linux on chromebook? crouton?


[13-Aug-19 07:23 AM] jl777c#5810
include the html server, rpc handler and json processing


[13-Aug-19 07:23 AM] jl777c#5810
install automake


[13-Aug-19 07:23 AM] dukeleto#7326
@allbits you need to install all the dev libs via apt-get


[13-Aug-19 07:23 AM] jl777c#5810
google whenever there is a missing package, 99% of time it tells you what package you need


[13-Aug-19 07:23 AM] dukeleto#7326
which are listed in README


[13-Aug-19 07:23 AM] dukeleto#7326
copy+paste the apt-get line from README.md works too üòÉ


[13-Aug-19 07:25 AM] dukeleto#7326
pretty cool that a superlite wallet can talk to the mempool


[13-Aug-19 07:25 AM] dukeleto#7326
I don't remember Electrum having any features like that, when I used it


[13-Aug-19 07:26 AM] jl777c#5810
nspv has a lot more capability than electrum. skipcount alone enables it to handle addresses with very large number of utxo, though no client takes advantage of that yet


[13-Aug-19 07:27 AM] jl777c#5810
you can search mempool for whether a specific utxo was spent in it, or if a specific address has received funds


[13-Aug-19 07:28 AM] jl777c#5810
oh, it also has an html wallet (and api) built in and runs locally, sort of big features


[13-Aug-19 07:29 AM] jl777c#5810
if you look at the superlite gui, you will see that txid are hyperlinked and it displays all vins/vouts, with the vin txid hyperlinked


[13-Aug-19 07:30 AM] jl777c#5810
so while it isnt a full block explorer, you can track down all the relevant details of your tx


[13-Aug-19 07:30 AM] jl777c#5810
and it does it in reasonable performance. though if there is only one nSPV fullnode, that will be a bottleneck as there is a rate limiter of 1 nspv message per second per peer, for each message type


[13-Aug-19 07:31 AM] jl777c#5810
as you add more nodes with latest FSM branch, then make sure they connect to the seed node so they automatically propagate to the superlites


[13-Aug-19 07:31 AM] jl777c#5810
or add more seed nodes if they are not cross connected with the main seed. though always good to have a handful of seed nodes


[13-Aug-19 07:32 AM] dukeleto#7326
@jl777c what is so exciting about this, is that a superlite client can do blockchain analysis and not have to trust a 3rd party explorer


[13-Aug-19 07:32 AM] jl777c#5810
i tried to make the GUI as fast as possible, while still keeping the internals single threaded


[13-Aug-19 07:32 AM] dukeleto#7326
just one aspect, but that excites me. We all trust explorers way too much


[13-Aug-19 07:32 AM] jl777c#5810
exactly


[13-Aug-19 07:33 AM] jl777c#5810
it is possible that your peer is not up to date, but the Peers page will show the status of each, so if a specific request doesnt complete or has missing data, just refresh the page


[13-Aug-19 07:33 AM] jl777c#5810
it seems to be working the same in unix and osx, but havent heard if it works with windows yet


[13-Aug-19 07:37 AM] allbits#5898
Yeah I might have to abandon this experiment lol. Overwhelms the noob.


[13-Aug-19 07:40 AM] smkhound#7640
but you're so close!


[13-Aug-19 07:42 AM] dukeleto#7326
@allbits i have experience with chromebook stuff and can help you. And yes, you do seem very close


[13-Aug-19 07:42 AM] dukeleto#7326
it's coldest and darkest just before sunrise


[13-Aug-19 07:43 AM] dukeleto#7326
i also have a few chromebooks to test with, somewhere. I use crouton


[13-Aug-19 07:43 AM] allbits#5898
Ok. I installed autconf. But then on '/autogen.sh it returned LIBTOOL is undefined


[13-Aug-19 07:43 AM] dukeleto#7326
let me give you a command to paste


[13-Aug-19 07:43 AM] allbits#5898
LIBTOOL sounds like a hollowman sweaty nightmare


[13-Aug-19 07:43 AM] dukeleto#7326
`sudo apt-get install build-essential pkg-config libc6-dev m4 g++-multilib autoconf libtool ncurses-dev unzip git python python-zmq zlib1g-dev wget libcurl4-gnutls-dev bsdmainutils automake curl libboost-dev`


[13-Aug-19 07:43 AM] dukeleto#7326
do that


[13-Aug-19 07:44 AM] allbits#5898
Ok


[13-Aug-19 07:44 AM] dukeleto#7326
libtool is low-level shit that you probably never want to know about üòÖ


[13-Aug-19 07:45 AM] dukeleto#7326
@allbits fyi, that command is in the KMD README.md


[13-Aug-19 07:45 AM] allbits#5898
Unable to locate g++-multilib


[13-Aug-19 07:48 AM] dukeleto#7326
@allbits paste the entire massive error somewhere, like pastebin or gist.github.com


[13-Aug-19 07:48 AM] dukeleto#7326
actualy, no


[13-Aug-19 07:49 AM] jl777c#5810
g++ isnt needed


[13-Aug-19 07:49 AM] dukeleto#7326
`sudo apt-get install build-essential pkg-config libc6-dev m4 autoconf libtool ncurses-dev unzip git python python-zmq zlib1g-dev wget libcurl4-gnutls-dev bsdmainutils automake curl libboost-dev`


[13-Aug-19 07:49 AM] jl777c#5810
if gcc is in the system that is enough


[13-Aug-19 07:49 AM] dukeleto#7326
@allbits try that


[13-Aug-19 07:55 AM] allbits#5898
That appears to be working


[13-Aug-19 07:56 AM] dukeleto#7326
groovy


[13-Aug-19 07:56 AM] dukeleto#7326
@allbits now see if build.sh works, that is a different ball of wax üòÉ


[13-Aug-19 07:57 AM] allbits#5898
./autogen.sh appeared to succeed


[13-Aug-19 07:58 AM] allbits#5898
,/configure returned error libevent headers missing


[13-Aug-19 08:01 AM] jl777c#5810
install libevent and libsodium


[13-Aug-19 08:01 AM] gcharang#6833
sudo apt-get install libsodium-dev curl libevent-dev git cmake nano wget ntp ntpdate automake unzip autoconf libtool -y


[13-Aug-19 08:01 AM] jl777c#5810
i think it is libsodium-dev


[13-Aug-19 08:01 AM] dukeleto#7326
yes


[13-Aug-19 08:01 AM] dukeleto#7326
the list of dependencies is out of date


[13-Aug-19 08:01 AM] dukeleto#7326
`sudo apt-get install libsodium-dev` @allbits


[13-Aug-19 08:01 AM] jl777c#5810
we probably need to update the readme with the appropriate magic apt-get


[13-Aug-19 08:02 AM] dukeleto#7326
@jl777c it depends on version of Ubuntu as well, so it gets complex


[13-Aug-19 08:02 AM] jl777c#5810
google helps


[13-Aug-19 08:02 AM] dukeleto#7326
Ubuntu 16 package names != Ubuntu 18 package names


[13-Aug-19 08:02 AM] jl777c#5810
i always just google the missing error package


[13-Aug-19 08:02 AM] dukeleto#7326
yes, package names are annoying like that


[13-Aug-19 08:02 AM] dukeleto#7326
@allbits probably also `sudo apt-get install libevent-dev`


[13-Aug-19 08:03 AM] dukeleto#7326
i often install `aptitude`, then you can do `aptitude search foo`


[13-Aug-19 08:03 AM] dukeleto#7326
and avoid google @jl777c


[13-Aug-19 08:06 AM] dukeleto#7326
@jl777c https://github.com/jl777/komodo/pull/1685

{Embed}
https://github.com/jl777/komodo/pull/1685
update dependency installation instructions by leto ¬∑ Pull Reques...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[13-Aug-19 08:08 AM] dukeleto#7326
@allbits it's probably going to compile for a long time. If it's still going, that is a good sign


[13-Aug-19 08:08 AM] dukeleto#7326
@allbits does your chromebook have 2GB of ram or 4GB? The compile will probably fail with only 2gb


[13-Aug-19 08:08 AM] dukeleto#7326
but there are ways to get around that


[13-Aug-19 08:09 AM] allbits#5898
Compile successful. ./nspv KMD working in terminal, discovering peers etc


[13-Aug-19 08:09 AM] jl777c#5810
!!


[13-Aug-19 08:09 AM] dukeleto#7326
wat


[13-Aug-19 08:09 AM] jl777c#5810
browser display works?


[13-Aug-19 08:09 AM] allbits#5898
But I'm not connecting in browser. Probably doing something very nooby


[13-Aug-19 08:10 AM] gcharang#6833
@dukeleto https://github.com/jl777/libnspv

{Embed}
https://github.com/jl777/libnspv
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[13-Aug-19 08:10 AM] allbits#5898
127.0.0.1:7771


[13-Aug-19 08:10 AM] dukeleto#7326
@gcharang should i have added deps to that instead?


[13-Aug-19 08:10 AM] dukeleto#7326
I wasn't sure


[13-Aug-19 08:10 AM] jl777c#5810
at the beginning in the console it should say NSPV_rpcloop 127.0.0.1:7771 bind sock...


[13-Aug-19 08:11 AM] dukeleto#7326
y'all are famous: https://twitter.com/dukeleto/status/1161291662397779970

{Embed}
Duke Leto (@dukeleto)
https://twitter.com/dukeleto/status/1161291662397779970
We now have a $KMD Antara Superlite wallet for $HUSH !
This means that extremely low-resource devices like a watch or embedded computer and just about anything, can act as a wallet, with full protection of #DPoW.
Pure HTML GUI that talks to other full nodes, no Javascript!...
https://images-ext-2.discordapp.net/external/Idur1HTz6VYFsDdRymgMliIgf0ghXLYknaAS2XM4mkw/https/pbs.twimg.com/media/EB28m5iWwAA65vt.jpg%3Alarge
Twitter


[13-Aug-19 08:11 AM] jl777c#5810
updating libnspv apt-get in libnspv repo makes sense, if komodo line was out of date, then that too


[13-Aug-19 08:11 AM] gcharang#6833
yes, that is the standalone version

komodod also has all the functionality

I have the deps for libnspv here: https://docs.komodoplatform.com/nSPV/#installation
tested on ubuntu 16.04

{Embed}
https://docs.komodoplatform.com/nSPV/
Komodo Documentation
Documentation for developers building on the Komodo Platform
https://images-ext-2.discordapp.net/external/pQcpVLQgfWglPr7tkLLPNfnaXLp21V6nGaMQYJYPkho/https/docs.komodoplatform.com/Dev_Docs_Introduction_small.png


[13-Aug-19 08:11 AM] jl777c#5810
@grewalsatinder is there a way to tell the .html to refuse to run javascript?


[13-Aug-19 08:12 AM] allbits#5898
Yes it does say that in the console


[13-Aug-19 08:12 AM] jl777c#5810
http://127.0.0.1:7771


[13-Aug-19 08:12 AM] jl777c#5810
try that exact url


[13-Aug-19 08:12 AM] jl777c#5810
not https


[13-Aug-19 08:12 AM] dukeleto#7326
@jl777c interesting question. There is a way to detect if JS is off via HTML


[13-Aug-19 08:12 AM] allbits#5898
I did. "This site can't be reached"


[13-Aug-19 08:13 AM] jl777c#5810
you have the bind sock.n API enabled message?


[13-Aug-19 08:13 AM] dukeleto#7326
if it's not off, it's on. Maybe you could hook into an "autodestruct if JS is on" @jl777c , but it's called <noscript></noscript> Not sure how to detect the inverse


[13-Aug-19 08:13 AM] allbits#5898
Yes


[13-Aug-19 08:13 AM] dukeleto#7326
@jl777c we could play JS games, and if we see they work, we assume JS is on and do seppuku


[13-Aug-19 08:13 AM] jl777c#5810
maybe the browser is configured to not be able to go to 127.0.0.1


[13-Aug-19 08:14 AM] dukeleto#7326
like, use JS to modify the DOM. And then see if it is actually modified


[13-Aug-19 08:14 AM] dukeleto#7326
if modified => JS is on. You can do evil things with CSS


[13-Aug-19 08:14 AM] dukeleto#7326
CSS is turing complete


[13-Aug-19 08:14 AM] allbits#5898
Googling


[13-Aug-19 08:14 AM] dukeleto#7326
@jl777c i think i know @allbits problem


[13-Aug-19 08:14 AM] jl777c#5810
the page is autogenerated so when i add an SHA256 checksum to all the template files, it really cant be changed


[13-Aug-19 08:14 AM] dukeleto#7326
@allbits you must tell me, how is linux installed on your CB?


[13-Aug-19 08:15 AM] dukeleto#7326
127.0.0.1 don't mean what you think it does


[13-Aug-19 08:15 AM] dukeleto#7326
Chromebooks have VLANs


[13-Aug-19 08:15 AM] jl777c#5810
but would be nice to have a JS disabled method in the template


[13-Aug-19 08:15 AM] jl777c#5810
oh, so its 192.... type of address?


[13-Aug-19 08:15 AM] dukeleto#7326
it might be completely isolated


[13-Aug-19 08:15 AM] dukeleto#7326
chromebooks use recent linux kernel jails for IO/everything


[13-Aug-19 08:16 AM] jl777c#5810
try http://localhost:7771


[13-Aug-19 08:16 AM] dukeleto#7326
it's a config setting somewhere


[13-Aug-19 08:16 AM] dukeleto#7326
to allow packets between VMs and the main Chromebook OS


[13-Aug-19 08:18 AM] allbits#5898
I'm not even sure how I installed linux. I went to open the terminal app a couple of days and it just asked me if I wanted to install Linux so I said yes


[13-Aug-19 08:18 AM] jl777c#5810
what does http://localhost:7771/ do?


[13-Aug-19 08:18 AM] allbits#5898
Same thing


[13-Aug-19 08:19 AM] jl777c#5810
in the browser settings (advanced) is there anything about disabling localhost or preventing browsing to internal sites


[13-Aug-19 08:20 AM] jl777c#5810
chromebook does seem to have some strangenesses about localhost


[13-Aug-19 08:22 AM] gcharang#6833
@allbits 
try
```
hostname -I
```
if it says
```
100.115.92.196
```
visit
100.115.92.196:7771


[13-Aug-19 08:22 AM] jl777c#5810
nspv blocks anything that isnt 127.0.0.1


[13-Aug-19 08:23 AM] gcharang#6833
ahh, that won't work then


[13-Aug-19 08:23 AM] allbits#5898
Yeah I tried that after googling


[13-Aug-19 08:24 AM] jl777c#5810
i can add a -allowip= option so when you launch nspv it would allow that specific ip address

{Reactions}
üëç 

[13-Aug-19 08:24 AM] allbits#5898
Mine is 100.115.92.205


[13-Aug-19 08:29 AM] jl777c#5810
in jl777 branch, git pull and make


[13-Aug-19 08:29 AM] jl777c#5810
then


[13-Aug-19 08:30 AM] jl777c#5810
./nspv -x=100.115.92.205


[13-Aug-19 08:32 AM] allbits#5898
Do I need to say KMD also


[13-Aug-19 08:34 AM] allbits#5898
No success


[13-Aug-19 08:35 AM] allbits#5898
Console does return

set external ip to 100.115.92.205


[13-Aug-19 08:35 AM] allbits#5898
It also returns 127.0.0.1:7771 bind sock enabled


[13-Aug-19 08:39 AM] jl777c#5810
oh, i need to change that!


[13-Aug-19 08:39 AM] jl777c#5810
fixing


[13-Aug-19 08:41 AM] dukeleto#7326
so much progress, in here. it's lovely


[13-Aug-19 08:42 AM] jl777c#5810
its actually binding 0.0.0.0:7771 so if that works, it wouldnt matter the external ip


[13-Aug-19 08:42 AM] jl777c#5810
but lets test binding a specific ip address


[13-Aug-19 08:43 AM] jl777c#5810
oh, does curl work to 127.0.0.1:7771 ?


[13-Aug-19 08:45 AM] allbits#5898
How do I test that


[13-Aug-19 08:46 AM] allbits#5898
I did curl 127.0.0.1:7771


[13-Aug-19 08:46 AM] allbits#5898
Yes it worked


[13-Aug-19 08:46 AM] allbits#5898
Returned the html stuff in console


[13-Aug-19 08:47 AM] jl777c#5810
ok, try the latest version


[13-Aug-19 08:47 AM] jl777c#5810
git pull


[13-Aug-19 08:47 AM] jl777c#5810
make


[13-Aug-19 08:49 AM] dukeleto#7326
@jl777c chromebooks support ipv6 as well, just a thought. Not sure if your code checks ipv6 loopback. It might not need to deal with those complexities


[13-Aug-19 08:54 AM] jl777c#5810
i wrote the rpc and html handling directly via tcp calls to the low level port. not sure if it handles ipv6 or not


[13-Aug-19 08:54 AM] jl777c#5810
it is really just for single threaded localhost so i doubt it


[13-Aug-19 08:56 AM] allbits#5898
Not connecting in browser. Console returns expected messages


[13-Aug-19 08:57 AM] jl777c#5810
does doing curl to the 100.115.92.205:7771 address work also?


[13-Aug-19 09:01 AM] allbits#5898
Yes


[13-Aug-19 09:10 AM] jl777c#5810
ok, so the -x option is working!


[13-Aug-19 09:11 AM] jl777c#5810
as to why the browser isnt, that seems some sort of system config issue


[13-Aug-19 09:11 AM] jl777c#5810
maybe running as sudo will allow to access localhost?


[13-Aug-19 09:20 AM] allbits#5898
Nope. I'll keep googling around about that


[13-Aug-19 09:28 AM] Regnar#6164
Spotted this which reminded me of nspv in a way.
`To speed things up, the researchers give each new certificate verification information based on a block a few hundred or 1,000 blocks behind it ‚Äî called a ‚Äúbreadcrumb.‚Äù When a new user joins, they match the breadcrumb of an early block to a breadcrumb 1,000 blocks ahead. That breadcrumb can be matched to another breadcrumb 1,000 blocks ahead, and so on.`

<http://news.mit.edu/2019/vault-faster-more-efficient-cryptocurrency-0124>


[13-Aug-19 09:32 AM] dukeleto#7326
@allbits are you using crouton or some kind of ChromeOS VM?


[13-Aug-19 09:33 AM] dukeleto#7326
https://superuser.com/questions/646304/google-chrome-cant-access-localhost-domains#649631

{Embed}
https://superuser.com/questions/646304/google-chrome-cant-access-localhost-domains
Google Chrome can't access localhost domains
This is my first time trying Chrome and I can't access localhost, 127.0.0.1 or any other local domain I have setup from within Chrome 29.0.1547.66. They all work fine in Firefox and Internet Explor...
https://images-ext-2.discordapp.net/external/N4dCvbCaCBWT_sESkNTH2lx3-EhkV9eCrYJflXNw2Ds/%3Fv%3De869e4459439/https/cdn.sstatic.net/Sites/superuser/img/apple-touch-icon%402.png


[13-Aug-19 09:34 AM] dukeleto#7326
chrome://flags/#allow-insecure-localhost


[13-Aug-19 09:34 AM] dukeleto#7326
@allbits try to click that link, or paste into chrome


[13-Aug-19 09:36 AM] dukeleto#7326
i remember dealing with this when using chromebooks. You have to do something special to allow ssh'ing from the container and the main OS


[13-Aug-19 09:37 AM] allbits#5898
I enabled that flag. Still no success


[13-Aug-19 09:37 AM] allbits#5898
Using crouton


[13-Aug-19 09:56 AM] dukeleto#7326
@allbits you might need to restart browser after changing that


[13-Aug-19 09:59 AM] dukeleto#7326
@allbits try all the things here: https://stackoverflow.com/questions/33524826/localhost-not-working-in-chrome-127-0-0-1-does-work

{Embed}
https://stackoverflow.com/questions/33524826/localhost-not-working-in-chrome-127-0-0-1-does-work
Localhost not working in Chrome, 127.0.0.1 does work
I'm trying to run a local node server, but for whatever reason localhost:3000 does not work.  The error page states This webpage is not available ERR_CONNECTION_CLOSED  However, 127.0.0.1:3000 does...
https://images-ext-1.discordapp.net/external/dP07hBXxuorGcvXU609uJ_e6ZgPlIdBxqG8OjQQiAyY/%3Fv%3D73d79a89bded/https/cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon%402.png


[13-Aug-19 09:59 AM] dukeleto#7326
Goog may have disabled workarounds


[13-Aug-19 09:59 AM] dukeleto#7326
This is a security "feature"


[13-Aug-19 10:12 AM] jl777c#5810
@Sir Seven the latest jl777 might support the update button for showing mempool tx, you need to send and get something in mempool first. amount will show as 0, but txid should appear properly and maybe you can click it and see if it returns valid data


[13-Aug-19 10:12 AM] jl777c#5810
also fixed the 38 vin crash


[13-Aug-19 10:12 AM] jl777c#5810
at least i found a buffer that was too small


[13-Aug-19 10:14 AM] Sir Seven#7158
Sounds good. Will check it a bit later.


[13-Aug-19 10:22 AM] allbits#5898
Not making headway here :/ Gonna have to throw in the towel for a bit


[13-Aug-19 10:27 AM] Deleted User#0000
Wrong attititude üòÑ


[13-Aug-19 10:27 AM] jorian#4555
he has the `temp_dev` role


[13-Aug-19 10:27 AM] Deleted User#0000
so never give up


[13-Aug-19 10:32 AM] allbits#5898
Five kids. Single dad. Operating business. Rock 'n roll singer. I don't give up ;)


[13-Aug-19 10:33 AM] allbits#5898
Reading kmd discord and dabbling in cli stuff is my relax time hehe


[13-Aug-19 10:34 AM] allbits#5898
Fyi tried installing brave browser on chromebook but got same result

{Reactions}
3040_kingpeepo (2) 

[13-Aug-19 10:38 AM] allbits#5898
Also did lynx in terminal and it worked


[13-Aug-19 10:42 AM] jl777c#5810
worked, as in it displayed the pages?


[13-Aug-19 10:42 AM] allbits#5898
Yes


[13-Aug-19 10:44 AM] jl777c#5810
oh, so the problem is just with the chrome


[13-Aug-19 10:44 AM] jl777c#5810
did it work without the -x=ipaddr parameter?


[13-Aug-19 10:45 AM] jl777c#5810
i guess it could be a workaround for chromebooks


[13-Aug-19 10:45 AM] jl777c#5810
i wonder if anybody can build for android


[13-Aug-19 10:45 AM] jl777c#5810
or windows


[13-Aug-19 10:47 AM] allbits#5898
Yes it works without -x=ipaddr parameter in lynx


[13-Aug-19 10:47 AM] allbits#5898
Lynx is cli only tho


[13-Aug-19 10:47 AM] allbits#5898
Doesn't work with brave


[13-Aug-19 10:50 AM] dukeleto#7326
These are recent Same-Origin-Policy security "features" that Lynx predates


[13-Aug-19 10:51 AM] dukeleto#7326
Superlite wallet with w3m sounds elite: https://en.wikipedia.org/wiki/W3m

{Embed}
https://en.wikipedia.org/wiki/W3m
W3m
w3m is a free software/open source text-based web browser and terminal pager. It has support for tables, frames, SSL connections, color and inline images on suitable terminals. Generally, it renders pages in a form as true to their original layout as possible.
The name "w3m" ...
https://images-ext-1.discordapp.net/external/X1JvSMBUaGgDJNm6YR_PtemjwDppY8VaQkXwlssATXA/https/upload.wikimedia.org/wikipedia/commons/6/62/W3m-wikipedia.png


[13-Aug-19 10:51 AM] allbits#5898
Doesn't work on Opera


[13-Aug-19 10:51 AM] dukeleto#7326
@allbits try w3m üòÉ


[13-Aug-19 10:51 AM] dukeleto#7326
it's Lynx++


[13-Aug-19 10:52 AM] dukeleto#7326
@allbits mad respect for single dad with 5 kids. I can barely manage 1 with a wife to help


[13-Aug-19 10:57 AM] allbits#5898
Haha. I have four nannies/housekeepers lol

{Reactions}
üòÇ (2) 

[13-Aug-19 11:58 AM] dukeleto#7326
https://twitter.com/dukeleto/status/1161350291717087237

{Embed}
Duke Leto (@dukeleto)
https://twitter.com/dukeleto/status/1161350291717087237
@radix42 new contest: What is the smallest device with tiniest CPU/RAM resources that can run a $KMD #superlite wallet? https://t.co/yCv20Zz8UD
https://images-ext-1.discordapp.net/external/XpTRgh0S417o2W0RsK9zu1UP1ZZ0BQ2Ya_Rf9hBy7HA/https/pbs.twimg.com/tweet_video_thumb/EB3x7nwXYAAlyN4.jpg
Twitter


[13-Aug-19 12:01 PM] jl777c#5810
the html and coins files bloated the HDD footprint to 1.5MB


[13-Aug-19 12:02 PM] jl777c#5810
i think RAM footprint is still around 3MB (mega not giga), but it needs to be measured again


[13-Aug-19 12:02 PM] jl777c#5810
works in 32bit CPU


[13-Aug-19 12:02 PM] jl777c#5810
maybe even 16 bit microcontrollers if it has a decent c compiler


[13-Aug-19 12:11 PM] dukeleto#7326
@jl777c i think i just found the first potential external collaboration for superlite/nSPV


[13-Aug-19 12:12 PM] dukeleto#7326
I am working on integrating Hush into OpenBazaar, and they are not so excited to run ZEC full nodes nor HUSH full nodes


[13-Aug-19 12:12 PM] dukeleto#7326
and then I thought, "shit, they can use superlite wallets in their own API"


[13-Aug-19 12:12 PM] dukeleto#7326
I am in a private slack room working with their devs


[13-Aug-19 12:20 PM] jl777c#5810
yes, you can just use curl to issue rpc requests


[13-Aug-19 12:20 PM] jl777c#5810
the html is just invoking the same internal functions


[13-Aug-19 12:21 PM] jl777c#5810
but ZEC probably wont work as they dont have all the downstream changes we made that is needed to support nSPV


[13-Aug-19 12:47 PM] CMaurice#1685
getting lots of: ```nServices.5 disconnect from node 11: /MagicBean:2.0.15-rc2/ (1485781)
Disconnect node 11```


[13-Aug-19 12:48 PM] jl777c#5810
yes, only fullnodes running dev branch (or below) support nSPV


[13-Aug-19 12:48 PM] jl777c#5810
other peers will be disconnected from


[13-Aug-19 12:48 PM] CMaurice#1685
yep, seems to be working fine


[13-Aug-19 12:49 PM] jorian#4555
maybe i'm node 11? i'm not running a full node but have a nspv lite wallet open


[13-Aug-19 12:51 PM] jl777c#5810
superlites dont register as a relaying node, so the fullnodes shouldnt bother with them


[13-Aug-19 12:52 PM] jl777c#5810
it seems many are trying out the nspv, but not many complaints of bugs. is it just working?


[13-Aug-19 12:52 PM] jl777c#5810
we still need to verify it works on windows and android


[13-Aug-19 01:08 PM] allbits#5898
I'm on android - termux but having problems with dependencies


[13-Aug-19 01:09 PM] allbits#5898
"unable to locate package" for many of them


[13-Aug-19 01:12 PM] allbits#5898
I'm also trying to figure out why I'm getting "unable to locate package" for libevent-dev in popos but wasn't getting that result in ubuntu


[13-Aug-19 01:21 PM] CMaurice#1685
the required packages don't seem to be in unstable-packages either, you'd need to compile or cross-compile them I think


[13-Aug-19 01:25 PM] CMaurice#1685
appears they have libsodium for libsodium-dev (https://github.com/termux/termux-packages/blob/master/packages/libsodium/build.sh) dunno about others


[13-Aug-19 01:26 PM] CMaurice#1685
so I started nspv with -x=IPofMachine, but was unable to connect to it from another machine on the local network, other servers working fine


[13-Aug-19 01:27 PM] jl777c#5810
curl doesnt work?


[13-Aug-19 01:27 PM] jl777c#5810
i never actually verified remote works, probably should


[13-Aug-19 01:34 PM] CMaurice#1685
curl: (56) Recv failure: Connection reset by peer


[13-Aug-19 01:46 PM] jl777c#5810
ok, i will look into this later this week


[13-Aug-19 01:47 PM] jl777c#5810
you are setting -x=<ip of other machine>


[13-Aug-19 01:47 PM] CMaurice#1685
nope, IPofThisMachine


[13-Aug-19 01:47 PM] jl777c#5810
the one you are doing the curl from


[13-Aug-19 01:48 PM] jl777c#5810
no, -x needs to be the ip address of the external machine


[13-Aug-19 01:48 PM] jl777c#5810
so only a single external node is allowed access


[13-Aug-19 01:48 PM] jl777c#5810
can you see if that works


[13-Aug-19 01:48 PM] CMaurice#1685
I see, checking


[13-Aug-19 01:49 PM] jl777c#5810
there is no point to allow random nodes to connect, as the other nodes can just run an nspv themselves


[13-Aug-19 01:49 PM] jl777c#5810
so just special situations like for docker or chromebook


[13-Aug-19 01:49 PM] jl777c#5810
where you end up not having a working 127.0.0.1


[13-Aug-19 01:51 PM] CMaurice#1685
ok, nspv errors out with external ip anyway


[13-Aug-19 01:59 PM] jl777c#5810
ok, will need to investigate


[13-Aug-19 02:23 PM] allbits#5898
Possible html error?: I decided to run nspv on a system where komodod already running. So I used the -p option, selecting port 5000.  In the browser, the first page came up fine. Then when logging in I come to a blank page - this seems to be because the link takes me to 127.0.01:7771 instead of 127.0.0.1:5000


[13-Aug-19 02:24 PM] jl777c#5810
yes, this seems a bug


[13-Aug-19 02:24 PM] jl777c#5810
will fix tomorrow


[13-Aug-19 03:06 PM] CMaurice#1685 (pinned)
to build on termux:

pkg upgrade && pkg install build-essential git wget libsodium libevent

there may be other packages required as I have used termux to build before

git clone https://github.com/jl777/libnspv/
cd libnspv

I did execute:

find . -name 'config.sub' -exec chmod u+w '{}' \; -exec cp -f "${PREFIX}/share/libtool/build-aux/config.sub" '{}' \;
find . -name 'config.guess' -exec chmod u+w '{}' \; -exec cp -f "${PREFIX}/share/libtool/build-aux/config.guess" '{}' \;

(from https://wiki.termux.com/wiki/Building_packages). Probably necessary, anyway...
it's the same: 

./autogen.sh
./configure
make

wait a bit then ./nspv

then just visit 127.0.0.1:7771


[13-Aug-19 03:06 PM] CMaurice#1685
amazing, so cool


[13-Aug-19 03:06 PM] CMaurice#1685
SOFA KING COOL


[13-Aug-19 03:10 PM] CMaurice#1685
so, calmed down now, logged in with wif key


[13-Aug-19 03:14 PM] allbits#5898
Thanks. On the first command I get

This installation run will require temporarily removing the essential package libandroid-support:aarch64 due to a Conflicts/Pre-Depends loop. This is often bad, but if you really want to do it, activate the APT::Force-LoopBreak option.
E: Internal Error, Could not early remove libandroid-support:aarch64 (2)


[13-Aug-19 03:15 PM] allbits#5898
I can't even install coreutils without getting the same result


[13-Aug-19 03:17 PM] CMaurice#1685
hm, allbits#5898 there is an issue here: https://github.com/termux/termux-packages/issues/4129

{Embed}
https://github.com/termux/termux-packages/issues/4129
Internal Error, Could not early remove libandroid-support:aarch64 ...
for pkg, and apt. apt-get differs; apt-get upgrade Reading package lists... Done Building dependency tree Reading state information... Done Calculating upgrade... Done The following packages have b...
https://images-ext-2.discordapp.net/external/PCGHCfA5vh9GcWEytCGQAZVnKU5LSSo5aME8T88YPqM/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/8104776


[13-Aug-19 03:18 PM] CMaurice#1685
I did upgrade my termux sys a few weeks ago, there was some procedure I forget now, something to do with a new rootfs I think. Is yours an older install?


[13-Aug-19 03:19 PM] CMaurice#1685
I've successfully built on Nexus 6P and Pixel 2 XL


[13-Aug-19 03:20 PM] allbits#5898
I uninstalled and reinstalled


[13-Aug-19 03:20 PM] allbits#5898
Let's see ...


[13-Aug-19 03:21 PM] grewalsatinder#9653
Rooted android?


[13-Aug-19 03:21 PM] CMaurice#1685
nope, stock


[13-Aug-19 03:21 PM] grewalsatinder#9653
Perfect


[13-Aug-19 03:33 PM] grewalsatinder#9653
Thanks for steps @CMaurice üòÄ


[13-Aug-19 03:33 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610964153779224583/Screenshot_20190814-103112_Termux.jpg


[13-Aug-19 03:33 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610964171835834398/Screenshot_20190814-103222_DuckDuckGo.jpg


[13-Aug-19 03:33 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/610964180002013190/Screenshot_20190814-103246_DuckDuckGo.jpg


[13-Aug-19 03:35 PM] grewalsatinder#9653
@@jl777c @dukeleto nspv running on Samsung Galaxy S9, sock Android OS, no Rooted OS!
CC @ca333 @Mylo

{Reactions}
üíØ (4) shexy (5) üëç 

[13-Aug-19 03:35 PM] grewalsatinder#9653
@SHossain


[13-Aug-19 03:36 PM] grewalsatinder#9653
HTML is not as cool on mobile screen, but it can be improved I think


[13-Aug-19 03:37 PM] CMaurice#1685
yepyep, might even be worth ui just for mobile


[13-Aug-19 03:37 PM] SHossain#0007
This is great. Can't wait to test this on my phone when I'm back home.


[13-Aug-19 03:38 PM] SHossain#0007
Great job!


[13-Aug-19 03:38 PM] grewalsatinder#9653
@jl777c @dukeleto I couldn't find a way to block running JS on HTML page. Maybe that SHA256 sum pages serving is solution, or theere can be a C code which strips the <script> </script> tags which are only for Js


[13-Aug-19 03:40 PM] grewalsatinder#9653
Pinned a message.


[13-Aug-19 03:42 PM] allbits#5898
Success on Android here too!!!! Thanks @CMaurice


[13-Aug-19 03:43 PM] CMaurice#1685
great, pleasure


[13-Aug-19 03:46 PM] allbits#5898
Send and receive working fine!


[13-Aug-19 05:49 PM] grewalsatinder#9653
I will fix  the css snd UI for mobile screen. Wait for that update. üòé


[13-Aug-19 07:49 PM] dukeleto#7326
@jl777c `Content-Security-Policy: default-src 'self'; connect-src 'none'; object-src 'none'; frame-src 'none'; child-src 'none' ` is what I have cooked up, which tells all modern browsers to disable all JS, iframes, plugin objects and background worker processes


[13-Aug-19 07:49 PM] dukeleto#7326
whatever prints out the HTML interface needs to put that as an HTTP header


[13-Aug-19 07:50 PM] dukeleto#7326
and that should greatly increase the security of the HTML UI, from browser-based attacks from the OS or browser being infected with malware that injects code into pages/etc


[13-Aug-19 07:51 PM] dukeleto#7326
@jl777c the security is opt-in, the newer the browser, the more secure. Crazy old browsers don't know about CSP or enforce it, but that is not who we care about anyway


[13-Aug-19 07:53 PM] dukeleto#7326
@grewalsatinder https://www.w3.org/TR/CSP2/ is a good read üòÉ

{Reactions}
üëç 

[13-Aug-19 08:20 PM] grewalsatinder#9653
Awesome! Will read it. Thanks!


[13-Aug-19 08:22 PM] dukeleto#7326
I just read it to cook up that CSP above, i learned some new stuff


[13-Aug-19 08:41 PM] allbits#5898
@dukeleto my HUSH super lite works great


[14-Aug-19 12:04 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/73

{Embed}
https://github.com/jl777/libnspv/pull/73
HTML/CSS display fix for mobile screens by satindergrewal ¬∑ Pull ...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 12:59 AM] jl777c#5810
merged. also added the content security. now rewards is displayed for non-KMD


[14-Aug-19 01:00 AM] jl777c#5810
also the txid list now has the headers on each line. is that intentional?


[14-Aug-19 01:01 AM] jl777c#5810
it seems libnspv is running on most everything so far, just the chromebook browser issue and windows is unconfirmed


[14-Aug-19 01:04 AM] grewalsatinder#9653
let me check


[14-Aug-19 01:09 AM] grewalsatinder#9653
rewards are hiding to show if I use ILN


[14-Aug-19 01:10 AM] grewalsatinder#9653
tx history is now showing the heading for the value, as I removed the table columns and just using single row and using <div> tags to manage the resizing of the screen.


[14-Aug-19 01:12 AM] jl777c#5810
ok, so this is needed for mobile. i guess it is ok


[14-Aug-19 01:12 AM] grewalsatinder#9653
yes


[14-Aug-19 01:12 AM] jl777c#5810
for ILN i see the rewards


[14-Aug-19 01:12 AM] jl777c#5810
how does it look on mobile now?


[14-Aug-19 01:13 AM] jl777c#5810
can you test the new content security header?


[14-Aug-19 01:13 AM] jl777c#5810
you can modify the template to add JS, but it should not allow it


[14-Aug-19 01:16 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611110908760162332/Screenshot_20190814-201441_DuckDuckGo.jpg
https://cdn.discordapp.com/attachments/594906735467036682/611110909364011008/Screenshot_20190814-201535_DuckDuckGo.jpg
https://cdn.discordapp.com/attachments/594906735467036682/611110909909139476/Screenshot_20190814-201620_DuckDuckGo.jpg
https://cdn.discordapp.com/attachments/594906735467036682/611110909909139477/Screenshot_20190814-201605_DuckDuckGo.jpg


[14-Aug-19 01:16 AM] grewalsatinder#9653
login, wallet, info, txidinfo renders good


[14-Aug-19 01:17 AM] grewalsatinder#9653
I think I need to fix the logo size


[14-Aug-19 01:17 AM] grewalsatinder#9653
and I see what you were saying about the menu buttons


[14-Aug-19 01:17 AM] grewalsatinder#9653
for some reason those are not taking CSS style on mobile browser, using DuckDuckGo browser on Android.


[14-Aug-19 01:17 AM] grewalsatinder#9653
but on Desktop FireFox, works perfectly fine.


[14-Aug-19 01:17 AM] grewalsatinder#9653
checking other desktop browsers


[14-Aug-19 01:19 AM] grewalsatinder#9653
wow! I see same issue using Safari and Google Chrome for menu buttons


[14-Aug-19 01:19 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611111716943560708/Screen_Shot_2019-08-14_at_8.18.51_PM.png


[14-Aug-19 01:19 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611111718864683018/Screen_Shot_2019-08-14_at_8.19.09_PM.png


[14-Aug-19 01:19 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611111721641181209/Screen_Shot_2019-08-14_at_8.19.36_PM.png


[14-Aug-19 01:19 AM] grewalsatinder#9653
firefox doesn't show issue


[14-Aug-19 01:20 AM] grewalsatinder#9653
has to check why


[14-Aug-19 01:33 AM] jl777c#5810
@CMaurice can you make a PR to the readme in libnspv so we can have the instructions on how to build for android


[14-Aug-19 01:34 AM] jl777c#5810
dev branch is a good one to PR to


[14-Aug-19 01:35 AM] grewalsatinder#9653
@jl777c 
top menu buttons css style fix


[14-Aug-19 01:35 AM] grewalsatinder#9653
https://github.com/jl777/libnspv/pull/75

{Embed}
https://github.com/jl777/libnspv/pull/75
top menu buttons css style fix by satindergrewal ¬∑ Pull Request #...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 01:36 AM] jl777c#5810
finally! i get the cool buttons too


[14-Aug-19 01:36 AM] grewalsatinder#9653
pushing the instructions for android too


[14-Aug-19 01:36 AM] grewalsatinder#9653
yay! üòÉ üéâ


[14-Aug-19 01:36 AM] jl777c#5810
address form is too narrow again


[14-Aug-19 01:36 AM] jl777c#5810
i see Rewards for ILN


[14-Aug-19 01:37 AM] jl777c#5810
for txinfo, we might want to put the vin/vout above the hex outputs, which really dont help most users


[14-Aug-19 01:37 AM] jl777c#5810
antara logo is too big


[14-Aug-19 01:40 AM] grewalsatinder#9653
yes, coz address form is no more statically set to width


[14-Aug-19 01:40 AM] grewalsatinder#9653
if I do that the resizing messes up the rendering


[14-Aug-19 01:40 AM] grewalsatinder#9653
might get back to it later trying to fix


[14-Aug-19 01:40 AM] grewalsatinder#9653
or may be someone else can help that if possible


[14-Aug-19 01:41 AM] grewalsatinder#9653
pushing fix for txinfo and logo


[14-Aug-19 01:41 AM] ca333#0333
awesome - we will certainly get a mobile wallet up for libnspv - maybe even add a "nSPV mode" to the atomicDEX wallet.


[14-Aug-19 01:44 AM] ca333#0333
@moneystacks @Audo @Daniel CP plz check infos posted above, arrange a blogpost or so and share through SM. This is basically a successful PoC for mobile (actually platform independent) nSPV and a huge step. Mobile Dapps, wallets - even mobile games can easily integrate Komodo and other Smart Chains with libnspv.

{Reactions}
üëç 

[14-Aug-19 01:44 AM] jl777c#5810
it appears to work on all the systems we tried it on. just windows and chromebook browser config, windows just seems to be nobody tried a build yet


[14-Aug-19 01:45 AM] jl777c#5810
@grewalsatinder i added a total received and total sent (network bytes) fields to the getinfo response. Can you add that to the getinfo page. this way we can see how much bandwidth is being used


[14-Aug-19 01:48 AM] Sir Seven#7158
@jl777c  Actually tried api and curl on WIndows - works well.
Hasn't check browser UI yet.


[14-Aug-19 01:48 AM] CMaurice#1685
yep, will do. Also want to look into running under tor on Android. Should I expect any problems, exit nodes are just IPs, right?


[14-Aug-19 01:49 AM] jl777c#5810
i didnt add any special tor support, but didnt disable it, so it is up to tor to be compatible


[14-Aug-19 01:49 AM] jl777c#5810
@Sir Seven good that it functions on windows, but the html is what might have the issues more than the low level code


[14-Aug-19 01:49 AM] jl777c#5810
@grewalsatinder did you verify the anti-JS header works?


[14-Aug-19 01:51 AM] jl777c#5810
not being able to see the entire address in the send field is not good... needs to be fixed


[14-Aug-19 01:53 AM] jl777c#5810
@Deleted User can you reduce the bandwidth being used for headers? maybe once all nodes go into sync, it can reduce the frequency to when there is a new block detected? outbound bandwidth after several minutes is 1044 bytes, inbound is 240kb and it is just sitting idle


[14-Aug-19 01:55 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611120709053186049/Screen_Shot_2019-08-14_at_8.55.00_PM.png


[14-Aug-19 01:55 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611120710236110881/Screen_Shot_2019-08-14_at_8.55.20_PM.png


[14-Aug-19 01:55 AM] grewalsatinder#9653
for me ILN is not showing any HTML tags regarding Rwards.


[14-Aug-19 01:55 AM] grewalsatinder#9653
moved TX-vin/vout on top


[14-Aug-19 01:55 AM] grewalsatinder#9653
is that okay?


[14-Aug-19 01:56 AM] jl777c#5810
yes, it is more useful this way


[14-Aug-19 01:58 AM] jl777c#5810
@Deleted User even without any new blocks coming in, inbound data went up to 320kb now. so i think that is one optimization, but likely it is possible to reduce bandwidth usage even more?


[14-Aug-19 01:59 AM] jl777c#5810
@Sir Seven were you able to verify the mempool (Unconfirmed Transactions) display via the update button


[14-Aug-19 02:01 AM] smkhound#7640
this should fix the button background issue in safari/chrome.
```
a.btn {
    background-color: #1e2938 !important;
}
a.btn:hover {
    background-color: #158 !important;
}```
Give me a few minutes, I should be able to sort out each one individually and PR


[14-Aug-19 02:01 AM] jl777c#5810
the buttons work now


[14-Aug-19 02:03 AM] smkhound#7640
ah ok, beat me to it!


[14-Aug-19 02:03 AM] jl777c#5810
width of address field in the send coins form needs to be widened in a mobile compatible way


[14-Aug-19 02:06 AM] grewalsatinder#9653
working on address input field


[14-Aug-19 02:06 AM] jl777c#5810
@Sir Seven please also confirm the skipcount works, along with the fix for the 38vin crash


[14-Aug-19 02:06 AM] Daniel CP#2020
Hey guys, we actually already posted an article about nSPV

https://komodoplatform.com/nspv-next-generation-spv/

{Embed}
Daniel
https://komodoplatform.com/nspv-next-generation-spv/
nSPV: Komodo's Next Generation Simply Payment Verification (SPV) Tech
The Komodo Dev Team has created nSPV, a superlight client that's 1000 times faster than existing simple payment verificaiton (SPV) methods. Learn more here.
https://images-ext-1.discordapp.net/external/1VnmcNKavmVFCOpP9TNDqvbN1Z1fsffve2lMMi062VE/https/komodoplatform.com/wp-content/uploads/2019/08/nSPV-banner-image-jpg.jpg


[14-Aug-19 02:07 AM] Daniel CP#2020
If there's any info that's missing from here, we can go back and add it in or create a second post


[14-Aug-19 02:07 AM] jl777c#5810
second post should be about the GUI that is 100% html, without any javascript

{Reactions}
üíØ (2) 

[14-Aug-19 02:08 AM] jl777c#5810
it is the typical easy to use html GUI, but it has only static html that is generated internally from within the nspv C code


[14-Aug-19 02:08 AM] jl777c#5810
it uses localhost, which makes this nearly as secure as using cli and unlike all the other html wallets, there is no extra layer of code, certainly no node.js


[14-Aug-19 02:09 AM] jl777c#5810
only 2 external libraries, libevent and libsodium, the rest is all in source code in libnspv


[14-Aug-19 02:09 AM] moneystacks#7758
we can make an SM series out of it, so if something is missing or you would like to add just tell me


[14-Aug-19 02:10 AM] jl777c#5810
so far it is working on all OS we have tested it on, even 32 bit raspberry pi


[14-Aug-19 02:10 AM] jl777c#5810
HDD space of about 2MB, RAM usage of about 4MB


[14-Aug-19 02:11 AM] jl777c#5810
network bandwidth usage is relatively low, but we can reduce it further


[14-Aug-19 02:12 AM] Sir Seven#7158
@jl777c skipcount works, i believe the issue is closed.
38vin transaction generation do not crash libnspv for me atm.
Yet I got random crashes on broadcast. Either webUI or api. Trying to see what's up with it atm.


[14-Aug-19 02:13 AM] jl777c#5810
@grewalsatinder <span class="col-lg-3 col-sm-4 col-xs-12" style="display: none;"><b>Rewards:</b><br> 0.00000000 ILN</span>


[14-Aug-19 02:13 AM] jl777c#5810
it shows display: none, but still the Rewards is being displayed. this started with the mobile PR


[14-Aug-19 02:13 AM] grewalsatinder#9653
it will go out in the HTML tags, but won't display.


[14-Aug-19 02:13 AM] grewalsatinder#9653
display: none; means hidden.


[14-Aug-19 02:13 AM] jl777c#5810
yet, i can see it


[14-Aug-19 02:13 AM] grewalsatinder#9653
display: ; means unhidden


[14-Aug-19 02:14 AM] jl777c#5810
does anybody else see the Rewards: 0.000000 ILN, displayed for non-KMD coins?


[14-Aug-19 02:14 AM] Sir Seven#7158
Oh. Forgot to close the issue for skipcount.


[14-Aug-19 02:15 AM] jl777c#5810
with latest, even the amount might show up, just for the last mempool tx though


[14-Aug-19 02:18 AM] jl777c#5810
@Sir Seven if broadcast is crashing, likely it relates to the size of the hex


[14-Aug-19 02:20 AM] jl777c#5810
@moneystacks i think the initial nSPV post is very good about the low level workings, but the second post should be about the accessibility and ease of onboarding new users is. this centers on its ability to run on a wide variety of platforms and having the html GUI that isnt sacrificing security


[14-Aug-19 02:21 AM] jl777c#5810
using the browser, does open it up to clipboard replacing malware and keyloggers at the browser level, so it isnt quite as secure as cli, but other than that, the security exposure is essentially the same as cli as it is the cli program that is generating the html


[14-Aug-19 02:22 AM] jl777c#5810
and nSPV in general is almost at the same security level as a fullnode, there is the reliance on other nodes to tell it what utxo you have. this can be mitigated by tracking locally the utxo the address has, but the initial version of superlite wallet uses no HDD storage at all. nothing is on HDD, all in RAM


[14-Aug-19 02:23 AM] smkhound#7640
`http://127.0.0.1:7771/method/login?wif=WIF_GOES_HERE` is also potentially exposed in browser history if not cleared.


[14-Aug-19 02:23 AM] jl777c#5810
yes, @grewalsatinder can we change that to a POST?


[14-Aug-19 02:24 AM] jl777c#5810
we need to remove this browser history exposure


[14-Aug-19 02:24 AM] smkhound#7640

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611128035382657024/unknown.png


[14-Aug-19 02:24 AM] grewalsatinder#9653
sure


[14-Aug-19 02:24 AM] Sir Seven#7158
Yep. 30+ inputs generate a huge hex to broadcast.
And  it goes down with buffer overflow on broadcast.
https://paste.ubuntu.com/p/89fVX2gbnf/


[14-Aug-19 02:26 AM] jl777c#5810
this is via curl?


[14-Aug-19 02:26 AM] grewalsatinder#9653
@jl777c I see that I had not did git pull, is seeing those rewards now


[14-Aug-19 02:26 AM] grewalsatinder#9653
pushing all those fixies


[14-Aug-19 02:27 AM] jl777c#5810
if not, plz see if curl crashes with big broadcast


[14-Aug-19 02:28 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611128889074384906/Screen_Shot_2019-08-14_at_9.27.42_PM.png


[14-Aug-19 02:28 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611128900046815238/Screen_Shot_2019-08-14_at_9.27.51_PM.png


[14-Aug-19 02:28 AM] grewalsatinder#9653
@jl777c yes, I added jQuery <script> to code, which is not running in console


[14-Aug-19 02:29 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611129237708996608/Screen_Shot_2019-08-14_at_9.29.07_PM.png


[14-Aug-19 02:29 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611129239546363904/Screen_Shot_2019-08-14_at_9.29.11_PM.png


[14-Aug-19 02:29 AM] grewalsatinder#9653
adding custom <script> tag also not loading


[14-Aug-19 02:29 AM] grewalsatinder#9653
üòÉ


[14-Aug-19 02:30 AM] Deleted User#0000
@jl777c  yes. I had tried it before. When it gets the headers to only fetch one. It fell out of sync. Didnt spend much time on it though


[14-Aug-19 02:31 AM] jl777c#5810
it is currently a bandwidth hog, relatively speaking


[14-Aug-19 02:31 AM] jl777c#5810
hopefully you can reduce its usage 10x


[14-Aug-19 02:31 AM] Deleted User#0000
Yes it is wasteful


[14-Aug-19 02:31 AM] jl777c#5810
@Sir Seven pushed fix for broadcast crash


[14-Aug-19 02:31 AM] Deleted User#0000
I can have a go at it tomorrow.


[14-Aug-19 02:32 AM] jl777c#5810
ok. one simple way is to just start the process if the Peers page is loaded. and then stop once we get the peers in sync


[14-Aug-19 02:32 AM] jl777c#5810
in most cases, even if a peer is out of sync, it isnt a giant disaster. i guess might need to prune nodes during the spend call


[14-Aug-19 02:33 AM] Deleted User#0000
I think if we have the latest header, and it linkc back, there is no reason to need this header from all nodes really


[14-Aug-19 02:34 AM] jl777c#5810
exactly


[14-Aug-19 02:34 AM] jl777c#5810
it is just doing numpeers more work than needed, and always doing it, even when no new blocks are coming in


[14-Aug-19 02:35 AM] grewalsatinder#9653
@jl777c I moved the HTML variable `$REWARDS_DISPLAY_KMD` to custom.css file


[14-Aug-19 02:35 AM] grewalsatinder#9653
it's not taking it's value update there


[14-Aug-19 02:35 AM] grewalsatinder#9653
can you please fix that?


[14-Aug-19 02:35 AM] Deleted User#0000
like I said I did try to slow it down before, SO I know where to start


[14-Aug-19 02:35 AM] jl777c#5810
ok. there is now the totalsent/totalrecv fields in getinfo so you can see how much bandwidth it is eating

{Reactions}
üëç 

[14-Aug-19 02:36 AM] jl777c#5810
@Sir Seven update again, pushed another fix


[14-Aug-19 02:36 AM] jl777c#5810
@grewalsatinder what do i have to do to fix it?


[14-Aug-19 02:36 AM] grewalsatinder#9653
no worries, I think I can find a work around. just a sec.


[14-Aug-19 02:40 AM] grewalsatinder#9653
@jl777c work around didn't work. inline css style comes under the security policy applied for some reason.


[14-Aug-19 02:40 AM] grewalsatinder#9653
I defined the `$REWARDS_DISPLAY_KMD` in custom.css file


[14-Aug-19 02:40 AM] Sir Seven#7158
Oh. Just rechecked with api - it crashes.
https://paste.ubuntu.com/p/rz3BKd3Rgd/
Not yet updated.


[14-Aug-19 02:40 AM] grewalsatinder#9653
right now if key word `$REWARDS_DISPLAY_KMD` is in HTML it is replaced with none.


[14-Aug-19 02:40 AM] grewalsatinder#9653
but if it's in custom.css it it's not.


[14-Aug-19 02:41 AM] jl777c#5810
but for me, it did replace it properly, it still had no effect


[14-Aug-19 02:41 AM] jl777c#5810
i posted you the html it generated


[14-Aug-19 02:41 AM] jl777c#5810
<span class="col-lg-3 col-sm-4 col-xs-12" style="display: none;"><b>Rewards:</b><br> 0.00000000 ILN</span>


[14-Aug-19 02:41 AM] grewalsatinder#9653
yep, that's because some latest security policy


[14-Aug-19 02:41 AM] grewalsatinder#9653
It's inline style within tag


[14-Aug-19 02:41 AM] jl777c#5810
so it is replacing it


[14-Aug-19 02:41 AM] grewalsatinder#9653
I'm moving it to a custom.css class


[14-Aug-19 02:42 AM] grewalsatinder#9653
so html will only refer to now that css class in custom.css file


[14-Aug-19 02:42 AM] grewalsatinder#9653
like this
```<span class="col-lg-3 col-sm-4 col-xs-12 rewards"><b>Rewards:</b><br> $REWARDS $COIN</span>```


[14-Aug-19 02:42 AM] grewalsatinder#9653
rewards css class


[14-Aug-19 02:42 AM] jl777c#5810
this is lower priority than changing the login to a POST


[14-Aug-19 02:42 AM] grewalsatinder#9653
okay


[14-Aug-19 02:44 AM] Sir Seven#7158
Rebuilt nspv with latest jl777 branch.
Still crashes on huge hex broadcast.


[14-Aug-19 02:45 AM] jl777c#5810
how big is the hex?


[14-Aug-19 02:45 AM] Sir Seven#7158
Sent it in PM.


[14-Aug-19 02:45 AM] jl777c#5810
ok, i will try to duplicate


[14-Aug-19 02:46 AM] jl777c#5810
its not that big...


[14-Aug-19 02:47 AM] jl777c#5810
it worked for me


[14-Aug-19 02:48 AM] Sir Seven#7158
Hm.


[14-Aug-19 02:48 AM] jl777c#5810
make sure you have latest jl777 branch and get me the backtrace


[14-Aug-19 02:48 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/83

{Embed}
https://github.com/jl777/libnspv/pull/83
txdiinfo vin/vout, logo size, login post, send_form fixes by satin...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 02:54 AM] Sir Seven#7158
On commit `1a72c903e73f4e63c27e3c825722edbbc15bf460`
https://paste.ubuntu.com/p/dnX4CgStQp/

Crashes.


[14-Aug-19 02:55 AM] jl777c#5810
with curl?


[14-Aug-19 02:56 AM] Sir Seven#7158
With api/mehtod/broadcast/hex from browser.


[14-Aug-19 02:56 AM] jl777c#5810
plz try with curl


[14-Aug-19 02:56 AM] jl777c#5810
this separates the problem from the low level vs html processing


[14-Aug-19 02:57 AM] jl777c#5810
i think there is a limit to the size of GET data on url


[14-Aug-19 02:58 AM] jl777c#5810
you can just broadcast the same hex


[14-Aug-19 03:05 AM] grewalsatinder#9653
@jl777c there were many problems due to new security policy. I checked on the website https://content-security-policy.com/

{Embed}
https://content-security-policy.com/
Content Security Policy CSP Reference & Examples
Content Security Policy Reference Guide and Examples


[14-Aug-19 03:06 AM] grewalsatinder#9653
and added .css files and `script-src 'unsafe-inline'` to file


[14-Aug-19 03:06 AM] grewalsatinder#9653
those inline css issues and pages rendering css is fixed now


[14-Aug-19 03:06 AM] grewalsatinder#9653
pushing update


[14-Aug-19 03:06 AM] grewalsatinder#9653
js is restricted


[14-Aug-19 03:06 AM] grewalsatinder#9653
checked and verifed by trying to load jquery


[14-Aug-19 03:06 AM] grewalsatinder#9653
doesnt load


[14-Aug-19 03:06 AM] jl777c#5810
can you change the data that is POST for login to {"wif":"<wif str>"}


[14-Aug-19 03:07 AM] jl777c#5810
right now it is wif=U....


[14-Aug-19 03:07 AM] grewalsatinder#9653
already done in latest update


[14-Aug-19 03:07 AM] grewalsatinder#9653
oh..


[14-Aug-19 03:07 AM] grewalsatinder#9653
just a sec


[14-Aug-19 03:07 AM] jl777c#5810
aha! so the POST data comes in as JSON?


[14-Aug-19 03:07 AM] grewalsatinder#9653
I guess not... jus a sec, let me check that


[14-Aug-19 03:08 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/84

{Embed}
https://github.com/jl777/libnspv/pull/84
content policy to allow custom.css and bootstrap.css and inline cs...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 03:08 AM] jl777c#5810
if it is hard to do, i can tweak it internally


[14-Aug-19 03:08 AM] grewalsatinder#9653
gonna check on login post json now


[14-Aug-19 03:09 AM] grewalsatinder#9653
I guess it's sending data as body form data ü§î


[14-Aug-19 03:09 AM] grewalsatinder#9653
need to verify


[14-Aug-19 03:09 AM] jl777c#5810
yes, in the form of wif=<data>


[14-Aug-19 03:09 AM] jl777c#5810
which is not bad.


[14-Aug-19 03:10 AM] grewalsatinder#9653
okay, if you can manage that, that'd be good üòÉ


[14-Aug-19 03:10 AM] jl777c#5810
just that my POST data handler assumes it was valid JSON. I can always manually parse and construct a JSON if it isnt easy to fix


[14-Aug-19 03:10 AM] jl777c#5810
will do


[14-Aug-19 03:10 AM] grewalsatinder#9653
thanks üôÇ


[14-Aug-19 03:10 AM] grewalsatinder#9653
but still hold for a min


[14-Aug-19 03:10 AM] grewalsatinder#9653
let me give that a try to send json


[14-Aug-19 03:10 AM] jl777c#5810
the Rewards are gone. but does this allow other things to also be possible now?


[14-Aug-19 03:11 AM] grewalsatinder#9653
I verified by defining jQuery <script> in head of HTML which the page refused to load


[14-Aug-19 03:11 AM] grewalsatinder#9653
content policy working for the javascript


[14-Aug-19 03:11 AM] jl777c#5810
ok and inline css is just formatting stuff?


[14-Aug-19 03:11 AM] grewalsatinder#9653
for css it is allowing the inline css


[14-Aug-19 03:11 AM] grewalsatinder#9653
and the css defined in content policy


[14-Aug-19 03:12 AM] grewalsatinder#9653
yep, just displaying and styling the html DOM objects


[14-Aug-19 03:12 AM] jl777c#5810
style-src 'self' custom.css bootstrap.min.css 'unsafe-inline'; @dukeleto do you see any exposure with adding this to the header?


[14-Aug-19 03:13 AM] grewalsatinder#9653
@dukeleto may be can verify that content policy change. To my reading and understanding adding style-src should not be issue:
```Content-Security-Policy: default-src 'self'; style-src 'self' custom.css bootstrap.min.css 'unsafe-inline';```


[14-Aug-19 03:16 AM] grewalsatinder#9653
I also see this in FireFox console:
```Content Security Policy: Directive ‚Äòchild-src‚Äô has been deprecated. Please use directive ‚Äòworker-src‚Äô to control workers, or directive ‚Äòframe-src‚Äô to control frames respectively.
‚Äã```


[14-Aug-19 03:16 AM] grewalsatinder#9653
@jl777c also removing bootstrap.min.css.map


[14-Aug-19 03:16 AM] grewalsatinder#9653
it's only needed for devtools


[14-Aug-19 03:17 AM] grewalsatinder#9653
the console waring in chrome might say `DevTools failed to parse SourceMap: http://127.0.0.1:12986/method/bootstrap.min.css.map`


[14-Aug-19 03:17 AM] grewalsatinder#9653
which can be ignored


[14-Aug-19 03:23 AM] jl777c#5810
nice!


[14-Aug-19 03:23 AM] jl777c#5810
got the login via POST working

{Reactions}
üî• (2) 

[14-Aug-19 03:29 AM] grewalsatinder#9653
yes! works as expected! üòÉ


[14-Aug-19 03:30 AM] Sir Seven#7158
Ok. There are 2 problems on Win:
1. Requires libwinpthread-1 to run.  There are no one on fresh Win installation. Can be googled and downloaded tho.
2. Do not respond to curls or browser calls, same error:
`{"error": "cant find methodfile"}`
or for opening http://127.0.0.1:7771/
`{"error": "cant find index"}`

In case: not only .exe file is in nspv directory. All pages and files from github are included.


[14-Aug-19 03:34 AM] TonyL#3577
`Requires libwinpthread-1.dll to run. ` it's mingw thingy - tried to link it statically but not found easy solution


[14-Aug-19 03:34 AM] grewalsatinder#9653
@jl777c added two HTML global vars:
```// $NETBYTEIN - Network Bytes Recieved
    // $NETBYTEOUT - Network Bytes Sent```


[14-Aug-19 03:34 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611145648028516352/Screen_Shot_2019-08-14_at_10.34.27_PM.png


[14-Aug-19 03:34 AM] grewalsatinder#9653
is that Okay ?


[14-Aug-19 03:35 AM] TonyL#3577
` All pages and files from github are included.` @Sir Seven in `html` folder? pages should be in `nspvexecfolder/html`


[14-Aug-19 03:38 AM] Sir Seven#7158
Sec.


[14-Aug-19 03:43 AM] grewalsatinder#9653
https://github.com/jl777/libnspv/pull/85

{Embed}
https://github.com/jl777/libnspv/pull/85
removed bootstrap css map. only needed for devtools by satindergre...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 03:44 AM] grewalsatinder#9653
also includes: Network Bytes info stub HTML added in getinfo


[14-Aug-19 03:47 AM] Sir Seven#7158
@TonyL Yeah, my bad. Started nspv.exe from old catalog (backup one), heh.
Actually works fine.
`1. Requires libwinpthread-1 to run.  There are no one on fresh Win installation. Can be googled and downloaded tho.`
Only problem it seems.


[14-Aug-19 03:47 AM] jl777c#5810
so win browser works?


[14-Aug-19 03:47 AM] Sir Seven#7158
Yep.


[14-Aug-19 03:48 AM] jl777c#5810
great! so the only system incompatibility is with chrome on a chromebook


[14-Aug-19 03:48 AM] Sir Seven#7158
Even in IE.


[14-Aug-19 03:49 AM] Sir Seven#7158
For mempool:
When you press `Update` on Unconfirmed transactions field - transactions from mempool will not be displayed.
You need to press `Update` and `Refresh` right after.


[14-Aug-19 03:50 AM] Sir Seven#7158
In thiss way unconfirmed transactions from/to your address will be displayed on Transaction History.


[14-Aug-19 03:50 AM] jl777c#5810
does it show amount?


[14-Aug-19 03:50 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611149651734822923/Screenshot_20190814-225017_DuckDuckGo.jpg


[14-Aug-19 03:50 AM] Sir Seven#7158
Yes.


[14-Aug-19 03:50 AM] jl777c#5810
could it be a timing issue?


[14-Aug-19 03:51 AM] grewalsatinder#9653
mobile view works as expected


[14-Aug-19 03:51 AM] jl777c#5810
try doing update, waiting a bit, then doing update again


[14-Aug-19 03:51 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611149792495665153/unknown.png


[14-Aug-19 03:51 AM] jl777c#5810
it ended up in the Transactions history? that is for confirmed, seems it is off by 1 in the confirmations calc


[14-Aug-19 03:52 AM] jl777c#5810
pushed fix for confirmation count off by one, also now displays the network bytes in and out

{Reactions}
üòÉ üëç 

[14-Aug-19 03:53 AM] jl777c#5810
i think for mempool testing, it needs a chain that will take more than a few seconds to mine a block


[14-Aug-19 03:57 AM] Sir Seven#7158
Trying mempool on ILN.


[14-Aug-19 03:57 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611151419248082954/unknown.png


[14-Aug-19 03:57 AM] Sir Seven#7158
Nothing.


[14-Aug-19 03:57 AM] Sir Seven#7158
Network is displayed on info page.


[14-Aug-19 03:58 AM] jl777c#5810
ok, i will duplicate and debug mempool


[14-Aug-19 03:59 AM] Sir Seven#7158
Hm. Let me recheck it KMD also, with latest changes.


[14-Aug-19 04:02 AM] grewalsatinder#9653
ReadMe also includes build instructions for Mac, Linux, Android.


[14-Aug-19 04:03 AM] grewalsatinder#9653
Please verify and let me know if some issue, or if something missing.


[14-Aug-19 04:03 AM] grewalsatinder#9653
https://github.com/jl777/libnspv/tree/jl777#how-to-build

{Embed}
https://github.com/jl777/libnspv/tree/jl777
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 04:04 AM] grewalsatinder#9653
Need Windows instructions, or just push the update to ReadMe if someone solves windows issues


[14-Aug-19 04:48 AM] CMaurice#1685
made pr to dev branch with fuller Termux on Android instructions, if we can get new users to try for feedback on shorter and longer instructions would be good


[14-Aug-19 04:49 AM] CMaurice#1685
going to research making a .deb package so 350mb build tools not required


[14-Aug-19 04:51 AM] grewalsatinder#9653
@CMaurice https://github.com/jl777/libnspv/tree/jl777#how-to-build

{Embed}
https://github.com/jl777/libnspv/tree/jl777
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 04:51 AM] grewalsatinder#9653
üòÑ


[14-Aug-19 04:51 AM] grewalsatinder#9653
it's already there in jl777 branch


[14-Aug-19 04:52 AM] grewalsatinder#9653
may be just fix those there not to have conflicting instructions


[14-Aug-19 04:53 AM] jl777c#5810
merged


[14-Aug-19 04:53 AM] CMaurice#1685
yep, it may be we'll find there are difficulties with both sets of instructions tho


[14-Aug-19 04:54 AM] grewalsatinder#9653
yep


[14-Aug-19 05:20 AM] jl777c#5810
@grewalsatinder added support for normal seed phrases, so if the login wif is not a wif, it will use it as a agama compatible seed


[14-Aug-19 05:21 AM] grewalsatinder#9653
yep, been reading your commits as you been doing them üòÅ


[14-Aug-19 05:21 AM] jl777c#5810
maybe the login screen needs to change a bit


[14-Aug-19 05:26 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611173846510469120/Screen_Shot_2019-08-15_at_12.26.25_AM.png


[14-Aug-19 05:26 AM] grewalsatinder#9653
@jl777c wording changed


[14-Aug-19 05:27 AM] jl777c#5810
ok


[14-Aug-19 05:31 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/88

{Embed}
https://github.com/jl777/libnspv/pull/88
wallet seed wording change by satindergrewal ¬∑ Pull Request #88 ...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 05:50 AM] Audo#5667
Hey @grewalsatinder & @ca333 & anyone else involved.

We made a briefing template that helps us to get the full picture of this story and also documents the information for later use, so it doesn't get lost.

https://docs.google.com/document/d/1X77Vh5ASOShuWTvbMxygs3EAjixTmWaab4fmYrIDt9E/edit?usp=sharing

We willl add this task to Monday.com

EDIT: if we can make this briefing template better let me know

{Embed}
https://docs.google.com/document/d/1X77Vh5ASOShuWTvbMxygs3EAjixTmWaab4fmYrIDt9E/edit?usp=sharing
nSPV Briefing
Background Previously published content: https://komodoplatform.com/nspv-next-generation-spv/ A second post would be about a GUI that is 100% html, without any javascript. Subject What is the subject of this briefing? Please provide a short overview. Please answer here.    Ur...
https://images-ext-1.discordapp.net/external/XRyA2eufOVIGMMcJLc3gl3cuU8GCpmDB8EOy7rxXN58/https/lh4.googleusercontent.com/xkum7I8LTBZPnCnZRHKAoGoVk_z7p1oJkDH6Rt2DmOVBoYNXpOXp2XDI1pGwOtW28Vna8A%3Dw1200-h630-p


[14-Aug-19 05:54 AM] jl777c#5810
@grewalsatinder the txid in the mempool list is not hyperlinked


[14-Aug-19 06:04 AM] grewalsatinder#9653
@jl777c does it need vout/vin in that link?


[14-Aug-19 06:04 AM] grewalsatinder#9653
what should it be?


[14-Aug-19 06:04 AM] jl777c#5810
same as for normal tx, just hyperlink to txidinfo page


[14-Aug-19 06:04 AM] jl777c#5810
the txid is not clickable for mempool


[14-Aug-19 06:04 AM] jl777c#5810
it is for normal tx


[14-Aug-19 06:05 AM] grewalsatinder#9653
okay


[14-Aug-19 06:07 AM] grewalsatinder#9653
https://github.com/jl777/libnspv/pull/89

{Embed}
https://github.com/jl777/libnspv/pull/89
mempool txid linked by satindergrewal ¬∑ Pull Request #89 ¬∑ jl777...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 06:07 AM] grewalsatinder#9653
done


[14-Aug-19 06:27 AM] jl777c#5810
works


[14-Aug-19 06:46 AM] dukeleto#7326
@jl777c fyi my CSP uses some "deprecated" fields with some browsers will warn about, but that is the only thing old browsers know, which is why I included. Allowing bootstrap should be fine


[14-Aug-19 06:47 AM] dukeleto#7326
frame-src is deprecated


[14-Aug-19 06:47 AM] dukeleto#7326
but old browsers only know that, not child-src


[14-Aug-19 06:47 AM] dukeleto#7326
just to explain why you might see some warnings in some browser console logs


[14-Aug-19 06:48 AM] dukeleto#7326
I have learned, as a web dev, that the spec is not the real world


[14-Aug-19 06:48 AM] dukeleto#7326
So including "deprecated" stuff often improves security of older stuff, that only knows that deprecated thing


[14-Aug-19 06:51 AM] jl777c#5810
is the header from https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_rpc.h##L1097 ok?

{Embed}
https://github.com/jl777/libnspv/blob/jl777/src/tools/nSPV_rpc.h
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 06:56 AM] jl777c#5810
the mempool rows are too wide to fit in a screen.
Dest.Address -> Destination
the Type field can be a lot narrower


[14-Aug-19 06:57 AM] grewalsatinder#9653
what is the output in Type field?


[14-Aug-19 06:58 AM] jl777c#5810
just the IN badge


[14-Aug-19 06:59 AM] grewalsatinder#9653
okay


[14-Aug-19 07:13 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611200670103765013/Screen_Shot_2019-08-15_at_2.12.58_AM.png


[14-Aug-19 07:13 AM] grewalsatinder#9653
testing with stub values


[14-Aug-19 07:13 AM] grewalsatinder#9653
@jl777c does it look better?


[14-Aug-19 07:13 AM] jl777c#5810
yes


[14-Aug-19 07:13 AM] grewalsatinder#9653
okay


[14-Aug-19 07:16 AM] grewalsatinder#9653
https://github.com/jl777/libnspv/pull/90

{Embed}
https://github.com/jl777/libnspv/pull/90
mempool table fix by satindergrewal ¬∑ Pull Request #90 ¬∑ jl777/l...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 07:17 AM] jl777c#5810
works. now mempool detection works and displays properly!


[14-Aug-19 07:18 AM] jl777c#5810
the only issues i know of are: too much bandwidth used for hdr sync, chromebook browser, -x option not working, broadcast of large tx gets timeout


[14-Aug-19 07:23 AM] grewalsatinder#9653
@ns408 works!!!


[14-Aug-19 07:23 AM] grewalsatinder#9653
```Satinders-MacBook-Pro:~ satinder$ brew tap ns408/homebrew-libnspv
Updating Homebrew...
==> Auto-updated Homebrew!
Updated 2 taps (homebrew/core and homebrew/cask).
==> New Formulae
zrepl

==> Tapping ns408/libnspv
Cloning into '/usr/local/Homebrew/Library/Taps/ns408/homebrew-libnspv'...
remote: Enumerating objects: 5, done.
remote: Counting objects: 100% (5/5), done.
remote: Compressing objects: 100% (5/5), done.
remote: Total 5 (delta 0), reused 1 (delta 0), pack-reused 0
Unpacking objects: 100% (5/5), done.
Tapped 1 formula (31 files, 26.5KB).
Satinders-MacBook-Pro:~ satinder$ brew uninstall libnspv
Error: No such keg: /usr/local/Cellar/libnspv
Satinders-MacBook-Pro:~ satinder$ brew install libnspv
==> Installing libnspv from ns408/libnspv
==> Downloading https://github.com/ns408/libnspv/archive/0.1.tar.gz
==> Downloading from https://codeload.github.com/ns408/libnspv/tar.gz/0.1
######################################################################## 100.0%
==> ./autogen.sh
==> ./configure --prefix=/usr/local/Cellar/libnspv/0.1
==> make
==> make install
üç∫  /usr/local/Cellar/libnspv/0.1: 49 files, 1.7MB, built in 54 seconds
Satinders-MacBook-Pro:~ satinder$ ns
nscurl    nslookup  nspv      nsupdate
Satinders-MacBook-Pro:~ satinder$```


[14-Aug-19 07:23 AM] grewalsatinder#9653
@jl777c üòÉ


[14-Aug-19 07:26 AM] grewalsatinder#9653
```Satinders-MacBook-Pro:~ satinder$ brew uninstall libnspv
Uninstalling /usr/local/Cellar/libnspv/0.1... (49 files, 1.7MB)
Satinders-MacBook-Pro:~ satinder$ ns
nscurl    nslookup  nsupdate
Satinders-MacBook-Pro:~ satinder$```


[14-Aug-19 07:26 AM] grewalsatinder#9653
easy üòÉ


[14-Aug-19 07:27 AM] ns408#8889
beautiful. thanks for testing it @grewalsatinder 

I'm still cleaning bits up and adding some doco. All code is on github.
@jl777c would you rather have the tap sitting in one of your repos? I'm happy to send instructions to create one and I can create PR so you can merge it so that people can do this:

```
brew tap jl777/homebrew-libnspv
```

instead of the current `ns408/homebrew-libnspv`


[14-Aug-19 07:30 AM] grewalsatinder#9653
thanks @ns408 üòÉ üëç


[14-Aug-19 07:31 AM] jl777c#5810
@ns408 , yes PR please


[14-Aug-19 07:33 AM] ns408#8889
@grewalsatinder üëç 
@jl777c üëç 

**Anyone reading above post, please disregard the `brew tap ns408/homebrew-libnspv` bit since I'll be moving it to jl777's repo.**

{Reactions}
üëç 

[14-Aug-19 08:58 AM] ns408#8889
@jl777c https://github.com/jl777/libnspv/pull/94 - if you can action it now otherwise I'm happy to wait.

{Embed}
https://github.com/jl777/libnspv/pull/94
update README.md by ns408 ¬∑ Pull Request #94 ¬∑ jl777/libnspv
@jl777 could you please perform the following steps:

once you merge this PR, could you please create this tag and push it to the repo.

git tag -a 0.1
git push --tags


fork https://github.com/Mes...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[14-Aug-19 11:03 AM] dukeleto#7326
nice homebrew marketing üëç


[14-Aug-19 01:49 PM] phideas#8309
did a little test. small tx in and out. worked ok. 
when finished, i tried to empty the wallet. tx generates fine but couldn't broadcast. results in timeout.


[14-Aug-19 01:53 PM] jl777c#5810
send 0.0001 less than balance


[14-Aug-19 02:16 PM] phideas#8309
tried several times, didn't worked out. i will try to post some debug info.


[14-Aug-19 02:21 PM] jl777c#5810
if it is a test account without much funds, you can send me the wif and exact step you do to get the bug, i can then fix it


[14-Aug-19 02:37 PM] phideas#8309
no problem james, i always test with small amounts. only dust left in there. for some reason it always bugs me if i can't sweep a wallet to zero. üòÉ maybe b/c i see potential value in dust.


[14-Aug-19 02:44 PM] phideas#8309
here the generated tx screen `https://i.imgur.com/pAD132w.png`
broadcast times out.


[14-Aug-19 02:57 PM] phideas#8309
sent a little dust to the wallet. after generating tx now there are 2 tx - vin on input.
broadcasted ok. üëå wallet empty


[14-Aug-19 03:27 PM] Regnar#6164
Can't post a screenshot but I'm pretty sure I got nSPV KMD going on my raspberry pi 4. üòÑ


[14-Aug-19 03:34 PM] Regnar#6164
wasn't sure what to put for p2p though <https://docs.komodoplatform.com/nSPV/#enabling-the-nspv-client>


[14-Aug-19 08:08 PM] Regnar#6164
What exactly does `misbehave` score mean when looking at peers? and is there a point where it disconnects from them or something?


[14-Aug-19 08:25 PM] dukeleto#7326
yes


[14-Aug-19 08:26 PM] dukeleto#7326
@Regnar full nodes have a system of keeping score of which nodes should be banned, and each peer gets a "banscore", so misbehaving most likely means close to being banned


[14-Aug-19 08:26 PM] dukeleto#7326
sending invalid/wrong data will get you banned as a peer, since that is an attack vector


[14-Aug-19 08:26 PM] dukeleto#7326
and it can happen normally, i.e. during a chain re-org, where different nodes have different views of reality

{Reactions}
üëç 

[14-Aug-19 08:37 PM] Regnar#6164
Okay I thought it was normal for some peers to disagree at chain tips, I have a few peers with misbehave score of 2. What's the scale here for "not normal"?


[14-Aug-19 08:46 PM] dukeleto#7326
I don't know and would have to go read source code to find out. If it's not causing bugs, I wouldn't worry about it


[14-Aug-19 10:10 PM] smkhound#7640
@Regnar `p2p` should be set in coins file, and match what is seen from `getinfo` p2pport for the chain.


[14-Aug-19 10:27 PM] jl777c#5810
it is automatic for coins already properly configured in the coins file


[14-Aug-19 10:27 PM] jl777c#5810
you just need to know the coin symbol


[14-Aug-19 10:27 PM] jl777c#5810
no symbol defaults to KMD


[14-Aug-19 10:48 PM] Deleted User#0000
@Regnar  That was something I added, because for a while there were lots of non updated full nodes sending rubbish or incorrect heights

{Reactions}
üëç 

[14-Aug-19 10:48 PM] Deleted User#0000
It only really uses it to ban a node on old version, or if it continues to send chain tips shorter than 2 blocks behind the current tip it has.


[15-Aug-19 01:11 AM] jl777c#5810
@Sir Seven some reports of broadcast timeout, but for tx that are not big. i cant reproduce this, so if you can plz get me the raw hex that gets timeout when broadcast


[15-Aug-19 01:11 AM] Sir Seven#7158
Ok. Will try a few.


[15-Aug-19 01:19 AM] jl777c#5810
of course any other bugs are good too. it seems to be getting pretty solid, but need to add some more error checking/handling and error page


[15-Aug-19 02:56 AM] Sir Seven#7158
Found 2 hexes, 1st always ends up in `error adding to mempool`
2nd timeouts. Sent 'em in PM.


[15-Aug-19 03:06 AM] jl777c#5810
first one is trying to doublespend, so it should get an error


[15-Aug-19 03:07 AM] jl777c#5810
second one, just worked for me via html


[15-Aug-19 03:28 AM] ns408#8889 (pinned)
*To install libnspv on mac*

```
brew tap jl777/libnspv
brew install libnspv
```

To run it on port 3000
```
nspv KMD -p 3000
```

{Reactions}
üî• (3) üëç 

[15-Aug-19 03:28 AM] jl777c#5810
Pinned a message.

{Reactions}
üëç (2) 

[15-Aug-19 03:53 AM] Sir Seven#7158
Hm. So far can't get timeouts on broadcast with good nodes connected.
Noticed other thing:
Txs in mempool can be displayed with 0 amount:


[15-Aug-19 03:53 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611512691319898122/unknown.png


[15-Aug-19 03:54 AM] Sir Seven#7158
After pressing update there are like 50/50 if Amount will be shown or not.


[15-Aug-19 03:54 AM] jl777c#5810
yes, maybe i need to update the protocol version, the mempool amounts was a fullnode change


[15-Aug-19 03:54 AM] Sir Seven#7158
What is current version? 70000005?


[15-Aug-19 03:55 AM] jl777c#5810
i will update the version and update my nodes, that should fix this


[15-Aug-19 03:55 AM] jl777c#5810
7000...5 is nServices


[15-Aug-19 03:55 AM] jl777c#5810
current protocol version is 000...2


[15-Aug-19 03:57 AM] Sir Seven#7158
Also, autologout in html wallet happens with no notifications to user. I mean, at least at login we might inform user about 777s timeout.


[15-Aug-19 03:58 AM] jl777c#5810
that is a text change in html, plz ask satinder for such


[15-Aug-19 03:58 AM] Sir Seven#7158
Got it.


[15-Aug-19 04:02 AM] jl777c#5810
updated my nodes. ILN and NSPV chains are already running, KMD chains will take 10 minutes to update


[15-Aug-19 04:02 AM] jl777c#5810
should have protocol version 3 now


[15-Aug-19 04:02 AM] jl777c#5810
it shows on the getinfo page


[15-Aug-19 04:03 AM] jl777c#5810
NSPV is a good chain to test mempool as i dont think it is being actively mined


[15-Aug-19 04:04 AM] jl777c#5810
now the broadcast should be more reliable, along with mempool and i think a few other tweaks that are now active


[15-Aug-19 04:09 AM] Deleted User#0000
I will look at the headers sync tonight.


[15-Aug-19 04:11 AM] Deleted User#0000
Will start on it soon.


[15-Aug-19 04:11 AM] Deleted User#0000
Was that the only thing?


[15-Aug-19 04:19 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/99

{Embed}
https://github.com/jl777/libnspv/pull/99
login session notification added to login page by satindergrewal ...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[15-Aug-19 06:08 AM] jl777c#5810
@grewalsatinder is there a variable to display the time left before auto-logout?


[15-Aug-19 06:09 AM] grewalsatinder#9653
haven't defined it


[15-Aug-19 06:09 AM] grewalsatinder#9653
can define it


[15-Aug-19 06:09 AM] grewalsatinder#9653
where should it be showing? ü§î


[15-Aug-19 06:09 AM] jl777c#5810
maybe we can do a modal display. so on the account page if it is logged in, it shows one view. if not logged in, another view


[15-Aug-19 06:10 AM] jl777c#5810
you can make a variable to control this via "" vs "none" and another for the time left before autologout


[15-Aug-19 06:11 AM] grewalsatinder#9653
okay üëç


[15-Aug-19 06:12 AM] grewalsatinder#9653
`./nspv KMD` doesn't start


[15-Aug-19 06:13 AM] grewalsatinder#9653
```$ ./nspv KMD
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash KMD
Start NSPV_rpcloop.7771
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:7771 bind sock.3 API enabled at unixtime.1565874730 <<<<<<<<<
Discover KMD peers...end of client runloop
Satinders-MacBook-Pro:libnspv satinder$```


[15-Aug-19 06:13 AM] grewalsatinder#9653
running latest code from jl777 branch


[15-Aug-19 06:14 AM] jl777c#5810
yes, strange. investigating. other chains seems to work


[15-Aug-19 06:16 AM] jl777c#5810
forgot to start the fullnodes!


[15-Aug-19 06:16 AM] jl777c#5810
they are starting now


[15-Aug-19 06:27 AM] grewalsatinder#9653
okay


[15-Aug-19 06:27 AM] grewalsatinder#9653
doing git pull


[15-Aug-19 06:44 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611555757825064960/Screen_Shot_2019-08-16_at_1.43.50_AM.png


[15-Aug-19 06:44 AM] grewalsatinder#9653
@jl777c hiding address gen and login section.


[15-Aug-19 06:44 AM] grewalsatinder#9653
does that look okay?


[15-Aug-19 06:44 AM] grewalsatinder#9653
or need change?


[15-Aug-19 06:44 AM] jl777c#5810
seems too simple


[15-Aug-19 06:45 AM] jl777c#5810
shouldnt it have coin, balance


[15-Aug-19 06:45 AM] jl777c#5810
maybe logout button


[15-Aug-19 06:45 AM] grewalsatinder#9653
true... adding those too


[15-Aug-19 06:45 AM] jl777c#5810
though we have logout button in upper right, so maybe no need for that


[15-Aug-19 06:45 AM] jl777c#5810
what else is typically on account page


[15-Aug-19 06:45 AM] grewalsatinder#9653
alright, adding that balance etc section on top then


[15-Aug-19 06:45 AM] grewalsatinder#9653
if logged in only then that section will display


[15-Aug-19 07:12 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611562875059830795/Screen_Shot_2019-08-16_at_2.11.49_AM.png


[15-Aug-19 07:12 AM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/611562876607528990/Screen_Shot_2019-08-16_at_2.12.11_AM.png


[15-Aug-19 07:12 AM] grewalsatinder#9653
@jl777c display of contents based on logged in or not logged in


[15-Aug-19 07:14 AM] jl777c#5810
yes, looks good


[15-Aug-19 07:15 AM] grewalsatinder#9653
added two global vars


[15-Aug-19 07:15 AM] grewalsatinder#9653
```// $LOGINDISPLAY - If Logged in set to "". Else "none"
    // $LOGOUTDISPLAY - If NOT Logged in set to "". Else "none"```


[15-Aug-19 07:19 AM] grewalsatinder#9653
pushed go github


[15-Aug-19 07:19 AM] grewalsatinder#9653
LOGIN and LOGOUT DISPLAY global vars


[15-Aug-19 07:19 AM] grewalsatinder#9653
available in existing PR


[15-Aug-19 07:19 AM] grewalsatinder#9653
https://github.com/jl777/libnspv/pull/99

{Embed}
https://github.com/jl777/libnspv/pull/99
login session notification added to login page by satindergrewal ...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[15-Aug-19 07:19 AM] jl777c#5810
thanks!


[15-Aug-19 07:20 AM] grewalsatinder#9653
np üôÇ


[15-Aug-19 08:02 AM] jl777c#5810
pushed to dev branch, i will start using the dev branch for when the new features appear stable. after it tests out ok, then it will migrate to beta and eventually master


[15-Aug-19 08:02 AM] jl777c#5810
so from now on jl777 branch is the bleeding edge that might not even build properly


[15-Aug-19 08:02 AM] jl777c#5810
make PR to dev branch


[15-Aug-19 08:03 AM] jl777c#5810
unless it is the html templates, which are the bleeding edge


[15-Aug-19 08:04 AM] grewalsatinder#9653
clear üëç


[15-Aug-19 08:07 AM] grewalsatinder#9653
account login/logout works! üôÇ


[15-Aug-19 08:40 AM] grewalsatinder#9653
@dukeleto need help with something mate


[15-Aug-19 08:40 AM] grewalsatinder#9653
if I select a .jpg file in an input field it will only post it's file name


[15-Aug-19 08:40 AM] grewalsatinder#9653
the examples I found online was using JavaScript to get full path of the file


[15-Aug-19 08:40 AM] grewalsatinder#9653
need to figure out without Js


[15-Aug-19 08:41 AM] grewalsatinder#9653
too late here now, so will try to look for a solution to it later.


[15-Aug-19 08:41 AM] grewalsatinder#9653
in the mean time if you can please take a look, would be great!


[15-Aug-19 09:01 AM] jl777c#5810
@Sir Seven there should be a set of reliable KMD fullnodes now


[15-Aug-19 09:08 AM] Sir Seven#7158
Shouldn't be they included in coins file?


[15-Aug-19 09:10 AM] jl777c#5810
for KMD it is an exception


[15-Aug-19 09:10 AM] Deleted User#0000
I think it can have a DNS server yes?


[15-Aug-19 09:11 AM] jl777c#5810
it can, but i dont know how to configure DNS server and having a decent list of seeds will cross connect to the peers they have

{Reactions}
üíØ 

[15-Aug-19 09:13 AM] Sir Seven#7158
@dukeleto HUSH seems to work just fine on nspv, yet there are but 1 good node to connect. Thus, timeout errors are frequent. Unless you manually disable node discovery.


[15-Aug-19 09:45 AM] jl777c#5810
@Sir Seven latest version automatically limits the sending amount to 0.0001 less than the max amount you have. plz test this


[15-Aug-19 10:04 AM] Sir Seven#7158
With curl and API it always result in error `not enough funds`.
In webUI any amount more than (balance - 0.0001) will result in autolimited tx.

Note: there is txfee param in coins file, we might use it here.


[15-Aug-19 10:16 AM] dukeleto#7326
@Sir Seven thanks, you are correct. Notary nodes are not yet running versions of HUSH which enable nSPV, so we only have 1 full node with nspv services right now


[15-Aug-19 10:17 AM] dukeleto#7326
@Sir Seven i will spin up some more hush nodes soon, and ask some NNs to update when that code hits master branch (it hasn't yet)


[15-Aug-19 10:17 AM] jl777c#5810
@Sir Seven this is an html only feature


[15-Aug-19 10:18 AM] jl777c#5810
yes, make an issue to use the txfee in the coins file, though all komodo coins use the standard


[15-Aug-19 12:28 PM] jl777c#5810
@Sir Seven added support for wallet seeds in english, french, italian, spanish, korean, japanese, chinese_simplified, chinese_traditional
you can use the seed interchangeably with the wif, at least you should be able to, if not it is a bug. to make it change language just add a &lang=korean to the url


[15-Aug-19 12:29 PM] Sir Seven#7158
html-only or new rpcs?


[15-Aug-19 12:29 PM] jl777c#5810
both should work, just pass in the seed via the "wif" field, it autodetects if it is a wif or a seed


[15-Aug-19 12:39 PM] jl777c#5810
added russian seeds


[15-Aug-19 12:39 PM] jl777c#5810
you can see all the supported languages in the ~/libnspv/seeds dir


[15-Aug-19 12:57 PM] jl777c#5810
@Sir Seven added "language" api, the "help" api should list all the current api calls


[15-Aug-19 12:57 PM] jl777c#5810
anyway, it just has "lang":"russian" to set the default language to russian


[15-Aug-19 12:57 PM] jl777c#5810
we can add any language with a file having the 2048 words in that language in the seeds dir


[15-Aug-19 09:24 PM] 9oklp#8901
Can the new nspv wallet be used for other coins like Agama could, e.g. Bitcoin?


[15-Aug-19 09:26 PM] CHMEX#0686
For other notarized SmartChains like RFOX DEX REVS etc yes


[15-Aug-19 11:00 PM] 9oklp#8901
Ok, just KMD and smartchains, thanks!


[15-Aug-19 11:54 PM] actionslacks#4072
@9oklp  Bitcoin may be the gateway drug into the potential of crypto but it will not be the "killer app" that takes crypto to mainstream adoption. Even those in charge of it's development are documented as being in favor of it's role as reserve asset.


[16-Aug-19 12:00 AM] actionslacks#4072
the eradication of ECMAscript from crypto transactions is key to it's security and feasibility for mobile, low bandwidth applications. credit card machines don't run internet browsers for a reason.


[16-Aug-19 06:39 AM] 9oklp#8901
@actionslacks , I agree btc is probably the crypto reserve currency like gold used to be in the fiat world. I really liked being able to use Agama for other coins though, that was a cool feature!


[16-Aug-19 08:27 AM] dukeleto#7326
@jl777c is getting an external coin to use nSPV tech something you care about? Do we want that, as proof that nSPV is awesome? Or would you rather keep this tech inside the KMD fold for a while?


[16-Aug-19 08:27 AM] jl777c#5810
porting nspv to an external coin would be 10x the work as adding dPoW


[16-Aug-19 08:29 AM] dukeleto#7326
@jl777c thank you, now I know how much to charge üëº


[16-Aug-19 08:29 AM] dukeleto#7326
not that I think I could make it work easily


[16-Aug-19 08:29 AM] dukeleto#7326
@jl777c people have asked me about adding it to CHIPS


[16-Aug-19 08:29 AM] dukeleto#7326
but I told @grewalsatinder it would be non-trivial


[16-Aug-19 08:30 AM] dukeleto#7326
@jl777c regardless of complexity, "strategically", what are your desires?


[16-Aug-19 08:30 AM] dukeleto#7326
If somebody gonna pay me 5BTC to add nSPV to their coin, is that OK? No person is offering this yet, just wondering


[16-Aug-19 08:32 AM] jl777c#5810
seems better if it stayed komodo only for a while, but if someone will pay you 5 BTC, seems you should do it

{Reactions}
üëç 

[16-Aug-19 08:42 AM] jl777c#5810
latest jl777 branch might not work anymore on 32bit or windows, not sure


[16-Aug-19 08:42 AM] jl777c#5810
i added a bunch of jpeg code and curve25519. it should be ok, but not sure


[16-Aug-19 08:42 AM] jl777c#5810
@Sir Seven can you verify if it still works on windows


[16-Aug-19 08:43 AM] jl777c#5810
it is hardcoded now to use a .jpg file called test.jpg and from that it makes a dest.jpg with the wif steganographically encoded. but the password is very silly, so dont use real passphrases yet


[16-Aug-19 08:44 AM] jl777c#5810
the idea is that you can save your wif inside a .jpg protected with a password.

{Reactions}
shexy 

[16-Aug-19 08:44 AM] jl777c#5810
without knowing which .jpg if was and the password, then it cant be extracted


[16-Aug-19 08:45 AM] jl777c#5810
of course using a fixed location test.jpg and a fixed passphrase defeats this, but it was just a lot of code to get the basic functionality working


[16-Aug-19 08:50 AM] dukeleto#7326
@jl777c that is really awesome, looking forward to trying this feature out


[16-Aug-19 08:52 AM] jl777c#5810
unless the .jpg is really small it should be impossible to visually see any changes


[17-Aug-19 04:39 AM] hyperDEX#6586
Havent really been following along but what are the benefits to using the jpg? Just a 2fa of sorts?


[17-Aug-19 04:49 AM] jl777c#5810
it is like pin code,but there isnt any data directly associated with nspv


[17-Aug-19 04:50 AM] jl777c#5810
plausible deniability when computer is searched for crypto accounts

{Reactions}
üõ¨ üõ´ ‚ô• 3040_kingpeepo 

[17-Aug-19 04:50 AM] jl777c#5810
if you have nspv data in local storage, they will taser you if you dont divulge your password


[17-Aug-19 04:50 AM] jl777c#5810
if you have nspv data in local storage, they will taser you if you dont divulge your password


[17-Aug-19 04:51 AM] jl777c#5810
seems just better if there is no direct evidence that nspv ever was on the computer

{Reactions}
üëè 

[17-Aug-19 04:51 AM] jl777c#5810
you can make arbitrary number of decoy .jpg linked to small balances


[17-Aug-19 04:52 AM] jl777c#5810
the possibilities seem quite flexible. you can send the .jpg image as a gift with the password for it divulged separately for inheritance purposes

{Reactions}
üòç (3) 

[17-Aug-19 05:11 AM] hyperDEX#6586
I wonder if you can encode the jpg with yubikeys


[17-Aug-19 05:11 AM] hyperDEX#6586
So you would need both the hardware key and the pic


[17-Aug-19 06:39 AM] dukeleto#7326
@jl777c you will also be able to put a 200KB JPG image into the memo field of any kmd sapling chain, which offers many other exciting possibilities


[17-Aug-19 06:39 AM] dukeleto#7326
HUSH+ARRR wallets will probably support it first, and then others


[17-Aug-19 07:25 AM] Sir Seven#7158
@jl777c Seeds generation work fine with curls. Checked all langs you listed above.
You can log in with them in html wallet no problem.

Few problems: (on latest jl777 branch)
1. Using api call: http://127.0.0.1:7771/api/method/getnewaddress   results in error `{"error":"cant find methodfile"} `
2. If there is no lang supported passed ass param (AE: "lang": "svensk", or typo like "lang": "englih"), you will get random data as seed.
```json
:~/libnspv$ curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "getnewaddress", "params": ["englih"] }' -H 'content-type: text/plain;' http://127.0.0.1:12986/

{"seed":"19 1789 1601 670 516 1566 1734 726 857 77 1692 855 1129 1183 1203 948 1350 1447 1741 998 1263 1003 1593","wif":"Uq6bnT9VPGnfJCn9NPQ6fVzZdtELQS5XThhZ7jhND942ExWKyErt","address":"RTaTmrR3TgK4gBmiC5Ru9Tg2HzZWmx5S32","pubkey":"0331eea382ac2b308eb98ebdd1e8f3b05fea2ddd6af5d5f0068015e781e54a6236","wifprefix":188,"compressed":1}
``` 
It's probably better to either default unknown langs to english, similair to "lang": "", or throw an error instead.

Will recheck nspv build for WIn soon.


[17-Aug-19 02:14 PM] TonyL#3577
hm, latest jl777 doesn't build for windows:

```x86_64-w64-mingw32-gcc -DHAVE_CONFIG_H -I. -I./src  -I./src -I/root/libnspv_win/libnspv/depends/x86_64-w64-mingw32/share/../include/  -I./include -I./src/logdb/include -O2   -O2 -O2  -Wno-unused-parameter -pipe -O2  -W -std=gnu99 -pedantic -Wno-unused-function -Wno-long-long -Wno-overlength-strings -MT src/tools/jpeg/nspv-jaricom.o -MD -MP -MF src/tools/jpeg/.deps/nspv-jaricom.Tpo -c -o src/tools/jpeg/nspv-jaricom.o `test -f 'src/tools/jpeg/jaricom.c' || echo './'`src/tools/jpeg/jaricom.c
In file included from src/tools/jpeg/jpeglib.h:27:0,
                 from src/tools/jpeg/jaricom.c:18:
src/tools/jpeg/jmorecfg.h:178:9: error: unknown type name ‚Äòint32_t‚Äô
 typedef int32_t JDIMENSION;
         ^~~~~~~
Makefile:1811: recipe for target 'src/tools/jpeg/nspv-jaricom.o' failed
make[1]: *** [src/tools/jpeg/nspv-jaricom.o] Error 1
make[1]: Leaving directory '/root/libnspv_win/libnspv'
Makefile:2850: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
```


[17-Aug-19 02:16 PM] jl777c#5810
fixing


[17-Aug-19 02:17 PM] jl777c#5810
pushed fix


[17-Aug-19 02:25 PM] TonyL#3577
can confirm it building for windows now [CC @Sir Seven ]


[17-Aug-19 08:27 PM] NutellaLicka#4241
Would adding nSPV to CHIPS be a KMD funded development. It seems like it would greatly benefit the project.


[17-Aug-19 09:44 PM] grewalsatinder#9653
Don't think so. CHIPS is independent project.


[17-Aug-19 09:58 PM] NutellaLicka#4241
Well CHIPS is a SuperNET project technically. Along with managing the revshare from CHIPS


[18-Aug-19 01:02 AM] Sir Seven#7158
Builds now and works on WIndows.


[18-Aug-19 04:46 AM] dukeleto#7326
Adding nSPV to CHIPS would not be easy, but possible. It's more work than adding DPoW to a coin and it's more work than putting verushash in chips


[18-Aug-19 04:46 AM] dukeleto#7326
but y'all know that. I thought I was in chips discord üòÖ

{Reactions}
üòÅ (2) 

[19-Aug-19 11:13 AM] siu#3920
Hey guys, im trying to test komodo in spv mode in raspberry pi 4


[19-Aug-19 11:13 AM] siu#3920
but komodo doesnt compile in raspberry pi


[19-Aug-19 11:55 AM] dukeleto#7326
@siu correct, rasppi is not supported


[19-Aug-19 11:57 AM] siu#3920
ok, cool


[19-Aug-19 12:04 PM] siu#3920
oh wow, just tested it on my laptop... this is a ma zing


[19-Aug-19 12:04 PM] siu#3920
üòÆ


[19-Aug-19 01:27 PM] siu#3920
it would be nice if komodo could be compiled in a raspberry pi


[19-Aug-19 01:28 PM] siu#3920
right now i get this error: ```make: *** [funcs.mk:259: /home/pi/komodo/depends/work/build/armv7l-unknown-linux-gnueabihf/boost/1_66_0-f05f0228e8a/./.stamp_built] Error 1
make: Leaving directory '/home/pi/komodo/depends'```


[19-Aug-19 01:28 PM] siu#3920
@jl777c


[19-Aug-19 01:29 PM] siu#3920
maybe @artemciy_dice can help on this too, seems similar as what was happening on mm2 compiling.


[19-Aug-19 01:36 PM] artemciy_dice#0049
Judging by this error here - https://github.com/KomodoPlatform/atomicDEX-API/issues/501#issuecomment-516940954 - we're past the Boost build on raspbian, e.g. we don't have a full mm2 build there yet, but Boost builds NP, because this errors happens after the Boost build.

{Embed}
https://github.com/KomodoPlatform/atomicDEX-API/issues/501
mm2 does not build in Raspberry Pi 4 (using raspbian) ¬∑ Issue #50...
Tried to build mm2 on a new Raspberry Pi 4, this was the output of the error: Running `/home/pi/atomicDEX-API/target/debug/build/common-81f1ce86e9959ac8/build-script-build` [common 0.1.0] cargo:rer...
https://images-ext-2.discordapp.net/external/RDvx2WIoH0iRzE_70DuHLDOM6rqONFcnMd4HT0XBnOI/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/21276113


[19-Aug-19 01:39 PM] artemciy_dice#0049
And we're using `b2` to build Boost ( https://github.com/KomodoPlatform/atomicDEX-API/blob/d30c4295805ca39211d5a680a5ddb7494d9afdf2/mm2src/common/build.rs#L699 ). Had less luck with CMake.

{Embed}
https://github.com/KomodoPlatform/atomicDEX-API/blob/d30c4295805ca39211d5a680a5ddb7494d9afdf2/mm2src/common/build.rs
KomodoPlatform/atomicDEX-API
This is the official AtomicAPI (atomicDEX API) repository - KomodoPlatform/atomicDEX-API
https://images-ext-2.discordapp.net/external/RDvx2WIoH0iRzE_70DuHLDOM6rqONFcnMd4HT0XBnOI/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/21276113


[19-Aug-19 09:45 PM] Sir Seven#7158
@siu Above was mentioned that libnpv builds on rasppi with no issues. You might want to try it instead.


[20-Aug-19 01:52 AM] siu#3920
I built it, but cant seem to make it run...


[20-Aug-19 01:52 AM] siu#3920
I cant see anything on browser on port 7771


[20-Aug-19 02:55 AM] Sir Seven#7158
@siu 
Try curl from terminal:
`curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "getinfo", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/`
And check there is process listnening on 7771 port:
`ss -tlnp | grep 7771`


[20-Aug-19 06:30 AM] dukeleto#7326
@siu ZEC is not compatible to be compiled on rasp pi, which is why KMD is not compat. It's not ever gonna happen


[20-Aug-19 06:30 AM] dukeleto#7326
so just get better hardware üôÇ


[20-Aug-19 06:31 AM] dukeleto#7326
64bit OS is preferred, raspian is 32bit broken-ness

{Reactions}
üòû 

[20-Aug-19 06:31 AM] dukeleto#7326
@siu the PirateChest uses this: https://store.pine64.org/?product=rockpro64-4gb-single-board-computer

{Embed}
pineadmin
https://store.pine64.org/?product=rockpro64-4gb-single-board-computer
Store


[20-Aug-19 07:14 AM] TonyL#3577
@dukeleto https://www.raspberrypi.org/products/raspberry-pi-3-model-b-plus/ has 64bit CPU, if I remember correct it's possible to compile komodod for x64 arm

{Embed}
https://www.raspberrypi.org/products/raspberry-pi-3-model-b-plus/
Buy a Raspberry Pi 3 Model B+ ‚Äì Raspberry Pi
https://images-ext-1.discordapp.net/external/YapH9kRu4GgPAGgz3wfK-q0iZRYhrQLhW9tkTFdMXUA/https/rpf-products.cdn.prismic.io/rpf-products/8c67a3e02f41441dae98f8b91c792c1e1b4afef1_770a5842.jpg


[20-Aug-19 09:24 AM] jl777c#5810
@siu libnspv works on 32bit, but komodod wont. well i guess in nSPV=1 mode it might be possible to make it work, but would be a LOT of work and since libnspv already works, there seems little point


[20-Aug-19 09:45 AM] dukeleto#7326
@TonyL the flavor of ARM that it is doesn't play nice with zcash dependencies, iirc. There are very good reasons when radix42 says something ain't gonna work üôÇ


[20-Aug-19 09:45 AM] dukeleto#7326
Unless you got it to actually work, I wouldn't assume


[20-Aug-19 09:46 AM] dukeleto#7326
rasppi is ARMv7, i.e. many things are emulated in software or don't even exist, where ARMv8 is drastically better


[20-Aug-19 09:46 AM] dukeleto#7326
rasp pi is just not worth the money, it's meant to be simple+easy with lots of "batteries included" stuff for students


[20-Aug-19 09:47 AM] dukeleto#7326
It's not for dev'ing


[20-Aug-19 09:47 AM] dukeleto#7326
additionally, the OS they give people to run on it, it's highly de-optimized


[20-Aug-19 09:47 AM] dukeleto#7326
32bit OS, for 64bit hardware, lulz


[20-Aug-19 09:48 AM] dukeleto#7326
https://www.friendlyarm.com/index.php?route=product/product&product_id=234


[20-Aug-19 09:48 AM] dukeleto#7326
That is what you want ^


[20-Aug-19 09:48 AM] dukeleto#7326
that has 6 cores, more than the pirate chest version


[20-Aug-19 09:48 AM] dukeleto#7326
and runs armbian nicely


[20-Aug-19 09:49 AM] dukeleto#7326
not sure, but maybe AES primitives are missing on ARMv7


[20-Aug-19 09:49 AM] dukeleto#7326
all i remember, is radix42 ran away screaming. Good luck üôÇ


[20-Aug-19 09:49 AM] TonyL#3577
oh ok, I've heard 64bit Ubuntu Mate works on this raspberry but never tried üòÖ


[20-Aug-19 09:49 AM] TonyL#3577
so totally trust you in this question hehe


[20-Aug-19 09:50 AM] dukeleto#7326
I think you will find that nobody has ever gotten Zcash running on any type of rasppi, if you do, let me know!


[20-Aug-19 09:51 AM] dukeleto#7326
If it's not ARMv8, it's not worth working on the HW, imho


[20-Aug-19 10:29 AM] siu#3920
got libnspv working!


[20-Aug-19 10:30 AM] siu#3920
on RPI


[20-Aug-19 10:30 AM] siu#3920
awesome!

{Reactions}
3040_kingpeepo (2) 

[20-Aug-19 10:36 AM] jl777c#5810
can someone make a PR with instructions on how to add the proper lines to the coins file so nspv will work with a coin


[20-Aug-19 10:38 AM] siu#3920
would be nice!


[20-Aug-19 10:49 AM] jl777c#5810
i explained it already, but probably good to have a more detailed explanation


[20-Aug-19 10:49 AM] siu#3920
i have not scrolled much above. Sorry. Just wanted to test this.


[20-Aug-19 10:50 AM] jl777c#5810
so far, not so many bugs. it just seems to work


[20-Aug-19 10:52 AM] siu#3920
sorry if it sounds incompetent, but how would i start the ./nspv KMD file to be accessed from LAN ip?


[20-Aug-19 10:52 AM] siu#3920
seems like i cant access the web wallet from the LAN ip


[20-Aug-19 11:01 AM] jl777c#5810
pretty sure you need an external ip address. it is in libbtc the networking code


[20-Aug-19 11:02 AM] siu#3920
ok


[20-Aug-19 11:02 AM] siu#3920
i was thinking on just the LAN network


[20-Aug-19 11:08 AM] jl777c#5810
if the fullnode can accept connections on the LAN ip, it might work


[20-Aug-19 11:08 AM] jl777c#5810
maybe need to -bind=LANip on the fullnode side?


[20-Aug-19 11:09 AM] jl777c#5810
oh, and you need to add the LANip peer, which currently is not possible via api, will need to make an addnode api later this week


[20-Aug-19 11:10 AM] jl777c#5810
for non-KMD coins, you can change the "nSPV" parameter in the coins file


[20-Aug-19 11:29 AM] siu#3920
Seems like there is something off with the wallet seed encoding


[20-Aug-19 11:30 AM] siu#3920
I tried a seed generate from atomic dex but printed a different address


[20-Aug-19 11:31 AM] siu#3920
By the way i think it might be easier since i just want to access the wallet interface through a browser in a different device, not the lib itself.


[20-Aug-19 11:31 AM] siu#3920
Not sure if im being clear


[20-Aug-19 11:32 AM] siu#3920
I want to run it as a website. Or it cant handle different logins simultaneously?


[20-Aug-19 11:33 AM] jl777c#5810
it is a single user wallet


[20-Aug-19 11:33 AM] jl777c#5810
specifically via localhost


[20-Aug-19 11:33 AM] jl777c#5810
no remote access


[20-Aug-19 11:36 AM] siu#3920
Ok, understood now


[20-Aug-19 12:51 PM] siu#3920
how far is nSPV from supporting light dice CC play?


[20-Aug-19 12:54 PM] jl777c#5810
komodod -nSPV=1 might already support it, not sure


[20-Aug-19 12:55 PM] jl777c#5810
libnspv has to have each CC rpc implemented, once the basic finalizeCCtx is done. it isnt yet


[20-Aug-19 01:01 PM] siu#3920
üëç


[20-Aug-19 01:04 PM] jl777c#5810
duplicate the functionality of the finalizeCCtx function in komodod


[20-Aug-19 01:05 PM] jl777c#5810
libnspv is 100% in C, it is a different codebase than komodod


[20-Aug-19 01:05 PM] jl777c#5810
it is in komodod already, but using C++ and all the existing komodod


[20-Aug-19 01:05 PM] jl777c#5810
libnspv, is just the superlite client without komodod, and it is 100% in C

{Reactions}
üëå 

[20-Aug-19 01:38 PM] siu#3920
I just tested KMDICE with -nSPV=1


[20-Aug-19 01:38 PM] siu#3920
but it shows an empty response on `dicelist`


[20-Aug-19 01:39 PM] siu#3920
```./komodo-cli -ac_name=KMDICE dicelist    
[
]
```


[20-Aug-19 01:41 PM] jl777c#5810
let @Mihailo know about any CC rpc calls that dont work


[20-Aug-19 03:58 PM] Mihailo#5902
@siu I'm in the middle of refactoring some calls for nSPV, the [cc]list calls won't work right now. I'm on the road this week, but will try to fix it and PR it by end of the week.

{Reactions}
üéâ 

[20-Aug-19 04:40 PM] dukeleto#7326
@siu FYI,  you could run a nspv wallet on localhost on some trusted server, then VPN into that network remotely, and then go to https://10.0.0.77 in your browser to view the wallet. You could run any number of these for diff coins on diff ports. This might be something like the original use case you were asking about.


[20-Aug-19 04:59 PM] Deleted User#0000
Nar just need a nSPV that handles unlimited coins... üòÑ One day


[21-Aug-19 08:17 AM] siu#3920
just tried to run ./nspv KMDICE


[21-Aug-19 08:17 AM] siu#3920
seemed good until i tried to login: ```result ({"result":"success","status":"wif will expire in 777 seconds","address":"RDGVBu3J9M1x2cXPB8MgX9S1Fbkq6FWzvc","pubkey":"03db419891c867f545d90be56f7ee8c9ce9fa829e88497bf3f7ba00a654a2634a4","wifprefix":188,"compressed":1})
got utxos response 136.243.58.134:7770 1566400444 size.209 numtxos.2
got txids response 1566400444 size.6513 RDGVBu3J9M1x2cXPB8MgX9S1Fbkq6FWzvc CC.0 num.134
[1]    7419 segmentation fault (core dumped)  ./nspv KMDICE
```


[21-Aug-19 08:18 AM] siu#3920
btw, thanks @Mihailo for working on the cc calls!


[21-Aug-19 08:22 AM] TonyL#3577
@Sir Seven could you please try to reproduce crash above? (and collect backtrace / create issue if needed)


[21-Aug-19 08:24 AM] Sir Seven#7158
Hm. @siu  Can you provide please a bit more info?


[21-Aug-19 08:25 AM] Sir Seven#7158
Or you literally just run it and tryed to log in?


[21-Aug-19 08:25 AM] Sir Seven#7158
:)


[21-Aug-19 08:25 AM] siu#3920
where could it get more info? does libnspv collects a log?


[21-Aug-19 08:25 AM] siu#3920
yeah, ran it and then when to the interface and tried to log in.


[21-Aug-19 08:26 AM] Sir Seven#7158
In browser, got it.


[21-Aug-19 08:26 AM] siu#3920
yes, browser


[21-Aug-19 08:38 AM] Sir Seven#7158
Can you share your coins file entry for KMDICE?
Is it default?
```
  {
    "coin":"KMDICE",
    "asset":"KMDICE",
    "fname": "KMDice",
    "rpcport":30177,
    "mm2": 1
  },
```


[21-Aug-19 08:40 AM] Sir Seven#7158
With set above it defaults to KMD. And doesn't crash on loging.
```
./nspv KMDICE
couldnt match coin, defaulting to KMD chain
```


[21-Aug-19 08:43 AM] TonyL#3577
`couldnt match coin, defaulting to KMD chain` seems your client not using KMDICE AC on start by some reason
also note that crash might be specific to some Dice CC vouts siu has in his wallet


[21-Aug-19 08:44 AM] gcharang#6833
{
  "coin": "COIN",
  "asset": "COIN",
  "fname": "Coin",
  "rpcport": 12345,
  "mm2": 1,
  "p2p": 12346,
  "magic": "feb4cb23",
  "nSPV": "5.9.102.210, 5.9.253.195, 5.9.253.196, 5.9.253.197, 5.9.253.198, 5.9.253.199, 5.9.253.200, 5.9.253.201, 5.9.253.202, 5.9.253.203"
}
it needs all these


[21-Aug-19 08:44 AM] jl777c#5810
without nSPV field in coins file, it wont do nSPV


[21-Aug-19 08:44 AM] jl777c#5810
KMDICE is not running on any of those ip addresses


[21-Aug-19 08:44 AM] jl777c#5810
neithere is COIN


[21-Aug-19 08:44 AM] Sir Seven#7158
Above is default coins entry for KMDICE. Currently in repo.


[21-Aug-19 08:44 AM] gcharang#6833
i'm just saying all those keys are needed


[21-Aug-19 08:45 AM] jl777c#5810
you need to put the ip address of the nodes that run the COIN


[21-Aug-19 08:45 AM] gcharang#6833
`https://docs.komodoplatform.com/nSPV/#property-descriptions`


[21-Aug-19 08:49 AM] Sir Seven#7158
@siu  Can't reproduce.
Please check your coins file for nspv. Check link above. If it repeats on your side, you can share backtrace:
`https://docs.komodoplatform.com/komodo/debug-Komodo.html#run-komodo-daemon-with-gdb-tool`
Pretty much the same for libnspv.


[21-Aug-19 08:51 AM] siu#3920
i tried again and it logged in, but even when running ./nspv KMDICE, it seems to log me into the KMD wallet


[21-Aug-19 08:51 AM] siu#3920
it shows my kmd balance, not my kmdice balance


[21-Aug-19 08:52 AM] siu#3920
it didnt crash this time since i left it running for some time before logging in


[21-Aug-19 08:52 AM] gcharang#6833
@siu have you modified your coins file to have all the keys described here: `https://docs.komodoplatform.com/nSPV/#property-descriptions`?


[21-Aug-19 08:53 AM] TonyL#3577
I believe KMDICE nspv compatible full node is needed to be prepared at first


[21-Aug-19 08:53 AM] siu#3920
i did not do any modifications to the libnspv coins file


[21-Aug-19 08:54 AM] jl777c#5810
then it would print that it is defaulting to KMD


[21-Aug-19 08:54 AM] siu#3920
indeed @jl777c i just saw it: ```./nspv KMDICE
couldnt match coin, defaulting to KMD chain
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash KMD
```


[21-Aug-19 08:54 AM] gcharang#6833
@siu first compile latest komodod ona vps and start the kmdice chain 
then add the KMDICE chain to the coins file in the libnspv dir
with the above properties


[21-Aug-19 08:54 AM] gcharang#6833
add the full nodes's ip to the nSPV key


[21-Aug-19 08:55 AM] jl777c#5810
why run a komodo superlite??

{Reactions}
üëÜ 

[21-Aug-19 08:55 AM] jl777c#5810
-nSPV=1 runs it as a superlite node, NOT as a fullnode that supports nSPV


[21-Aug-19 08:55 AM] jl777c#5810
you just need to run a normal node from the right branch of repo

{Reactions}
üëç 

[21-Aug-19 08:55 AM] siu#3920
i guess i would need a fullnode ip address for KMDICE?


[21-Aug-19 08:55 AM] siu#3920
ok


[21-Aug-19 08:56 AM] TonyL#3577
yes you need at least one full node with nspv code included


[21-Aug-19 08:56 AM] TonyL#3577
latest FSM lets say is fine


[21-Aug-19 08:56 AM] siu#3920
ok


[21-Aug-19 08:56 AM] siu#3920
welp., that extends my testing for a few days then


[21-Aug-19 08:56 AM] siu#3920
syncing KMDICE is a pain


[21-Aug-19 08:56 AM] siu#3920
oh, i can use my NN


[21-Aug-19 08:57 AM] TonyL#3577
I don't think thats NN repo has needed code


[21-Aug-19 08:57 AM] siu#3920
but i use beta branch on the NN


[21-Aug-19 08:57 AM] siu#3920
yeah, true.


[21-Aug-19 08:57 AM] jl777c#5810
dev branch or "below"


[21-Aug-19 08:57 AM] jl777c#5810
if you just update the KMDICE node to dev branch it would work as a seed node for "nSPV" field


[21-Aug-19 08:58 AM] siu#3920
ok


[21-Aug-19 04:30 PM] Regnar#6164
https://i.imgur.com/VZhNf4r.png

{Embed}
https://imgur.com/VZhNf4r
https://images-ext-2.discordapp.net/external/gJmdzLHtYvMVS3_zam0S1yMqRmA6_d7xALbrYyC8rgk/https/i.imgur.com/VZhNf4r.png

{Reactions}
üò¨ üëç (3) KMD (3) 

[21-Aug-19 05:46 PM] grewalsatinder#9653
@Regnar nice!! üôÇ üëç

{Reactions}
üëç 

[21-Aug-19 05:47 PM] Regnar#6164
Going to tweak it some more


[21-Aug-19 05:47 PM] grewalsatinder#9653
is that Electron desktop app?

{Reactions}
üöé üòÖ 

[21-Aug-19 05:52 PM] grewalsatinder#9653
hmm... missed the title üòÑ


[21-Aug-19 05:52 PM] grewalsatinder#9653
python based desktop app


[21-Aug-19 05:52 PM] Regnar#6164
tkinter python


[21-Aug-19 05:52 PM] grewalsatinder#9653
so I guess python using Electron framework


[21-Aug-19 05:53 PM] Regnar#6164
It's hard not making this look like it's from 1996


[21-Aug-19 05:53 PM] grewalsatinder#9653
not really concerned about the look mate üòâ


[21-Aug-19 05:54 PM] Regnar#6164
haha well it already functionally works so

{Reactions}
üëç 

[21-Aug-19 05:57 PM] grewalsatinder#9653
very nice üôÇ üëç


[21-Aug-19 07:08 PM] Regnar#6164
https://i.imgur.com/BwryKxp.png

{Embed}
https://imgur.com/BwryKxp
https://images-ext-2.discordapp.net/external/0cPrXtp4pfYveHE7Suouv6hBCRVFGS1-XJoTA3ME10Y/https/i.imgur.com/BwryKxp.png


[21-Aug-19 07:08 PM] Regnar#6164
Much cleaner


[21-Aug-19 07:19 PM] dukeleto#7326
@Regnar i did some Tk GUI coding in the 90's üôÇ

{Reactions}
ü§ì 

[21-Aug-19 07:20 PM] dukeleto#7326
and GTK


[21-Aug-19 07:21 PM] dukeleto#7326
@grewalsatinder there is no Electron involved, thank heavens: https://wiki.python.org/moin/TkInter


[21-Aug-19 07:31 PM] grewalsatinder#9653
oh so it's "TkInter" based? ü§î interesting


[21-Aug-19 07:31 PM] grewalsatinder#9653
hope it's better secure than Electron


[21-Aug-19 07:35 PM] Regnar#6164
I'm not sure how to get that working for windows yet.


[21-Aug-19 07:36 PM] dukeleto#7326
@grewalsatinder it's tech from the 80's, old school GUI programming

{Reactions}
üëç 

[21-Aug-19 07:37 PM] grewalsatinder#9653
üòÑ I can trust better on old programming language than new


[21-Aug-19 07:37 PM] dukeleto#7326
electron is a monstrosity, plz don't mention it so much üòÖ


[21-Aug-19 07:37 PM] grewalsatinder#9653
üòÖ agree


[21-Aug-19 07:37 PM] dukeleto#7326
it might hear you


[21-Aug-19 07:37 PM] grewalsatinder#9653
https://tenor.com/view/anchorman-will-ferrell-nod-agreed-ron-burgundy-gif-4668685

{Embed}
https://tenor.com/view/anchorman-will-ferrell-nod-agreed-ron-burgundy-gif-4668685
agreed
https://images-ext-2.discordapp.net/external/ML2gJ0_RYVwydLwopw6Vj27daEwuIp-XUDr-yAjCcY8/https/media.tenor.co/images/aa0c3ef43d48d8fa827c92c646703ead/raw


[21-Aug-19 07:38 PM] dukeleto#7326
TCL/TK was how people wrote GUIs, back in the day, before GTK


[21-Aug-19 07:38 PM] dukeleto#7326
y'all prolly never even heard of GTK


[21-Aug-19 07:38 PM] dukeleto#7326
good lord i am old


[21-Aug-19 07:38 PM] grewalsatinder#9653
yep, that gui reminds me of KDE for some reason üòÑ


[21-Aug-19 07:39 PM] grewalsatinder#9653
Knoppix Live CD..... üòÖ


[21-Aug-19 07:39 PM] grewalsatinder#9653
Mandrics....


[21-Aug-19 07:39 PM] dukeleto#7326
KDE was a reaction to GTK/Gnome


[21-Aug-19 07:39 PM] dukeleto#7326
kind of like Pepsi and Coke


[21-Aug-19 07:39 PM] dukeleto#7326
they do the same exact thing, but 2 different fiefdoms


[21-Aug-19 07:40 PM] dukeleto#7326
and I think KDE is MIT while Gtk/gnome is GPL


[21-Aug-19 07:40 PM] grewalsatinder#9653
right... I was student when I tried RedHat 8


[21-Aug-19 07:40 PM] dukeleto#7326
if you wanted to make GUIs for Unix systems, you had the choice of TK, GTK or QT, which all came from TK, i think


[21-Aug-19 07:41 PM] dukeleto#7326
https://en.wikipedia.org/wiki/Tk_(software) was written in 1991

{Embed}
https://en.wikipedia.org/wiki/Tk_(software)
Tk (software)
Tk is a free and open-source, cross-platform widget toolkit that provides a library of basic elements of GUI widgets for building a graphical user interface (GUI) in many programming languages.
Tk provides a number of widgets commonly needed to develop desktop applications, s...
https://images-ext-2.discordapp.net/external/z9DVQha28Hof_3M-TuZ3szVFu5TX4jrJNxQmoDCmjcI/https/upload.wikimedia.org/wikipedia/commons/thumb/3/31/Tk-Demo_using_Tk_8.6.6_on_Windows_10%252C_November_2016.png/1200px-Tk-Demo_using_Tk_8.6.6_on_Windows_10%252C_November_2016.png

{Reactions}
üëç (2) 

[21-Aug-19 07:42 PM] dukeleto#7326
GTK was 1998


[21-Aug-19 07:42 PM] dukeleto#7326
GTK was the new hotness when I was first learning to code üòÖ


[21-Aug-19 07:42 PM] dukeleto#7326
and TK was how the old greybeards did stuff


[21-Aug-19 07:43 PM] grewalsatinder#9653
hehe.... for me was still 2 years yet to touch a computer in 1998 üòÖ


[21-Aug-19 07:56 PM] Regnar#6164
I use GTK too....


[21-Aug-19 07:57 PM] Regnar#6164
oh man I use GTK, TK, and QT right now...


[21-Aug-19 08:03 PM] grewalsatinder#9653
I so want to do my lessons on QT, but I'm more engaged with learning btc lessons for now üòê


[21-Aug-19 08:43 PM] Regnar#6164
so do I leave this theme in there? üòÇ


[21-Aug-19 09:13 PM] Regnar#6164
Got some basic themes for the GUI, you just click on settings and select the theme and it automatically switches over. I added the Orange one too (kroc) <https://github.com/theblackmallard/nspv_pywallet/blob/master/README.md>


[22-Aug-19 01:42 AM] jl777c#5810
@Sir Seven pushed new version to jl777 branch. it should be able to display p2sh addresses now, you can check by looking at a txid with a multisig address in it. there is also a new api call "addnode", with param "ipaddr", the format is "5.9.102.210" or "5.9.102.210:port"


[22-Aug-19 01:42 AM] jl777c#5810
any new bugs?


[22-Aug-19 02:40 AM] Sir Seven#7158
Will check new version soon.
Haven't found new bugs.


[22-Aug-19 03:22 AM] Sir Seven#7158
@jl777c
Instant segfault on addnode method:

```http://127.0.0.1:12986/api/method/addnode
backtrace:
https://paste.ubuntu.com/p/JxNFz6n7rq/```

```curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "addnode", "params": [] }' -H 'content-type: text/plain;' http://127.0.0.1:12986/
backtrace:
https://paste.ubuntu.com/p/HPvQjx4g2W/```


[22-Aug-19 03:22 AM] Sir Seven#7158
bactrace looks same in both cases.


[22-Aug-19 03:27 AM] Sir Seven#7158
Works fine with ipaddr given.
```
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "addnode", "params": ["159.69.45.70:12985"] }' -H 'content-type: text/plain;' http://127.0.0.1:12986/
{"result":"success","status":"ipaddr already there","ipaddr":"159.69.45.70:12985"}
```


[22-Aug-19 03:33 AM] gcharang#6833
jl777/komodo branch: jl777
started with `komodod -nSPV=1`
 crashes for the command `komodo-cli getrawtransaction e90ddbca10e04d98526125fd6b68e9b5745323dbcbc7b972b0560d025de3f023`
I know this is not a nspv command but it should give an error message without crashing
backtrace: `https://paste.ubuntu.com/p/np76MJ3rNb/`
@jl777c


[22-Aug-19 03:54 AM] jl777c#5810
@Sir Seven pushed fix. you didnt have any "ipaddr" field, so it was a null pointer


[22-Aug-19 03:57 AM] jl777c#5810
@gcharang most all the normal rpc commands will fail in some way or another. @Mihailo will need to add some error checking for the ones that crash in a bad way


[22-Aug-19 04:00 AM] Sir Seven#7158
Fixed. Returns error if no parameter given.


[22-Aug-19 04:28 AM] jl777c#5810
@Sir Seven i added libcryptoconditions code to libnspv. i made a script called "onetime" that you run one time. this will autogen and configure and build the libcryptoconditions.


[22-Aug-19 04:28 AM] jl777c#5810
after you run the onetime script, then just make from ~libnspv and it should build nspv as usual


[22-Aug-19 04:32 AM] jl777c#5810
i tested this on unix and osx but not windows


[22-Aug-19 04:38 AM] jl777c#5810
@gcharang can you make a list of the non-CC rpc calls that crash with nSPV=1 mode?


[22-Aug-19 04:47 AM] gcharang#6833
will do


[22-Aug-19 05:21 AM] dukeleto#7326
is nspv v2 still compat with the network, or only v3 ?


[22-Aug-19 05:21 AM] dukeleto#7326
I am updating Hush to v3 now


[22-Aug-19 05:23 AM] dukeleto#7326
latest FSM is merged in and I am testing out a compile now


[22-Aug-19 05:44 AM] Sir Seven#7158
Actually, onetime script also builds nspv executable.
Hm. Not sure of make and configure options tho. @TonyL can you please check it? PMed additional info.


[22-Aug-19 06:48 AM] TonyL#3577
Am I understand correct that end-goal for windows is to make .dll file?


[22-Aug-19 06:53 AM] TonyL#3577
there is 0 win mentions in `cryptoconditions`, not sure what I should expect üòÖ


[22-Aug-19 07:06 AM] TonyL#3577
https://github.com/jl777/komodo/blob/jl777/src/cc/makerogue @Sir Seven in general I think just condition with build via mingw as in this script is needed for `onetime` script

{Embed}
https://github.com/jl777/komodo/blob/jl777/src/cc/makerogue
jl777/komodo
Komodo. Contribute to jl777/komodo development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[22-Aug-19 07:16 AM] TonyL#3577
libnspv windows build script set host env to `x86_64-w64-mingw32` so this `if [ "$HOST" = "x86_64-w64-mingw32" ]; ` condition will match


[22-Aug-19 07:45 AM] jl777c#5810
i have no idea about windows


[22-Aug-19 07:45 AM] jl777c#5810
you see the onetime script is simple enough


[22-Aug-19 07:45 AM] jl777c#5810
and it just needs to link in the libcryptoconditions.la file to nspv


[22-Aug-19 09:17 AM] Sir Seven#7158
In this case, it's enough to run onetime script (or just make libcryptoconditions) and run build_win.sh right after.
In this case nspv.exe works fine on windows, not sure about CC itself.


[22-Aug-19 09:31 AM] jl777c#5810
there is no CC implemented yet, but now it has the cryptoconditions library linked it, it is possible to start adding CC spends

{Reactions}
shexy (2) 

[22-Aug-19 11:20 AM] CMaurice#1685
Fyi building in Termux on Android:```CC       src/exhaustive_tests-tests_exhaustive.o                                                CCLD     exhaustive_tests                       CC       src/libsecp256k1_la-secp256k1.lo     clang-8: error: the clang compiler does not support '-march=x86-64'                             make[1]: *** [Makefile:1004: src/libsecp256k1_la-secp256k1.lo] Error 1                          make[1]: Leaving directory '/data/data/com.termux/files/home/libnspv/src/tools/cryptoconditions/src/include/secp256k1'``` ...

```make[1]: *** No rule to make target 'src/tools/cryptoconditions/libcryptoconditions.la', needed by 'nspv'.  Stop.                               make[1]: Leaving directory '/data/data/com.termux/files/home/libnsp```


[22-Aug-19 11:27 AM] jl777c#5810
it seems this makes nspv not work on android, until that is fixed. hopefully someone else can


[22-Aug-19 11:33 AM] jl777c#5810
@dimxy can you look into this?


[22-Aug-19 11:42 AM] dimxy#2587
Okay


[22-Aug-19 11:43 AM] jl777c#5810
it happens during the build process for cryptoconditions, which is in the src/tools/cryptoconditions


[22-Aug-19 11:43 AM] jl777c#5810
the onetime script in ~libnspv shows the build process


[22-Aug-19 11:43 AM] jl777c#5810
jl777 branch only


[22-Aug-19 11:44 AM] dimxy#2587
I see


[22-Aug-19 11:52 AM] CMaurice#1685
I edited `-march:x86-64` to `-march=aarch64` in `Makefile.am` but it's a generated file and is recreated with `-march=x86-64`
I don't know much about this sort of thing but enjoying learning


[22-Aug-19 11:53 AM] CMaurice#1685
no, it's something else


[22-Aug-19 12:04 PM] CMaurice#1685
the `aarch64` does propagate to the other Makefiles but the build fails with the same error


[22-Aug-19 02:18 PM] dimxy#2587
received  the same error


[22-Aug-19 09:43 PM] dukeleto#7326
Main HUSH seednode is running latest nspv v3 code, it's currently syncing from scratch but will be ready for testing soon


[23-Aug-19 12:16 AM] jl777c#5810
@dimxy now you duplicated it, hopefully you can track it down and fix it

{Reactions}
üëç 

[23-Aug-19 02:15 AM] jl777c#5810
@dimxy @Mihailo @Deleted User I updated https://github.com/jl777/libnspv/issues
you will see a few with your handle on it. we can discuss the details on github for things that are unclear. i think 107 will need some discussion. we have a chance to make a nice maintainable way to create signed CC tx

{Embed}
https://github.com/jl777/libnspv/issues
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559

{Reactions}
üëå (3) shexy (2) 

[23-Aug-19 10:15 AM] siu#3920
I was able to install manjaro 64bit on raspberry pi


[23-Aug-19 10:15 AM] siu#3920
maybe i can get to build Komodo here?


[23-Aug-19 10:16 AM] siu#3920
@dukeleto


[23-Aug-19 11:38 AM] dukeleto#7326
@siu go ahead and try


[23-Aug-19 12:24 PM] siu#3920
stops in the same place


[23-Aug-19 12:24 PM] siu#3920
there is no build instructions for arm i believe


[23-Aug-19 12:25 PM] siu#3920
```    "aarch64-unknown-linux-gnu-ar"  rc "bin.v2/libs/thread/build/gcc-gnu-9.1.0/release/link-static/threadapi-pthread/threading-multi/libboost_thread.a" "bin.v2/libs/thread/build/gcc-gnu-9.1.0/release/link-static/threadapi-pthread/threading-multi/pthread/thread.o" "bin.v2/libs/thread/build/gcc-gnu-9.1.0/release/link-static/threadapi-pthread/threading-multi/pthread/once.o" "bin.v2/libs/thread/build/gcc-gnu-9.1.0/release/link-static/threadapi-pthread/threading-multi/future.o"
    "aarch64-unknown-linux-gnu-ranlib" "bin.v2/libs/thread/build/gcc-gnu-9.1.0/release/link-static/threadapi-pthread/threading-multi/libboost_thread.a"

/bin/sh: line 1: aarch64-unknown-linux-gnu-ar: command not found
/bin/sh: line 2: aarch64-unknown-linux-gnu-ranlib: command not found
...failed gcc.archive bin.v2/libs/thread/build/gcc-gnu-9.1.0/release/link-static/threadapi-pthread/threading-multi/libboost_thread.a...
...skipped <pstage/lib>libboost_thread.a for lack of <pbin.v2/libs/thread/build/gcc-gnu-9.1.0/release/link-static/threadapi-pthread/threading-multi>libboost_thread.a...
...failed updating 9 targets...
...skipped 9 targets...
...updated 9 targets...
make: *** [funcs.mk:259: /home/siu/komodo/depends/work/build/aarch64-unknown-linux-gnu/boost/1_66_0-f05f0228e8a/./.stamp_built] Error 1
make: Leaving directory '/home/siu/komodo/depends'
```


[23-Aug-19 12:34 PM] dukeleto#7326
@siu do you remember what I said about this?


[23-Aug-19 12:35 PM] dukeleto#7326
@siu you could offer @radix42 a bounty, or she can tell you if it's viable. what you are doing have never been tried before, and it's not going to be easy for you to compile things


[23-Aug-19 12:36 PM] dukeleto#7326
it's only ever been tested on ARMbian


[23-Aug-19 12:37 PM] dukeleto#7326
@siu and to put it in perspective, it's $40 to buy a better machine that "just works" or potentially paying somebody to do dozens of hours of work to get an old piece of HW to work. Or maybe it not that hard, I have no idea


[23-Aug-19 12:38 PM] dukeleto#7326
which is why rasppi's are just overpriced and not dev-friendly


[23-Aug-19 12:38 PM] dukeleto#7326
compiling zcash on arm also takes hours


[23-Aug-19 12:38 PM] siu#3920
i have a better machine... i am just curious if its possible to build komodo on the new Rpi that has 4gb


[23-Aug-19 12:38 PM] dukeleto#7326
how invested are you on using this device?


[23-Aug-19 12:38 PM] siu#3920
you said it wont ever work since raspbian is 32bit


[23-Aug-19 12:38 PM] dukeleto#7326
there is a reason armbian doesn't even care about supporting various rasppi's


[23-Aug-19 12:39 PM] dukeleto#7326
32bit is a nogo


[23-Aug-19 12:39 PM] dukeleto#7326
64bit is a maybe-go


[23-Aug-19 12:39 PM] siu#3920
but the new rpi4 supports 64bit and manjaro already published a 64bit arm version


[23-Aug-19 12:39 PM] siu#3920
i am trying this in the new manjaro 64bit arm version


[23-Aug-19 12:39 PM] dukeleto#7326
never heard or used that linux distro


[23-Aug-19 12:39 PM] dukeleto#7326
and no idea what stuff they do


[23-Aug-19 12:39 PM] siu#3920
its based on arch


[23-Aug-19 12:39 PM] dukeleto#7326
like I said, it's lots of work to maybe support shitty rasppi hw


[23-Aug-19 12:40 PM] dukeleto#7326
maybe rpi4 is viable, not sure


[23-Aug-19 12:40 PM] dukeleto#7326
@radix42 has more informed opinions about the HW and porting KMD to it


[23-Aug-19 12:40 PM] siu#3920
but its cheap. and has 4gb ram which is something that should be nice to have.


[23-Aug-19 12:40 PM] dukeleto#7326
it's actually not cheap


[23-Aug-19 12:40 PM] dukeleto#7326
it's more expensive, than the better counterparts


[23-Aug-19 12:40 PM] siu#3920
?


[23-Aug-19 12:40 PM] dukeleto#7326
if you look at performance


[23-Aug-19 12:41 PM] siu#3920
you mean banana pi and stuff like that?


[23-Aug-19 12:41 PM] dukeleto#7326
please, don't try to sell me on how good rpi4's are üôÇ None of the devs here want to support it


[23-Aug-19 12:41 PM] siu#3920
really?


[23-Aug-19 12:41 PM] dukeleto#7326
so you will need to convince radix42


[23-Aug-19 12:41 PM] siu#3920
why?


[23-Aug-19 12:41 PM] dukeleto#7326
Nobody cares to support old expensive weak shite


[23-Aug-19 12:41 PM] dukeleto#7326
and also, rpi never was viable anyway


[23-Aug-19 12:41 PM] dukeleto#7326
maybe 64bit rpi4 is viable, maybe


[23-Aug-19 12:42 PM] siu#3920
i am talking about the new model that just came out in july


[23-Aug-19 12:42 PM] dukeleto#7326
but, who gonna do the work? radix42 never wanted to touch these, because the OS is broken


[23-Aug-19 12:42 PM] siu#3920
it has 4gb and supports 64bit software


[23-Aug-19 12:42 PM] dukeleto#7326
rpi's as a whole, are expensive and resource limited


[23-Aug-19 12:42 PM] dukeleto#7326
The pirate chest and new Hush machine will use this: https://store.pine64.org/?product=rockpro64-4gb-single-board-computer

{Embed}
pineadmin
https://store.pine64.org/?product=rockpro64-4gb-single-board-computer
Store


[23-Aug-19 12:42 PM] dukeleto#7326
rpi4 is for kids to play with


[23-Aug-19 12:42 PM] dukeleto#7326
that machine, that i linked above, runs KMD perfectly


[23-Aug-19 12:43 PM] dukeleto#7326
if you want something else, you get to do a massive amount of work


[23-Aug-19 12:43 PM] dukeleto#7326
to maybe have it work


[23-Aug-19 12:43 PM] siu#3920
but that pinearm is arm, its basically the same work if i understand this correctly


[23-Aug-19 12:43 PM] radix42#3743
it uses the rock64 not the pro but the pro would run kmd fine


[23-Aug-19 12:44 PM] dukeleto#7326
@radix42 oops, wrong model


[23-Aug-19 12:44 PM] radix42#3743
rasbpi 4 needs a 64bit OS, which means a 3rd party one


[23-Aug-19 12:44 PM] dukeleto#7326
@radix42 siu wants to use Majaro 64bit linux on an rpi4


[23-Aug-19 12:44 PM] siu#3920
yes, archarm and manjaro already have 64bit versions for it.


[23-Aug-19 12:44 PM] dukeleto#7326
what is the viability of that? it's not armbian


[23-Aug-19 12:44 PM] radix42#3743
no idea


[23-Aug-19 12:44 PM] dukeleto#7326
@siu there you go


[23-Aug-19 12:44 PM] dukeleto#7326
Nobody wants to do free work to support old shitty hardware


[23-Aug-19 12:44 PM] radix42#3743
what's it based on


[23-Aug-19 12:45 PM] dukeleto#7326
and rpi4 is old and shitty, in my book


[23-Aug-19 12:45 PM] radix42#3743
did i see arch above?


[23-Aug-19 12:45 PM] siu#3920
yes


[23-Aug-19 12:45 PM] dukeleto#7326
overpriced. most of the cost of an rpi goes to marketing


[23-Aug-19 12:45 PM] radix42#3743
prolly run my binaries then


[23-Aug-19 12:45 PM] dukeleto#7326
i doubt it, to be honest


[23-Aug-19 12:46 PM] dukeleto#7326
some tiny difference in how the filesystem is laid out with break some library


[23-Aug-19 12:46 PM] dukeleto#7326
@radix42 is it completely staticly linked?


[23-Aug-19 12:46 PM] radix42#3743
why? just needs glibc


[23-Aug-19 12:46 PM] radix42#3743
i think lemme check


[23-Aug-19 12:46 PM] dukeleto#7326
I just imagine ARMbian => Manjaro linux is a huge jump, no idea what changes lie beneath


[23-Aug-19 12:46 PM] dukeleto#7326
maybe some kernel setting


[23-Aug-19 12:46 PM] dukeleto#7326
gosh, I can't imagine all the ways it could break


[23-Aug-19 12:46 PM] dukeleto#7326
but maybe it just works


[23-Aug-19 12:47 PM] radix42#3743
well ok a buncha libraries


[23-Aug-19 12:47 PM] dukeleto#7326
@radix42 who knows if they even use the same glibc version?


[23-Aug-19 12:47 PM] radix42#3743
``` ldd komodod
        linux-vdso.so.1 (0x0000007f99c4d000)
        libz.so.1 => /lib/aarch64-linux-gnu/libz.so.1 (0x0000007f99bde000)
        libstdc++.so.6 => /usr/lib/aarch64-linux-gnu/libstdc++.so.6 (0x0000007f99a49000)
        libpthread.so.0 => /lib/aarch64-linux-gnu/libpthread.so.0 (0x0000007f99a1d000)
        librt.so.1 => /lib/aarch64-linux-gnu/librt.so.1 (0x0000007f99a06000)
        libdl.so.2 => /lib/aarch64-linux-gnu/libdl.so.2 (0x0000007f999f1000)
        libanl.so.1 => /lib/aarch64-linux-gnu/libanl.so.1 (0x0000007f999dd000)
        libm.so.6 => /lib/aarch64-linux-gnu/libm.so.6 (0x0000007f99923000)
        libgomp.so.1 => /usr/lib/aarch64-linux-gnu/libgomp.so.1 (0x0000007f998e6000)
        libgcc_s.so.1 => /lib/aarch64-linux-gnu/libgcc_s.so.1 (0x0000007f998c2000)
        libc.so.6 => /lib/aarch64-linux-gnu/libc.so.6 (0x0000007f99769000)
        /lib/ld-linux-aarch64.so.1 (0x0000007f99c22000)```


[23-Aug-19 12:47 PM] dukeleto#7326
good ol libgomp


[23-Aug-19 12:48 PM] siu#3920
so you know this is the uname -a for the manjaro version im running: ```Linux rpi 4.19.65-1-MANJARO-ARM #1 SMP PREEMPT Tue Aug 13 14:39:03 UTC 2019 aarch64 GNU/Linux
```


[23-Aug-19 12:48 PM] dukeleto#7326
that is good


[23-Aug-19 12:48 PM] dukeleto#7326
same arch


[23-Aug-19 12:48 PM] dukeleto#7326
it has some chance of working, i give it that


[23-Aug-19 12:48 PM] siu#3920
@radix42 which repo i could try?


[23-Aug-19 12:48 PM] radix42#3743
https://crypto.mercerweiss.com/komodo-v0.4.0-aarch64.tgz


[23-Aug-19 12:48 PM] dukeleto#7326
but libs and other weird shit could break something


[23-Aug-19 12:48 PM] radix42#3743
there's komodo binaries for aaarch64


[23-Aug-19 12:49 PM] radix42#3743
don't try a source build yet try that binary first, source builds are voodoo on aarch64


[23-Aug-19 12:50 PM] dukeleto#7326
i don't even know how to do those


[23-Aug-19 12:50 PM] dukeleto#7326
not sure I do!


[23-Aug-19 12:50 PM] radix42#3743
https://github.com/MercerWeissAlt/komodo/tree/dev-aarch64

{Embed}
https://github.com/MercerWeissAlt/komodo/tree/dev-aarch64
MercerWeissAlt/komodo
zcash. Contribute to MercerWeissAlt/komodo development by creating an account on GitHub.
https://images-ext-2.discordapp.net/external/fS2lZ9tO2J25_DK9QHDRstG9LeH4HdXwV9H9bhOqifQ/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/25749108


[23-Aug-19 12:51 PM] radix42#3743
gotta set HOST and a buncha other weird shit


[23-Aug-19 12:51 PM] radix42#3743
lemme know if the binary build works @siu


[23-Aug-19 12:51 PM] dukeleto#7326
@radix42 would all your binaries work if I decided to actually go with the PRO version of the pine64?


[23-Aug-19 12:51 PM] radix42#3743
should


[23-Aug-19 12:52 PM] radix42#3743
they work on nanopi and any other armbian


[23-Aug-19 12:52 PM] siu#3920
it worked!


[23-Aug-19 12:52 PM] radix42#3743
NICE


[23-Aug-19 12:52 PM] siu#3920
i do need to fetch zcash params


[23-Aug-19 12:53 PM] radix42#3743
grab fetch-params.sh from source anywhere


[23-Aug-19 12:53 PM] siu#3920
copying them from my laptop


[23-Aug-19 12:53 PM] radix42#3743
sweet


[23-Aug-19 12:53 PM] siu#3920
this looks promising! üòÅ


[23-Aug-19 12:54 PM] radix42#3743
feel free to send tips/donations! üôÇ


[23-Aug-19 12:55 PM] radix42#3743
https://jane.mercerweiss.com/


[23-Aug-19 12:56 PM] dukeleto#7326
errybody tip Jane


[23-Aug-19 12:57 PM] radix42#3743
good to know you CAN run on an rpi4


[23-Aug-19 12:57 PM] dukeleto#7326
itshappening.gif


[23-Aug-19 12:58 PM] dukeleto#7326
@siu I do understand that it's strategic for us to support a widely known/supported hunk of HW (even if I don't like it) and I hope that you can show the world stuff running on a rpi üòâ


[23-Aug-19 12:59 PM] siu#3920
btw, i guess you dont have merged the nspv code, right?


[23-Aug-19 12:59 PM] radix42#3743
into what?


[23-Aug-19 12:59 PM] radix42#3743
it builds out of the box on arm


[23-Aug-19 01:00 PM] dukeleto#7326
no


[23-Aug-19 01:00 PM] dukeleto#7326
the binaries


[23-Aug-19 01:00 PM] dukeleto#7326
are too old for nspv


[23-Aug-19 01:00 PM] dukeleto#7326
@radix42 your binaries are from before nspv


[23-Aug-19 01:00 PM] radix42#3743
oh


[23-Aug-19 01:00 PM] dukeleto#7326
the ancient olden days, before superlite


[23-Aug-19 01:00 PM] dukeleto#7326
also, those binaries can't sync HUSH


[23-Aug-19 01:00 PM] radix42#3743
they are from right after 0.4.0a


[23-Aug-19 01:00 PM] dukeleto#7326
yeah, that is old üòÖ


[23-Aug-19 01:01 PM] radix42#3743
I'll update them soon


[23-Aug-19 01:01 PM] dukeleto#7326
we can all barely keep up with James, that must have been thousands of commits ago


[23-Aug-19 01:01 PM] siu#3920
well, it would be a nice way to run a full node at home while you access it using nspv


[23-Aug-19 01:02 PM] dukeleto#7326
errybody who wants a binary send a donation to jane and i bet a new binary just magically appears soon üôÇ


[23-Aug-19 01:02 PM] radix42#3743
RNxd81GvT1WPMmEu3uR1idQmHZ5gjXihb8


[23-Aug-19 01:03 PM] radix42#3743
is the nspv stuff is master yet or HSM or what?


[23-Aug-19 01:03 PM] dukeleto#7326
hmmm


[23-Aug-19 01:03 PM] dukeleto#7326
good question


[23-Aug-19 01:04 PM] siu#3920
Not master yet


[23-Aug-19 01:04 PM] dukeleto#7326
@radix42 you might just want to build from the FSM branch


[23-Aug-19 01:04 PM] radix42#3743
that's what I've been tracking


[23-Aug-19 01:04 PM] dukeleto#7326
yes, it's there


[23-Aug-19 01:04 PM] radix42#3743
had trouble with FSM sometimes on arm before


[23-Aug-19 01:04 PM] dukeleto#7326
HUSH merges FSM in to track KMD


[23-Aug-19 01:04 PM] dukeleto#7326
FSM has a mac compile error on it right now


[23-Aug-19 01:05 PM] dukeleto#7326
might effect arm too, but you can add `return("")` to the end of the offending function if that happens


[23-Aug-19 01:05 PM] siu#3920
TxID:
f7dc77cb5469dab054f742ecdb187bcf14dca5afdc547ac25f08f22cacf1f01d


[23-Aug-19 01:05 PM] radix42#3743
thanks!


[23-Aug-19 01:05 PM] siu#3920
Tip sent from libnspv from my android üòÅ


[23-Aug-19 01:06 PM] siu#3920
```[siu@rpi ~]$ ./komodo-cli getinfo
{
  "version": 2001526,
  "protocolversion": 170007,
  "KMDversion": "0.4.0a",
  "synced": false,
  "notarized": 0,
  "prevMoMheight": 0,
  "notarizedhash": "0000000000000000000000000000000000000000000000000000000000000000",
  "notarizedtxid": "0000000000000000000000000000000000000000000000000000000000000000",
  "notarizedtxid_height": "mempool",
  "notarized_confirms": 0,
  "walletversion": 60000,
  "interest": 0.00000000,
  "balance": 0.00000000,
  "blocks": 6806,
  "longestchain": 1500072,
  "timeoffset": 0,
  "tiptime": 1475287345,
  "connections": 2,
  "proxy": "",
  "difficulty": 1,
  "testnet": false,
  "keypoololdest": 1566590521,
  "keypoolsize": 101,
  "paytxfee": 0.00000000,
  "relayfee": 0.00000100,
  "errors": "",
  "name": "KMD",
  "sapling": -1,
  "p2pport": 7770,
  "rpcport": 7771
}
 "errors": "u```


[23-Aug-19 01:06 PM] dukeleto#7326
wow, drinking our own champagne already! that is classy


[23-Aug-19 01:06 PM] radix42#3743
awesome, thanks!


[23-Aug-19 01:06 PM] siu#3920
its working!


[23-Aug-19 01:06 PM] siu#3920
syncing


[23-Aug-19 01:06 PM] dukeleto#7326
@siu sheeeeeeeeet mang


[23-Aug-19 01:06 PM] dukeleto#7326
you done good


[23-Aug-19 01:06 PM] dukeleto#7326
probably the first time KMD has ever run on an rpi


[23-Aug-19 01:06 PM] siu#3920
see! you just need to ask the right people üòÇ


[23-Aug-19 01:06 PM] siu#3920
i think so, yes


[23-Aug-19 01:07 PM] dukeleto#7326
tweet that shit up


[23-Aug-19 01:07 PM] dukeleto#7326
"These KMD binaries are known to work on xxx on RPI4" is probably some good marketing to go somewhere, and also using superlite


[23-Aug-19 01:08 PM] dukeleto#7326
doubleplusgood


[23-Aug-19 01:08 PM] radix42#3743
pretty sure it is the first time


[23-Aug-19 01:09 PM] radix42#3743
mrlynch didn't get the right os on his when he tried


[23-Aug-19 01:09 PM] dukeleto#7326
@siu do you care if I do a screenshot and make you famous on teh twitterz?


[23-Aug-19 01:10 PM] dukeleto#7326
https://twitter.com/chainmakers is suspended, is there a new acct?

{Embed}
https://twitter.com/chainmakers
Twitter / Account Suspended
From breaking news and entertainment to sports and politics, get the full story with all the live commentary.
Twitter


[23-Aug-19 01:12 PM] siu#3920
https://twitter.com/kmdchainmakers/status/1164993639778590720

{Embed}
Chainmakers (@kmdchainmakers)
https://twitter.com/kmdchainmakers/status/1164993639778590720
Thanks to @radix42 implementation of @KomodoPlatform  on ARM arch, for the first time ever we have been able to run a zcash fork on a #raspberrypi4  using #aarch64 #manjaro https://t.co/otxPaRVZWI
#Komodo #Zcash #piratechain #RaspberryPi
Twitter


[23-Aug-19 01:13 PM] radix42#3743
I RT'd it üôÇ


[23-Aug-19 01:13 PM] siu#3920
Ok, so now its just a matter to merge the nspv code and you could run komodo on crappy HW with no disk space


[23-Aug-19 01:15 PM] radix42#3743
we ran libnspv on a 32 bit rpi3 already


[23-Aug-19 01:17 PM] siu#3920
yes, this runs easily, but no full node!


[23-Aug-19 01:17 PM] radix42#3743
i know i know


[23-Aug-19 01:17 PM] siu#3920
i hope it fits on my 32gb microSD


[23-Aug-19 01:18 PM] radix42#3743
my .komodo folder is 20gb

{Reactions}
üò¨ 

[23-Aug-19 01:19 PM] dukeleto#7326
@radix42 https://www.kmdexplorer.io/tx/e1ac244986cbe414c1188396f7a899ec916f67ac1f00e8a800bd641cc2fce99f


[23-Aug-19 01:20 PM] radix42#3743
danke!


[23-Aug-19 01:23 PM] dukeleto#7326
thanks for all the nice binaries


[23-Aug-19 01:23 PM] siu#3920
so far its running quite well


[23-Aug-19 01:23 PM] siu#3920
using less than 1gb of ram


[23-Aug-19 01:26 PM] radix42#3743
doesn't take too much


[23-Aug-19 01:26 PM] radix42#3743
to sync kmd


[23-Aug-19 01:29 PM] siu#3920
Here in the jungle it does take a bit more üòÇ


[23-Aug-19 01:32 PM] dukeleto#7326
@siu make a shielded xtn on that fucker


[23-Aug-19 01:32 PM] siu#3920
i need to wait for it to sync first


[23-Aug-19 01:33 PM] siu#3920
ill leave it here over the weekend, on monday ill do it.


[23-Aug-19 01:33 PM] dukeleto#7326
ya, you do


[23-Aug-19 01:34 PM] siu#3920
i hope it doesnt burn itself over the weekend ;p


[23-Aug-19 01:36 PM] dukeleto#7326
@siu if it has a case that can be opened or removed, do that


[23-Aug-19 01:37 PM] siu#3920
i just ordered the case this week, still waiting for it to arrive


[23-Aug-19 01:37 PM] siu#3920
the case i bought even has a little fan to cool the cpu


[23-Aug-19 01:39 PM] radix42#3743
ah if its open air right now it should be fine to sync for cooling


[23-Aug-19 01:40 PM] dukeleto#7326
ya, open air is best üòÖ


[23-Aug-19 01:52 PM] radix42#3743
gtg, need to buy cat litter, it is a dire situation

{Reactions}
üò¨ 

[24-Aug-19 11:21 AM] Regnar#6164
https://i.imgur.com/XzCKXVM.png

{Embed}
https://imgur.com/XzCKXVM
https://images-ext-1.discordapp.net/external/z4eUG810WVkJRs-RCjFh-Zxz5aGjIE4BnP3VPEqUpv8/https/i.imgur.com/XzCKXVM.png


[24-Aug-19 11:24 AM] Regnar#6164
it's been a lot of fun working on this GUI for the nSPV pywallet TonyL built. I just added some tabs to reduce clutter on screen, an active theme changer, and an address book which lets you add and delete a name to address in app that gets stored to a CSV file and loads it in when you start the GUI.

{Reactions}
üî• (3) 

[24-Aug-19 11:54 AM] dukeleto#7326
lookin' good

{Reactions}
üëç 

[24-Aug-19 12:25 PM] TonyL#3577
Looks great! Will test a little and merge then. Also gonna make it work not only with komodod nspv but with libnspv to bring new live into this light wallet üòÉ


[24-Aug-19 01:20 PM] dimxy#2587
found what was the problem in building libnspv on termux:
in libnspv/src/tools/cryptoconditions/src/include/secp256k1/Makefile.am there is unconditionally set -march=x86 option that breaks the compilation on termux @jl777c


[24-Aug-19 01:20 PM] jl777c#5810
good news! can you make a PR that fixes this?


[24-Aug-19 01:23 PM] dimxy#2587
ok


[24-Aug-19 02:34 PM] Regnar#6164
I added a neater address book for that GUI (was just displaying Python dictionary, now it is a table), you can click a contact in the address book and it prefills the "send to address" field. It also has multiple themes you can change on the fly and it will save your theme so you don't have to keep changing it on start up.

{Reactions}
üöÄ (2) 

[25-Aug-19 03:39 PM] Deleted User#0000
https://github.com/jl777/libnspv/pull/112/files
Fixed the bandwidth issue with this pull request. 
Should be able to make verified txns off chain tip now I think. Although I would need to implement it.

{Embed}
https://github.com/jl777/libnspv/pull/112/files
fix bandwidth for sync of chain tip by blackjok3rtt ¬∑ Pull Reques...
Changes rpc of getpeerinfo to show the last validated header height rather than is_synced.
https://images-ext-2.discordapp.net/external/H9TDr69kM7mmxGBcENY3FInyORgkC6up-3NZ7sRUihU/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/30971146


[26-Aug-19 12:46 AM] Deleted User#0000
Not quite right still. üò¶ Still wokring on it.


[26-Aug-19 12:47 AM] jl777c#5810
@Deleted User thanks!
i noticed you got rid of the bestknownheight field, but for the html display it is needed. i also made a NSPV_longestchain global to use, but i am not sure if i am setting it correctly. it also seems that the last_validated_header is very rarely set


[26-Aug-19 12:47 AM] jl777c#5810
ok, it does seem it is better, but still not quite right.


[26-Aug-19 12:48 AM] Deleted User#0000
I didnt get rid of it, it just was not updating for me, so i removed it form RPC. Np to put back


[26-Aug-19 12:48 AM] jl777c#5810
i set the bestknownheight to just the highest reported height


[26-Aug-19 12:48 AM] Deleted User#0000
yes still not right. I have a new version in testing right now


[26-Aug-19 12:48 AM] jl777c#5810
and using the last_validated_header as the in sync version


[26-Aug-19 12:49 AM] Deleted User#0000
It seems also that some nodes that show as conencted do not respond... And never seemt o update anything...


[26-Aug-19 12:50 AM] jl777c#5810
it also seems that there is no need to get all headers from a node, if we know the latest validated header from any node, then couldnt we just request that header from another node and if it returns the same, then assume the earlier ones are ok?


[26-Aug-19 12:50 AM] Deleted User#0000
Yes. this is how its working


[26-Aug-19 12:51 AM] Deleted User#0000
It fetches quickly until it has all the headers that link back to the last notarization.


[26-Aug-19 12:51 AM] Deleted User#0000
then slows down to 1 node at a time.


[26-Aug-19 12:51 AM] jl777c#5810
ok, bandwidth is indeed much reduced


[26-Aug-19 12:51 AM] Deleted User#0000
yes, but my code is buggy still./ Hopefulyl wont take too much longer :abusedsmily:


[26-Aug-19 12:55 AM] jl777c#5810
@Sir Seven it seems that after a while some fullnodes go non-responsive. can you stress test a node to see if you can reliably reproduce this state on a small chain like ILN


[26-Aug-19 01:50 AM] Deleted User#0000
`https://github.com/jl777/libnspv/pull/113/files` 
This is better. I find that it eventually only gets data from node 1 after while.. Other nodes are being sent requests, but do not respond. Have a few ideas, to mess with later on.


[26-Aug-19 02:25 AM] jl777c#5810
@Deleted User it is strange that it isnt talking to more than a few nodes... before these changes, it was talking to all of them


[26-Aug-19 02:26 AM] jl777c#5810
i also see cases where bestknownheight is less than the "in sync" height, which seems a bit strange and not sure how that could happen


[26-Aug-19 02:31 AM] Deleted User#0000
To slow it down, I had to slow it down... This means that it is no longer, polling every peer for the same block height every time.


[26-Aug-19 02:33 AM] Deleted User#0000
Once it has enough headers to match back to chain tip, the last height it saw from each node that is a valid header (links back to last notarization) is saved.. Maybe we need to speed it up a little more, Although they all do eventually end up quite close. 
My bestknownheight is still gettting stuck.. 
```{
    "nodeid": 6,
    "protocolversion": 3,
    "ipaddress": "136.243.58.134",
    "port": 7770,
    "lastping": 1566811951,
    "time_started_con": 1566809171,
    "time_last_request": 1566811978,
    "services": 1879048197,
    "missbehavescore": 0,
    "bestknownheight": 1503652,
    "last_validated_header": 1503714
  }
```
This is why I commented it out earlier.


[26-Aug-19 02:34 AM] Deleted User#0000
ALso I have left my KMD nSPV ndoe running a while and ti is now talking to all peers. Will do some investigation on this see what I can work out.


[26-Aug-19 02:34 AM] Deleted User#0000
Seems an  intermittent  problem


[26-Aug-19 02:42 AM] TonyL#3577
@Sir Seven feel free to consult me on stress test matter - there is ready scripts for spam


[26-Aug-19 02:43 AM] Deleted User#0000
I think there needs to be some way to detect if a node has responded to a request. This will make things much easier.


[26-Aug-19 02:44 AM] Deleted User#0000
Currently it must loop from notarization height  forwards to chain tip, but if a node does not respond, it must go back and fetch this header from another node. This seems to at times take many attempts.


[26-Aug-19 02:44 AM] Deleted User#0000
The new logic that checks block heights are cached, helps a lot but its still doing undefined weird things.


[26-Aug-19 02:46 AM] Deleted User#0000
Also by slowing things down like this, it may lose some of its reorg handling.... Not too sure, need to test that.


[26-Aug-19 02:51 AM] Sir Seven#7158
@jl777c @TonyL Got it. Full node I've set for tests works fine for pretty much a week now, it might be a problem with libnspv stopping connection to the full node.
Well, just a few thoughts.


[26-Aug-19 02:53 AM] jl777c#5810
@Deleted User maybe just have all incoming packets update a last responded timestamp, then you can check that to see how active a node is. it feels like you are pruning away most of the nodes and only talking to one. maybe a bit of randomization in node selection?


[26-Aug-19 02:53 AM] Deleted User#0000
The timer is set for each node.


[26-Aug-19 02:53 AM] Deleted User#0000
I think I know whats going on, just have to mess with it longer


[26-Aug-19 02:54 AM] jl777c#5810
on the plus side, the bandwidth used is way down!


[26-Aug-19 02:54 AM] Deleted User#0000
Yes maybe too much lol.


[26-Aug-19 02:55 AM] Deleted User#0000
I am not actualky bannign any nodes so far, but I do want to try to make it try to find new peers, when one is not responding.


[26-Aug-19 02:56 AM] Deleted User#0000
If the lastvalidated height has not updated in a long time, I can try to force requests to that node, then if it fails to respond, drop it and try to add a new one.. 
Also may make th ban clear after some time, so it doesnt end up banning too many nodes permenantly.


[26-Aug-19 02:57 AM] Deleted User#0000
Seems to me that getting a reliable set of peers will solve most of the edge case bugs.


[26-Aug-19 02:59 AM] jl777c#5810
all the active nodes were responding using the old bruteforce method


[26-Aug-19 03:00 AM] Deleted User#0000
yes, they are rsp[onding for me now also.... its only sometimes... maybe its something i changed not sure.. Will try to sort it.


[26-Aug-19 03:03 AM] Deleted User#0000
Before the way it worked, was to poll every node for the same block height at the same time...
I have changed it so each nodes counter/timer is seperate with a random delay... so it only polls one at  a time.


[26-Aug-19 03:04 AM] Deleted User#0000
This is used by the libbtc code, but was disabled for ours... Maybe the 2 are not playing nicely together and I need to rethink how to do it.


[26-Aug-19 03:12 AM] jl777c#5810
ok. it does seem the issue is algorithmic and not networking related


[26-Aug-19 03:18 AM] Deleted User#0000
yes agree


[26-Aug-19 03:58 AM] Deleted User#0000
Might have found it... Just a matter of tuning the delay now so that it does not go so fast.


[26-Aug-19 05:13 AM] jl777c#5810
libnspv html wallet is now localizable into different languages. we just need a file in the same format at ~/libnspv/html/languages/english.json
we need at least the following languages: french, italian, chinese, chinese simplified, japanese, korean, russian and spanish.
those are the languages with seed words. however, the html can support basically any language, just need the language.json file

{Reactions}
üî• (2) üëÜ üóæ üÜó KMD (3) 

[26-Aug-19 05:16 AM] Mylo#8306
does libnspv use keepalive packets in it's protocol?


[26-Aug-19 05:16 AM] Deleted User#0000
@CrisF  japanese ?

{Reactions}
üëç 

[26-Aug-19 05:16 AM] jl777c#5810
@Mylo it does send regular ping messages, it is a normal bitcoin protocol peer


[26-Aug-19 05:17 AM] Mylo#8306
ok cool thanks!


[26-Aug-19 05:22 AM] Tylor zkFS#8280
Muy bueno....Domo arigoto


[26-Aug-19 05:29 AM] CrisF#3405
@Deleted User, will check.
Where should I look for `~/libnspv/html/languages/english.json`


[26-Aug-19 05:31 AM] Deleted User#0000
https://github.com/jl777/libnspv/blob/jl777/html/languages/english.json

{Embed}
https://github.com/jl777/libnspv/blob/jl777/html/languages/english.json
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559

{Reactions}
üôè 3040_kingpeepo (2) 

[26-Aug-19 05:34 AM] CrisF#3405
Ok, I'll sort out the Japanese. üáØüáµ

{Reactions}
üëç 

[26-Aug-19 06:00 AM] CrisF#3405
Just having a look at it and have a question:
Should this text be `previous` or `private`?
https://github.com/jl777/libnspv/blob/fe6e9dc3d74ae2be45f144dd4e6e372f10449d60/html/languages/english.json#L112

{Embed}
https://github.com/jl777/libnspv/blob/fe6e9dc3d74ae2be45f144dd4e6e372f10449d60/html/languages/english.json
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[26-Aug-19 06:01 AM] Deleted User#0000
@CrisF  previous


[26-Aug-19 06:01 AM] grewalsatinder#9653
Previous

{Reactions}
üëç 

[26-Aug-19 06:03 AM] Deleted User#0000
@jl777c  I think I sorted it. üôÇ


[26-Aug-19 06:03 AM] Deleted User#0000
Your change to longest chain is good too, solves display issues


[26-Aug-19 06:04 AM] CrisF#3405
Ok, thanks üëç


[26-Aug-19 06:07 AM] jl777c#5810
hindi is now supported and seems to work, at least everything is in incomprehensible scribbles to me with hindi


[26-Aug-19 06:08 AM] jl777c#5810
you can select a language on startup with -l=hindi


[26-Aug-19 06:18 AM] jl777c#5810
now, all the current languages has its corresponding .json file in the html/languages dir, just need to edit the english text into the target language


[26-Aug-19 06:20 AM] Deleted User#0000
The NSPV_longestchain, should that just be the highest height, or a validated height? That links back?


[26-Aug-19 06:20 AM] Deleted User#0000
not sure it matters, as it also has validated header


[26-Aug-19 06:20 AM] jl777c#5810
validated is probably better


[26-Aug-19 06:21 AM] Deleted User#0000
ok. takes about 5mins to sync KMD for me after start...Doesnt seem too bad. Will make PR soon.


[26-Aug-19 06:22 AM] jl777c#5810
@CMaurice jl777 branch should now work with android. can you confirm?


[26-Aug-19 06:38 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/120

{Embed}
https://github.com/jl777/libnspv/pull/120
hindi language update by satindergrewal ¬∑ Pull Request #120 ¬∑ jl...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[26-Aug-19 06:38 AM] grewalsatinder#9653
hindi language file is fully translated.


[26-Aug-19 06:52 AM] CMaurice#1685
can confirm `./onetime' builds jl777 branch from a fresh clone


[26-Aug-19 06:52 AM] CMaurice#1685
and the html is served @jl777c


[26-Aug-19 06:53 AM] CMaurice#1685
lots of things to try later , looks amazing

{Reactions}
üíØ (2) 

[26-Aug-19 07:16 AM] CMaurice#1685
heh, didn't think to just remove the -march flag


[26-Aug-19 07:44 AM] grewalsatinder#9653
https://github.com/jl777/libnspv/pull/121

{Embed}
https://github.com/jl777/libnspv/pull/121
hindi language fix by satindergrewal ¬∑ Pull Request #121 ¬∑ jl777...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[26-Aug-19 08:51 AM] Deleted User#0000
@grewalsatinder  @jl777c  
When I try to use the HTML wallet with firefix, it is crashing my nSPV daemon on login.


[26-Aug-19 08:51 AM] Deleted User#0000
Preints somethingabout  jpeg  pulls listunspent then crashes.


[26-Aug-19 08:55 AM] grewalsatinder#9653
yes, I got that too


[26-Aug-19 08:55 AM] grewalsatinder#9653
```
got utxos response 78.47.196.146:7770 1566834900 size.97 numtxos.0
nspv(22837,0x700000c0e000) malloc: Incorrect checksum for freed object 0x7fed32005200: probably modified after being freed.
Corrupt value: 0x3662306431623365
nspv(22837,0x700000c0e000) malloc: *** set a breakpoint in malloc_error_break to debug
Abort trap: 6
```


[26-Aug-19 08:57 AM] Deleted User#0000
https://imgur.com/JR8XQ7i.png

{Embed}
https://imgur.com/JR8XQ7i
Screenshot
https://images-ext-2.discordapp.net/external/aexGVk2msQqWDQlAw_R2tg2Rhipx-rdqOCN9F5WJAT4/https/i.imgur.com/JR8XQ7i.png


[26-Aug-19 09:08 AM] jl777c#5810
let me disable the jpg stufff


[26-Aug-19 09:09 AM] jl777c#5810
that should stop the crashing


[26-Aug-19 09:10 AM] Deleted User#0000
ok thanks. The html wallet looks nice btw @grewalsatinder  
Very cool

{Reactions}
üëç 

[26-Aug-19 09:10 AM] jl777c#5810
ok try now


[26-Aug-19 09:10 AM] grewalsatinder#9653
thanks @Deleted User üôÇ


[26-Aug-19 09:13 AM] grewalsatinder#9653
help translate nSPV to other languages please:
https://github.com/jl777/libnspv/tree/jl777/html/languages


[26-Aug-19 09:13 AM] grewalsatinder#9653
as many as possible


[26-Aug-19 09:15 AM] Deleted User#0000
@jl777c  Seems working now. üôÇ Will amke PR in nexzt few hours with fixed sync, still trying to find optimal rate of polling nodes to keep syncwhile not over doing it.


[26-Aug-19 09:17 AM] Sir Seven#7158
Getting random crashes working with html wallet in browser.
Same backtrace:
https://paste.ubuntu.com/p/GjQsmrGXGf/

Just like moving from Wallet to Info to Peers pages. Can't get set 100% way to reproduce.


[26-Aug-19 09:18 AM] jl777c#5810
thats in the periodic polling code. maybe some mutex are needed, looks like jokrs new code


[26-Aug-19 09:18 AM] Deleted User#0000
I have fix ready, can push now if needed to test it


[26-Aug-19 09:18 AM] Deleted User#0000
Mine is working fine


[26-Aug-19 09:19 AM] Sir Seven#7158
Oh, ok. Push it when ready then.


[26-Aug-19 09:19 AM] Deleted User#0000
ok


[26-Aug-19 09:20 AM] Sir Seven#7158
Didn't get how to switch html wallet lang. Parameter should be passed at nspv start or as parameter in browser(AE `&l=language`)?


[26-Aug-19 09:22 AM] Deleted User#0000
https://github.com/jl777/libnspv/pull/122
This is syncing KMD for me in about 130s after start... But may still be a little heavy on bandwidth, once synced

{Embed}
https://github.com/jl777/libnspv/pull/122
fix sync better by blackjok3rtt ¬∑ Pull Request #122 ¬∑ jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[26-Aug-19 09:22 AM] grewalsatinder#9653
@Sir Seven from Account page can change to any wallet language


[26-Aug-19 09:22 AM] grewalsatinder#9653
or can be used at start like `./nspv KMD -l=hindi`


[26-Aug-19 09:23 AM] grewalsatinder#9653
the name of the language file (without .json)


[26-Aug-19 09:26 AM] jl777c#5810
yes, the idea is that whatever installer would default to the systems language with the -l=<language> parameter


[26-Aug-19 09:26 AM] jl777c#5810
but from the Account page (after login) you can change the language


[26-Aug-19 09:27 AM] jl777c#5810
@Sir Seven merged latest pull 122


[26-Aug-19 09:30 AM] Deleted User#0000
doenst stop random crashes... Found a few issues.attempting fix


[26-Aug-19 09:31 AM] Deleted User#0000
double frees... in multiple places. Shouldnt be too hard to fix.


[26-Aug-19 09:31 AM] Deleted User#0000
:abusedsmily:


[26-Aug-19 09:34 AM] Sir Seven#7158
Yep, keeps on crashing after pull.


[26-Aug-19 09:35 AM] Deleted User#0000
there are multiple issues... probably isnt something I can fix in 5 mins...


[26-Aug-19 09:35 AM] Deleted User#0000
I will try though


[26-Aug-19 09:49 AM] Sir Seven#7158
Small issues with html wallet and localization:
1. Probably a typo with NOTARI_TXID_HEIGHT:


[26-Aug-19 09:49 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615588569360236580/unknown.png


[26-Aug-19 09:49 AM] Sir Seven#7158

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615588677346787328/unknown.png


[26-Aug-19 09:58 AM] Sir Seven#7158
2. Language selector has default option in dropdown, like
Select Language:
- select language
- english
-etc


[26-Aug-19 10:21 AM] jl777c#5810
1. as long as it is consistently uses the exact $variable name is not so important


[26-Aug-19 10:21 AM] jl777c#5810
2. not sure what you mean


[26-Aug-19 12:34 PM] grewalsatinder#9653
https://github.com/jl777/libnspv/pull/123

{Embed}
https://github.com/jl777/libnspv/pull/123
Jl777 by satindergrewal ¬∑ Pull Request #123 ¬∑ jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[26-Aug-19 12:34 PM] grewalsatinder#9653
@jl777c @Sir Seven pushed fix


[26-Aug-19 12:35 PM] grewalsatinder#9653
@Sir Seven renamed NOTARI_TXID_HEIGHT to NOTARI_TX_ID_HEIGHT in language json


[26-Aug-19 12:38 PM] jl777c#5810
i dont understand


[26-Aug-19 12:38 PM] jl777c#5810
why is it changed?


[26-Aug-19 12:38 PM] jl777c#5810
NOTARY_TXID_HEIGHT might make a bit more sense, but like i wrote above, there is no need to do this.


[26-Aug-19 12:40 PM] jl777c#5810
@Deleted User it seems much better, but the bandwidth usage is probably a bit too high. also, it doesnt update the "In Sync" column on the peers page, i was thinking that would be for validated height for a node


[26-Aug-19 12:42 PM] Deleted User#0000
@jl777c  will fix tomorrow. Yes bandwidth can be reduced further... just trying to work out the best way to do it still. Liekly what I have will work with some diffrent numbers.


[26-Aug-19 12:46 PM] grewalsatinder#9653
```{ "NOTARI_TXID": "Notarized Txid" },
            { "NOTARI_TXID_HEIGHT": "Notarization Txid Height" },```


[26-Aug-19 12:46 PM] grewalsatinder#9653
so instead of showing "Notarization Destination Txid" the page is now showing "Notarized Txid_HEIGHT"


[26-Aug-19 12:47 PM] grewalsatinder#9653
@jl777c what you want me to do to fix it?


[26-Aug-19 12:48 PM] jl777c#5810
what is the bug we are trying to fix?


[26-Aug-19 12:49 PM] jl777c#5810
doesnt it work now?


[26-Aug-19 12:49 PM] grewalsatinder#9653
so instead of showing "Notarization Destination Txid" the page is now showing "Notarized Txid_HEIGHT"


[26-Aug-19 12:49 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615634033195483250/Screen_Shot_2019-08-27_at_7.49.31_AM.png


[26-Aug-19 12:50 PM] grewalsatinder#9653
I changed it back in local files and you can see the highlited text with `_`


[26-Aug-19 12:50 PM] jl777c#5810
but it is currently showing the right info, isnt it?


[26-Aug-19 12:51 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615634451053019175/Screen_Shot_2019-08-27_at_7.51.22_AM.png


[26-Aug-19 12:51 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615634526135124001/Screen_Shot_2019-08-27_at_7.51.38_AM.png


[26-Aug-19 12:52 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615634589263855658/Screen_Shot_2019-08-27_at_7.51.54_AM.png


[26-Aug-19 12:52 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615634714123960329/Screen_Shot_2019-08-27_at_7.52.23_AM.png


[26-Aug-19 12:52 PM] grewalsatinder#9653

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/615634777906872343/Screen_Shot_2019-08-27_at_7.52.39_AM.png


[26-Aug-19 12:52 PM] grewalsatinder#9653
nope


[26-Aug-19 12:54 PM] jl777c#5810
what should it display?


[26-Aug-19 12:54 PM] grewalsatinder#9653
Notarization Txid Height


[26-Aug-19 12:54 PM] jl777c#5810
how does changing $NOTARI_TXID_HEIGHT -> $NOTARI_TX_ID_HEIGHT fix it?


[26-Aug-19 12:55 PM] grewalsatinder#9653
that's without Underscore and the whole word "HEIGHT" is not upper case, just the "H" letter of the word "Height" is uppercase.


[26-Aug-19 12:56 PM] jl777c#5810
ok, i understand that, but your pull request only changed the variable name


[26-Aug-19 12:56 PM] jl777c#5810
which doesnt affect what is displayed


[26-Aug-19 12:56 PM] grewalsatinder#9653
"NOTARI_TXID" json key was conflicting with "NOTARI_TXID_HEIGHT" json key.


[26-Aug-19 12:56 PM] grewalsatinder#9653
putting "NOTARI_TXID"'s value for "NOTARI_TXID_HEIGHT" and just printing "_HEIGHT".


[26-Aug-19 12:56 PM] jl777c#5810
to fix that, put the longer variable name first


[26-Aug-19 12:57 PM] jl777c#5810
in the english.json file


[26-Aug-19 12:57 PM] jl777c#5810
put the NOTARI_TXID_HEIGHT before NOTARI_TXID


[26-Aug-19 12:57 PM] grewalsatinder#9653
okay, let me try


[26-Aug-19 12:58 PM] grewalsatinder#9653
yes that worked!


[26-Aug-19 12:59 PM] grewalsatinder#9653
thanks, pushing this change


[26-Aug-19 01:03 PM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/124

{Embed}
https://github.com/jl777/libnspv/pull/124
moved NOTARI_TXID_HEIGHT key above NOTARI_TXID to fix var conflict...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[26-Aug-19 01:04 PM] grewalsatinder#9653
thanks James üôÇ


[26-Aug-19 03:50 PM] dukeleto#7326
what is the status of an android-based nSPV wallet?


[26-Aug-19 04:01 PM] Deleted User#0000
works


[26-Aug-19 04:01 PM] Deleted User#0000
@CMaurice


[26-Aug-19 04:09 PM] CMaurice#1685
Yep, jl777 branch is bleeding edge, has some functionality I'm not sure of the dev stage cf. Desktop, but logging in with wif fine, assume send and receive the same. Dev branch iirc is near stable and was working fine last I tried


[26-Aug-19 06:11 PM] Regnar#6164
Added some prices, 24 hour changes, and balance calculations


[26-Aug-19 06:11 PM] Regnar#6164
https://i.imgur.com/bP3QQrz.png

{Embed}
https://imgur.com/bP3QQrz
https://images-ext-1.discordapp.net/external/LU3S2bZ7MFBv_bcQyuph59WL-S0BCJXgeBHs13Lxg0E/https/i.imgur.com/bP3QQrz.png


[26-Aug-19 06:11 PM] Regnar#6164
oh and also some alternative currency valuation support
https://i.imgur.com/eUT7uaE.png

{Embed}
https://imgur.com/eUT7uaE
https://images-ext-2.discordapp.net/external/gdxQRw5_-lTXZHatAD17yrZkGete_TGnUSlwPW0N94c/https/i.imgur.com/eUT7uaE.png


[26-Aug-19 06:13 PM] Regnar#6164
the pywallet app is officially 500 lines of code... üòÖ

{Reactions}
‚ô• 3040_kingpeepo (5) 

[27-Aug-19 01:09 AM] jl777c#5810
@Sir Seven can you make a set of screenshots for translators, so they can see the GUI pages and the context of what needs to be translated


[27-Aug-19 01:13 AM] jl777c#5810
and maybe this can become a graphical documentation of the html wallet

{Reactions}
üôè 

[27-Aug-19 03:04 AM] Mihailo#5902
@jl777c @siu @gcharang @dukeleto Hey guys, would you be kind to summarize what stuff needs to be fixed or refactored for CC in nSPV mode so I don't have to look too much in history of the channel?


[27-Aug-19 03:13 AM] jl777c#5810
everything


[27-Aug-19 03:13 AM] jl777c#5810
there is no CC support at all right now


[27-Aug-19 03:14 AM] jl777c#5810
there is libcryptoconditions linked in and ready to be used


[27-Aug-19 03:15 AM] jl777c#5810
libnspv does normal transactions


[27-Aug-19 04:01 AM] dukeleto#7326
see above


[27-Aug-19 04:04 AM] siu#3920
@Mihailo i would recommend starting with integrating dice cc calls üòÅ


[27-Aug-19 04:05 AM] siu#3920
Since it would help on getting light dice games dapps


[27-Aug-19 04:07 AM] Mihailo#5902
Ah ok, I meant as you mentioned me on several things last two weeks just to have them on one place. Never mind, I'm on some CCnSPV stuff that I started and will check every CC (one by one) if it works and what needs to be done


[27-Aug-19 04:11 AM] siu#3920
I tried a couple of calls a week or so ago but nothing really worked


[27-Aug-19 04:11 AM] siu#3920
Some got stuck, others responded empty output


[27-Aug-19 04:13 AM] Mihailo#5902
I first fixed the CC calls on CCs I worked on as I know them the best. So you could try channels,gateways,oracles...


[27-Aug-19 04:13 AM] Mihailo#5902
They should be working, except the [cc]list rpc as I'm working on that now.


[27-Aug-19 04:14 AM] siu#3920
Oh ok, will give it a try then


[27-Aug-19 05:10 AM] Sir Seven#7158
@jl777c Finishing Russian translation atm. Will make screenshots after PR.


[27-Aug-19 07:25 AM] Deleted User#0000
https://github.com/jl777/libnspv/pull/126
Fixed crashes

{Embed}
https://github.com/jl777/libnspv/pull/126
fix random crashes by blackjok3rtt ¬∑ Pull Request #126 ¬∑ jl777/l...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[27-Aug-19 07:25 AM] Deleted User#0000
@jl777c


[27-Aug-19 07:28 AM] Deleted User#0000
I had to use valgrind on it... Wasnt a simple process... Bit seems to now be ok. Ive been sitting here just fetching txproofs for ages now and its not crashing. Still need to reduce bandwidth a bit more, but crash was more imporant.


[27-Aug-19 08:40 AM] dukeleto#7326
@Deleted User elite points for valgrind usage


[27-Aug-19 08:41 AM] Deleted User#0000
its easy a pie on nSPV


[27-Aug-19 08:41 AM] Deleted User#0000
there are no mem leaks


[27-Aug-19 08:41 AM] Deleted User#0000
or there is no longer any


[27-Aug-19 08:41 AM] dukeleto#7326
best time to run valgrind is on new codebases


[27-Aug-19 08:41 AM] Deleted User#0000
There were a bunch of calloc that were not setting enough buffer...


[27-Aug-19 08:42 AM] Deleted User#0000
so it over ran and corruped the heap.


[27-Aug-19 08:43 AM] dukeleto#7326
this is why Rust exists


[27-Aug-19 08:46 AM] Deleted User#0000
yes. I guess so... but nSPV is in C... so have to use what got


[27-Aug-19 09:20 PM] denio#8067
i did a pull request for german.json ,if you need this üëç

{Reactions}
üëç 

[28-Aug-19 01:10 AM] jl777c#5810
thanks! its merged. you can test it by launching ./nspv -l=german


[28-Aug-19 01:11 AM] jl777c#5810
also on the account page, it is in the dropdown for languages, but need the german word for the german language


[28-Aug-19 01:12 AM] denio#8067
german word for the german language is  "Deutsch"


[28-Aug-19 01:15 AM] jl777c#5810
fixed!


[28-Aug-19 01:15 AM] jl777c#5810
what is your KMD address, i will send a bounty


[28-Aug-19 01:17 AM] denio#8067
RBXmQGHj51iYe7C3PaeJh3MTSvByn6u7g1  But a better bounty is: Sign-up for the Hush csgo Tournament üòâ


[28-Aug-19 01:19 AM] jl777c#5810
sent


[28-Aug-19 01:19 AM] denio#8067
wow....ty @jl777c !

{Reactions}
üëç 

[28-Aug-19 04:08 AM] Mihailo#5902
@jl777c Why do nSPV node need sometime before it start working? Even normal nodes need some time before they relay transactions to each other. I noticed that like half a year ago it was better - it started relaying txs very soon from start but at some point it got longer. When I start superlite nspv node it needs few minutes before it can receive response from full node.


[28-Aug-19 04:08 AM] Mihailo#5902
Every time I change something and I want to try I need to wait some time before I can check...


[28-Aug-19 04:08 AM] Mihailo#5902
This is in case of 2 nodes!


[28-Aug-19 04:30 AM] jl777c#5810
you shouldnt need to wait more than a second


[28-Aug-19 05:52 AM] Sir Seven#7158
@Deleted User  After random crashes fix, getting reliably this one:
https://paste.ubuntu.com/p/JKwZtn7XWz/
`4028    malloc.c: No such file or directory.`
^^ quite strange.

You just need to log in, go to wallet html page and press Update Transaction History.

UPD:
Same scenario, different backtrace:
https://paste.ubuntu.com/p/VQxHrncsBh/


[28-Aug-19 06:00 AM] Sir Seven#7158 (pinned)
https://drive.google.com/drive/folders/1ZvzrhNBQgroejTKPl0kCOTJ8h7XMnO2M?usp=sharing
^^ Folder with wallet screenshots.
default screens are in english
and values screens show json variables to help with translations

{Reactions}
üî• üôá 

[28-Aug-19 06:08 AM] Sir Seven#7158
@TonyL I think you might pin message above.


[28-Aug-19 06:22 AM] jl777c#5810
Pinned a message.


[28-Aug-19 06:48 AM] Deleted User#0000
No worries will check this soon. üôÇ Thanks


[28-Aug-19 06:50 AM] Deleted User#0000
Just fixing the sync bandwidth. Nearly done.


[28-Aug-19 06:58 AM] Sir Seven#7158
PR Russian translation
https://github.com/jl777/libnspv/pull/128

@Deleted User There are two different crashes with similair scenario atm:
Updating mempoll transactions on Wallet page
And updating Transaction history.


[28-Aug-19 06:59 AM] Deleted User#0000
Weird... That was crashing for me every time before... So I fixed the crash on my system and broke it on yours üòÇ


[28-Aug-19 06:59 AM] Sir Seven#7158
Is image + password log in implemented now?
Or its in WIP status, so shouldn't bother?


[28-Aug-19 06:59 AM] Deleted User#0000
It was disabled.


[28-Aug-19 07:00 AM] Sir Seven#7158
Got it.


[28-Aug-19 07:00 AM] Deleted User#0000
I will enable it again once crashes are sorted out.


[28-Aug-19 07:00 AM] Deleted User#0000
opnce thing at a time.. or it gets too difficult


[28-Aug-19 07:00 AM] Sir Seven#7158
There are UI problems with it, guess should check after it is enabled again.


[28-Aug-19 07:01 AM] Deleted User#0000
yes, james disabled it to try a fast fix for the crashes... but the crashes were not from that.


[28-Aug-19 07:05 AM] jl777c#5810
too many UX issues with .jpg files


[28-Aug-19 07:06 AM] jl777c#5810
disabled semi-permanent, cant get the full path for the user selected file without javascript


[28-Aug-19 07:06 AM] Deleted User#0000
ah ok. so just leave it as 0 then?


[28-Aug-19 07:07 AM] jl777c#5810
yes, dont reenable it. it is still in the html, just hidden


[28-Aug-19 07:08 AM] siu#3920
@Mihailo which repo/branch you recommend to test your nspv integrations?


[28-Aug-19 07:11 AM] jl777c#5810
@grewalsatinder the .jpg form reappeared... must have messed it up with a merge


[28-Aug-19 07:12 AM] Sir Seven#7158
@jl777c >>yes, dont reenable it. it is still in the html, just hidden

There are situations when it pop-ups and breaks stuff a bit.
Will contact Satinder on it.


[28-Aug-19 07:14 AM] Mihailo#5902
@siu Use JLs nSPV branch as I PR stuff when I finish them


[28-Aug-19 07:15 AM] siu#3920
ok, luckyly that is what i just compiled


[28-Aug-19 07:15 AM] siu#3920
so i can test channels?


[28-Aug-19 07:16 AM] siu#3920
ok, first confusion


[28-Aug-19 07:16 AM] siu#3920
i just did nspv_login


[28-Aug-19 07:16 AM] Mihailo#5902
Yeah, I think it should work. If not, let me know what doesn't work


[28-Aug-19 07:16 AM] siu#3920
and when executing channelslist i get ``` ./komodo-cli channelslist
error code: -1
error message:
to use CC contracts you need to nspv_login first

```


[28-Aug-19 07:17 AM] Mihailo#5902
Have you done login recent, because it expires in 777 seconds


[28-Aug-19 07:17 AM] siu#3920
oh, wait... i guess i need to do use some test chain, im running KMD ü§¶


[28-Aug-19 07:17 AM] Mihailo#5902
Hahahah


[28-Aug-19 07:18 AM] siu#3920
```./komodo-cli -ac_name=NSPV channelslist
{
  "result": "success",
  "name": "Channels List"
}
```


[28-Aug-19 07:19 AM] siu#3920
ok, i guess there is some progress


[28-Aug-19 07:19 AM] siu#3920
no actual list tho


[28-Aug-19 07:19 AM] Mihailo#5902
Yes, that is in progress


[28-Aug-19 07:19 AM] Mihailo#5902
Right now


[28-Aug-19 07:20 AM] siu#3920
can you send me some NSPV?


[28-Aug-19 07:21 AM] siu#3920
RDGVBu3J9M1x2cXPB8MgX9S1Fbkq6FWzvc


[28-Aug-19 07:24 AM] grewalsatinder#9653
@jl777c I merged latest changes from your jl777 branch to mine. couldn't replicate the issue, after trying different steps.


[28-Aug-19 07:25 AM] jl777c#5810
@siu what is the mining diff for NSPV?


[28-Aug-19 07:25 AM] jl777c#5810
change language


[28-Aug-19 07:26 AM] grewalsatinder#9653
gonna check jl777 repo jl777 branch with fresh clone just to make sure.


[28-Aug-19 07:30 AM] grewalsatinder#9653
@jl777c üòÑ I see those changes are not merged to yours... weird  üòÑ


[28-Aug-19 07:30 AM] grewalsatinder#9653
I remember I did PR ü§î


[28-Aug-19 07:30 AM] grewalsatinder#9653
going to do again


[28-Aug-19 07:32 AM] grewalsatinder#9653
@jl777c https://github.com/jl777/libnspv/pull/129

{Embed}
https://github.com/jl777/libnspv/pull/129
hidden jpg sections by satindergrewal ¬∑ Pull Request #129 ¬∑ jl77...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[28-Aug-19 07:32 AM] grewalsatinder#9653
@Sir Seven after this merged, please try again.


[28-Aug-19 07:34 AM] Sir Seven#7158
Ok.


[28-Aug-19 07:36 AM] jl777c#5810
merged


[28-Aug-19 07:37 AM] grewalsatinder#9653
thanks üôÇ


[28-Aug-19 07:38 AM] Mihailo#5902
@siu I'm running my own chains so don't have any, try to mine as JL suggests


[28-Aug-19 07:39 AM] Sir Seven#7158
@grewalsatinder All fine now, cant reproduce.


[28-Aug-19 07:40 AM] grewalsatinder#9653
perfect üëç


[28-Aug-19 07:43 AM] grewalsatinder#9653
thanks for German translation @denio 
and thanks for Russian translation @Sir Seven üòÉ


[28-Aug-19 07:57 AM] Mihailo#5902
@jl777c I don't need to wait for a second to use cli, but to get the response from the fullnode it needs some time, it varies from time to time


[28-Aug-19 08:09 AM] Deleted User#0000
You need to filter the nodes down so that it only requests from  good peers... I have made heaps of changes in libnspv that does this and it works really good now.


[28-Aug-19 08:15 AM] Mihailo#5902
@siu So I have fixed the list rpc on at least my CCs, but it should work on all. Just on fixed ones it will be fast if there are a lot of CCs of that type on chain.


[28-Aug-19 08:15 AM] Mihailo#5902
https://github.com/jl777/komodo/pull/1698

{Embed}
https://github.com/jl777/komodo/pull/1698
Fix SetCCtxids for nSPV (#31) by Mixa84 ¬∑ Pull Request #1698 ¬∑ j...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[28-Aug-19 08:23 AM] jl777c#5810
is this a hardforking change to the fullnode side?


[28-Aug-19 08:43 AM] CrisF#3405
Thanks a lot for the wallet screenshots @Sir Seven . They are very helpful.


[28-Aug-19 08:58 AM] Deleted User#0000
@Sir Seven  
I canot reproduce your crash. I have tried compiling with and without degug set, and it does not happen for me. Is there some other steps I need to reproduce it? 
I just started nSPV. and then logged in, and updated an address with 12,000 tx many times, and its working perfectly.


[28-Aug-19 08:59 AM] Sir Seven#7158
Hm. I do run nspv on custom port. `-p 12900`
But it shouldn't affect wallet this way... as far as i see it.


[28-Aug-19 08:59 AM] Deleted User#0000
I will try it... It may be a system, issue... or something.. maybe compiling the nspv as static wil help?


[28-Aug-19 09:00 AM] Sir Seven#7158
Gimme link to your repo, to check from there.


[28-Aug-19 09:01 AM] Deleted User#0000
https://github.com/blackjok3rtt/libnspv
blackjok3r branch. 
I  just pushed the changes I have hereso that everything is the same.

{Embed}
https://github.com/blackjok3rtt/libnspv
blackjok3rtt/libnspv
Tiny Bitcoin Library written in C, with nSPV added - blackjok3rtt/libnspv
https://images-ext-2.discordapp.net/external/H9TDr69kM7mmxGBcENY3FInyORgkC6up-3NZ7sRUihU/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/30971146


[28-Aug-19 09:15 AM] Sir Seven#7158
With clean pull, ran onetime script. Started `nspv ILN -p 12900`
Logged in -> pressed Wallet button -> pressed Update (mempool) -> crash
https://paste.ubuntu.com/p/R6XJmMW3Jh/

Logged in -> pressed Wallet button -> crash
https://paste.ubuntu.com/p/yqjGzyJDgT/

And stuck there. Now each time i press Wallet it crashes.
Hmm, if that's sys problem, let me check on another device.
A few minutes.


[28-Aug-19 09:15 AM] Sir Seven#7158
After log in you are already on Wallet screen, yet i'm pressing Wallet button. Just in case.


[28-Aug-19 09:16 AM] Deleted User#0000
ok got it. I am on KMD so maybe that is the problem. üôÇ


[28-Aug-19 09:17 AM] Deleted User#0000
will test with ILN soon


[28-Aug-19 09:24 AM] Sir Seven#7158
Okay. Different PC.
Crash on login:
https://paste.ubuntu.com/p/7xZ2ScxTFS/


[28-Aug-19 09:24 AM] Sir Seven#7158
Mmmm.


[28-Aug-19 09:32 AM] Sir Seven#7158
Yes, actually works just fine on KMD.


[28-Aug-19 09:38 AM] Deleted User#0000
Working for me on ILN aswell...


[28-Aug-19 09:38 AM] Deleted User#0000
ü§î


[28-Aug-19 09:47 AM] Sir Seven#7158
Weird.


[28-Aug-19 10:03 AM] Mihailo#5902
@jl777c It shouldn't be. I have added a call to mempooltxids so I can filter with txids for SetCCtxids. It wouldn't hurt to just go through the changes to see if it will affect something!


[28-Aug-19 10:04 AM] jl777c#5810
but older versions that dont support this new functionality wont work, would it?


[28-Aug-19 10:04 AM] Mihailo#5902
Basically, on nodes that doesn't have this code, the call won't work. But that is it.


[28-Aug-19 10:04 AM] Mihailo#5902
Yes


[28-Aug-19 10:05 AM] Mihailo#5902
But the calls are for RPCs so it is not consesus stuff


[28-Aug-19 10:07 AM] jl777c#5810
ok, so i dont have to update the fullnodes?


[28-Aug-19 10:13 AM] Deleted User#0000
@Sir Seven  
No go on ubuntu 16.04 using the copy of your source. Its wokring perfectly.


[28-Aug-19 10:15 AM] Sir Seven#7158
No ideas.
Hm. Will try a few things later, not sure why it behaves so poorly for me.

{Reactions}
üëç 

[28-Aug-19 10:16 AM] Mihailo#5902
@jl777c No, it should be fine.


[28-Aug-19 10:16 AM] Mihailo#5902
Just the [cc]list rpc calls won't work


[28-Aug-19 10:17 AM] Deleted User#0000
should update version


[28-Aug-19 10:18 AM] Deleted User#0000
any time calls change, otherwise the client gets hung up trying all the nodes it sees.


[28-Aug-19 10:28 AM] Deleted User#0000
after sending a bunch of tx it breaks... 
I get a print of `change (null)` and nothig happens
I guess this is what you mean by utxo updating from mempool @jl777c  ?


[28-Aug-19 10:32 AM] Deleted User#0000
an is there any reason the nSPV client cannot just receive the real mempool? rather than needing to request it from full nodes?


[28-Aug-19 10:33 AM] Deleted User#0000
It connected to them already and they would just send mempool out to nSPV nodes the same as any other?


[28-Aug-19 10:35 AM] jl777c#5810
currently libnspv needs to wait for confirmations to get to a known state, has no concept of mempool when creating tx


[28-Aug-19 10:35 AM] jl777c#5810
it only needs to implement a mempool to have a real mempool


[28-Aug-19 10:36 AM] Deleted User#0000
great... seem to me that would be the proper way to do it


[28-Aug-19 10:36 AM] jl777c#5810
yes


[28-Aug-19 10:36 AM] jl777c#5810
then all the mempool requests can query the local mempool


[28-Aug-19 10:36 AM] jl777c#5810
worried about overall network bandwidth though


[28-Aug-19 10:36 AM] jl777c#5810
if there are a million nspv nodes, all needing to get all unconfirmed tx...


[28-Aug-19 10:37 AM] jl777c#5810
that is a giant load on the network


[28-Aug-19 10:37 AM] jl777c#5810
that is the design reason why the fullnodes do mempool scanning, to avoid the nspv nodes from having to relay unconfirmed tx


[28-Aug-19 10:38 AM] Deleted User#0000
yes a realiable utxo cache, and a local mempool will help a lot. 
mempool might be a pretty big job lol. It needs to be done from scratch in C right?


[28-Aug-19 10:38 AM] jl777c#5810
so when the overall network bandwidth is taken into consideration, that changes the optimal answer from having a local mempool to offloading it to the fullnodes


[28-Aug-19 10:38 AM] Deleted User#0000
ok


[28-Aug-19 10:38 AM] jl777c#5810
as you have experienced with bandwidth efficient header sync, the problem becomes orders of magnitude harder than just brute forcing requests to update local state


[28-Aug-19 10:39 AM] Deleted User#0000
yes


[28-Aug-19 10:39 AM] jl777c#5810
the idea for nspv is to get to where a few thousand full nodes can comfortable support millions of nspv superlite clients


[28-Aug-19 10:39 AM] jl777c#5810
that is the design priority. imagine we have 9600 baud modem connections and treat the bandwidth as a very precious resource


[28-Aug-19 10:40 AM] Deleted User#0000
got it. üôÇ 
mempool could be returned with the getinfo call if it was supplied the address? 
This should make it very easy to do.


[28-Aug-19 10:41 AM] jl777c#5810
there is already a  mempool message


[28-Aug-19 10:41 AM] Deleted User#0000
because nSPVC doesnt care about any other address


[28-Aug-19 10:41 AM] jl777c#5810
it has a function id and other parameters to use for searching


[28-Aug-19 10:42 AM] jl777c#5810
recommend to use the existing calls as mihailo is using it for CC tx creation


[28-Aug-19 10:42 AM] Deleted User#0000
ü§î


[28-Aug-19 10:42 AM] Mihailo#5902
@jl777c Is libnspv follwoing changes on Komodo nSPV or ?


[28-Aug-19 10:42 AM] jl777c#5810
and certainly querying for an address in mempool is already done


[28-Aug-19 10:42 AM] Deleted User#0000
yes


[28-Aug-19 10:42 AM] jl777c#5810
@Mihailo that is the goal, but so far not even faucetget is implemented yet


[28-Aug-19 10:43 AM] Deleted User#0000
maybe its another bug that I have ran into.. 
after I spend a bunch of utxos... it refuses to make more tx, but the "wallet" page shows all txids and utxos just fine, evenm from mempool


[28-Aug-19 10:43 AM] Mihailo#5902
BTW, when I said to @siu and others that CC is working, I meant on komodod. Haven't check libnspv!


[28-Aug-19 10:43 AM] Mihailo#5902
Should I work on libnspv to make CC work too?


[28-Aug-19 10:44 AM] jl777c#5810
after we solve what needs to be done for finalizecctx equivalent and have a plan on how to port all the CC rpc to libnspv


[28-Aug-19 10:44 AM] Mihailo#5902
Ok!


[28-Aug-19 12:59 PM] Sir Seven#7158
Got how to get 'fullnode not response' state JL777 mentioned.
It's a problem on libnspv client side it seems. Will provide all info to blackjok3r.
Does not reproduce on komodod -nSPV=1 instances.


[28-Aug-19 01:13 PM] siu#3920
iim testing again now


[28-Aug-19 01:13 PM] siu#3920
recompiled and im running NSPV chain


[28-Aug-19 01:14 PM] siu#3920
```./komodo-cli -ac_name=NSPV channelsaddress 03db419891c867f545d90be56f7ee8c9ce9fa829e88497bf3f7ba00a654a2634a4
{
  "result": "success",
  "ChannelsCCAddress": "RQy3rwX8sP9oDm3c39vGKA6H315cgtPLfr",
  "ChannelsCCBalance": 0.00000000,
  "ChannelsNormalAddress": "RQUuT8zmkvDfXqECH4m3VD3SsHZAfnoh1v",
  "ChannelsNormalBalance": 0.00000000,
  "ChannelsCC1of2Address": "RPEZqwU4rQNY2vTYHpA1L345rYbU5tMxgS",
  "ChannelsCC1of2TokensAddress": "RRSKXnvFWRpqPHHe37LEQvwszyD66CGF1d",
  "PubkeyCCaddress(Channels)": "RA99yXLJ1F8qvUyWSPqBk2GAJW3sTAk3BL",
  "PubkeyCCbalance(Channels)": 0.00000000,
  "myCCAddress(Channels)": "RA99yXLJ1F8qvUyWSPqBk2GAJW3sTAk3BL",
  "myCCbalance(Channels)": 0.00000000,
  "myaddress": "RDGVBu3J9M1x2cXPB8MgX9S1Fbkq6FWzvc",
  "mybalance": 0.00000000
}
```


[28-Aug-19 01:14 PM] siu#3920
channelsaddress seems to be working


[28-Aug-19 01:15 PM] siu#3920
takes a bit of time to return output


[28-Aug-19 01:15 PM] siu#3920
about 5 seconds, maybe more


[28-Aug-19 01:15 PM] siu#3920
can i get some NSPV?


[28-Aug-19 01:15 PM] siu#3920
i could mine them, but prefer not to load the whole chain if what i want is just test nspv mode.


[28-Aug-19 01:22 PM] siu#3920
no worries, i downloaded it on another server


[28-Aug-19 01:25 PM] siu#3920
i was able to execute a faucetget on nspv


[28-Aug-19 01:30 PM] siu#3920
oh... i can mine in nspv?


[28-Aug-19 01:38 PM] Deleted User#0000
https://github.com/jl777/libnspv/pull/130/files
Seems this fixes more crashes and sync bandwidth.

{Embed}
https://github.com/jl777/libnspv/pull/130/files
fix some more crashes, and sync bandwidth by blackjok3rtt ¬∑ Pull ...
https://images-ext-2.discordapp.net/external/H9TDr69kM7mmxGBcENY3FInyORgkC6up-3NZ7sRUihU/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/30971146


[28-Aug-19 01:41 PM] siu#3920
```./komodo-cli -ac_name=NSPV channelsinfo fc0aeb5fc6ce82c310734ee1ac48bd1dae8c1c4fe1cebf58a3271cdfd79e7619
{
  "result": "success",
  "Channel CC address": "RTBPrmGXmKXoCwa3hPgNsMiGZCszATMPuR",
  "Destination address": "RFGxmm9bFfX7nYWwKTV74SiJYdpV4kz19Z",
  "Number of payments": 2,
  "Denomination (satoshi)": "1",
  "Amount (satoshi)": "2",
  "Transactions": [
  ]
}
```


[28-Aug-19 01:41 PM] siu#3920
i was able to open a channel on nspv


[28-Aug-19 01:58 PM] siu#3920
@Mihailo i paste all this here since i think there is an issue with either `channelsopen` or `channelspayment` on nspv


[28-Aug-19 01:58 PM] siu#3920
```./komodo-cli -ac_name=NSPV channelsinfo fc0aeb5fc6ce82c310734ee1ac48bd1dae8c1c4fe1cebf58a3271cdfd79e7619
{
  "result": "success",
  "Channel CC address": "RTBPrmGXmKXoCwa3hPgNsMiGZCszATMPuR",
  "Destination address": "RFGxmm9bFfX7nYWwKTV74SiJYdpV4kz19Z",
  "Number of payments": 2,
  "Denomination (satoshi)": "1",
  "Amount (satoshi)": "2",
  "Transactions": [
    {
      "Open": "fc0aeb5fc6ce82c310734ee1ac48bd1dae8c1c4fe1cebf58a3271cdfd79e7619"
    }
  ]
}
‚ûú  src git:(nSPV) ‚úó ./komodo-cli -ac_name=NSPV channelspayment fc0aeb5fc6ce82c310734ee1ac48bd1dae8c1c4fe1cebf58a3271cdfd79e7619 1
{
  "result": "error",
  "error": "channelsopen tx not yet confirmed/notarized"
}
‚ûú  src git:(nSPV) ‚úó ./komodo-cli -ac_name=NSPV getrawmempool                   
[
]
```


[28-Aug-19 02:11 PM] Mihailo#5902
@siu You must compile komodo in testmode otherwise you must wait 100 blocks until tx is confirmed.


[28-Aug-19 02:11 PM] Mihailo#5902
There is the command how to do it in cc-general pinned I think


[28-Aug-19 02:15 PM] siu#3920
ok, thanks.


[29-Aug-19 05:27 AM] dukeleto#7326
Is there a way to visualize to the user, how much bandwidth the current wallet "connection" has used?


[29-Aug-19 05:27 AM] dukeleto#7326
Might be useful for people that are using pre-paid internet plans with a fixed bandwith limit


[29-Aug-19 06:20 AM] jl777c#5810
getinfo call shows network bytes received and sent


[29-Aug-19 06:21 AM] jl777c#5810
displayed on the html info page, latest version is looking really good, less than 1MB after 4+ hrs

{Reactions}
üëå shexy (2) 

[29-Aug-19 06:45 AM] Deleted User#0000
Love it.


[30-Aug-19 10:34 AM] gcharang#6833
@jl777c @Mihailo 
I've run a script to find the rpc that crash komdod in the -nSPV=1 mode
```
assetchainproof
getrawtransaction
zcsamplejoinsplit
```
all of these crash with
```
error: couldn't connect to server: EOF reached (code 1)
(make sure server is running and you are connecting to the correct RPC port)
```


[30-Aug-19 10:42 AM] jl777c#5810
only those three?


[30-Aug-19 10:43 AM] gcharang#6833
these three crash the daemon
I haven't checked for other types of errors or outputs that make no sense


[30-Aug-19 10:44 AM] jl777c#5810
as long as it doesnt crash, it seems ok for the non-nspv rpc


[30-Aug-19 10:58 AM] gcharang#6833
agreed
after the cc are working, may be the non-nspv rpc could return "Disabled"


[30-Aug-19 03:46 PM] Mihailo#5902
@gcharang I'll take a look at them on monday, maybe it will be quick fix!

{Reactions}
üëç 

[31-Aug-19 01:26 AM] jl777c#5810
probably just to return error if nSPV=1


[31-Aug-19 01:42 AM] gcharang#6833
@Mihailo I had run the script before with random arguments
but after running with correct arguments for the rpc, I have found a few more that crash the daemon. The commands along with arguments:
```
assetchainproof d19f1c3f7e630966e1d40838c56c8c63a6cbd828d34c3544be5a60b236cf1610

getrawtransaction "a44feb2e788d0332e283d8ca69c6a20999944dccac93246cbf9b36d841b08c95"

zcsamplejoinsplit

getblockchaininfo

gettxout "d7f9b34ad3e86f48fce55dbec1f2925b8dcbd15199977fd75d224254db9ae80d" 1

gettxoutsetinfo

signrawtransaction 0400008085202f8901ffbf4547647abdba819d44699942cb63681be37061f4acd760c0d1e0240d93ad0600000000ffffffff0130a57500000000003b6a39e283150a4346454b445241474f4efa2fe05c5d6cb0bf5a9be2aec4f1cd7a10c9472d6abc1e9bb9dc5903a4ec1a5b0a094346454b484f554e4400000000f36f00000000000000000000000000

z_getpaymentdisclosure 96f12882450429324d5f3b48630e3168220e49ab7b0f066e5c2935a6b88bb0f2 0 0 "refund"
```


[31-Aug-19 01:44 AM] grewalsatinder#9653
it'd be nice to see if libnspv can be compiled with emscripten and run in a browser


[31-Aug-19 01:45 AM] grewalsatinder#9653
and then turned into a browser add-on/extension: https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions

{Embed}
https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions
Browser Extensions
Extensions can extend and modify the capability of a browser. Extensions for Firefox are built using the WebExtensions¬†API, a¬†cross-browser system for developing extensions.
https://images-ext-1.discordapp.net/external/xo5aboqiJbHLtrDVvNmHYaom7xK5J-GVKr06BufiBHk/https/developer.mozilla.org/static/img/opengraph-logo.72382e605ce3.png

{Reactions}
üëÄ 

[02-Sep-19 01:08 AM] CrisF#3405
Hi, does `Create secure login image` (CREATE_LOGIN_IMG) still require translation?


[02-Sep-19 01:09 AM] CrisF#3405
I seem to remember seeing that steganography might not be used...


[02-Sep-19 01:09 AM] CrisF#3405
@grewalsatinder


[02-Sep-19 01:18 AM] jl777c#5810
for now it is disabled, but if not too much trouble, might as well translate it


[02-Sep-19 01:21 AM] CrisF#3405
Great thanks.


[02-Sep-19 01:23 AM] CrisF#3405
Be nice if there was a way to securely add it.  It's one of the features that I was interested in when I first came here, but nobody ever talked about.


[02-Sep-19 01:37 AM] CrisF#3405
I'm wondering how to have `Transaction Height` translated. 
Could someone please tell me what is it?


[02-Sep-19 01:38 AM] jl777c#5810
the height the txid was confirmed in


[02-Sep-19 01:38 AM] CrisF#3405
Thanks you üôè


[02-Sep-19 01:48 AM] CrisF#3405
Sorry, couple more questions:
Does `height` in 'the height the txid was confirmed in' mean block?
What is `Transaction Length`?


[02-Sep-19 02:07 AM] Deleted User#0000
height is the block height yes, and tranmsaction lenght is the size of the tx in bytes I think.


[02-Sep-19 02:07 AM] jl777c#5810
yes


[02-Sep-19 02:07 AM] Deleted User#0000
@CrisF


[02-Sep-19 02:08 AM] CrisF#3405
Thank you!


[02-Sep-19 05:11 PM] CrisF#3405
Hi,
Made a PR (#131) for Japanese translation.
Still have 2 questions though.  Will add to translation later.

1.  What is "Best Known Height" from `{ "BEST_HEIGHT": "Best Known Height"}`?  (left as English for now)

2.  What is `vini` from `"SPENT_VINI"`?  Found `spentvini` as "the input number of this output in the transaction that spent it" but a clear term in Japanese would help understanding.  Currently translated as `ÈÄÅ‰ø°vini`.


[02-Sep-19 05:23 PM] Deleted User#0000
best known height is the last header that the client seen from that peer that links back to the last notarization (validated) 
1 coin }
2 coin    ---> 6 coins 
3coin }
vin[0] = 1 
vin[1] = 2 
vin[2] = 3 
0,1,2 is i


[02-Sep-19 05:26 PM] CrisF#3405
Oh, ok, thanks üëç


[03-Sep-19 08:43 AM] dukeleto#7326
I am working on this Android app that connects to a full node, and I am wondering, how can I leverage some nSPV data, so that the app connecting to a full node doesn't actually have to fully "trust" that node? Is it possible to look at nSPV data and detect a malicious node giving false info? @jl777c


[03-Sep-19 08:44 AM] jl777c#5810
you can validate specific txids


[03-Sep-19 08:44 AM] dukeleto#7326
I am not trying to make a superlite wallet, but maybe leverage some of the data


[03-Sep-19 08:44 AM] jl777c#5810
you can also verify if a node is on the mainchain


[03-Sep-19 08:44 AM] dukeleto#7326
interesting


[03-Sep-19 08:45 AM] dukeleto#7326
@jl777c my app would need to send p2p messages to an nSPV-enabled full node, correct?


[03-Sep-19 08:46 AM] dukeleto#7326
this isn't in RPC-world


[03-Sep-19 08:46 AM] dukeleto#7326
unfortunately the mobile app is Kotlin and the backend service is Java. Using libnspv might be "fun"


[03-Sep-19 08:52 AM] jl777c#5810
can you issue curl requests?


[03-Sep-19 07:32 PM] dukeleto#7326
yes


[04-Sep-19 12:56 AM] jl777c#5810
then you can just issue api calls to libnspv, it will need to run as its own process


[04-Sep-19 05:09 AM] dukeleto#7326
maybe we need a special android build of libnspv, because android cannot run arbitrary executables. They need to be in .apk format


[04-Sep-19 06:42 AM] grewalsatinder#9653
@ca333 maybe can share idea of turning it to an android app module etc.


[04-Sep-19 06:43 AM] grewalsatinder#9653
or @artem.pikulin


[04-Sep-19 07:00 AM] dukeleto#7326
basically, how can Android apps leverage some nSPV data? We probably need to make an android app/library helper for libnspv. It' can't be compiled and used directly


[04-Sep-19 07:01 AM] dukeleto#7326
mostly it would be a wrapper around talking to full nodes via HTTP requests and parsing results


[04-Sep-19 07:01 AM] dukeleto#7326
we could probably get more android adoption if we make it easy for people


[04-Sep-19 07:03 AM] jl777c#5810
i heard it built for android


[04-Sep-19 07:13 AM] grewalsatinder#9653
it can be compiled as executable binary which needs to be exected from termux app.


[04-Sep-19 07:13 AM] grewalsatinder#9653
but if an app needs to be built, that might not be done similarly.


[04-Sep-19 07:13 AM] grewalsatinder#9653
I done such trials from `iguana` android test days.


[04-Sep-19 07:13 AM] grewalsatinder#9653
wasn't working for me


[04-Sep-19 07:14 AM] grewalsatinder#9653
the executable doesn't give the API or don't executed in the secure sandboxed environment if I understand correctly.


[04-Sep-19 07:15 AM] grewalsatinder#9653
so that means it needed to have the ability to make it a static lib which could be used to trigger it's main function via native mobile code written in Java or Kotlin language.


[04-Sep-19 07:15 AM] grewalsatinder#9653
I heard the similar solution from a local bitcoin dev of GreenAddress who made his app with similar approach.


[04-Sep-19 07:45 AM] dukeleto#7326
@grewalsatinder does that require a rooted android?


[04-Sep-19 07:45 AM] dukeleto#7326
Most people don't have access to that


[04-Sep-19 07:46 AM] grewalsatinder#9653
compiling libnspv on termux? nope


[04-Sep-19 07:46 AM] grewalsatinder#9653
non-rooted  android also compiles it


[04-Sep-19 07:46 AM] grewalsatinder#9653
instructions are there on readme for android


[04-Sep-19 07:47 AM] dukeleto#7326
"readme for android" ?


[04-Sep-19 07:47 AM] dukeleto#7326
did I miss something?


[04-Sep-19 07:48 AM] Mihailo#5902
If I remember correctly, you can use .so files in Android app. So libnspv needs to be built as .so library and you can then import it in app.


[04-Sep-19 07:48 AM] dukeleto#7326
Maybe I am dumb, but I am still not clear on how a Java/kotlin android .apk can use libnspv


[04-Sep-19 07:48 AM] dukeleto#7326
@Mihailo interesting, seems like a security issue


[04-Sep-19 07:48 AM] dukeleto#7326
how does Google verify it's not malware?


[04-Sep-19 07:49 AM] jl777c#5810
run libnspv, then have java issue curl requests?


[04-Sep-19 07:49 AM] dukeleto#7326
@jl777c yes, that seems possible


[04-Sep-19 07:49 AM] Mihailo#5902
Don't know about Play Store and its restrictions, I was using app directly on a device.


[04-Sep-19 07:50 AM] Mihailo#5902
JLs solution is easy, you just need to see how to run libnspv on Andriod device...


[04-Sep-19 07:51 AM] Mihailo#5902
@dukeleto https://developer.android.com/studio/projects/add-native-code

{Embed}
https://developer.android.com/studio/projects/add-native-code
Add C and C++ code to your project ¬†|¬† Android Developers
Learn how you can add C and C++ code to your Android project.
https://images-ext-1.discordapp.net/external/-5pTMoGb8bmkDiTBlCtEJkQ27J-gkcM3Mr5AjWwY1Jk/https/developer.android.com/images/android-developers.png


[04-Sep-19 07:51 AM] dukeleto#7326
@Mihailo thanks, i am an android newbie


[04-Sep-19 07:52 AM] dukeleto#7326
ah, ok. So google gets submitted the C++ source of the library too, and that is how they can vet for the Play Store


[04-Sep-19 07:52 AM] Mihailo#5902
I'm not so Android dev too, I have done some AOSP modification and rom building but not sure what are all the new stuff in Android world.


[04-Sep-19 07:52 AM] dukeleto#7326
it's all fun and good to get this to work with untrusted .apk's, but the real reason is so average people can install it from the Play Store


[04-Sep-19 07:53 AM] dukeleto#7326
@Mihailo they are just now releasing android 10 and changing everything again


[04-Sep-19 07:53 AM] dukeleto#7326
it seems nSPV should be reasonable to use from my android app


[04-Sep-19 07:53 AM] dukeleto#7326
and I might be making a first-of-it's-kind. It's not a superlite wallet, nor a full node, nor a light wallet


[04-Sep-19 07:54 AM] dukeleto#7326
but a remote-control-for-your-fullnode, which can leverage nSPV data directly from network peers, to provide additional safety in an unsafe environment (mobile phones)


[04-Sep-19 07:54 AM] dukeleto#7326
My goal is that nSPV can help in situations where something goes malicious


[04-Sep-19 07:56 AM] dukeleto#7326
i.e., when the full node and phone are not on same local network, this "wormhole" service needs to be used. And I want to design for that service going malicious and phones should be able to notice and disconnect


[04-Sep-19 07:57 AM] dukeleto#7326
and the plan is to run many wormholes, like electrum servers, to reduce the risk of a single server being so important and a juicy target for attacker


[04-Sep-19 09:16 AM] ca333#0333
@dukeleto yes - i can confirm libNSPV is fully android compatible and we successfully executed a PoC for a atomicDEX mobile nSPV mode.


[04-Sep-19 11:19 AM] dukeleto#7326
@ca333 that is awesome to hear


[05-Sep-19 02:21 AM] jorian#4555
nice


[05-Sep-19 11:48 AM] Tylor zkFS#8280
ACDC on nSPV - you guys are major dorks


[07-Sep-19 05:39 PM] Regnar#6164
https://i.imgur.com/kK5XvZl.png

Initial testing is working! currently this is fetching price data through Tor and using a randomly generated user agent üòÑ

{Embed}
https://imgur.com/kK5XvZl
https://images-ext-1.discordapp.net/external/JLD00_oO2xHsM_9il9iMlDilIjppv2q-L9JkvDyanas/https/i.imgur.com/kK5XvZl.png

{Reactions}
üëè (7) üëç (11) üòé (8) ü§ì (7) 

[07-Sep-19 05:41 PM] Regnar#6164
```price enabled
updating prices...
Tor Enabled
updating prices...
{'origin': '194.71.109.44, 194.71.109.44'}
price requested through Tor```


[08-Sep-19 07:09 AM] dukeleto#7326
very coooool!

{Reactions}
üëç 

[08-Sep-19 09:34 AM] Slyris#2880
Hey ! Very nice @Regnar

{Reactions}
üëç 

[14-Sep-19 12:20 PM] Regnar#6164
If anyone is curious about the above wallet, I just added the Tor support portion to the code on github. 
<https://github.com/theblackmallard/nspv_pywallet>

```Features:
-nSPV wallet for KMD
-Address Book
-Multi themes
-Multiple fiat prices
-Tor enabled price requests
-Manual override Tor Port choice
-Saves all settings on shutdown
```


[15-Sep-19 04:33 AM] dukeleto#7326
:shexy:


[27-Sep-19 02:32 AM] jl777c#5810
@gcharang please remove ```Pure library without wallet support
./autogen.sh
./configure --disable-wallet --disable-tools
make check```


[27-Sep-19 02:32 AM] jl777c#5810
from the readme


[27-Sep-19 02:32 AM] jl777c#5810
--disable-wallet --disable-tools are options that the nspv does not follow and maybe it needs some of the wallet functoins as all the nspv api is always supported


[27-Sep-19 02:39 AM] gcharang#6833
@jl777c submitting a PR in a sec


[27-Sep-19 02:39 AM] jl777c#5810
there is report that KMD nspv is not working, can someone verify that as of now it is working


[27-Sep-19 02:39 AM] gcharang#6833
will check


[27-Sep-19 02:41 AM] gcharang#6833
@jl777c <https://github.com/jl777/libnspv/pull/141/files>
is this ok ?


[27-Sep-19 02:43 AM] jl777c#5810
ok


[27-Sep-19 02:44 AM] TonyL#3577
@Sir Seven ^^


[27-Sep-19 02:49 AM] gcharang#6833
@jl777c I have verified that
the repo <https://github.com/jl777/libnspv/>  's branches: master, jl777

built using:
```
./autogen.sh
./configure
make
```

work fine for the KMD coin


[27-Sep-19 03:04 AM] Sir Seven#7158
@jl777c  KMD works fine for me. Building with ./onetime from master branch.


[27-Sep-19 04:13 AM] pbca26#5430
brew recipe for mac seems outdated
it's based on v0.1
dev is ahead


[27-Sep-19 04:14 AM] pbca26#5430
i have an issue with broadcast method
can someone verify it's working?
time curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "broadcast", "params": [""] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/ >> /dev/null
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   314    0   239  100    75      7      2  0:00:37  0:00:32  0:00:05    46

real    0m32.877s
user    0m0.011s
sys    0m0.019s

it never responds on my end properly
fails on timeout


[27-Sep-19 04:19 AM] gcharang#6833
@pbca26 it worked for me just now


[27-Sep-19 04:21 AM] jl777c#5810
is it a valid rawtx?


[27-Sep-19 04:21 AM] pbca26#5430
./nspv
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash KMD
Start NSPV_rpcloop.7771
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:7771 bind sock.3 API enabled at unixtime.1569583234 <<<<<<<<<
Discover KMD peers...Trying to connect to 1 5.9.102.210:7770
Trying to connect to 2 45.32.19.196:7770
Trying to connect to 3 5.9.253.195:7770
Trying to connect to 4 78.47.196.146:7770
Trying to connect to 5 23.254.165.16:7770
Trying to connect to 6 136.243.58.134:7770
Trying to connect to 7 5.9.253.196:7770
Trying to connect to 8 5.9.253.197:7770
Trying to connect to 9 5.9.253.198:7770
Trying to connect to 10 5.9.253.199:7770
Trying to connect to 11 5.9.253.200:7770
Trying to connect to 12 5.9.253.201:7770
Trying to connect to 13 5.9.253.202:7770
Trying to connect to 14 5.9.253.203:7770
Connected to node 3 5.9.253.195:7770
Connected to node 1 5.9.102.210:7770
Connected to node 6 136.243.58.134:7770
Connected to node 4 78.47.196.146:7770
Connected to node 2 45.32.19.196:7770
max rpc threads spawned and alive 0 <- 1
new argjson.({"jsonrpc":"2.0","id":"curltest","method":"getinfo","params":[""],"hdrheight":0})
node.1 reqhdr.0 hdrtotal.0 delay.30 k.1
node.2 reqhdr.0 hdrtotal.0 delay.33 k.1
node.3 reqhdr.0 hdrtotal.0 delay.33 k.1
node.4 reqhdr.0 hdrtotal.0 delay.33 k.1
node.5 reqhdr.0 hdrtotal.0 delay.33 k.1
node.6 reqhdr.0 hdrtotal.0 delay.30 k.1
[NODE:6] ht.1549525 hdrheight.1549525 lastntzht.0 esthdrleft.1549525
 ntzht.1549510 06497c37b2aa8ad52304d66a2291762bc48bada60cedd6ae92ac3f190730fbb5 <- size.74
new notarization at height.1549510
got txproof response 1569583239 size.1720 64031707ed8e8abb0f1481c1695cbd2bba783fdd0ae5afaba201da4aa96e931b ht.-1
new argjson.({"jsonrpc":"2.0","id":"curltest","method":"broadcast","params":[""],"hex":""})
no nodes
no nodes
no nodes
no nodes
Trying to connect to 15 103.6.12.112:7770
Connected to node 15 103.6.12.112:7770
node.15 reqhdr.1549510 hdrtotal.1 delay.37 k.1

this is what i'm getting after issuing broadcast method


[27-Sep-19 04:21 AM] jl777c#5810
plz post more details. like the hex that is failing


[27-Sep-19 04:22 AM] jl777c#5810
no nodes
no nodes


[27-Sep-19 04:22 AM] jl777c#5810
means no eligible nodes


[27-Sep-19 04:22 AM] jl777c#5810
what if you dont issue other api calls too recently


[27-Sep-19 04:23 AM] pbca26#5430
ha, with valid rawtx hex it failed with a proper error "error adding to mempool"


[27-Sep-19 04:23 AM] pbca26#5430
let me try it again


[27-Sep-19 04:31 AM] pbca26#5430
still no go on a freshly constructed tx
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "broadcast", "params": ["0400008085202f89013d8fc1f09d8a24b215296e12d434ca31e106871bdb77ff45f8cecdc9979ee26c000000006a473044022047f9f02739528df5196560003db99af1c2e3b9f82bdb2dcad0aa0fb0c9cabe8c022057e27b6fc499007bcadaa8cda7dad6a990bbfc0b7de096ab9b7acd6de78f8588012103ab871db1d39d3f3894df53bc1d3018a243b6768dffdb2a4c038fd92213854b99feffffff01d0e89600000000001976a914fc46abe3748209db896e25faf39090679f17475588acc1ee8d5d000000000000000000000000000000"] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/
{"result":"success","expected":"71ddf2b213fdc7efc60ed1ece6329578858e2c9609da783adabd7baa53fc1128","broadcast":"0000000000000000000000000000000000000000000000000000000000000000","retcode":-2,"type":"timeout","lastpeer":"78.47.196.146:7770"}


[27-Sep-19 04:37 AM] jl777c#5810
can someone else try to broadcast that hex


[27-Sep-19 04:40 AM] gcharang#6833
same output
```
{"result":"success","expected":"71ddf2b213fdc7efc60ed1ece6329578858e2c9609da783adabd7baa53fc1128","broadcast":"0000000000000000000000000000000000000000000000000000000000000000","retcode":-2,"type":"timeout","lastpeer":"45.32.19.196:7770"}
```
broadcasting here: <https://deckersu.github.io/coinbin/#broadcast> said TX decode failed


[27-Sep-19 04:41 AM] gcharang#6833
https://paste.ubuntu.com/p/TcXgbZSvp2/
decoderawtxn using komodod


[27-Sep-19 04:43 AM] gcharang#6833
broadcast using normal komodod worked


[27-Sep-19 04:45 AM] pbca26#5430
insight push tx also working for me fine
shouldn't be an issue with the hex


[27-Sep-19 04:45 AM] jl777c#5810
the issue seems to be that libnspv is not able to decode the hex, please make an issue with the exact hex that causes this


[27-Sep-19 04:47 AM] pbca26#5430
done


[27-Sep-19 01:30 PM] grewalsatinder#9653
@ns408 brew install is outdated ^^


[29-Sep-19 06:33 PM] jl777c#5810
improvements to tx propagation: https://open.library.ubc.ca/cIRcle/collections/ubctheses/24/items/1.0378175

{Embed}
https://open.library.ubc.ca/cIRcle/collections/ubctheses/24/items/1.0378175
Erlay : efficient transaction relay in Bitcoin
Bitcoin is a top-ranked cryptocurrency that has experienced huge growth and survived numerous attacks. The protocols making up Bitcoin must therefore accommodate the growth of the network and ensure security. However, Bitcoin‚Äôs transaction dissemination protocol has mostly ...

{Reactions}
ü§î 

[29-Sep-19 06:42 PM] jl777c#5810
apparently there is an implementation that is in the process of being included into BTC. this seems a very good improvement for high tx blockchains


[29-Sep-19 06:50 PM] jl777c#5810
pinsketch sounds very cool

{Reactions}
üëç 

[16-Oct-19 02:47 AM] Lumbi#8378
how to activate assetchains on the nSVP?


[16-Oct-19 02:48 AM] Lumbi#8378
I will upload some pics of my Pi1 once it is operational üòé


[16-Oct-19 02:52 AM] jl777c#5810
run full nodes from dev branch


[16-Oct-19 02:52 AM] jl777c#5810
add coins info into coins file


[16-Oct-19 02:52 AM] jl777c#5810
,


[16-Oct-19 02:52 AM] jl777c#5810
./nspv COIN


[16-Oct-19 02:52 AM] jl777c#5810
readme has info, please read it

{Reactions}
üëç (3) 

[16-Oct-19 06:25 AM] Lumbi#8378
anyone else get 
`Traceback (most recent call last):
  File "main.py", line 7, in <module>
    from tkinter import ttk` ?


[16-Oct-19 06:30 AM] smkhound#7640
likely a python version issue. ttk is its own package in py2.7
lowercase `tkinter` implies app expects py3.


[16-Oct-19 07:02 AM] dukeleto#7326
welcome to the joy of coding

{Reactions}
6849_pepeold (2) 

[16-Oct-19 07:14 AM] Lumbi#8378
https://github.com/pyinstaller/pyinstaller/issues/1957#issuecomment-382392439

{Embed}
https://github.com/pyinstaller/pyinstaller/issues/1957
Tkinter fails due to path issues ¬∑ Issue #1957 ¬∑ pyinstaller/pyi...
3.1.0 works fine, starting with 3.1.1 Tkinter bombs on some systems (Win 7 64bit, XP 32bit) like this: PyInstaller Bootloader 3.x LOADER: executable is C:\user\tcltest\tcltest_minimal.exe LOADER: h...
https://images-ext-2.discordapp.net/external/csmr2V5Lx0CcxUGQv63eKsTYiHRqBt9dThgvnCmneWs/%3Fs%3D400%26v%3D4/https/avatars3.githubusercontent.com/u/1215332


[16-Oct-19 09:22 AM] Regnar#6164
I haven't been able to get pyinstaller to work for anything of mine tbh (win10) so I'll have to look into that as well. I also haven't had a moment to clean up the pywallet here. üòï


[02-Nov-19 04:22 PM] Slyris#2880
@jl777c Seem's that for OSX `brew install automake` is required on new osx Systems


[02-Nov-19 04:24 PM] Slyris#2880
and `brew install libtool`


[02-Nov-19 04:27 PM] Slyris#2880
https://github.com/jl777/libnspv/pull/146/files


[09-Nov-19 04:14 PM] Sir Seven#7158
Have a rather interesting case here.
All my NSPV CI tests started to fail on spend rpc(nspv just crashes). Only thing changed - amount of coins in my test wallet.
Checked with different coins, wallets - only my test one fails.
Backtrace:
https://paste.ubuntu.com/p/mBbG6BPPV7/

@jl777c I'll DM you wallet and conditions crash happens with.


[09-Nov-19 11:16 PM] jl777c#5810
@Sir Seven congratulations on the first bug in libnspv found in a long time!

{Reactions}
ü•á (13) 

[09-Nov-19 11:16 PM] jl777c#5810
pushed fix to all branches other than master. after it is confirmed to be working, i will update master


[10-Nov-19 03:19 PM] dukeleto#7326
sounds like a fun bug


[13-Nov-19 01:31 AM] Slyris#2880
Hello.

Build last version of nspv from master

there is an additional returned field that is not specified in https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#getnewaddress

called "seed"

it's what i think ?


[13-Nov-19 01:32 AM] Slyris#2880
It's a string containing numbers separated by a white space


[13-Nov-19 01:39 AM] jl777c#5810
agama/atomicDEX compatible seed, in the specified language


[13-Nov-19 01:46 AM] Slyris#2880
ok great !


[13-Nov-19 01:49 AM] Slyris#2880
In case I want to create my own wallet in a video game, say the first time I start the game. In the idea should save this seed and use it in an existing portfolio, Agama or AtomicDex, is it? possible to import a seed just using nSPV without going through these existing wallets? Is it possible to use only nSPV for the use of the wallet. Consult the funds, spend, transaction history. I saw some call rpc that actually correspond to what I try to do.


[13-Nov-19 01:50 AM] jl777c#5810
you can login with any seed or wif


[13-Nov-19 01:50 AM] jl777c#5810
it has all the basic rpc calls you need for a wallet


[13-Nov-19 01:51 AM] jl777c#5810
you do need to do a spend followed by broadcast, so that is two steps, but this allows for user confirmation


[13-Nov-19 01:51 AM] jl777c#5810
if you just use the html wallet, you can see a simple wallet in action


[13-Nov-19 01:52 AM] Slyris#2880
Ok great


[13-Nov-19 01:52 AM] jl777c#5810
https://drive.google.com/drive/folders/1ZvzrhNBQgroejTKPl0kCOTJ8h7XMnO2M?usp=sharing


[13-Nov-19 01:52 AM] jl777c#5810
that has screenshots of the html gui


[13-Nov-19 01:53 AM] Slyris#2880
Ideally here are the steps I'm trying to follow:

The user starts his game with his own blockchain (create with the antara composer for example) He has setup his coin file and is now ready to spawn a new instance of nSPV directly from his game on his new blockchain. Once it's done, nSPV connects to the node of its blockchain, so far no problem. The idea is that the first time I start the game I will use the call rpc getnewaddress to create the portfolio of the player if I followed well. But the next time I log in I want to use my wallet with the address I just created. (so i use the login rpc call with the `wif` or the `seed` and there i'm ready to do anything i need


[13-Nov-19 01:53 AM] jl777c#5810
yes


[13-Nov-19 01:53 AM] Slyris#2880
Perfect. so far.


[13-Nov-19 01:53 AM] jl777c#5810
management of the actual seed/wif is left to the caller/user


[13-Nov-19 01:53 AM] Slyris#2880
Yeah that's what i'm thinking about i should not save the seed/wif


[13-Nov-19 01:54 AM] jl777c#5810
if you dont, then how will the user remember?


[13-Nov-19 01:54 AM] Slyris#2880
I should save it, but i need to think about exposing different solution to the user


[13-Nov-19 01:54 AM] Slyris#2880
just the save the seed into a file seem's dangerous no ?


[13-Nov-19 01:55 AM] Slyris#2880
I mean in terms of security, it's up to the user i guess.


[13-Nov-19 01:55 AM] jl777c#5810
yes, maybe if it is encrypted with a password/pin


[13-Nov-19 01:55 AM] Slyris#2880
Yeah i should ask for a password or smth like that


[13-Nov-19 01:55 AM] jl777c#5810
then some AES encrypted blob to store the seed locally


[13-Nov-19 01:55 AM] Slyris#2880
I guess it's exactly what is done in the AtomicDex


[13-Nov-19 01:55 AM] jl777c#5810
and the user could also copy down the seed


[13-Nov-19 01:55 AM] Slyris#2880
They store the seed that is accessible through a pin


[13-Nov-19 01:56 AM] jl777c#5810
yes


[13-Nov-19 01:56 AM] Slyris#2880
I will follow the same approach so.


[13-Nov-19 01:57 AM] Slyris#2880
Thank's for the clarification it's more clear now.


[13-Nov-19 01:57 AM] Slyris#2880
I guess that i have one seed / coin too


[13-Nov-19 01:57 AM] Slyris#2880
So i should probably ask only one pin for every seed


[13-Nov-19 01:58 AM] Slyris#2880
If the user in his game spawn an nSPV instance with KMD, one with RICK and create an address on both of them i will need to save both seed/wif (encrypted way) but ideally with an unique pin.


[13-Nov-19 01:59 AM] jl777c#5810
you can use the same seed/wif for all coins


[13-Nov-19 01:59 AM] Slyris#2880
So i create one the first time, and if the seed exist, use login instead of getnewaddress


[13-Nov-19 01:59 AM] Slyris#2880
for other coins.


[13-Nov-19 02:00 AM] Slyris#2880
first time game launch -> spawn instance -> create address only once -> use login for every other call once i have the seed.


[13-Nov-19 02:00 AM] jl777c#5810
makes sense. keep in mind the login lasts 777 seconds, after that the privkey is erased from memory


[13-Nov-19 02:01 AM] Slyris#2880
Means after login i should use the rpc calls for getting history stuff, etc and save it


[13-Nov-19 02:01 AM] Slyris#2880
And if the user want a refresh need to login again etc


[13-Nov-19 02:02 AM] Slyris#2880
I can i think run a dedicated thread for that, that login every 777 seconds and refresh information that the user need's.


[13-Nov-19 02:03 AM] Slyris#2880
If i understand correctly after a `login` rpc call, `logout` is automatically called after 777 seconds of activity.


[13-Nov-19 02:07 AM] Slyris#2880
Now i think about a real world usage let's say

I'm in a rpg video games, and i have golds (which is my coins) let's say i have 2000 RICK in game

I want to spend 1000, i will use `spent + broadcast` so i need to be `logged` here there is 2 solutions:

- Ask the pin at the moment where the user whant to buy something in game
- After the user logged in the game and enter his pin (once)  i automatically call `login` rpc call for him every 777 seconds for the session and don't ask pin anymore in game.

What we will prefer here ? Should we let the choice to the user to configure this behavior ?


[13-Nov-19 02:08 AM] Slyris#2880
I guess that's will be boring to type our pin each time we want to buy something, so we can save the pin for one game session let's say.


[13-Nov-19 02:09 AM] TonyL#3577
Pin asking on every blockchain tx should be very annoying for user


[13-Nov-19 02:09 AM] Slyris#2880
Yeah so what i'm suggesting is to have a login scene with a create wallet button that will ask user the pin that he want to create for his game blabla


[13-Nov-19 02:10 AM] Slyris#2880
and a login button where you just type your pin


[13-Nov-19 02:10 AM] Slyris#2880
When we leave the game we expire the pin for the session.


[13-Nov-19 02:10 AM] Slyris#2880
something like that


[13-Nov-19 02:11 AM] TonyL#3577
yep, decryption once on login into the game sounds good


[13-Nov-19 02:11 AM] jl777c#5810
also, you can do almost everything without being logged in


[13-Nov-19 02:11 AM] TonyL#3577
maybe you can just make nspv without expiration


[13-Nov-19 02:12 AM] jl777c#5810
only signing the tx needs to be logged in


[13-Nov-19 02:12 AM] TonyL#3577
as an option so it'll be the same - one login call and then usage until logout call


[13-Nov-19 02:12 AM] jl777c#5810
modifying the 777 autologout to 7777777 seconds is a matter of changing one define


[13-Nov-19 02:12 AM] Slyris#2880
If it's possible to add it as the command line parameters or in the nspv config that can be great


[13-Nov-19 02:13 AM] Slyris#2880
But in fact if for buyings any stuffs that i want i type my pin for 777 seconds, it's should be enough to shop everything that i need


[13-Nov-19 02:14 AM] jl777c#5810
it is just dangerous to have a funded privkey in memory forever


[13-Nov-19 02:14 AM] jl777c#5810
putting in the pin whenever transacting doesnt seem like too much burden


[13-Nov-19 02:14 AM] Slyris#2880
Yeah


[13-Nov-19 02:14 AM] TonyL#3577
`But in fact if for buyings any stuffs that i want i type my pin for 777 seconds, it's should be enough to shop everything that i need` but in future keystrokes you'll need to send permanently I wonder


[13-Nov-19 02:15 AM] Slyris#2880
Anyway this is just configuration stuff issue i guess we can change it at any moment


[13-Nov-19 02:15 AM] Slyris#2880
Best things to do it's to expose different possibility to the user and let him pick the best choice


[13-Nov-19 02:16 AM] Slyris#2880
If i want to type my pin every time i buy something.
If i want to type my pin only once. etc


[13-Nov-19 02:16 AM] Slyris#2880
Everyone is different i guess


[13-Nov-19 02:16 AM] Slyris#2880
it's mater of taste mostly.


[13-Nov-19 02:16 AM] TonyL#3577
It might be different for different games also


[13-Nov-19 02:16 AM] Slyris#2880
But we need to tell to the user to be aware of the different level of security solution that we expose to him.


[13-Nov-19 02:16 AM] TonyL#3577
In FPS I'll need to record results once per round, if we trade some NFT we'll need to broadcast txs and etc


[13-Nov-19 02:17 AM] Slyris#2880
Yeah but let's say you are in a mmorpg


[13-Nov-19 02:17 AM] Slyris#2880
Have a priv key in memory that doesn't expire


[13-Nov-19 02:17 AM] Slyris#2880
it's really dangerous


[13-Nov-19 02:18 AM] Slyris#2880
Especially on windows, detect the nSPV process and just put a watcher in real time to it


[13-Nov-19 02:18 AM] Slyris#2880
you will get the seed really easy.


[13-Nov-19 02:19 AM] Slyris#2880
You can easily sniff a packet of a mmorpg to know when a player is trying to buy something and at that moment to monitor the process nspv to try to get the seed, it's crooked, but I think it's really simple to make


[13-Nov-19 02:20 AM] Slyris#2880
Since if you know that the call `login` arrives when a user try to buy something at that moment the seed is exposed


[13-Nov-19 02:21 AM] Slyris#2880
After that, it's also up to the user to pay attention to the software that hangs on his computer, but it's becoming more and more common


[13-Nov-19 02:21 AM] TonyL#3577
With current design you'll have the seed as the plain text on some point anyway


[13-Nov-19 02:21 AM] gcharang#6833
>  sniff a packet of a mmorpg
this is in the internet, correct?

nSPV communication happens locally


[13-Nov-19 02:22 AM] Slyris#2880
But hey you take the case of a lambda user who just want to download the new mod of the game he likes, and behind you have an app that monitors nspv behind, it's not terrible


[13-Nov-19 02:22 AM] Slyris#2880
Yeah @gcharang I speak locally


[13-Nov-19 02:22 AM] Slyris#2880
I mean locally you can sniff the packet from localhost if you have a software that try to spy


[13-Nov-19 02:22 AM] gcharang#6833
oh, you mean the local system is already compromised?


[13-Nov-19 02:22 AM] Slyris#2880
Yup

{Reactions}
üëç 

[13-Nov-19 02:23 AM] Slyris#2880
Let's say you want to download a MOD's


[13-Nov-19 02:23 AM] Slyris#2880
in this mod's there is a spy software that's hook the nspv process


[13-Nov-19 02:23 AM] Slyris#2880
we are instantly fucked.


[13-Nov-19 02:23 AM] Slyris#2880
It's the user fault of course


[13-Nov-19 02:24 AM] gcharang#6833
got it, so even if it is a mod, the user should install from a trusted open source repo


[13-Nov-19 02:24 AM] Slyris#2880
Yeah ofc, but every day's people try to download external stuff for their games


[13-Nov-19 02:24 AM] Slyris#2880
we cannot control

{Reactions}
üëç 

[13-Nov-19 02:25 AM] Slyris#2880
But something that we can do, it's try to hiding the process nspv


[13-Nov-19 02:25 AM] Slyris#2880
from the task manager


[13-Nov-19 02:25 AM] Slyris#2880
https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntquerysysteminformation

{Embed}
https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntquerysysteminformation
NtQuerySystemInformation function (winternl.h) - Win32 apps
Retrieves the specified system information.
https://images-ext-2.discordapp.net/external/8_2StF6hBizSR9fUiWW7z9s8pqSQvUqlJfycyvxgW_4/https/docs.microsoft.com/en-us/media/logos/logo-ms-social.png


[13-Nov-19 02:31 AM] Slyris#2880
so here what I'm going to do is for the moment exposed a member function in my system nspv which allows to `encrypt / decrypt` a `wif` stored locally to use the login function. Later we will see where and how, and in which context we will use these two functions.


[13-Nov-19 02:33 AM] Slyris#2880
It would seem all the same that we have to look into the possible vulnerabilities of our solution (the private key has a time exposed) that does not necessarily happen on other game, because they are centralized and that finally the information is stored in a database that is not local.


[13-Nov-19 02:34 AM] Slyris#2880
The first idea that comes to my mind is to ban the external hooks on the process directly from the nSPV binary, I know it's possible I did it in the past. (but only on Windows)


[13-Nov-19 02:37 AM] Slyris#2880
But stackoverflow disagree with me


[13-Nov-19 02:37 AM] Slyris#2880

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/644123676052029440/Capture_decran_2019-11-13_a_11.37.13.png


[13-Nov-19 02:39 AM] Slyris#2880
I want to say that it's just part of the pros and cons, and the user should just pay attention, as we try to pay attention to our private keys


[13-Nov-19 02:54 AM] Slyris#2880
I love the idea of ‚Äã‚Äãhaving a decentralized online game, but that means that the user must be ultra serious and attentive to the environment in which he launches the game.


[13-Nov-19 02:55 AM] Slyris#2880
I guess some of the solution just launches their games in a sandbox that's untouchable and impenetrable


[13-Nov-19 02:56 AM] Slyris#2880
such as : https://itch.io/docs/itch/using/sandbox.html

Seem's to be really interesting.

{Embed}
https://itch.io/docs/itch/using/sandbox.html
The sandbox ¬∑ The itch.io app book


[13-Nov-19 04:10 AM] Sir Seven#7158
@jl777c   `pushed fix to all branches other than master. after it is confirmed to be working, i will update master`
Checked with cli and html wallet. Works fine. Autotests passed.
If I got it right - problem was with too much vins to transaction. Currently huge amounts of vins do not crash nspv process.


[13-Nov-19 04:15 AM] jl777c#5810
yes, before if you had more than 80 utxos it crashed. that address had 81!

{Reactions}
üé∞ 

[13-Nov-19 04:15 AM] jl777c#5810
now it should work, even with thousands


[13-Nov-19 07:01 AM] TonyL#3577
That was a jackpot to buypass 80 limitation with exactly 81 üòÇ


[13-Nov-19 07:03 AM] TonyL#3577
btw @Sir Seven is it some address in auto-tests? If you're using same address on real chain it's better to merge utxos into single one on each tests execution - otherwise each other test will be started with different conditions to previous one


[13-Nov-19 07:04 AM] TonyL#3577
non-det tests = bad tests if they are supposed to be det


[13-Nov-19 07:06 AM] Sir Seven#7158
>>That was a jackpot to buypass 80 limitation with exactly 81 üòÇ
T__T

>>better to merge utxos into single one on each tests execution
Was never needed, due to using different wifs for tests. Will implement auto-merge later, when other automation parts are final.


[14-Nov-19 06:27 AM] dukeleto#7326
sounds like i need to merge some more nspv changes into Hush, it's hard to keep up with y'all


[14-Nov-19 06:44 AM] jl777c#5810
this bug was in libnspv


[14-Nov-19 07:14 AM] dukeleto#7326
@jl777c i assume hush is using an older version of libnspv that the internals use, but i don't pretend to know how it all works. haven't had time to go read all of that code


[14-Nov-19 07:14 AM] jl777c#5810
libnspv is for clients only


[14-Nov-19 07:14 AM] jl777c#5810
nothing to do with the nSPV fullnode


[14-Nov-19 07:14 AM] jl777c#5810
or nSPV=1 clients


[14-Nov-19 07:49 AM] dukeleto#7326
ok, so for instance, a GUI libnspv wallet running on a smart toaster is what actually uses libnspv. not smart chain full nodes or smart chain nodes running in nspv mode


[14-Nov-19 07:50 AM] dukeleto#7326
i thought the full node used libnspv as well, so i have already learned something


[15-Nov-19 05:41 AM] dimxy#2587
I found a problem with libnspv for Android (I'm adding support to have it as a so library for my kogs project).
There is a call to pthread_cancel() which is apparently absent in Android NDK.
@jl777c 
I can see that the loop in the work thread listens for NSPV_STOPRECEIVED flag. Maybe shutdown the thread also with setting this flag?


[15-Nov-19 05:42 AM] jl777c#5810
if you know how to fix this, then please do and make a PR. i am not familiar with android pthread usage

{Reactions}
üëå 

[15-Nov-19 06:50 AM] dukeleto#7326
@dimxy i know very little about nspv


[15-Nov-19 06:50 AM] dukeleto#7326
but i have many scars of porting weird software across weird OS's


[15-Nov-19 06:52 AM] dukeleto#7326
@dimxy firstly, there should be a macro/etc that detects running under Android NDK, and run different code instead of `pthread_canel()` if true


[15-Nov-19 06:52 AM] dukeleto#7326
then, if you know the proper way to do it on android, do it üôÇ


[15-Nov-19 06:53 AM] dukeleto#7326
https://stackoverflow.com/questions/4610086/pthread-cancel-alternatives-in-android-ndk#4610138

{Embed}
https://stackoverflow.com/questions/4610086/pthread-cancel-alternatives-in-android-ndk
pthread_cancel() alternatives in Android NDK?
I am porting a mid-sized body of C++ code to Android NDK. Unfortunately the pthreads implementation (as of NDK v5, anyway) is incomplete. Specifically, our application relies on pthread_cancel() to...
https://images-ext-1.discordapp.net/external/dP07hBXxuorGcvXU609uJ_e6ZgPlIdBxqG8OjQQiAyY/%3Fv%3D73d79a89bded/https/cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon%402.png


[15-Nov-19 06:53 AM] dimxy#2587
yes, thank you, 
I'm testing the suggested fix for this


[15-Nov-19 06:53 AM] dukeleto#7326
groovy. Android support is super awesome and important to have working well


[15-Nov-19 06:54 AM] dimxy#2587
I also found this article but seems in nspv there is a cleaner way to shutdown the thread, thank you


[18-Nov-19 05:37 AM] Slyris#2880
We agree that if I use the call rpc `spend` without `broadcast`  then I risk nothing? No funds are locked and the balance is not reduced?


[18-Nov-19 05:42 AM] jl777c#5810
spend is purely local, cannot affect the blockchain.


[18-Nov-19 05:51 AM] Slyris#2880
Okay thank you so much.

Now I have another question, for example I am in a video game, I have the sufficient number of gold to buy an item, I buy this item, visually I see immediately that my golds have been debited from my wallet. In the case of the blockchain we have to wait for the confirmation to be sure of the transaction, the feeling of play will not be skewed by the fact of seeing its sum debited later and receive his item only once the confirmed transaction?

(everything using nspv)


[18-Nov-19 05:53 AM] jl777c#5810
i cant speak top the gameplay aspect, but you should be able to mask over the fact it takes a minute to confirm


[18-Nov-19 05:54 AM] Slyris#2880
I can obviously visually immediately reduce the balance, it is not a problem but in case there has been a problem of transaction must be able to restore the state correctly.


[18-Nov-19 05:54 AM] jl777c#5810
as soon as it is pending, it is very very likely it will confirm, so it can be displayed as pending and then marked complete when confirmed. well, actually, until notarized, it isnt 100% permanent as it could get reorged, but that is unlikely


[18-Nov-19 05:54 AM] Slyris#2880
Ok so in game wallet visually will have 2 balance: Available, Pending ?


[18-Nov-19 05:54 AM] Slyris#2880
I think it's likely what we want to achieve


[18-Nov-19 05:54 AM] jl777c#5810
i think if you just display things based on pending or confirmed, the blockchain state will restore your gamestate?


[18-Nov-19 05:55 AM] Slyris#2880
Yeah i mean if in the wallet instead of 1000golds i see: 900 Rick 100 Pending


[18-Nov-19 05:55 AM] jl777c#5810
you do need to make sure that if you assumed it was completed and it turns out it isnt, to undo whatever impact the orphaned tx had in the game


[18-Nov-19 05:55 AM] Slyris#2880
It's ok


[18-Nov-19 06:02 AM] Slyris#2880
do we have an nspv call where we give the txid and it's telling us if it's pending or completed ?

I see https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#mempool

But it's written `in development` means that's not finished yet ?

{Embed}
https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html
Komodo Documentation
Documentation for developers building on the Komodo Platform
https://images-ext-2.discordapp.net/external/pQcpVLQgfWglPr7tkLLPNfnaXLp21V6nGaMQYJYPkho/https/docs.komodoplatform.com/Dev_Docs_Introduction_small.png


[18-Nov-19 06:03 AM] Slyris#2880
There is also `spentinfo` that i can use after the `broadcast`.


[18-Nov-19 06:04 AM] Slyris#2880
i also see that: https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#txproof

Is using a rpc call named `gettransaction` but it's not documented yet i think

{Embed}
https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html
Komodo Documentation
Documentation for developers building on the Komodo Platform
https://images-ext-2.discordapp.net/external/pQcpVLQgfWglPr7tkLLPNfnaXLp21V6nGaMQYJYPkho/https/docs.komodoplatform.com/Dev_Docs_Introduction_small.png


[18-Nov-19 06:46 AM] jl777c#5810
mempool rpc works


[18-Nov-19 06:46 AM] jl777c#5810
so you can scan for txid to be in mempool or not


[18-Nov-19 06:46 AM] jl777c#5810
if it isnt, you can check to see if it is confirmed


[18-Nov-19 06:46 AM] jl777c#5810
with txproof


[18-Nov-19 07:23 AM] TonyL#3577
@jl777c I think I've broke the nSPV (crashed on my side): https://paste.ubuntu.com/p/jnjbnqV4yz/

What I did is such call:
``` curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "gettransaction", "params": ["e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c854",1 ] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/ | jq```


[18-Nov-19 07:23 AM] TonyL#3577
There was an example in documentation with existing tx `e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855` and it works fine, that I wanted to check which error it'll return in case of non-existing tx so changed last number in txid and it crashed


[18-Nov-19 07:29 AM] jl777c#5810
pushed fix to jl777 branch


[18-Nov-19 07:29 AM] Slyris#2880
@Sir Seven Do not hesitate to sync release from github too ^ i will probably need to use this call to


[18-Nov-19 07:35 AM] jl777c#5810
once the bug fix is confirmed, i will propagate to the other branches


[18-Nov-19 07:37 AM] TonyL#3577
```{
  "result": "error",
  "error": "could not get tx."
}
```


[18-Nov-19 07:37 AM] TonyL#3577
looks like it's fine now - just very very long response time


[18-Nov-19 07:38 AM] TonyL#3577
`real    0m30.087s`


[18-Nov-19 07:39 AM] jl777c#5810
it is the timeout


[18-Nov-19 07:53 AM] TonyL#3577
Ah, but no crash now


[18-Nov-19 07:54 AM] TonyL#3577
```time curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "gettransaction", "params": ["e07709088fa2690fdc71b43b5d7760689e42ca90f7dfb74b18bf47a1ad94c855",1 ] }' -H 'content-type: text/plain;' http://127.0.0.1:7771/ | jq
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   658    0   511  100   147   4961   1427 --:--:-- --:--:-- --:--:--  6388
{
  "hex": "0400008085202f8901c25ecb12f5fc17120bf92ed18ff71754b5f58e6eece2fba44fc114f14176df04010000006a4730440220732047807944afcb062f5dc7af87fe5b9979e447cd235ef1b130e50008c3d51a02201b232814bcee9c0b5a29aa24d453e493cd121a0e21d94c0e84476de0a15e74a101210217a6aa6c0fe017f9e469c3c00de5b3aa164ca410e632d1c04169fd7040e20e06ffffffff02401ac805000000001976a914d020156e7d0fead249cfb5a458952ae941ac9f9e88ac5800fb0b000000001976a9144726f2838fc4d6ac66615e10604e18926e9b556e88ac06a5355d000000000000000000000000000000",
  "retcode": 0
}

real    0m0.127s
user    0m0.025s
sys    0m0.008s```


[18-Nov-19 07:54 AM] TonyL#3577
for existing transaction it works super fast


[18-Nov-19 07:58 AM] jl777c#5810
yes, it queries peers, if a response comes in, it returns. if not, it waits, but no response will arrive. maybe it is sending a "not found" response at the low level. someone can dig into this and make it respond faster for not found txid, but it seems in most cases the valid txid is queried

{Reactions}
üëç 

[19-Nov-19 12:10 AM] Slyris#2880
nvm


[19-Nov-19 12:10 AM] jl777c#5810
no, i have spent fractions before


[19-Nov-19 12:10 AM] Slyris#2880
nevermind, my mistake in json was implicitly converted to std::size_t


[19-Nov-19 12:10 AM] Slyris#2880
double -> was changed to 0


[19-Nov-19 12:10 AM] jl777c#5810
oh, that is indeed too small


[19-Nov-19 12:10 AM] Slyris#2880
üòÑ


[19-Nov-19 12:11 AM] Slyris#2880
It's the moment where i will use `broadcast` epic fail are coming üòÑ


[19-Nov-19 12:12 AM] Slyris#2880
@jl777c There is a branch or an ongoing development for tokensCC + nspv ?


[19-Nov-19 12:31 AM] jl777c#5810
@Mihailo is working on CC over nspv


[21-Nov-19 07:50 PM] Bryan_Beus#6442
With nspv, can we only execute commands that are in the nSPV API in the documentation?
https://developers.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#enabling-the-nspv-client

{Embed}
https://developers.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html
Komodo Developer Documentation
Documentation for developers building on the Komodo Platform
https://images-ext-2.discordapp.net/external/JRuH6_LDrjOGd6HbRckiIc9OBFcyJGE1c7DjCukFvtA/https/developers.komodoplatform.com/start-here-pics/Dev_Docs_Introduction_small.png


[21-Nov-19 07:51 PM] Bryan_Beus#6442
So, we couldn't do like a KVstore API command with nSPV, could we?


[21-Nov-19 10:00 PM] jl777c#5810
KV really should deprecated, oracles are much better. and we are working on doing CC over nSPV, just not done yet


[22-Nov-19 06:16 AM] SHossain#0007
we don't want to use KV anymore as PoC?


[22-Nov-19 06:26 AM] jl777c#5810
it has scaling issues, we should start deprecating it


[22-Nov-19 07:01 AM] dukeleto#7326
good to know


[22-Nov-19 01:58 PM] Regnar#6164
@PTYX ^^

{Reactions}
3040_kingpeepo (2) 

[08-Dec-19 08:54 AM] PHBA2061 | VietStaking Validator#2530
I'm launching NSPV chain with the pinned parameters, on komodod 0.5.0 , but I'm not able to sync any block, Idk if it is just me


[08-Dec-19 09:06 AM] jl777c#5810
maybe try connecting to 5.9.102.210, the stated seed node seems to not accept more than a few connections


[08-Dec-19 10:51 AM] PHBA2061 | VietStaking Validator#2530
actually I had to remove the `-nSPV=1` parameter when launching komodod, otherwise it wouldn't start syncing


[08-Dec-19 11:30 AM] jl777c#5810
-nSPV=1 makes it a superlite client, it wont sync


[08-Dec-19 11:30 AM] jl777c#5810
that is sort of the point for it


[08-Dec-19 11:40 AM] PHBA2061 | VietStaking Validator#2530
oh I didn't know that, thanks for the explanation


[24-Dec-19 03:58 PM] Regnar#6164
Which current chains are nSPV capable for testing? Are RICK and MORTY?


[24-Dec-19 09:17 PM] gcharang#6833
@Regnar all the coins in this file
<https://github.com/jl777/libnspv/blob/master/coins>
with the field `nspv` have been tested to work well with nSPV
docs: <https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html>
note that antara modules aren't ready for testing yet
most smart chains should work with nspv

{Reactions}
üëå 

[25-Dec-19 03:56 PM] Regnar#6164
Oh HUSH, cool. I need to up my work on Hush stuff


[25-Dec-19 08:22 PM] Tylor zkFS#8280
Wow...I thought only KMD asset were covered with nspv..guess notaries are nota other chains too??? I might be misunderstanding


[25-Dec-19 08:22 PM] Tylor zkFS#8280
Good to know that list is longer than I thought


[26-Dec-19 02:34 PM] Tylor zkFS#8280
This document doesn't say all of this coins are supported  https://komodoplatform.com/nspv-next-generation-spv/  double check for correct info

{Embed}
Daniel
https://komodoplatform.com/nspv-next-generation-spv/
nSPV: Komodo's Next Generation Simple Payment Verification (SPV)
The Komodo Dev Team has created nSPV, a superlight client that's 1000 times faster than existing simple payment verificaiton (SPV) methods. Learn more here.
https://images-ext-1.discordapp.net/external/1VnmcNKavmVFCOpP9TNDqvbN1Z1fsffve2lMMi062VE/https/komodoplatform.com/wp-content/uploads/2019/08/nSPV-banner-image-jpg.jpg


[26-Dec-19 09:52 PM] Smedley#8094
Would it be possible to rewrite libnspv in javascript to run as a browser extension?


[26-Dec-19 09:54 PM] gcharang#6833
it is possible, but there is a "better" option
compile the libnspv written in C to web assembly, which can be run in a browser

{Reactions}
üëç üíØ 

[26-Dec-19 10:03 PM] gcharang#6833
@Tylor zkFS 
all the coins in https://github.com/jl777/libnspv/blob/master/coins are NOT supported
only the coins with the field nspv in their data

{Embed}
https://github.com/jl777/libnspv/blob/master/coins
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[27-Dec-19 07:27 AM] Tylor zkFS#8280
I am blind


[27-Dec-19 08:01 PM] Mylo#8306
https://github.com/jl777/libnspv#how-to-build-in-termux-on-android

{Embed}
https://github.com/jl777/libnspv
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[27-Dec-19 08:01 PM] Mylo#8306
Who has built on android/arm9 ?


[27-Dec-19 08:02 PM] Mylo#8306
This is an interesting integration platform to build on `https://www.cnx-software.com/2019/12/27/this-business-card-is-a-3-linux-computer-powered-by-allwinner-f1c100s-soc/amp/`


[27-Dec-19 08:37 PM] jl777c#5810
i dont remember who did it


[27-Dec-19 09:50 PM] gcharang#6833
@grewalsatinder or @dimxy built on android I think


[28-Dec-19 02:46 PM] Tylor zkFS#8280
I thought @radix42


[28-Dec-19 02:48 PM] radix42#3743
no i built on arm7 linus


[28-Dec-19 08:00 PM] grewalsatinder#9653
@Mylo there are instructions to build on Android, using Termix. But that will give a binary nSPV.
@dimxy made a separate module which calls nSPV functions and made it compatible for Android. Check his Github repository. But it has to be compiled on Android OS itself, using Termix I think.
I will try to solve compiling it over computer after New year.


[28-Dec-19 08:03 PM] grewalsatinder#9653
I was just practicing C and learned how to make a separate C file to call nSPV functions. dimxy's implimentation is obviously great and much better.


[28-Dec-19 09:47 PM] Mylo#8306
ok thanks @grewalsatinder for info - very useful to know.  i'll not be looking at nspv on arm immediately, but good to know for some manufacturers

{Reactions}
üëç üôÇ üëå 

[02-Jan-20 09:57 AM] kremer#0658
is there a limitation to the amount of requests that can be made to nspv servers over a period of time?


[02-Jan-20 09:58 AM] jl777c#5810
yes


[02-Jan-20 09:59 AM] jl777c#5810
1 per second from a specific node for a specific message


[02-Jan-20 10:10 AM] kremer#0658
ok ty


[05-Jan-20 05:25 PM] Regnar#6164
So I'm still pretty new to working with Github (so hopefully I did it right) but I just made some pull requests for the libnspv repo üòÑ


[05-Jan-20 05:28 PM] Regnar#6164

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/663554434197880852/unknown.png


[05-Jan-20 05:29 PM] Regnar#6164
This way your Seed and WIF are hidden from view until you hover over them and then you can copy and paste them. Just some HTML/CSS tricks


[06-Jan-20 09:08 PM] Regnar#6164
and we're merged üòÑ


[07-Jan-20 02:53 PM] Paro#7842
```paro@ub-komodo:~/libnspv$ ./nspv MARMARATEST &
[1] 39345
paro@ub-komodo:~/libnspv$ Found (MARMARATEST) magic.cc652259, p2p.47508 seeds.(52.150.41.146)
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash MARMARATEST
Start NSPV_rpcloop.47507
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:47507 bind sock.3 API enabled at unixtime.1578437355 <<<<<<<<<
Discover MARMARATEST peers...Trying to connect to 1 52.150.41.146:47508
max rpc threads spawned and alive 0 <- 1
no nodes
no nodes
no nodes
node.1 reqhdr.0 hdrtotal.0 delay.43 k.2
no nodes
no nodes
no nodes
end of client runloop```
It closes after a while it's connected.
It runs for three or five seconds and closes.


[07-Jan-20 03:41 PM] Regnar#6164
@Paro what is `MARMARATEST`?


[07-Jan-20 03:42 PM] Paro#7842
my test blockchain


[07-Jan-20 03:42 PM] Regnar#6164
I just tried that and it couldn't find chain and defaulted to KMD


[07-Jan-20 03:42 PM] Paro#7842
I was using it in my blockchain.


[07-Jan-20 03:42 PM] Regnar#6164
are you also running a full node of your chain?


[07-Jan-20 03:43 PM] Regnar#6164
somewhere else I mean


[07-Jan-20 03:43 PM] Paro#7842
yes


[07-Jan-20 03:44 PM] Paro#7842
"52.150.41.146" works here


[07-Jan-20 03:46 PM] Regnar#6164
does your node have `-nSPV=1`?


[07-Jan-20 03:47 PM] Paro#7842
asset....conf ?


[07-Jan-20 03:47 PM] Paro#7842
I think I need to add


[07-Jan-20 03:48 PM] Regnar#6164
I'm not actually sure man, I'm pretty new to nspv. I would assume you have to adjust the conf file to include at least a starter node


[07-Jan-20 03:48 PM] Regnar#6164
<https://github.com/jl777/coins/blob/master/coins> like these have IPs for nodes under `"nspv":"52.150.41.146"`


[07-Jan-20 03:50 PM] Regnar#6164
but I also think your node needs to be started with the `nSPV=1` param too.


[07-Jan-20 03:51 PM] Regnar#6164
<https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#enabling-the-nspv-client>
`Copy the following code to the file named coins (located at the root level of the source directory).

(Change each value as appropriate for the desired Smart Chain.)`


[07-Jan-20 03:51 PM] Paro#7842
```
[
  {
    "coin": "MARMARATEST",
    "asset": "MARMARATEST",
    "fname": "MARMARATEST",
    "rpcport": 47509,
    "mm2": 2,
    "p2p": 47508,
    "magic": "cc652259",
    "nSPV": "37.148.210.158"
  }
```


[07-Jan-20 03:54 PM] Paro#7842
Are you currently using "libnspv" ?


[07-Jan-20 03:54 PM] Regnar#6164
```./nspv MARMARATEST
Found (MARMARATEST) magic.cc652259, p2p.47508 seeds.(37.148.210.158)
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash MARMARATEST
Start NSPV_rpcloop.47509
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:47509 bind sock.3 API enabled at unixtime.1578441236 <<<<<<<<<
Discover MARMARATEST peers...Trying to connect to 1 37.148.210.158:47508
Connected to node 1 37.148.210.158:47508
end of client runloop
```


[07-Jan-20 03:55 PM] Regnar#6164
yea i am, I'm seeing the same problem with that after adding it to my coins file


[07-Jan-20 03:56 PM] Paro#7842
```paro@ub-komodo:~/libnspv$ ./nspv MARMARATEST --debug
Found (MARMARATEST) magic.cc652259, p2p.47508 seeds.(37.148.210.158)
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash MARMARATEST
Start NSPV_rpcloop.47507
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:47507 bind sock.3 API enabled at unixtime.1578441357 <<<<<<<<<
Discover MARMARATEST peers...DEBUG :Trying to connect to 1...
Trying to connect to 1 37.148.210.158:47508
DEBUG :Event callback on node 1
Connected to node 1 37.148.210.158:47508
DEBUG :Successfull connected to node 1.
DEBUG :sending message to node 1: version
DEBUG :Connected nodes: 1
DEBUG :received command from node 1: reject
DEBUG :Event callback on node 1
DEBUG :Disconnected from the remote peer 1.
DEBUG :Connected nodes: 0
end of client runloop
paro@ub-komodo:~/libnspv$
```


[07-Jan-20 03:58 PM] Paro#7842
I'm building a different branch `jl777`


[07-Jan-20 03:58 PM] Paro#7842
```https://github.com/jl777/libnspv/tree/jl777```


[07-Jan-20 04:02 PM] Paro#7842
yea i saw


[07-Jan-20 04:02 PM] Paro#7842
```DEBUG :Event callback on node 1
Connected to node 1 37.148.210.158:47508
DEBUG :Successfull connected to node 1.
DEBUG :sending message to node 1: version
DEBUG :Connected nodes: 1
bind(37.148.210.158) port.47509 failed: Cannot assign requested address sock.7. errno.99
bind(37.148.210.158) port.47509 failed: Cannot assign requested address sock.7. errno.99
bind(37.148.210.158) port.47509 failed: Cannot assign requested address sock.7. errno.99
bind(37.148.210.158) port.47509 failed: Cannot assign requested address sock.7. errno.99
bind(37.148.210.158) port.47509 failed: Cannot assign requested address sock.7. errno.99
bind(37.148.210.158) port.47509 failed: Cannot assign requested address sock.7. errno.99
```


[07-Jan-20 04:14 PM] Regnar#6164
so is it the port number choice?


[07-Jan-20 04:18 PM] Paro#7842
rpcport 47509
p2pport 47508


[07-Jan-20 04:18 PM] Paro#7842
nspv port : 47507


[07-Jan-20 04:19 PM] Paro#7842
http://prntscr.com/qklvrc

{Embed}
http://prntscr.com/qklvrc
Screenshot
Captured with Lightshot
https://images-ext-2.discordapp.net/external/CeENj24PO-A3rgZjk2ddm7lGMCYIFLorRXpJbBGg0vk/https/image.prntscr.com/image/T6m6TugTRIOGw_TVQw8mnA.png


[07-Jan-20 04:30 PM] Paro#7842
1 after receiving data.  disconnecting
http://prntscr.com/qklyjo

{Embed}
http://prntscr.com/qklyjo
Screenshot
Captured with Lightshot
https://images-ext-2.discordapp.net/external/2ti2Ont21C0XSHg_QIl0YwjvkpEw9Kxv1_YLZOUE00Y/https/image.prntscr.com/image/QJoJ_bWqQXS25-jZneTLFw.png


[07-Jan-20 04:48 PM] Regnar#6164
does your chain have dPoW?


[07-Jan-20 04:50 PM] Regnar#6164
I think nSPV only works with dPoW, otherwise what would be the purpose of syncing to the last notarized point if your chain isn't the one being notarized?


[07-Jan-20 04:52 PM] Paro#7842
the problem I think on our server


[07-Jan-20 04:52 PM] Regnar#6164
okay so yes dPoW


[07-Jan-20 04:54 PM] Regnar#6164
what are the params you use to set up the full node?


[07-Jan-20 05:00 PM] Paro#7842
```./komodod -ac_name=MARMARATEST -ac_supply=2000000 -ac_cc=2 -addnode=37.148.210.158 -addressindex=1 -spentindex=1 -ac_marmara=1 -ac_staked=75 -ac_reward=3000000000 -pubkey= &
```


[07-Jan-20 05:00 PM] Regnar#6164
I think you need `-nSPV=1`


[07-Jan-20 05:01 PM] Regnar#6164
check the channel message*


[07-Jan-20 05:01 PM] Regnar#6164
```./komodod -nSPV=1 -ac_reward=100000000  -ac_name=NSPV -ac_supply=10000000000 -ac_cc=2 -addressindex=1 -spentindex=1 -connect=5.9.102.210 &
./komodod -nSPV=1 -addnode=5.9.253.195 &```


[07-Jan-20 05:02 PM] Paro#7842
```./komodod -ac_name=MARMARATEST -ac_supply=2000000 -ac_cc=2 -addnode=37.148.210.158 -addressindex=1 -spentindex=1 -ac_marmara=1 -ac_staked=75 -ac_reward=3000000000 -nSPV=1 &
```


[07-Jan-20 05:02 PM] Regnar#6164
yea maybe


[07-Jan-20 05:04 PM] Regnar#6164
@Paro <https://discordapp.com/channels/412898016371015680/594906735467036682/610218568310718465>


[07-Jan-20 05:04 PM] Regnar#6164
oh wait nvm


[07-Jan-20 05:05 PM] Regnar#6164
that's to run the Komdod as nSPV and not full node


[07-Jan-20 05:05 PM] Paro#7842
i saw


[07-Jan-20 05:05 PM] Paro#7842
But I've never used it like this before.


[07-Jan-20 05:06 PM] Regnar#6164
I mean, adding it to the params would (i think) make your full node an nSPV only. which isn't what we want.


[07-Jan-20 05:06 PM] Paro#7842
no


[07-Jan-20 05:06 PM] Paro#7842
I want to use "libnspv".


[07-Jan-20 05:06 PM] Regnar#6164
So there is probably some other reason the regular nspv isn't working


[07-Jan-20 05:06 PM] Paro#7842
But he's making mistakes the way I used it before.


[07-Jan-20 05:07 PM] Paro#7842
yes connecting works breaks after 3-5 seconds https://discordapp.com/channels/412898016371015680/594906735467036682/664264591412297758


[07-Jan-20 05:07 PM] Paro#7842
I don't think it's compatible with MarmaraCC.


[07-Jan-20 05:08 PM] Paro#7842
MarmaraCC has changed a lot.


[07-Jan-20 05:08 PM] Paro#7842
Look at when @dimxy  or @jl777c  arrives.


[07-Jan-20 05:09 PM] Paro#7842
we'll make a nspv wallet


[07-Jan-20 05:11 PM] Regnar#6164
sounds good, nSPV is pretty new to me as well


[07-Jan-20 05:11 PM] Paro#7842
nspv is very easy and very nice.


[07-Jan-20 05:14 PM] Regnar#6164
Yea so far it is great


[07-Jan-20 10:34 PM] jl777c#5810
was this issue resolved?


[07-Jan-20 10:50 PM] Paro#7842
Unfortunately, it's not solved. It's still going on.


[07-Jan-20 10:51 PM] Paro#7842
I've tried every branch.


[07-Jan-20 11:18 PM] jl777c#5810
do you get peers?


[07-Jan-20 11:18 PM] jl777c#5810
does the basic wallet info work?


[07-Jan-20 11:39 PM] Paro#7842
yes


[07-Jan-20 11:39 PM] Paro#7842
There are problems MarmaraCC also i think it stems from this.


[07-Jan-20 11:40 PM] Paro#7842
the prize earned. "blockchain" again deletes


[07-Jan-20 11:42 PM] Paro#7842
I'm trying to identify the error


[07-Jan-20 11:43 PM] Paro#7842
That's another problem.  `It has nothing to do with "nspv".`


[11-Jan-20 07:40 AM] Tylor zkFS#8280
is it possible to add other coins in  the future to nSPV tech or will it only be KMD assets forever and ever?


[11-Jan-20 07:47 AM] jl777c#5810
nSPV supports both core changes and notarization


[20-Jan-20 03:11 AM] ns408#8889
hey team.
Looking at https://github.com/dimxy/libnspv/tree/fix-android#android and wondering if we need to be able to do that without Termux or if there are any other challenges in building cross platform builds. For eg: building android builds on macOS

{Embed}
https://github.com/dimxy/libnspv/tree/fix-android
dimxy/libnspv
Tiny Bitcoin Library written in C, with nSPV added - dimxy/libnspv
https://images-ext-2.discordapp.net/external/FG7_8N0jtCftKtsAk7K5U05eeO1dpQWPnEQ9A5NQLBI/%3Fs%3D400%26v%3D4/https/avatars0.githubusercontent.com/u/21120539


[20-Jan-20 03:25 AM] grewalsatinder#9653
@dimxy üëÜ


[20-Jan-20 03:26 AM] grewalsatinder#9653
If cross build of Android is not done yet, @ns408 has done some progress on that solution üôÇ

{Reactions}
üëç 

[20-Jan-20 03:29 AM] dimxy#2587
great! I'll see this solution

{Reactions}
üëç (2) 

[20-Jan-20 03:30 AM] grewalsatinder#9653
I'm also looking forward to test it üôÇ 
@ns408

{Reactions}
üëç 

[20-Jan-20 05:15 AM] Mylo#8306
anyone tested this for cross compiling?  http://nickdesaulniers.github.io/blog/2016/07/01/android-cli/

{Embed}
http://nickdesaulniers.github.io/blog/2016/07/01/android-cli/
Cross Compiling C/C++ for Android - Nick Desaulniers
Let‚Äôs say you want to build a hello world command line application in C or C++
and run it on your Android phone. How would you go about it? It‚Äôs not ‚Ä¶


[20-Jan-20 05:25 AM] Mylo#8306
following the instructions on this page, i get all the compilers & linkers etc. installed in my `~/dev/arm` dir.
here is a list of the contents 2 levels deep to save you the effort, maybe you can recognize some stuff that could work.
https://gist.github.com/imylomylo/34d379aaf2e5813da46345e1cd97849f


[20-Jan-20 05:51 AM] Mylo#8306
I've read a bit more into this rabbit hole.  Definitely not in my current skill set - maybe in 2008 was more my cross compile golden-age....if i have time late mid-late february and it's still an open issue, i might be able to revisit.


[20-Jan-20 05:59 AM] ns408#8889
Will take parts from it that we can reuse.
I'm working on this but will be refactoring once all the pieces come together: https://github.com/Meshbits/libnspv/blob/myCC/build_android.sh

{Embed}
https://github.com/Meshbits/libnspv/blob/myCC/build_android.sh
Meshbits/libnspv
Tiny Bitcoin Library written in C, with nSPV added - Meshbits/libnspv
https://images-ext-2.discordapp.net/external/oG1NSLO43GsOfVF2_OLOhN4Ytj7loW9-2SfeGfRCOD0/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/37174660

{Reactions}
üëå 

[20-Jan-20 06:52 AM] ns408#8889
So, it worked.

```
panda-mac:libnspv panda 01:46 am
$ file nspv
nspv: ELF 64-bit LSB pie executable ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /system/, not stripped
```
Binary got built - not been able to test because that would need to be run on an android arm64 platform. _And for the same reason, I didn't run `make check`.

I'd appreciate a few other people trying it - if possible, especially if you push binaries to android devices on daily basis.
Script is less than optimal but works - so any changes, suggestions are welcome.

Details of the only change I had made to `Makefile.am` logged in https://github.com/Meshbits/libnspv/commits/myCC along with other comments and reasons.

Lessons learnt:
- ndk is amazing but you really gotta know the switches and which paths, targets, host values will make a difference. Learnt (through frustration) a bit about android api level and sometimes instead of relying on env variable, it simply points to a binary. Eg: `export CC=$TOOLCHAIN/bin/aarch64-linux-android28-clang` in the script was previously pointing to `android21-clang` and that got me fairly frustrated cause I couldn't figure out why libevent compilation was failing. Dev (who was amazingly helpful) pointed out the API level version but still couldn't see that before eventually realising that I need to get `28`.
- `pthreads` not needed for android binaries and cause failures while trying to build binaries.

{Embed}
https://github.com/Meshbits/libnspv/commits/myCC
Meshbits/libnspv
Tiny Bitcoin Library written in C, with nSPV added - Meshbits/libnspv
https://images-ext-2.discordapp.net/external/oG1NSLO43GsOfVF2_OLOhN4Ytj7loW9-2SfeGfRCOD0/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/37174660

{Reactions}
üëç (2) 

[20-Jan-20 05:46 PM] Mylo#8306
man that's awesome!!  i'm doing a workshop Tue-Fri so won't be able to test until weekend.

{Reactions}
üëç 

[20-Jan-20 11:19 PM] ns408#8889
Thanks @Mylo. No problem. Whenever you get a chance.


[21-Jan-20 12:35 AM] ns408#8889
@ca333 does the above solve any problem. If you guys are doing any cross-platform compilation, I would be happy to help setup android compilation for libnspv in the CI/CD pipeline.
cc @grewalsatinder @dimxy

{Reactions}
üëç (2) üéÖ 

[27-Jan-20 12:02 AM] grewalsatinder#9653
@ns408 did @ca333 or @dimxy or anybody else contact you on your efforts if it's any use for nspv project or Games/Android SDK project?


[27-Jan-20 12:08 AM] dimxy#2587
I switched urgently to another project for the last 2 weeks.
Soon I return to libnspv and I'll try to use your code. Thank you for your efforts, @ns408!

{Reactions}
üëç (2) 

[27-Jan-20 12:10 AM] grewalsatinder#9653
@dimxy appreciate for the update mate üôÇ 
Please keep us updated and let us know if we could be of any help anywhere further üëç

{Reactions}
üëç 

[27-Jan-20 12:12 AM] grewalsatinder#9653
I asked @ns408 to be available in case this needs to be setup for CI/CD, so was expecting someone might have contacted him, but I was unaware of any such update.


[27-Jan-20 12:13 AM] grewalsatinder#9653
anyway, once the required changes are in dimxy's repo, I guess then it'd be good to do CI/CD setup


[21-Mar-20 01:18 PM] Paro#7842
Can anyone use "nspv" as url?


[21-Mar-20 04:02 PM] Regnar#6164
@Paro what do you mean?


[21-Mar-20 04:24 PM] Paro#7842
"nspv" is not available as "http://ip:port/api" ?


[21-Mar-20 04:24 PM] Paro#7842
it didn't work that way.


[21-Mar-20 04:58 PM] Alright#0419
@Paro yes


[21-Mar-20 04:58 PM] Alright#0419
it is TCP


[21-Mar-20 06:33 PM] Mylo#8306
Instructions on github worked for me on Linux & Android (termux).


[15-Apr-20 02:14 PM] Alright#0419
I need to use nspv via python, has anyone had any luck with this yet?


[15-Apr-20 02:18 PM] TonyL#3577
https://github.com/tonymorony/nspv_pywallet if you mean rpc calls

{Embed}
https://github.com/tonymorony/nspv_pywallet
tonymorony/nspv_pywallet
simple Python wallet based on Komodo nSPV technology - tonymorony/nspv_pywallet
https://images-ext-2.discordapp.net/external/IULxymVak7WPV8PZwfkPCOyLSBf6KKjfvRL8wa24Vjc/%3Fs%3D400%26v%3D4/https/avatars1.githubusercontent.com/u/24797699


[15-Apr-20 02:20 PM] Alright#0419
No, I'm trying to p2p messages in python


[15-Apr-20 02:20 PM] Alright#0419
not using daemon


[15-Apr-20 02:20 PM] TonyL#3577
Ah, I see


[15-Apr-20 02:21 PM] Alright#0419
I know electrum fork does typical p2p messages, but I was hoping to find something much simpler üòÖ


[15-Apr-20 02:23 PM] TonyL#3577
https://github.com/namuyan/p2p-python maybe something like that will add inspiration üòÑ

{Embed}
https://github.com/namuyan/p2p-python
namuyan/p2p-python
Simple peer2peer library. designed for bc4py project. - namuyan/p2p-python
https://images-ext-1.discordapp.net/external/wJe4ssMYAdUmFYuYIa1sEOETFxOxUfRKN34MxC-b_Ec/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/19928816


[15-Apr-20 02:25 PM] Alright#0419
https://en.bitcoin.it/wiki/Protocol_documentation#Message_types
electrum seems to have most(maybe all?) of these implemented, but doesn't look fun to implement new nspv messages

{Embed}
https://en.bitcoin.it/wiki/Protocol_documentation
Protocol documentation


[16-Apr-20 06:06 PM] Mylo#8306
@Alright noted & v.interested though not keen cos of current workload.


[16-Apr-20 06:08 PM] Mylo#8306
I‚Äôve got 2 py blog posts coming out. One from your mining chan convert address snippet & pbca cpl weeks ago had an electrum sapling example fyi


[17-Apr-20 05:57 AM] Alright#0419
@Mylo was wrong about electrum having p2p messages implemented. It just uses the electrum api


[17-Apr-20 05:57 AM] Alright#0419
the server itself should though? Not sure, haven't had a moment to look through it


[17-Apr-20 09:22 AM] pbca26#5430
it requires a daemon so i doubt it can do any p2p messaging
it's simply an indexer service similar to insight

{Reactions}
üôÅ 

[17-Apr-20 03:45 PM] Mylo#8306
Cool thanks for clarifying. Of course!


[30-Jun-20 07:55 PM] vichiet#4058
Hello . Where can I find the last nspv executable for windows ? Thanks in advance


[30-Jun-20 10:44 PM] grewalsatinder#9653
you can use the build instructions:
https://github.com/jl777/libnspv#how-to-build-libnspv-with-libbtc-and-tools

{Embed}
https://github.com/jl777/libnspv
jl777/libnspv
Tiny Bitcoin Library written in C, with nSPV added - jl777/libnspv
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[01-Jul-20 01:16 AM] gcharang#6833
@vichiet there is no official windows executable. you will have to compile it on linux and then use it in windows
instructions: https://hackmd.io/@gcharang/H12rBpF08

{Embed}
https://hackmd.io/@gcharang/H12rBpF08
nspv windows build - HackMD
# nspv windows build  Clone  ```bash git clone https://github.com/jl777/libnspv/ cd libnspv git chec
https://images-ext-2.discordapp.net/external/LPlGDN5uQsliFWiAuM4XKx0Myz76uEuSsH2_8s-I7l0/%3Fs%3D400/https/avatars.githubusercontent.com/u/21151592

{Reactions}
üëÄ 

[01-Jul-20 01:34 AM] Mylo#8306
Pinned a message.


[01-Jul-20 01:57 AM] TonyL#3577
https://github.com/jl777/libnspv/pull/178 opened PR to fix that broken build script, also James propagated deps changes which were only in dev branch before (libsodium working url) so its possible to build any branch atm (all in sync actually)

{Embed}
https://github.com/jl777/libnspv/pull/178
fix broken win build script by tonymorony ¬∑ Pull Request #178 ¬∑ jl7...
https://images-ext-1.discordapp.net/external/ZluS_vPUp--Ma1oFnNdhU0YaB0OEwzwGFNPA2N_uSAk/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/5962559


[01-Jul-20 02:00 AM] TonyL#3577
so to build on windows you have to install deps/configure posix mode mingw according to: https://github.com/komodoplatform/komodo#windows and then run build script

{Embed}
https://github.com/komodoplatform/komodo
KomodoPlatform/komodo
Komodo. Contribute to KomodoPlatform/komodo development by creating an account on GitHub.
https://images-ext-2.discordapp.net/external/RDvx2WIoH0iRzE_70DuHLDOM6rqONFcnMd4HT0XBnOI/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/21276113


[01-Jul-20 03:51 AM] vichiet#4058
Thanks for all answers . I will try tonight


[07-Jul-20 05:56 AM] vichiet#4058
Thanks for your help. I succeeded to compile npsv

{Reactions}
üëç 

[13-Jul-20 07:48 AM] pbca26#5430
in case someone will need pre-built nspv binaries for dev or personal use
tested to work on all 3 os
https://github.com/pbca26/libnspv/releases/tag/v0.3

{Embed}
https://github.com/pbca26/libnspv/releases/tag/v0.3
Release NSPV v0.3 ¬∑ pbca26/libnspv
libwinpthread-1.dll source: https://sourceforge.net/projects/sixtyfourbitcompiles/files/64bit/libwinpthread-1.dll/download?use_mirror=autoselect
https://images-ext-1.discordapp.net/external/eAyZeHiy4WW9wZ48j56fGdLeddChc61iEXHM6kAeHvs/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/7769879

{Reactions}
üëç (6) 

[14-Oct-20 02:54 AM] mahatini#6912
kmd has side chain?


[14-Oct-20 05:02 AM] gcharang#6833
independant chains called Smart Chains can be launched using Komodo's technology: <https://developers.komodoplatform.com/basic-docs/smart-chains/smart-chain-tutorials/create-a-default-smart-chain.html> @mahatini


[14-Oct-20 05:04 AM] mahatini#6912
I mean, what's  difference between Smart Chain and Side Chain...


[14-Oct-20 05:05 AM] mahatini#6912
Seeing the doc


[14-Oct-20 05:06 AM] gcharang#6833
smart chains are completely independant chains that can be launched by anyone. they have access to all the komodo features/technologies/tools etc.,

side chains in bitcoin world are alternate chains whose coins mirror the value of a main chain. there may be other differences based on who is answering


[14-Oct-20 05:12 AM] mahatini#6912
Thanks gc


[14-Oct-20 05:12 AM] mahatini#6912
I am reading https://developers.komodoplatform.com/basic-docs/smart-chains/smart-chain-tutorials/create-a-default-smart-chain.html#introduction

{Embed}
https://developers.komodoplatform.com/basic-docs/smart-chains/smart-chain-tutorials/create-a-default-smart-chain.html
Creating Komodo Smart Chains
(when the goal is only to build a new Smart Chain, there is no need to sync the KMD main chain)
https://images-ext-2.discordapp.net/external/JRuH6_LDrjOGd6HbRckiIc9OBFcyJGE1c7DjCukFvtA/https/developers.komodoplatform.com/start-here-pics/Dev_Docs_Introduction_small.png


[14-Oct-20 05:13 AM] mahatini#6912
Be frankly, I wonder... why there is not any snapshot


[14-Oct-20 05:16 AM] mahatini#6912
Maybe that will be more friendly for newbie...?


[14-Oct-20 05:16 AM] gcharang#6833
what do you mean by no snapshot?


[14-Oct-20 05:17 AM] grewalsatinder#9653
illustrations I think is what he means

{Reactions}
üëç 

[14-Oct-20 05:18 AM] mahatini#6912
screen shot, picture, to show what command is being used, in VPS terminal(command line)


[14-Oct-20 05:21 AM] gcharang#6833
all the commands can be used by directly copy pasting in the appropriate directories, I am not sure what extra information can be gained by seeing the same commands in a picture?


[14-Oct-20 05:22 AM] mahatini#6912
@Paro ,  I am new to use Discord,  may I know, how you pasted the Screenshot?


[14-Oct-20 05:23 AM] mahatini#6912
I am using Mac, what is the short-key, I tried Command - V,  also, Shift - Command - V, none can work


[14-Oct-20 05:25 AM] gcharang#6833
> how you pasted the Screenshot?
you can upload the image to an external site and share the link here


[14-Oct-20 05:27 AM] mahatini#6912
Part I: Creating a New Komodo Smart Chain
With your machines successfully able to ping each other, you are ready to create your first Smart Chain.

The following instructions use the simplest possible set of parameters in creating a new Smart Chain: a coin with the ticker symbol HELLOWORLD, 777777 pre-mined coins, and a block reward of .0001.

On your first node, change into the directory where Komodo's komodod and komodo-cli are installed and execute the following commands in the terminal:


[14-Oct-20 05:27 AM] mahatini#6912
On your first node, change into the directory where Komodo's komodod and komodo-cli are installed and execute the following commands in the terminal:


[14-Oct-20 05:27 AM] mahatini#6912
means,  I should install komodo-cli, first


[14-Oct-20 05:28 AM] mahatini#6912
also komodod


[14-Oct-20 05:28 AM] mahatini#6912
how to install 'komodod' and 'komodo-cli'


[14-Oct-20 05:30 AM] gcharang#6833
installation: <https://developers.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/installing-from-source.html>


[14-Oct-20 05:31 AM] mahatini#6912
see it, thanks


[14-Oct-20 05:35 AM] gcharang#6833
@mahatini you can continue asking questions in the #ü§ù‚îÇgeneral-support or #üíª‚îÉdev-general channel. this channel is reserved for discussions about nspv tech


[26-Nov-20 06:45 AM] grewalsatinder#9653
m able to compile nspv on Apple Silicon mac üôÇ

{Reactions}
ü§î üëè 

[26-Nov-20 06:45 AM] grewalsatinder#9653
```
‚ûú  libnsvpm1 git:(master) ‚úó ls -lh nspv
-rwxr-xr-x  1 satinder  staff   784K 27 Nov 03:44 nspv
‚ûú  libnsvpm1 git:(master) ‚úó file nspv
nspv: Mach-O 64-bit executable arm64
‚ûú  libnsvpm1 git:(master) ‚úó
```


[26-Nov-20 06:50 AM] grewalsatinder#9653
installed Homebrew using instructions from this video:
https://www.youtube.com/watch?v=nv2ylxro7rM
basically this script:
https://gist.github.com/nrubin29/bea5aa83e8dfa91370fe83b62dad6dfa
command:
```
/bin/bash -c "$(curl -fsSL https://gist.githubusercontent.com/nrubin29/bea5aa83e8dfa91370fe83b62dad6dfa/raw/48f48f7fef21abb308e129a80b3214c2538fc611/homebrew_m1.sh)"
```
```
source ~/.zshrc
brew install libevent libsodium
git clone https://github.com/jl777/libnspv
cd libnspv
./autogen.sh
DIREVENT="/opt/homebrew/Cellar/libevent/2.1.12"
DIRSODIUM="/opt/homebrew/Cellar/libsodium/1.0.18_1"
./configure CFLAGS="-I$DIREVENT/include -I$DIRSODIUM/include" LDFLAGS="-L$DIREVENT/lib -L$DIRSODIUM/lib"
make
```


[03-Jan-21 04:36 PM] Regnar#6164
I'm having trouble running nSPV for KMD
installed from here <https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#installation>
It runs for a few seconds, enough that I can see the wallet in browser and interact for a short while but thats it, it stops afterwards.
```
./nspv KMD
027e3758c3a65b12aa1046462b486d0a63bfa1beae327897f56c5cfb7daaae71 genesisblockhash KMD
Start NSPV_rpcloop.7771
>>>>>>>>>> NSPV_rpcloop 127.0.0.1:7771 bind sock.3 API enabled at unixtime.1609720434 <<<<<<<<<
Discover KMD peers...Trying to connect to 1 5.9.102.210:7770
Trying to connect to 2 45.32.19.196:7770
Trying to connect to 3 5.9.253.195:7770
Trying to connect to 4 78.47.196.146:7770
Trying to connect to 5 23.254.165.16:7770
Trying to connect to 6 136.243.58.134:7770
Trying to connect to 7 5.9.253.196:7770
Trying to connect to 8 5.9.253.197:7770
Trying to connect to 9 5.9.253.198:7770
Trying to connect to 10 5.9.253.199:7770
Trying to connect to 11 5.9.253.200:7770
Trying to connect to 12 5.9.253.201:7770
Trying to connect to 13 5.9.253.202:7770
Trying to connect to 14 5.9.253.203:7770
Connected to node 6 136.243.58.134:7770
Connected to node 2 45.32.19.196:7770
node.1 reqhdr.0 hdrtotal.0 delay.31 k.2
node.3 reqhdr.0 hdrtotal.0 delay.37 k.2
node.10 reqhdr.0 hdrtotal.0 delay.42 k.2
node.9 reqhdr.0 hdrtotal.0 delay.38 k.2
node.8 reqhdr.0 hdrtotal.0 delay.41 k.2
node.7 reqhdr.0 hdrtotal.0 delay.32 k.2
node.13 reqhdr.0 hdrtotal.0 delay.36 k.2
node.14 reqhdr.0 hdrtotal.0 delay.33 k.2
node.4 reqhdr.0 hdrtotal.0 delay.36 k.2
node.11 reqhdr.0 hdrtotal.0 delay.40 k.2
node.12 reqhdr.0 hdrtotal.0 delay.41 k.2
end of client runloop
```


[04-Jan-21 07:28 AM] pbca26#5430
@Regnar  try this binary https://github.com/pbca26/libnspv/releases/tag/v0.3.1 it was working well for me
alternatively you can clone the repo and build it under your git handle

{Embed}
https://github.com/pbca26/libnspv/releases/tag/v0.3.1
Release NSPV v0.3.1 ¬∑ pbca26/libnspv
win libwinpthread-1.dll source: https://sourceforge.net/projects/sixtyfourbitcompiles/files/64bit/libwinpthread-1.dll/download?use_mirror=autoselect
https://images-ext-1.discordapp.net/external/eAyZeHiy4WW9wZ48j56fGdLeddChc61iEXHM6kAeHvs/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/7769879

{Reactions}
üëç 

[05-Jan-21 06:17 AM] Regnar#6164
That appears to be working thanks!


[05-Jan-21 06:22 AM] Regnar#6164
why type of webserver is this for the GUI? I suspected Flask or another Python type but I'm not seeing any obvious structures. also i'm not too familar with variables coming in `$` format for python


[05-Jan-21 06:36 AM] Regnar#6164
I'm trying to find where this variable `$LOGIN_SEED_NOTICE` comes from since there is a spelling error in it.
```libnspv$ grep -r "LOGIN_SEED_NOTICE" *
html/logout:<div class="alert alert-danger" role="alert">$LOGIN_SEED_NOTICE</div>
html/index:<div class="alert alert-danger" role="alert">$LOGIN_SEED_NOTICE</div>
html/login:<div class="alert alert-danger" role="alert">$LOGIN_SEED_NOTICE</div>```


[05-Jan-21 06:38 AM] Regnar#6164
I assume many of the `$` variables are from text outputs from the daemon and plugged into Python variables to be served to HTML with some template language, I'm just not sure which framework this is using.


[05-Jan-21 07:48 AM] gcharang#6833
@grewalsatinder can help I think


[05-Jan-21 07:54 AM] gcharang#6833
I think code from this file generates the html GUI https://github.com/pbca26/libnspv/blob/master/src/tools/nSPV_htmlgui.h

{Embed}
https://github.com/pbca26/libnspv/blob/master/src/tools/nSPV_htmlgui.h
pbca26/libnspv
Tiny Bitcoin Library written in C, with nSPV added - pbca26/libnspv
https://images-ext-1.discordapp.net/external/eAyZeHiy4WW9wZ48j56fGdLeddChc61iEXHM6kAeHvs/%3Fs%3D400%26v%3D4/https/avatars2.githubusercontent.com/u/7769879


[05-Jan-21 07:59 AM] Regnar#6164
Yea that does seem to be where the variables are coming from. I don't know C, but I'll see if I can work that out


[05-Jan-21 08:06 AM] Regnar#6164
hmm actually, it looks like every "page" is receiving all the variables, which is simple


[05-Jan-21 08:10 AM] Regnar#6164
`grep -o "\$[A-Z_]\+" nSPV_htmlgui.h | sort -u` appears to give all the named variables too


[05-Jan-21 08:21 AM] Regnar#6164
I'm trying to understand how the URL mapping works in this, specifically, can I add a new endpoint to serve different html file


[05-Jan-21 09:10 AM] Regnar#6164
lol okay I'm no further than I was an hour ago... *insert Edison quote about 10,000 ways it wont work*


[05-Jan-21 10:40 AM] Regnar#6164

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/796085663903907870/unknown.png


[05-Jan-21 10:41 AM] Regnar#6164
ideally I'd like to make a page that is designed to specifically fit in Chrome extension size windows. It could be a cool way to interact with nSPV wallets running in the backgrounds without having to keep a window open, or navigating to a local host endpoint all the time


[05-Jan-21 10:47 AM] Regnar#6164
as for the chrome extensions, they are pretty easy to build a basic version. This is just the localhost in an iframe.


[05-Jan-21 10:50 AM] Regnar#6164
so technically there could be an "extension" url endpoint with just the basics, address, balance, send, etc. laid out to be a basic interface and maybe an "admin" button which opens a new tab with the full GUI so more details can be worked out.


[05-Jan-21 10:51 AM] Regnar#6164
but I've been fumbling through unfamiliar code in an unfamilar language for too long today lol


[05-Jan-21 02:23 PM] grewalsatinder#9653
There is no framework for http.
It is all C language HTTP calls coded in nspv.
I made the HTML page templates with variables which are filled with data through C code.
HTML is bootstrap css, and is mobile friendly.


[05-Jan-21 03:56 PM] Regnar#6164
yea I was able to figure a bit of it out. though I wasn't really sure on adding a new page.


[05-Jan-21 11:15 PM] grewalsatinder#9653
Yea adding a new page definitely would need C languages changes


[05-Jan-21 11:16 PM] grewalsatinder#9653
If you can go through the logic of existing pages you will know how to


[05-Jan-21 11:16 PM] grewalsatinder#9653
But it will be C language changes to add a new page

{Reactions}
üëç 

[06-Jan-21 01:14 PM] Regnar#6164
Yea I don't know C so it's been an adventure...er..nightmare

{Reactions}
üëçüèº 

[07-Jan-21 09:23 AM] Regnar#6164
shooting for something like this

{Attachments}
https://cdn.discordapp.com/attachments/594906735467036682/796791166561419304/unknown.png


[07-Jan-21 09:24 AM] Regnar#6164
as a chrome extension using nspv


[07-Jan-21 09:25 AM] grewalsatinder#9653
I think you should target your own GUI app mate


[07-Jan-21 09:25 AM] grewalsatinder#9653
if you want something like this


[07-Jan-21 09:30 AM] Regnar#6164
honestly I was going to just make it to compliment nSPV wallet already. So not as a standalone, but as another way to interface with Komodo's own nSPV


[07-Jan-21 09:30 AM] Regnar#6164
I don't know enough about the wallet itself to build that. I know Python and some web languages. but no C etc


[07-Jan-21 09:31 AM] grewalsatinder#9653
you don't need C understanding, just it's API calls


[07-Jan-21 09:31 AM] grewalsatinder#9653
https://developers.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#introduction


[07-Jan-21 09:32 AM] grewalsatinder#9653
try it's API calls


[07-Jan-21 09:32 AM] grewalsatinder#9653
and make your own GUI around it in python and html etc


[07-Jan-21 09:32 AM] grewalsatinder#9653
or whatever you can use to make gui


[07-Jan-21 09:32 AM] Regnar#6164
I helped make the python nspv GUI


[07-Jan-21 09:33 AM] grewalsatinder#9653
that's cool üëç


[07-Jan-21 09:34 AM] Regnar#6164
<https://github.com/tonymorony/nspv_pywallet> which was just using the RPC calls. I just thought it would be easier to add a "page" to the current wallet that was displayed like a chrome extension, then point the extension iframe at that page.


[07-Jan-21 09:36 AM] grewalsatinder#9653
how you will manage the starting of `./nspv` command from chrome extension ?


[07-Jan-21 09:36 AM] Regnar#6164
prayer?


[07-Jan-21 09:36 AM] grewalsatinder#9653
üòÇ


[07-Jan-21 09:37 AM] Regnar#6164
again, it wasn't going to be something standalone.


[07-Jan-21 09:37 AM] grewalsatinder#9653
if user has to trigger `./nspv` themselves from cli and then open chrome and then extension, then it's same as opening the URL


[07-Jan-21 09:38 AM] Regnar#6164
it's more like, leave nspv running in background, use browser like normal, occassionally open that extension and interact.


[07-Jan-21 09:38 AM] Regnar#6164
I wasn't intending to spend any significant amount of time, or even make it a standalone thing, just have another way users/devs could interact with it should they choose


[07-Jan-21 09:40 AM] Regnar#6164
though this does have me considering the alternative, a standalone nspv wallet/gui/maybe extension


[07-Jan-21 09:42 AM] Regnar#6164
This looks pretty cool <https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Emscripten>


[07-Jan-21 10:13 AM] Regnar#6164
actually, an idea for Komodo in general would be an ultra lightweight desktop application using nSPV and maybe something like this <https://neutralino.js.org/> Idk much about the project besides it's an electron clone that's "lightweight"
comparison <https://github.com/neutralinojs/evaluation>


[07-Jan-21 11:00 AM] pbca26#5430
verus wallet has nspv integrated so you can cross electron out of the list already
although they never released it i think
besides that i also did electrum wallet nspv PoC
so there are more nspv client alternatives exist for devs than meets the eye


[07-Jan-21 11:01 AM] pbca26#5430
if i'm not mistaken dimxy is working on browser version for nspv


[07-Jan-21 11:02 AM] pbca26#5430
so one day running so called extension w/o local proxies will be possible


[07-Jan-21 11:26 AM] Regnar#6164
that would be pretty cool


[07-Jan-21 11:27 AM] Regnar#6164
I'd love to see a slick GUI nSPV based wallet for KMD that is <10mb


[07-Jan-21 02:24 PM] pbca26#5430
i'm looking forward to that day myself üôÇ


[07-Jan-21 02:26 PM] pbca26#5430
zero install would be even better but that will imply degraded security


[07-Jan-21 02:39 PM] NutellaLicka#4241
```so there are more nspv client alternatives exist for devs than meets the eye```
There are more dev options on KMD than meets the eye. I don't think people realise the opportunities that are available on the KMD platform.


[08-Jan-21 05:59 AM] Regnar#6164
I'm not familar with this term, `zero install`


[08-Jan-21 08:35 PM] daemonfox#6136
This can;t be stated enough. The problem is making things turnkey.

{Reactions}
üëç 

[08-Jan-21 08:36 PM] daemonfox#6136
It means something like, make a web address call with all params of what you want and t one transaction complets. Done, no install just dAPP style integrations with single minimal steps to broadcasta nd confirm.

{Reactions}
üëç 

[20-Jan-21 06:38 AM] daemonfox#6136
Can you point me at this pls? Ppl are showing interest in more nSPV solutions especially looking at aDEX evolution.


[20-Jan-21 06:40 AM] daemonfox#6136
Your PoC.


[20-Jan-21 12:05 PM] pbca26#5430 (pinned)
@daemonfox 
https://github.com/pbca26/electrum-komodo/tree/nspv
https://github.com/VerusCoin/Verus-Desktop/commit/6eff620932117f8787bb8450c53cdd7a2ce567ff


[20-Jan-21 12:15 PM] daemonfox#6136
TY!


[21-Jan-21 02:11 AM] Mylo#8306
Pinned a message.


[03-Feb-21 12:07 PM] NutellaLicka#4241
Referring to https://discord.com/channels/412898016371015680/463445317136809984/806477231538962452 
@dimxy do you know how nSPV may change?


[03-Feb-21 11:55 PM] dimxy#2587
one of the questions currently I am studying is how to optimise the delivery of nspv node list to clients

{Reactions}
üëç 

[10-Feb-21 08:20 PM] Tylor zkFS#8280
I was thinking private IPFS @dimxy and or 32 Master Nodes / NN ops--- I have the DB pretty much solved


[10-Feb-21 08:21 PM] Tylor zkFS#8280
add some old school to the new - Orbit DB


[21-Feb-21 12:32 PM] daria#0156
Hello üëã  is there an existing js wrapper for nSPV by any chance? I looked around but didnt seem to find one. Dont want to reinvent the wheel if someone has already made one üôÇ


[21-Feb-21 02:10 PM] Mylo#8306
Unlikely

{Reactions}
üëå üôè 

[21-Feb-21 03:21 PM] grewalsatinder#9653
I think someone tried to make it. Not sure if it was @dimxy or @ca333


[21-Feb-21 03:21 PM] grewalsatinder#9653
M talking about the wasm build of nspv


[21-Feb-21 03:22 PM] grewalsatinder#9653
Since it is all C code it can be compiled to wasm.


[21-Feb-21 03:22 PM] grewalsatinder#9653
Not sure how many issues there might be to solve at first.


[22-Feb-21 01:42 AM] ca333#0333
yes @dimxy is actively working on this technology layer - he making entire Komodo, NSPV and CC tech stack (Antara,..) full compatible with web-stack - huge progress happening on this field.


[22-Feb-21 01:45 AM] dimxy#2587
yes I have an experimental cc in js implementation, connected over nspv to komodod. I'll update the github and post a link there

{Reactions}
treasure (7) üíØ (6) üöÄ (6) 

[22-Feb-21 02:31 AM] grewalsatinder#9653
Cool üôÇüëçüèº


[22-Feb-21 05:46 AM] Mylo#8306
that's pretty exciting


[22-Feb-21 10:50 AM] daria#0156
That sounds great. Looking forward to check it out. üòä thank you


[02-Mar-21 05:45 AM] dimxy#2587
@daria @grewalsatinder @NutellaLicka 
here is my experimental code with nspv support:
https://github.com/dimxy/komodo/tree/websockets-support - a build with embedded websocketspp lib support (use 'make clean' and './zcutil/build.sh --enable-websockets' to build)
https://github.com/dimxy/bitgo-komodo-cc-lib bitgo javascript lib fork with cryptoconditions and nspv protocol added, it has a js cc faucet sample running in browser or in node.js, allows to create faucet fund and get transactions

{Reactions}
üëç (2) ü§ô 

[02-Mar-21 11:14 AM] NutellaLicka#4241
Thanks mate! Hopefully we can contribute to this codebase and get it off the ground üôÇ

{Reactions}
üëç 

[03-Mar-21 02:32 PM] Mylo#8306
Mylo ikomodo post placeholder


[07-Mar-21 06:27 PM] daria#0156
hi there üëã I got a couple of questions on nspv. Getting all my knowledge from here ->  https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-setup/nspv.html#introduction

What does the "id" stand for in the curl requests, I dont see any description of what it should be. The examples have "curltest". I assume it s a random value but what is it for?

Also, I dont see any method accepting the seed phrase as some sort of recovery method. Shouldnt there be some method which will accept it and allow user to regain access to their funds?

Thx to whoever s got some answers üôÇ


[07-Mar-21 06:38 PM] grewalsatinder#9653
@daria with login you can use wif or seed


[07-Mar-21 06:40 PM] daria#0156
I saw that it works in the browser interface, but it doesnt say so in the docs. I guess outdated docs üôÇ Thx @grewalsatinder

{Reactions}
üëç 

[07-Mar-21 06:52 PM] grewalsatinder#9653
M not sure the purpose of id either ü§î
But that is custom for sure, applications specific.
Maybe @gcharang or @dimxy can clear on it better


[07-Mar-21 08:24 PM] gcharang#6833
id is used to associate a response with the curl command that requested it. atleast thats how it works with komodod. see example (curl command and response) here: https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-api/address.html#getaddressbalance

{Embed}
https://docs.komodoplatform.com/basic-docs/smart-chains/smart-chain-api/address.html
Address Index
The following RPC calls interact with the komodod software, and are made available through the komodo-cli software.
https://images-ext-2.discordapp.net/external/JRuH6_LDrjOGd6HbRckiIc9OBFcyJGE1c7DjCukFvtA/https/developers.komodoplatform.com/start-here-pics/Dev_Docs_Introduction_small.png


[07-Mar-21 08:32 PM] daria#0156
@gcharang so it sort of identifies the caller? e.g. I will make id in my requests "tokel" ?


[07-Mar-21 08:35 PM] gcharang#6833
not the caller. just the particular curl command

say you use id: abc for a command requesting balance
then, without waiting for the response, you send another command to send coins to and address with id: def

you can match the responses and their commands by matching the ids

not sure nspv returns ids in the response, but komodod itself does


[07-Mar-21 08:48 PM] daria#0156
ah I see, thank you for clarifying. I dont think nspv returns ids in the response.


[07-Mar-21 08:49 PM] daria#0156
so in theory I can just skip it entirely since nspv does not work with those.


[07-Mar-21 09:10 PM] daria#0156
hmm, **another question on nspv,** it seems like I always receive success no matter what I put as login params, even if I put "socks" ü§£ 

```
curl --data-binary '{"jsonrpc": "2.0", "id":"curltest", "method": "login", "params": ["socks"] }' -H 'content-type: text/plain;' http://127.0.0.1:7771
```

response
```
{"result":"success","status":"wif will expire in 777 seconds","address":"REH9srTNZP143zQw2N6psTbpZHv4Q1E3B6","pubkey":"02b525a24c4252104425d443bc8515d0f60487942569224ff688ef1325516a2238","wifprefix":34,"compressed":0}
```

Not sure what to think of that ü§∑‚Äç‚ôÄÔ∏è  Is that intended behavior? I can literlly type in anything and it logs me into some wallet. Addresses are always different.


[07-Mar-21 09:23 PM] gcharang#6833
you can use any words as seed words. they just won't be secure. in atomicdex, if you select "custom seed", you can use "socks" as seed words as well


[07-Mar-21 09:55 PM] daria#0156
@gcharang I see, so then in theory that means I guessed someone's seed. But I have tried putting in totall jibberish and completely random strings and I still login. I cant possibly keep on guessing other people's seeds all the timeü§∑‚Äç‚ôÄÔ∏è  It almost looks like new addresses are created on login


[07-Mar-21 10:06 PM] gcharang#6833
it is not someone's seed. it is just a seed. a properly constructed seed is so random that it can't be guessed in a billion years even if all the computing power in the world is used to bruteforce it.

the gibberish seeds are also valid seeds and address/privkey pairs can be created from them. it is just that they are not secure and can be  bruteforced. So, the wallet must generate seed words that are from the bip39 list (2048 words) and they should be generated using proper cryptographic randomness


[07-Mar-21 10:11 PM] daria#0156
thank you for your explanation, that makes perfect sense üôÇ @gcharang  üôè

{Reactions}
üëç 

[10-Jun-21 07:41 PM] Mylo#8306
anyone tested libnspv and KV?


[11-Jun-21 12:37 AM] NutellaLicka#4241
Together or separately? We have been using libnspv in Tokel, but not KV i dont believe


[11-Jun-21 12:08 PM] Alright#0419
@Mylo KV is outdated tech, would not recommend using it


[11-Jun-21 03:45 PM] Mylo#8306
outdated yes, but for simple data, it still works & it works simply.


[11-Jun-21 03:45 PM] Mylo#8306
for my PoC MVP, i just need something to work p2p, kv is dead simple


[11-Jun-21 03:46 PM] Mylo#8306
it's like CC training wheels üòÑ


[11-Jun-21 10:29 PM] jorian#4555
in b4 Alright breaks its chain

{Reactions}
ü§£ 

[17-Jun-21 03:36 AM] NutellaLicka#4241
Can libnspv/libbtc be used on the CHIPS blockchain?


[17-Jun-21 05:47 AM] grewalsatinder#9653
@dimxy I also want to know that üôÇ


[17-Jun-21 05:47 AM] grewalsatinder#9653
If there are changes required to make CHIPS work with libnspv, can you please help there?


[17-Jun-21 08:05 AM] dimxy#2587
i think there is no specific nSPV command support in CHIPS yet. The basic bitcoin p2p protocol could only be used


[17-Jun-21 08:06 AM] jl777c#5810
the changes to the p2p messaging were not that much, just a couple of hooks into calling the nspv code, so shouldnt take too much work to port it into CHIPS


[17-Jun-21 03:00 PM] NutellaLicka#4241
Im still working out whether it would be something worthwhile doing for the project. The biggest thing I can think of is that people could manage their chips quickly using a super lite wallet. I dont see how it would come into any gameplay though.


[18-Jun-21 01:07 AM] NutellaLicka#4241
Is it possible to run multiple nspv instances for different coins at the same time, and interact with them at the same time?


[18-Jun-21 01:09 AM] jl777c#5810
dont see any reason why it couldnt be done


[18-Jun-21 01:09 AM] jl777c#5810
might even work without any changes, just launch multiple times with different ports and coins


[18-Jun-21 01:16 AM] NutellaLicka#4241
Great news. @daria lets try to keep this channel up to date with any nSPV testing we do (once we get to that stage). 
For everyones awareness, Tokel has a beautiful working GUI nSPV wallet. We were discussing whether we put effort into converting this into a multi-chain wallet as well, so we could run Komodo & Tokel (and whatever other coins people would like) within the same wallet interface. 

A multi-chain superlite wallet would be pretty cool.


[18-Jun-21 01:17 AM] jl777c#5810
indeed


[18-Jun-21 02:02 AM] grewalsatinder#9653
yes, and much needed too üôÇ üëç

{Reactions}
Tokel labs 

[18-Sep-21 08:47 PM] PTYX#6840
it definitely would be more useful to any user to have it as a multiwallet.

{Reactions}
KMD 

==============================================================
Exported 6,043 message(s)
==============================================================
